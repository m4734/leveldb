cscope 15 $HOME/leveldb-1.22               0001150984
	@build/CMakeFiles/3.10.2/CompilerIdC/CMakeCCompilerId.c

1 #ifdeà
__ılu¥lus


5 #ià
defšed
(
__18CXX
)

6 
	#ID_VOID_MAIN


	)

8 #ià
defšed
(
__CLASSIC_C__
)

10 cÚ¡

	)

11 vŞ©e

	)

18 #ià
defšed
(
__INTEL_COMPILER
è|| defšed(
__ICC
)

19 
	#COMPILER_ID
 "IÁ–"

	)

20 #ià
defšed
(
_MSC_VER
)

21 
	#SIMULATE_ID
 "MSVC"

	)

24 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__INTEL_COMPILER
/100)

	)

25 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__INTEL_COMPILER
/10 % 10)

	)

26 #ià
defšed
(
__INTEL_COMPILER_UPDATE
)

27 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER_UPDATE
)

	)

29 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER
 % 10)

	)

31 #ià
defšed
(
__INTEL_COMPILER_BUILD_DATE
)

33 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__INTEL_COMPILER_BUILD_DATE
)

	)

35 #ià
defšed
(
_MSC_VER
)

37 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

38 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

41 #–ià
defšed
(
__PATHCC__
)

42 
	#COMPILER_ID
 "P©hSÿË"

	)

43 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PATHCC__
)

	)

44 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PATHCC_MINOR__
)

	)

45 #ià
defšed
(
__PATHCC_PATCHLEVEL__
)

46 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PATHCC_PATCHLEVEL__
)

	)

49 #–ià
defšed
(
__BORLANDC__
è&& defšed(
__CODEGEARC_VERSION__
)

50 
	#COMPILER_ID
 "Emb¬ÿd”o"

	)

51 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>24 & 0x00FF)

	)

52 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>16 & 0x00FF)

	)

53 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__CODEGEARC_VERSION__
 & 0xFFFF)

	)

55 #–ià
defšed
(
__BORLANDC__
)

56 
	#COMPILER_ID
 "BÜÏnd"

	)

58 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__BORLANDC__
>>8)

	)

59 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__BORLANDC__
 & 0xFF)

	)

61 #–ià
defšed
(
__WATCOMC__
) && __WATCOMC__ < 1200

62 
	#COMPILER_ID
 "W©com"

	)

64 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__WATCOMC__
 / 100)

	)

65 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10è% 10)

	)

66 #ià(
__WATCOMC__
 % 10) > 0

67 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

70 #–ià
defšed
(
__WATCOMC__
)

71 
	#COMPILER_ID
 "O³nW©com"

	)

73 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__WATCOMC__
 - 1100è/ 100)

	)

74 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10è% 10)

	)

75 #ià(
__WATCOMC__
 % 10) > 0

76 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

79 #–ià
defšed
(
__SUNPRO_C
)

80 
	#COMPILER_ID
 "SunPro"

	)

81 #ià
__SUNPRO_C
 >= 0x5100

83 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_C
>>12)

	)

84 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_C
>>4 & 0xFF)

	)

85 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_C
 & 0xF)

	)

88 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_C
>>8)

	)

89 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_C
>>4 & 0xF)

	)

90 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_C
 & 0xF)

	)

93 #–ià
defšed
(
__HP_cc
)

94 
	#COMPILER_ID
 "HP"

	)

96 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__HP_cc
/10000)

	)

97 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__HP_cc
/100 % 100)

	)

98 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__HP_cc
 % 100)

	)

100 #–ià
defšed
(
__DECC
)

101 
	#COMPILER_ID
 "Com·q"

	)

103 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__DECC_VER
/10000000)

	)

104 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__DECC_VER
/100000 % 100)

	)

105 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__DECC_VER
 % 10000)

	)

107 #–ià
defšed
(
__IBMC__
è&& defšed(
__COMPILER_VER__
)

108 
	#COMPILER_ID
 "zOS"

	)

110 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

111 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

112 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

114 #–ià
defšed
(
__IBMC__
è&& !defšed(
__COMPILER_VER__
) && __IBMC__ >= 800

115 
	#COMPILER_ID
 "XL"

	)

117 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

118 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

119 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

121 #–ià
defšed
(
__IBMC__
è&& !defšed(
__COMPILER_VER__
) && __IBMC__ < 800

122 
	#COMPILER_ID
 "Visu®Age"

	)

124 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

125 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

126 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

128 #–ià
defšed
(
__PGI
)

129 
	#COMPILER_ID
 "PGI"

	)

130 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PGIC__
)

	)

131 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PGIC_MINOR__
)

	)

132 #ià
defšed
(
__PGIC_PATCHLEVEL__
)

133 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PGIC_PATCHLEVEL__
)

	)

136 #–ià
defšed
(
_CRAYC
)

137 
	#COMPILER_ID
 "C¿y"

	)

138 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_RELEASE_MAJOR
)

	)

139 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_RELEASE_MINOR
)

	)

141 #–ià
defšed
(
__TI_COMPILER_VERSION__
)

142 
	#COMPILER_ID
 "TI"

	)

144 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000000)

	)

145 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000 % 1000)

	)

146 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__TI_COMPILER_VERSION__
 % 1000)

	)

148 #–ià
defšed
(
__FUJITSU
è|| defšed(
__FCC_VERSION
è|| defšed(
__fcc_v”siÚ
)

149 
	#COMPILER_ID
 "Fuj™su"

	)

151 #–ià
defšed
(
__TINYC__
)

152 
	#COMPILER_ID
 "TšyCC"

	)

154 #–ià
defšed
(
__BCC__
)

155 
	#COMPILER_ID
 "Bruû"

	)

157 #–ià
defšed
(
__SCO_VERSION__
)

158 
	#COMPILER_ID
 "SCO"

	)

160 #–ià
defšed
(
__şªg__
è&& defšed(
__­¶e_bud_v”siÚ__
)

161 
	#COMPILER_ID
 "AµËCÏng"

	)

162 #ià
defšed
(
_MSC_VER
)

163 
	#SIMULATE_ID
 "MSVC"

	)

165 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__şªg_majÜ__
)

	)

166 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__şªg_mšÜ__
)

	)

167 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__şªg_·tchËv–__
)

	)

168 #ià
defšed
(
_MSC_VER
)

170 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

171 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

173 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__­¶e_bud_v”siÚ__
)

	)

175 #–ià
defšed
(
__şªg__
)

176 
	#COMPILER_ID
 "CÏng"

	)

177 #ià
defšed
(
_MSC_VER
)

178 
	#SIMULATE_ID
 "MSVC"

	)

180 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__şªg_majÜ__
)

	)

181 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__şªg_mšÜ__
)

	)

182 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__şªg_·tchËv–__
)

	)

183 #ià
defšed
(
_MSC_VER
)

185 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

186 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

189 #–ià
defšed
(
__GNUC__
)

190 
	#COMPILER_ID
 "GNU"

	)

191 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

192 #ià
defšed
(
__GNUC_MINOR__
)

193 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

195 #ià
defšed
(
__GNUC_PATCHLEVEL__
)

196 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

199 #–ià
defšed
(
_MSC_VER
)

200 
	#COMPILER_ID
 "MSVC"

	)

202 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

203 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

204 #ià
defšed
(
_MSC_FULL_VER
)

205 #ià
_MSC_VER
 >= 1400

207 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 100000)

	)

210 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 10000)

	)

213 #ià
defšed
(
_MSC_BUILD
)

214 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
_MSC_BUILD
)

	)

217 #–ià
defšed
(
__VISUALDSPVERSION__
è|| defšed(
__ADSPBLACKFIN__
è|| defšed(
__ADSPTS__
è|| defšed(
__ADSP21000__
)

218 
	#COMPILER_ID
 "ADSP"

	)

219 #ià
defšed
(
__VISUALDSPVERSION__
)

221 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__VISUALDSPVERSION__
>>24)

	)

222 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__VISUALDSPVERSION__
>>16 & 0xFF)

	)

223 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__VISUALDSPVERSION__
>>8 & 0xFF)

	)

226 #–ià
defšed
(
__IAR_SYSTEMS_ICC__
è|| defšed(
__IAR_SYSTEMS_ICC
)

227 
	#COMPILER_ID
 "IAR"

	)

228 #ià
defšed
(
__VER__
)

229 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__VER__
è/ 1000000)

	)

230 
	#COMPILER_VERSION_MINOR
 
	`DEC
(((
__VER__
è/ 1000è% 1000)

	)

231 
	#COMPILER_VERSION_PATCH
 
	`DEC
((
__VER__
è% 1000)

	)

232 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__IAR_SYSTEMS_ICC__
)

	)

235 #–ià
defšed
(
__ARMCC_VERSION
)

236 
	#COMPILER_ID
 "ARMCC"

	)

237 #ià
__ARMCC_VERSION
 >= 1000000

239 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/1000000)

	)

240 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 100)

	)

241 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

244 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/100000)

	)

245 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 10)

	)

246 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

250 #–ià
defšed
(
__SDCC_VERSION_MAJOR
è|| defšed(
SDCC
)

251 
	#COMPILER_ID
 "SDCC"

	)

252 #ià
defšed
(
__SDCC_VERSION_MAJOR
)

253 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__SDCC_VERSION_MAJOR
)

	)

254 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__SDCC_VERSION_MINOR
)

	)

255 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__SDCC_VERSION_PATCH
)

	)

258 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
SDCC
/100)

	)

259 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
SDCC
/10 % 10)

	)

260 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
SDCC
 % 10)

	)

263 #–ià
defšed
(
_SGI_COMPILER_VERSION
è|| defšed(
_COMPILER_VERSION
)

264 
	#COMPILER_ID
 "MIPS´o"

	)

265 #ià
defšed
(
_SGI_COMPILER_VERSION
)

267 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/100)

	)

268 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/10 % 10)

	)

269 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_SGI_COMPILER_VERSION
 % 10)

	)

272 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_COMPILER_VERSION
/100)

	)

273 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_COMPILER_VERSION
/10 % 10)

	)

274 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_COMPILER_VERSION
 % 10)

	)

281 #–ià
defšed
(
__sgi
)

282 
	#COMPILER_ID
 "MIPS´o"

	)

284 #–ià
defšed
(
__hpux
è|| defšed(
__hpua
)

285 
	#COMPILER_ID
 "HP"

	)

288 
	#COMPILER_ID
 ""

	)

295 cÚ¡* 
	gšfo_comp”
 = "INFO" ":" "comp”[" 
COMPILER_ID
 "]";

296 #ifdeà
SIMULATE_ID


297 cÚ¡* 
	gšfo_simuÏ‹
 = "INFO" ":" "simuÏ‹[" 
SIMULATE_ID
 "]";

300 #ifdeà
__QNXNTO__


301 cÚ¡* 
	gqnxÁo
 = "INFO" ":" "qnxnto[]";

304 #ià
defšed
(
__CRAYXE
è|| defšed(
__CRAYXC
)

305 cÚ¡ *
	gšfo_üay
 = "INFO" ":" "compiler_wrapper[CrayPrgEnv]";

308 
	#STRINGIFY_HELPER
(
X
è#X

	)

309 
	#STRINGIFY
(
X
è
	`STRINGIFY_HELPER
(X)

	)

312 #ià
defšed
(
__lšux
è|| defšed(
__lšux__
è|| defšed(
lšux
)

313 
	#PLATFORM_ID
 "Lšux"

	)

315 #–ià
defšed
(
__CYGWIN__
)

316 
	#PLATFORM_ID
 "Cygwš"

	)

318 #–ià
defšed
(
__MINGW32__
)

319 
	#PLATFORM_ID
 "MšGW"

	)

321 #–ià
defšed
(
__APPLE__
)

322 
	#PLATFORM_ID
 "D¬wš"

	)

324 #–ià
defšed
(
_WIN32
è|| defšed(
__WIN32__
è|| defšed(
WIN32
)

325 
	#PLATFORM_ID
 "Wšdows"

	)

327 #–ià
defšed
(
__F»eBSD__
è|| defšed(
__F»eBSD
)

328 
	#PLATFORM_ID
 "F»eBSD"

	)

330 #–ià
defšed
(
__N‘BSD__
è|| defšed(
__N‘BSD
)

331 
	#PLATFORM_ID
 "N‘BSD"

	)

333 #–ià
defšed
(
__O³nBSD__
è|| defšed(
__OPENBSD
)

334 
	#PLATFORM_ID
 "O³nBSD"

	)

336 #–ià
defšed
(
__sun
è|| defšed(
sun
)

337 
	#PLATFORM_ID
 "SunOS"

	)

339 #–ià
defšed
(
_AIX
è|| defšed(
__AIX
è|| defšed(
__AIX__
è|| defšed(
__aix
è|| defšed(
__aix__
)

340 
	#PLATFORM_ID
 "AIX"

	)

342 #–ià
defšed
(
__sgi
è|| defšed(
__sgi__
è|| defšed(
_SGI
)

343 
	#PLATFORM_ID
 "IRIX"

	)

345 #–ià
defšed
(
__hpux
è|| defšed(
__hpux__
)

346 
	#PLATFORM_ID
 "HP-UX"

	)

348 #–ià
defšed
(
__HAIKU__
)

349 
	#PLATFORM_ID
 "Haiku"

	)

351 #–ià
defšed
(
__BeOS
è|| defšed(
__BEOS__
è|| defšed(
_BEOS
)

352 
	#PLATFORM_ID
 "BeOS"

	)

354 #–ià
defšed
(
__QNX__
è|| defšed(
__QNXNTO__
)

355 
	#PLATFORM_ID
 "QNX"

	)

357 #–ià
defšed
(
__Œu64
è|| defšed(
_Œu64
è|| defšed(
__TRU64__
)

358 
	#PLATFORM_ID
 "Tru64"

	)

360 #–ià
defšed
(
__riscos
è|| defšed(
__riscos__
)

361 
	#PLATFORM_ID
 "RISCos"

	)

363 #–ià
defšed
(
__sšix
è|| defšed(
__sšix__
è|| defšed(
__SINIX__
)

364 
	#PLATFORM_ID
 "SINIX"

	)

366 #–ià
defšed
(
__UNIX_SV__
)

367 
	#PLATFORM_ID
 "UNIX_SV"

	)

369 #–ià
defšed
(
__bsdos__
)

370 
	#PLATFORM_ID
 "BSDOS"

	)

372 #–ià
defšed
(
_MPRAS
è|| defšed(
MPRAS
)

373 
	#PLATFORM_ID
 "MP-RAS"

	)

375 #–ià
defšed
(
__osf
è|| defšed(
__osf__
)

376 
	#PLATFORM_ID
 "OSF1"

	)

378 #–ià
defšed
(
_SCO_SV
è|| defšed(
SCO_SV
è|| defšed(
sco_sv
)

379 
	#PLATFORM_ID
 "SCO_SV"

	)

381 #–ià
defšed
(
__uÉrix
è|| defšed(
__uÉrix__
è|| defšed(
_ULTRIX
)

382 
	#PLATFORM_ID
 "ULTRIX"

	)

384 #–ià
defšed
(
__XENIX__
è|| defšed(
_XENIX
è|| defšed(
XENIX
)

385 
	#PLATFORM_ID
 "X’ix"

	)

387 #–ià
defšed
(
__WATCOMC__
)

388 #ià
defšed
(
__LINUX__
)

389 
	#PLATFORM_ID
 "Lšux"

	)

391 #–ià
defšed
(
__DOS__
)

392 
	#PLATFORM_ID
 "DOS"

	)

394 #–ià
defšed
(
__OS2__
)

395 
	#PLATFORM_ID
 "OS2"

	)

397 #–ià
defšed
(
__WINDOWS__
)

398 
	#PLATFORM_ID
 "Wšdows3x"

	)

401 
	#PLATFORM_ID


	)

405 
	#PLATFORM_ID


	)

414 #ià
defšed
(
_WIN32
è&& defšed(
_MSC_VER
)

415 #ià
defšed
(
_M_IA64
)

416 
	#ARCHITECTURE_ID
 "IA64"

	)

418 #–ià
defšed
(
_M_X64
è|| defšed(
_M_AMD64
)

419 
	#ARCHITECTURE_ID
 "x64"

	)

421 #–ià
defšed
(
_M_IX86
)

422 
	#ARCHITECTURE_ID
 "X86"

	)

424 #–ià
defšed
(
_M_ARM64
)

425 
	#ARCHITECTURE_ID
 "ARM64"

	)

427 #–ià
defšed
(
_M_ARM
)

428 #ià
_M_ARM
 == 4

429 
	#ARCHITECTURE_ID
 "ARMV4I"

	)

430 #–ià
_M_ARM
 == 5

431 
	#ARCHITECTURE_ID
 "ARMV5I"

	)

433 
	#ARCHITECTURE_ID
 "ARMV" 
	`STRINGIFY
(
_M_ARM
)

	)

436 #–ià
defšed
(
_M_MIPS
)

437 
	#ARCHITECTURE_ID
 "MIPS"

	)

439 #–ià
defšed
(
_M_SH
)

440 
	#ARCHITECTURE_ID
 "SHx"

	)

443 
	#ARCHITECTURE_ID
 ""

	)

446 #–ià
defšed
(
__WATCOMC__
)

447 #ià
defšed
(
_M_I86
)

448 
	#ARCHITECTURE_ID
 "I86"

	)

450 #–ià
defšed
(
_M_IX86
)

451 
	#ARCHITECTURE_ID
 "X86"

	)

454 
	#ARCHITECTURE_ID
 ""

	)

457 #–ià
defšed
(
__IAR_SYSTEMS_ICC__
è|| defšed(
__IAR_SYSTEMS_ICC
)

458 #ià
defšed
(
__ICCARM__
)

459 
	#ARCHITECTURE_ID
 "ARM"

	)

461 #–ià
defšed
(
__ICCAVR__
)

462 
	#ARCHITECTURE_ID
 "AVR"

	)

465 
	#ARCHITECTURE_ID
 ""

	)

468 
	#ARCHITECTURE_ID


	)

472 
	#DEC
(
n
) \

473 ('0' + (((
n
) / 10000000)%10)), \

474 ('0' + (((
n
) / 1000000)%10)), \

475 ('0' + (((
n
) / 100000)%10)), \

476 ('0' + (((
n
) / 10000)%10)), \

477 ('0' + (((
n
) / 1000)%10)), \

478 ('0' + (((
n
) / 100)%10)), \

479 ('0' + (((
n
) / 10)%10)), \

480 ('0' + ((
n
è% 10))

	)

483 
	#HEX
(
n
) \

484 ('0' + ((
n
)>>28 & 0xF)), \

485 ('0' + ((
n
)>>24 & 0xF)), \

486 ('0' + ((
n
)>>20 & 0xF)), \

487 ('0' + ((
n
)>>16 & 0xF)), \

488 ('0' + ((
n
)>>12 & 0xF)), \

489 ('0' + ((
n
)>>8 & 0xF)), \

490 ('0' + ((
n
)>>4 & 0xF)), \

491 ('0' + ((
n
è& 0xF))

	)

494 #ifdeà
COMPILER_VERSION_MAJOR


495 cÚ¡ 
	gšfo_v”siÚ
[] = {

498 
COMPILER_VERSION_MAJOR
,

499 #ifdeà
COMPILER_VERSION_MINOR


500 '.', 
COMPILER_VERSION_MINOR
,

501 #ifdeà
COMPILER_VERSION_PATCH


502 '.', 
COMPILER_VERSION_PATCH
,

503 #ifdeà
COMPILER_VERSION_TWEAK


504 '.', 
COMPILER_VERSION_TWEAK
,

512 #ifdeà
COMPILER_VERSION_INTERNAL


513 cÚ¡ 
	gšfo_v”siÚ_š‹º®
[] = {

517 
COMPILER_VERSION_INTERNAL
,']','\0'};

521 #ifdeà
SIMULATE_VERSION_MAJOR


522 cÚ¡ 
	gšfo_simuÏ‹_v”siÚ
[] = {

525 
SIMULATE_VERSION_MAJOR
,

526 #ifdeà
SIMULATE_VERSION_MINOR


527 '.', 
SIMULATE_VERSION_MINOR
,

528 #ifdeà
SIMULATE_VERSION_PATCH


529 '.', 
SIMULATE_VERSION_PATCH
,

530 #ifdeà
SIMULATE_VERSION_TWEAK


531 '.', 
SIMULATE_VERSION_TWEAK
,

542 cÚ¡* 
	gšfo_¶©fÜm
 = "INFO" ":" "¶©fÜm[" 
PLATFORM_ID
 "]";

543 cÚ¡* 
	gšfo_¬ch
 = "INFO" ":" "¬ch[" 
ARCHITECTURE_ID
 "]";

548 #ià!
defšed
(
__STDC__
)

549 #ià
defšed
(
_MSC_VER
è&& !defšed(
__şªg__
)

550 
	#C_DIALECT
 "90"

	)

552 
	#C_DIALECT


	)

554 #–ià
__STDC_VERSION__
 >= 201000L

555 
	#C_DIALECT
 "11"

	)

556 #–ià
__STDC_VERSION__
 >= 199901L

557 
	#C_DIALECT
 "99"

	)

559 
	#C_DIALECT
 "90"

	)

561 cÚ¡ * 
	gšfo_Ïnguage_dŸËù_deçuÉ
 =

562 "INFO" ":" "dŸËù_deçuÉ[" 
C_DIALECT
 "]";

566 #ifdeà
ID_VOID_MAIN


567 
	$maš
(è{
	}
}

569 #ià
defšed
(
__CLASSIC_C__
)

570 
	$maš
(
¬gc
, 
¬gv
) argc; *argv[];

572 
	$maš
(
¬gc
, * 
¬gv
[])

575 
»quœe
 = 0;

576 
»quœe
 +ğ
šfo_comp”
[
¬gc
];

577 
»quœe
 +ğ
šfo_¶©fÜm
[
¬gc
];

578 
»quœe
 +ğ
šfo_¬ch
[
¬gc
];

579 #ifdeà
COMPILER_VERSION_MAJOR


580 
»quœe
 +ğ
šfo_v”siÚ
[
¬gc
];

582 #ifdeà
COMPILER_VERSION_INTERNAL


583 
»quœe
 +ğ
šfo_v”siÚ_š‹º®
[
¬gc
];

585 #ifdeà
SIMULATE_ID


586 
»quœe
 +ğ
šfo_simuÏ‹
[
¬gc
];

588 #ifdeà
SIMULATE_VERSION_MAJOR


589 
»quœe
 +ğ
šfo_simuÏ‹_v”siÚ
[
¬gc
];

591 #ià
	`defšed
(
__CRAYXE
è|| defšed(
__CRAYXC
)

592 
»quœe
 +ğ
šfo_üay
[
¬gc
];

594 
»quœe
 +ğ
šfo_Ïnguage_dŸËù_deçuÉ
[
¬gc
];

595 ()
¬gv
;

596  
»quœe
;

597 
	}
}

	@build/CMakeFiles/3.10.2/CompilerIdCXX/CMakeCXXCompilerId.cpp

4 #iâdeà
__ılu¥lus


12 #ià
defšed
(
__COMO__
)

13 
	#COMPILER_ID
 "Com—u"

	)

15 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__COMO_VERSION__
 / 100)

	)

16 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__COMO_VERSION__
 % 100)

	)

18 #–ià
defšed
(
__INTEL_COMPILER
è|| defšed(
__ICC
)

19 
	#COMPILER_ID
 "IÁ–"

	)

20 #ià
defšed
(
_MSC_VER
)

21 
	#SIMULATE_ID
 "MSVC"

	)

24 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__INTEL_COMPILER
/100)

	)

25 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__INTEL_COMPILER
/10 % 10)

	)

26 #ià
defšed
(
__INTEL_COMPILER_UPDATE
)

27 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER_UPDATE
)

	)

29 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER
 % 10)

	)

31 #ià
defšed
(
__INTEL_COMPILER_BUILD_DATE
)

33 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__INTEL_COMPILER_BUILD_DATE
)

	)

35 #ià
defšed
(
_MSC_VER
)

37 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

38 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

41 #–ià
defšed
(
__PATHCC__
)

42 
	#COMPILER_ID
 "P©hSÿË"

	)

43 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PATHCC__
)

	)

44 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PATHCC_MINOR__
)

	)

45 #ià
defšed
(
__PATHCC_PATCHLEVEL__
)

46 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PATHCC_PATCHLEVEL__
)

	)

49 #–ià
defšed
(
__BORLANDC__
è&& defšed(
__CODEGEARC_VERSION__
)

50 
	#COMPILER_ID
 "Emb¬ÿd”o"

	)

51 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>24 & 0x00FF)

	)

52 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>16 & 0x00FF)

	)

53 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__CODEGEARC_VERSION__
 & 0xFFFF)

	)

55 #–ià
defšed
(
__BORLANDC__
)

56 
	#COMPILER_ID
 "BÜÏnd"

	)

58 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__BORLANDC__
>>8)

	)

59 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__BORLANDC__
 & 0xFF)

	)

61 #–ià
defšed
(
__WATCOMC__
) && __WATCOMC__ < 1200

62 
	#COMPILER_ID
 "W©com"

	)

64 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__WATCOMC__
 / 100)

	)

65 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10è% 10)

	)

66 #ià(
__WATCOMC__
 % 10) > 0

67 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

70 #–ià
defšed
(
__WATCOMC__
)

71 
	#COMPILER_ID
 "O³nW©com"

	)

73 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__WATCOMC__
 - 1100è/ 100)

	)

74 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10è% 10)

	)

75 #ià(
__WATCOMC__
 % 10) > 0

76 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

79 #–ià
defšed
(
__SUNPRO_CC
)

80 
	#COMPILER_ID
 "SunPro"

	)

81 #ià
__SUNPRO_CC
 >= 0x5100

83 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_CC
>>12)

	)

84 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_CC
>>4 & 0xFF)

	)

85 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_CC
 & 0xF)

	)

88 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_CC
>>8)

	)

89 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_CC
>>4 & 0xF)

	)

90 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_CC
 & 0xF)

	)

93 #–ià
defšed
(
__HP_aCC
)

94 
	#COMPILER_ID
 "HP"

	)

96 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__HP_aCC
/10000)

	)

97 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__HP_aCC
/100 % 100)

	)

98 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__HP_aCC
 % 100)

	)

100 #–ià
defšed
(
__DECCXX
)

101 
	#COMPILER_ID
 "Com·q"

	)

103 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__DECCXX_VER
/10000000)

	)

104 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__DECCXX_VER
/100000 % 100)

	)

105 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__DECCXX_VER
 % 10000)

	)

107 #–ià
defšed
(
__IBMCPP__
è&& defšed(
__COMPILER_VER__
)

108 
	#COMPILER_ID
 "zOS"

	)

110 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMCPP__
/100)

	)

111 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMCPP__
/10 % 10)

	)

112 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMCPP__
 % 10)

	)

114 #–ià
defšed
(
__IBMCPP__
è&& !defšed(
__COMPILER_VER__
) && __IBMCPP__ >= 800

115 
	#COMPILER_ID
 "XL"

	)

117 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMCPP__
/100)

	)

118 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMCPP__
/10 % 10)

	)

119 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMCPP__
 % 10)

	)

121 #–ià
defšed
(
__IBMCPP__
è&& !defšed(
__COMPILER_VER__
) && __IBMCPP__ < 800

122 
	#COMPILER_ID
 "Visu®Age"

	)

124 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMCPP__
/100)

	)

125 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMCPP__
/10 % 10)

	)

126 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMCPP__
 % 10)

	)

128 #–ià
defšed
(
__PGI
)

129 
	#COMPILER_ID
 "PGI"

	)

130 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PGIC__
)

	)

131 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PGIC_MINOR__
)

	)

132 #ià
defšed
(
__PGIC_PATCHLEVEL__
)

133 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PGIC_PATCHLEVEL__
)

	)

136 #–ià
defšed
(
_CRAYC
)

137 
	#COMPILER_ID
 "C¿y"

	)

138 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_RELEASE_MAJOR
)

	)

139 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_RELEASE_MINOR
)

	)

141 #–ià
defšed
(
__TI_COMPILER_VERSION__
)

142 
	#COMPILER_ID
 "TI"

	)

144 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000000)

	)

145 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000 % 1000)

	)

146 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__TI_COMPILER_VERSION__
 % 1000)

	)

148 #–ià
defšed
(
__FUJITSU
è|| defšed(
__FCC_VERSION
è|| defšed(
__fcc_v”siÚ
)

149 
	#COMPILER_ID
 "Fuj™su"

	)

151 #–ià
defšed
(
__SCO_VERSION__
)

152 
	#COMPILER_ID
 "SCO"

	)

154 #–ià
defšed
(
__şªg__
è&& defšed(
__­¶e_bud_v”siÚ__
)

155 
	#COMPILER_ID
 "AµËCÏng"

	)

156 #ià
defšed
(
_MSC_VER
)

157 
	#SIMULATE_ID
 "MSVC"

	)

159 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__şªg_majÜ__
)

	)

160 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__şªg_mšÜ__
)

	)

161 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__şªg_·tchËv–__
)

	)

162 #ià
defšed
(
_MSC_VER
)

164 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

165 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

167 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__­¶e_bud_v”siÚ__
)

	)

169 #–ià
defšed
(
__şªg__
)

170 
	#COMPILER_ID
 "CÏng"

	)

171 #ià
defšed
(
_MSC_VER
)

172 
	#SIMULATE_ID
 "MSVC"

	)

174 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__şªg_majÜ__
)

	)

175 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__şªg_mšÜ__
)

	)

176 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__şªg_·tchËv–__
)

	)

177 #ià
defšed
(
_MSC_VER
)

179 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

180 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

183 #–ià
defšed
(
__GNUC__
è|| defšed(
__GNUG__
)

184 
	#COMPILER_ID
 "GNU"

	)

185 #ià
defšed
(
__GNUC__
)

186 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

188 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUG__
)

	)

190 #ià
defšed
(
__GNUC_MINOR__
)

191 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

193 #ià
defšed
(
__GNUC_PATCHLEVEL__
)

194 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

197 #–ià
defšed
(
_MSC_VER
)

198 
	#COMPILER_ID
 "MSVC"

	)

200 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

201 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

202 #ià
defšed
(
_MSC_FULL_VER
)

203 #ià
_MSC_VER
 >= 1400

205 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 100000)

	)

208 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 10000)

	)

211 #ià
defšed
(
_MSC_BUILD
)

212 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
_MSC_BUILD
)

	)

215 #–ià
defšed
(
__VISUALDSPVERSION__
è|| defšed(
__ADSPBLACKFIN__
è|| defšed(
__ADSPTS__
è|| defšed(
__ADSP21000__
)

216 
	#COMPILER_ID
 "ADSP"

	)

217 #ià
defšed
(
__VISUALDSPVERSION__
)

219 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__VISUALDSPVERSION__
>>24)

	)

220 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__VISUALDSPVERSION__
>>16 & 0xFF)

	)

221 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__VISUALDSPVERSION__
>>8 & 0xFF)

	)

224 #–ià
defšed
(
__IAR_SYSTEMS_ICC__
è|| defšed(
__IAR_SYSTEMS_ICC
)

225 
	#COMPILER_ID
 "IAR"

	)

226 #ià
defšed
(
__VER__
)

227 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__VER__
è/ 1000000)

	)

228 
	#COMPILER_VERSION_MINOR
 
	`DEC
(((
__VER__
è/ 1000è% 1000)

	)

229 
	#COMPILER_VERSION_PATCH
 
	`DEC
((
__VER__
è% 1000)

	)

230 
	#COMPILER_VERSION_INTERNAL
 
	`DEC
(
__IAR_SYSTEMS_ICC__
)

	)

233 #–ià
defšed
(
__ARMCC_VERSION
)

234 
	#COMPILER_ID
 "ARMCC"

	)

235 #ià
__ARMCC_VERSION
 >= 1000000

237 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/1000000)

	)

238 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 100)

	)

239 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

242 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/100000)

	)

243 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 10)

	)

244 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

248 #–ià
defšed
(
_SGI_COMPILER_VERSION
è|| defšed(
_COMPILER_VERSION
)

249 
	#COMPILER_ID
 "MIPS´o"

	)

250 #ià
defšed
(
_SGI_COMPILER_VERSION
)

252 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/100)

	)

253 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/10 % 10)

	)

254 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_SGI_COMPILER_VERSION
 % 10)

	)

257 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_COMPILER_VERSION
/100)

	)

258 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_COMPILER_VERSION
/10 % 10)

	)

259 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_COMPILER_VERSION
 % 10)

	)

266 #–ià
defšed
(
__sgi
)

267 
	#COMPILER_ID
 "MIPS´o"

	)

269 #–ià
defšed
(
__hpux
è|| defšed(
__hpua
)

270 
	#COMPILER_ID
 "HP"

	)

273 
	#COMPILER_ID
 ""

	)

280 cÚ¡* 
	gšfo_comp”
 = "INFO" ":" "comp”[" 
COMPILER_ID
 "]";

281 #ifdeà
SIMULATE_ID


282 cÚ¡* 
	gšfo_simuÏ‹
 = "INFO" ":" "simuÏ‹[" 
SIMULATE_ID
 "]";

285 #ifdeà
__QNXNTO__


286 cÚ¡* 
	gqnxÁo
 = "INFO" ":" "qnxnto[]";

289 #ià
defšed
(
__CRAYXE
è|| defšed(
__CRAYXC
)

290 cÚ¡ *
	gšfo_üay
 = "INFO" ":" "compiler_wrapper[CrayPrgEnv]";

293 
	#STRINGIFY_HELPER
(
X
è#X

	)

294 
	#STRINGIFY
(
X
è
	`STRINGIFY_HELPER
(X)

	)

297 #ià
defšed
(
__lšux
è|| defšed(
__lšux__
è|| defšed(
lšux
)

298 
	#PLATFORM_ID
 "Lšux"

	)

300 #–ià
defšed
(
__CYGWIN__
)

301 
	#PLATFORM_ID
 "Cygwš"

	)

303 #–ià
defšed
(
__MINGW32__
)

304 
	#PLATFORM_ID
 "MšGW"

	)

306 #–ià
defšed
(
__APPLE__
)

307 
	#PLATFORM_ID
 "D¬wš"

	)

309 #–ià
defšed
(
_WIN32
è|| defšed(
__WIN32__
è|| defšed(
WIN32
)

310 
	#PLATFORM_ID
 "Wšdows"

	)

312 #–ià
defšed
(
__F»eBSD__
è|| defšed(
__F»eBSD
)

313 
	#PLATFORM_ID
 "F»eBSD"

	)

315 #–ià
defšed
(
__N‘BSD__
è|| defšed(
__N‘BSD
)

316 
	#PLATFORM_ID
 "N‘BSD"

	)

318 #–ià
defšed
(
__O³nBSD__
è|| defšed(
__OPENBSD
)

319 
	#PLATFORM_ID
 "O³nBSD"

	)

321 #–ià
defšed
(
__sun
è|| defšed(
sun
)

322 
	#PLATFORM_ID
 "SunOS"

	)

324 #–ià
defšed
(
_AIX
è|| defšed(
__AIX
è|| defšed(
__AIX__
è|| defšed(
__aix
è|| defšed(
__aix__
)

325 
	#PLATFORM_ID
 "AIX"

	)

327 #–ià
defšed
(
__sgi
è|| defšed(
__sgi__
è|| defšed(
_SGI
)

328 
	#PLATFORM_ID
 "IRIX"

	)

330 #–ià
defšed
(
__hpux
è|| defšed(
__hpux__
)

331 
	#PLATFORM_ID
 "HP-UX"

	)

333 #–ià
defšed
(
__HAIKU__
)

334 
	#PLATFORM_ID
 "Haiku"

	)

336 #–ià
defšed
(
__BeOS
è|| defšed(
__BEOS__
è|| defšed(
_BEOS
)

337 
	#PLATFORM_ID
 "BeOS"

	)

339 #–ià
defšed
(
__QNX__
è|| defšed(
__QNXNTO__
)

340 
	#PLATFORM_ID
 "QNX"

	)

342 #–ià
defšed
(
__Œu64
è|| defšed(
_Œu64
è|| defšed(
__TRU64__
)

343 
	#PLATFORM_ID
 "Tru64"

	)

345 #–ià
defšed
(
__riscos
è|| defšed(
__riscos__
)

346 
	#PLATFORM_ID
 "RISCos"

	)

348 #–ià
defšed
(
__sšix
è|| defšed(
__sšix__
è|| defšed(
__SINIX__
)

349 
	#PLATFORM_ID
 "SINIX"

	)

351 #–ià
defšed
(
__UNIX_SV__
)

352 
	#PLATFORM_ID
 "UNIX_SV"

	)

354 #–ià
defšed
(
__bsdos__
)

355 
	#PLATFORM_ID
 "BSDOS"

	)

357 #–ià
defšed
(
_MPRAS
è|| defšed(
MPRAS
)

358 
	#PLATFORM_ID
 "MP-RAS"

	)

360 #–ià
defšed
(
__osf
è|| defšed(
__osf__
)

361 
	#PLATFORM_ID
 "OSF1"

	)

363 #–ià
defšed
(
_SCO_SV
è|| defšed(
SCO_SV
è|| defšed(
sco_sv
)

364 
	#PLATFORM_ID
 "SCO_SV"

	)

366 #–ià
defšed
(
__uÉrix
è|| defšed(
__uÉrix__
è|| defšed(
_ULTRIX
)

367 
	#PLATFORM_ID
 "ULTRIX"

	)

369 #–ià
defšed
(
__XENIX__
è|| defšed(
_XENIX
è|| defšed(
XENIX
)

370 
	#PLATFORM_ID
 "X’ix"

	)

372 #–ià
defšed
(
__WATCOMC__
)

373 #ià
defšed
(
__LINUX__
)

374 
	#PLATFORM_ID
 "Lšux"

	)

376 #–ià
defšed
(
__DOS__
)

377 
	#PLATFORM_ID
 "DOS"

	)

379 #–ià
defšed
(
__OS2__
)

380 
	#PLATFORM_ID
 "OS2"

	)

382 #–ià
defšed
(
__WINDOWS__
)

383 
	#PLATFORM_ID
 "Wšdows3x"

	)

386 
	#PLATFORM_ID


	)

390 
	#PLATFORM_ID


	)

399 #ià
defšed
(
_WIN32
è&& defšed(
_MSC_VER
)

400 #ià
defšed
(
_M_IA64
)

401 
	#ARCHITECTURE_ID
 "IA64"

	)

403 #–ià
defšed
(
_M_X64
è|| defšed(
_M_AMD64
)

404 
	#ARCHITECTURE_ID
 "x64"

	)

406 #–ià
defšed
(
_M_IX86
)

407 
	#ARCHITECTURE_ID
 "X86"

	)

409 #–ià
defšed
(
_M_ARM64
)

410 
	#ARCHITECTURE_ID
 "ARM64"

	)

412 #–ià
defšed
(
_M_ARM
)

413 #ià
_M_ARM
 == 4

414 
	#ARCHITECTURE_ID
 "ARMV4I"

	)

415 #–ià
_M_ARM
 == 5

416 
	#ARCHITECTURE_ID
 "ARMV5I"

	)

418 
	#ARCHITECTURE_ID
 "ARMV" 
	`STRINGIFY
(
_M_ARM
)

	)

421 #–ià
defšed
(
_M_MIPS
)

422 
	#ARCHITECTURE_ID
 "MIPS"

	)

424 #–ià
defšed
(
_M_SH
)

425 
	#ARCHITECTURE_ID
 "SHx"

	)

428 
	#ARCHITECTURE_ID
 ""

	)

431 #–ià
defšed
(
__WATCOMC__
)

432 #ià
defšed
(
_M_I86
)

433 
	#ARCHITECTURE_ID
 "I86"

	)

435 #–ià
defšed
(
_M_IX86
)

436 
	#ARCHITECTURE_ID
 "X86"

	)

439 
	#ARCHITECTURE_ID
 ""

	)

442 #–ià
defšed
(
__IAR_SYSTEMS_ICC__
è|| defšed(
__IAR_SYSTEMS_ICC
)

443 #ià
defšed
(
__ICCARM__
)

444 
	#ARCHITECTURE_ID
 "ARM"

	)

446 #–ià
defšed
(
__ICCAVR__
)

447 
	#ARCHITECTURE_ID
 "AVR"

	)

450 
	#ARCHITECTURE_ID
 ""

	)

453 
	#ARCHITECTURE_ID


	)

457 
	#DEC
(
n
) \

458 ('0' + (((
n
) / 10000000)%10)), \

459 ('0' + (((
n
) / 1000000)%10)), \

460 ('0' + (((
n
) / 100000)%10)), \

461 ('0' + (((
n
) / 10000)%10)), \

462 ('0' + (((
n
) / 1000)%10)), \

463 ('0' + (((
n
) / 100)%10)), \

464 ('0' + (((
n
) / 10)%10)), \

465 ('0' + ((
n
è% 10))

	)

468 
	#HEX
(
n
) \

469 ('0' + ((
n
)>>28 & 0xF)), \

470 ('0' + ((
n
)>>24 & 0xF)), \

471 ('0' + ((
n
)>>20 & 0xF)), \

472 ('0' + ((
n
)>>16 & 0xF)), \

473 ('0' + ((
n
)>>12 & 0xF)), \

474 ('0' + ((
n
)>>8 & 0xF)), \

475 ('0' + ((
n
)>>4 & 0xF)), \

476 ('0' + ((
n
è& 0xF))

	)

479 #ifdeà
COMPILER_VERSION_MAJOR


480 cÚ¡ 
	gšfo_v”siÚ
[] = {

483 
COMPILER_VERSION_MAJOR
,

484 #ifdeà
COMPILER_VERSION_MINOR


485 '.', 
COMPILER_VERSION_MINOR
,

486 #ifdeà
COMPILER_VERSION_PATCH


487 '.', 
COMPILER_VERSION_PATCH
,

488 #ifdeà
COMPILER_VERSION_TWEAK


489 '.', 
COMPILER_VERSION_TWEAK
,

497 #ifdeà
COMPILER_VERSION_INTERNAL


498 cÚ¡ 
	gšfo_v”siÚ_š‹º®
[] = {

502 
COMPILER_VERSION_INTERNAL
,']','\0'};

506 #ifdeà
SIMULATE_VERSION_MAJOR


507 cÚ¡ 
	gšfo_simuÏ‹_v”siÚ
[] = {

510 
SIMULATE_VERSION_MAJOR
,

511 #ifdeà
SIMULATE_VERSION_MINOR


512 '.', 
SIMULATE_VERSION_MINOR
,

513 #ifdeà
SIMULATE_VERSION_PATCH


514 '.', 
SIMULATE_VERSION_PATCH
,

515 #ifdeà
SIMULATE_VERSION_TWEAK


516 '.', 
SIMULATE_VERSION_TWEAK
,

527 cÚ¡* 
	gšfo_¶©fÜm
 = "INFO" ":" "¶©fÜm[" 
PLATFORM_ID
 "]";

528 cÚ¡* 
	gšfo_¬ch
 = "INFO" ":" "¬ch[" 
ARCHITECTURE_ID
 "]";

533 #ià
defšed
(
_MSC_VER
è&& defšed(
_MSVC_LANG
)

534 
	#CXX_STD
 
_MSVC_LANG


	)

536 
	#CXX_STD
 
__ılu¥lus


	)

539 cÚ¡ * 
	gšfo_Ïnguage_dŸËù_deçuÉ
 = "INFO" ":" "dialect_default["

540 #ià
CXX_STD
 > 201402L

542 #–ià
CXX_STD
 >= 201402L

544 #–ià
CXX_STD
 >= 201103L

553 
	$maš
(
¬gc
, * 
¬gv
[])

555 
»quœe
 = 0;

556 
»quœe
 +ğ
šfo_comp”
[
¬gc
];

557 
»quœe
 +ğ
šfo_¶©fÜm
[
¬gc
];

558 #ifdeà
COMPILER_VERSION_MAJOR


559 
»quœe
 +ğ
šfo_v”siÚ
[
¬gc
];

561 #ifdeà
COMPILER_VERSION_INTERNAL


562 
»quœe
 +ğ
šfo_v”siÚ_š‹º®
[
¬gc
];

564 #ifdeà
SIMULATE_ID


565 
»quœe
 +ğ
šfo_simuÏ‹
[
¬gc
];

567 #ifdeà
SIMULATE_VERSION_MAJOR


568 
»quœe
 +ğ
šfo_simuÏ‹_v”siÚ
[
¬gc
];

570 #ià
	`defšed
(
__CRAYXE
è|| defšed(
__CRAYXC
)

571 
»quœe
 +ğ
šfo_üay
[
¬gc
];

573 
»quœe
 +ğ
šfo_Ïnguage_dŸËù_deçuÉ
[
¬gc
];

574 ()
¬gv
;

575  
»quœe
;

576 
	}
}

	@build/CMakeFiles/CheckTypeSize/CMAKE_SIZEOF_UNSIGNED_SHORT.c

1 
	~<sys/ty³s.h
>

2 
	~<¡dšt.h
>

3 
	~<¡ddef.h
>

6 #undeà
KEY


7 #ià
defšed
(
__i386
)

8 
	#KEY
 '_','_','i','3','8','6'

	)

9 #–ià
defšed
(
__x86_64
)

10 
	#KEY
 '_','_','x','8','6','_','6','4'

	)

11 #–ià
defšed
(
__µc__
)

12 
	#KEY
 '_','_','p','p','c','_','_'

	)

13 #–ià
defšed
(
__µc64__
)

14 
	#KEY
 '_','_','p','p','c','6','4','_','_'

	)

15 #–ià
defšed
(
__¯rch64__
)

16 
	#KEY
 '_','_','a','a','r','c','h','6','4','_','_'

	)

17 #–ià
defšed
(
__ARM_ARCH_7A__
)

18 
	#KEY
 '_','_','A','R','M','_','A','R','C','H','_','7','A','_','_'

	)

19 #–ià
defšed
(
__ARM_ARCH_7S__
)

20 
	#KEY
 '_','_','A','R','M','_','A','R','C','H','_','7','S','_','_'

	)

23 
	#SIZE
 (())

	)

24 
	gšfo_size
[] = {'I', 'N', 'F', 'O', ':', 's','i','z','e','[',

25 ('0' + ((
SIZE
 / 10000)%10)),

26 ('0' + ((
SIZE
 / 1000)%10)),

27 ('0' + ((
SIZE
 / 100)%10)),

28 ('0' + ((
SIZE
 / 10)%10)),

29 ('0' + (
SIZE
 % 10)),

31 #ifdeà
KEY


32 ' ','k','e','y','[', 
KEY
, ']',

36 #ifdeà
__CLASSIC_C__


37 
	$maš
(
¬gc
, 
¬gv
) argc; *argv[];

39 
	$maš
(
¬gc
, *
¬gv
[])

42 
»quœe
 = 0;

43 
»quœe
 +ğ
šfo_size
[
¬gc
];

44 ()
¬gv
;

45  
»quœe
;

46 
	}
}

	@build/CMakeFiles/feature_tests.c

2 cÚ¡ 
	gã©u»s
[] = {"\n"

4 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
) >= 304

11 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
è>ğ304 && 
defšed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

18 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
è>ğ406 && 
defšed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 201000L

25 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
è>ğ304 && 
defšed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

34 
	$maš
(
¬gc
, ** 
¬gv
è{ (ïrgv;  
ã©u»s
[¬gc]; 
	}
}

	@build/include/port/port_config.h

5 #iâdeà
STORAGE_LEVELDB_PORT_PORT_CONFIG_H_


6 
	#STORAGE_LEVELDB_PORT_PORT_CONFIG_H_


	)

9 #ià!
defšed
(
HAVE_FDATASYNC
)

10 
	#HAVE_FDATASYNC
 1

	)

14 #ià!
defšed
(
HAVE_FULLFSYNC
)

15 
	#HAVE_FULLFSYNC
 0

	)

19 #ià!
defšed
(
HAVE_CRC32C
)

20 
	#HAVE_CRC32C
 0

	)

24 #ià!
defšed
(
HAVE_SNAPPY
)

25 
	#HAVE_SNAPPY
 1

	)

30 #ià!
defšed
(
LEVELDB_IS_BIG_ENDIAN
)

31 
	#LEVELDB_IS_BIG_ENDIAN
 0

	)

	@db/autocompact_test.cc

5 
	~"db/db_im¶.h
"

6 
	~"Ëv–db/ÿche.h
"

7 
	~"Ëv–db/db.h
"

8 
	~"ut/‹¡h¬Ãss.h
"

9 
	~"ut/‹¡ut.h
"

11 
Çme¥aû
 
	gËv–db
 {

13 şas 
	cAutoCom·ùTe¡
 {

14 
	gpublic
:

15 
AutoCom·ùTe¡
() {

16 
dbÇme_
 = 
‹¡
::
TmpDœ
() + "/autocompact_test";

17 
	gtšy_ÿche_
 = 
NewLRUCache
(100);

18 
	gİtiÚs_
.
	gblock_ÿche
 = 
tšy_ÿche_
;

19 
De¡royDB
(
dbÇme_
, 
İtiÚs_
);

20 
	gİtiÚs_
.
	gü—‹_if_missšg
 = 
Œue
;

21 
	gİtiÚs_
.
	gcom´essiÚ
 = 
kNoCom´essiÚ
;

22 
ASSERT_OK
(
DB
::
O³n
(
İtiÚs_
, 
dbÇme_
, &
db_
));

25 ~
AutoCom·ùTe¡
() {

26 
d–‘e
 
	gdb_
;

27 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

28 
d–‘e
 
	gtšy_ÿche_
;

31 
	g¡d
::
¡ršg
 
Key
(
i
) {

32 
buf
[100];

33 
¢´štf
(
buf
, (buf), "key%06d", 
i
);

34  
	g¡d
::
¡ršg
(
buf
);

37 
ušt64_t
 
Size
(cÚ¡ 
Sliû
& 
¡¬t
, cÚ¡ Sliû& 
lim™
) {

38 
Rªge
 
r
(
¡¬t
, 
lim™
);

39 
ušt64_t
 
	gsize
;

40 
	gdb_
->
G‘Aµroxim©eSizes
(&
r
, 1, &
size
);

41  
	gsize
;

44 
DoR—ds
(
n
);

46 
	g´iv©e
:

47 
¡d
::
¡ršg
 
dbÇme_
;

48 
Cache
* 
	gtšy_ÿche_
;

49 
O±iÚs
 
	gİtiÚs_
;

50 
DB
* 
	gdb_
;

53 cÚ¡ 
	gkV®ueSize
 = 200 * 1024;

54 cÚ¡ 
	gkTÙ®Size
 = 100 * 1024 * 1024;

55 cÚ¡ 
	gkCouÁ
 = 
kTÙ®Size
 / 
kV®ueSize
;

59 
	gAutoCom·ùTe¡
::
	$DoR—ds
(
n
) {

60 
¡d
::
¡ršg
 
	`v®ue
(
kV®ueSize
, 'x');

61 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

64 
i
 = 0; i < 
kCouÁ
; i++) {

65 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), 
	`Key
(
i
), 
v®ue
));

67 
	`ASSERT_OK
(
dbi
->
	`TEST_Com·ùMemTabË
());

70 
i
 = 0; i < 
kCouÁ
; i++) {

71 
	`ASSERT_OK
(
db_
->
	`D–‘e
(
	`Wr™eO±iÚs
(), 
	`Key
(
i
)));

73 
	`ASSERT_OK
(
dbi
->
	`TEST_Com·ùMemTabË
());

76 cÚ¡ 
št64_t
 
š™Ÿl_size
 = 
	`Size
(
	`Key
(0), Key(
n
));

77 cÚ¡ 
št64_t
 
š™Ÿl_Ùh”_size
 = 
	`Size
(
	`Key
(
n
), Key(
kCouÁ
));

80 
¡d
::
¡ršg
 
lim™_key
 = 
	`Key
(
n
);

81 
»ad
 = 0; 
Œue
;„ead++) {

82 
	`ASSERT_LT
(
»ad
, 100) << "Takingoo†ongo compact";

83 
I‹¿tÜ
* 
™”
 = 
db_
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

84 
™”
->
	`S“kToFœ¡
();

85 
™”
->
	`V®id
(è&& i‹r->
	`key
().
	`ToSŒšg
(è< 
lim™_key
; i‹r->
	`Next
()) {

88 
d–‘e
 
™”
;

90 
Env
::
	`DeçuÉ
()->
	`SË•FÜMiüo£cÚds
(1000000);

91 
ušt64_t
 
size
 = 
	`Size
(
	`Key
(0), Key(
n
));

92 
	`årštf
(
¡d”r
, "™” %3d => %7.3àMB [Ùh” %7.3àMB]\n", 
»ad
 + 1,

93 
size
 / 1048576.0, 
	`Size
(
	`Key
(
n
), Key(
kCouÁ
)) / 1048576.0);

94 ià(
size
 <ğ
š™Ÿl_size
 / 10) {

101 cÚ¡ 
št64_t
 
fš®_Ùh”_size
 = 
	`Size
(
	`Key
(
n
), Key(
kCouÁ
));

102 
	`ASSERT_LE
(
fš®_Ùh”_size
, 
š™Ÿl_Ùh”_size
 + 1048576);

103 
	`ASSERT_GE
(
fš®_Ùh”_size
, 
š™Ÿl_Ùh”_size
 / 5 - 1048576);

104 
	}
}

106 
	$TEST
(
AutoCom·ùTe¡
, 
R—dAÎ
è{ 
	`DoR—ds
(
kCouÁ
); 
	}
}

108 
	$TEST
(
AutoCom·ùTe¡
, 
R—dH®f
è{ 
	`DoR—ds
(
kCouÁ
 / 2); 
	}
}

112 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/builder.cc

5 
	~"db/bud”.h
"

7 
	~"db/dbfÜm©.h
"

8 
	~"db/f’ame.h
"

9 
	~"db/bË_ÿche.h
"

10 
	~"db/v”siÚ_ed™.h
"

11 
	~"Ëv–db/db.h
"

12 
	~"Ëv–db/’v.h
"

13 
	~"Ëv–db/™”©Ü.h
"

15 
	~"db/fh.h
"

17 
Çme¥aû
 
	gËv–db
 {

19 
Stus
 
BudTabË
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, 
Env
* 
’v
, cÚ¡ 
O±iÚs
& 
İtiÚs
,

20 
TabËCache
* 
bË_ÿche
, 
I‹¿tÜ
* 
™”
, 
FeM‘aD©a
* 
m‘a
, 
FH
 *
fh
) {

21 
Stus
 
	gs
;

22 
	gm‘a
->
	gfe_size
 = 0;

23 
	g™”
->
S“kToFœ¡
();

25 
	gm‘a
->
	gfs
 = 0;

27 
	g¡d
::
¡ršg
 
âame
 = 
TabËFeName
(
dbÇme
, 
m‘a
->
numb”
);

28 ià(
	g™”
->
V®id
()) {

29 
Wr™abËFe
* 
	gfe
;

30 
	gs
 = 
’v
->
NewWr™abËFe
(
âame
, &
fe
);

31 ià(!
	gs
.
ok
()) {

32  
	gs
;

35 
TabËBud”
* 
	gbud”
 = 
Ãw
 TabËBud”(
İtiÚs
, 
fe
);

36 
	gm‘a
->
	gsm®Ë¡
.
DecodeFrom
(
™”
->
key
());

37 ià(
	gfh
 !ğ
NULL
)

39 ; 
	g™”
->
V®id
(); i‹r->
Next
()) {

40 
Sliû
 
	gkey
 = 
™”
->
key
();

41 
	gm‘a
->
	gÏrge¡
.
DecodeFrom
(
key
);

42 
	gbud”
->
Add
(
key
, 
™”
->
v®ue
());

43 
	gm‘a
->
	gfs
 +ğ
fh
->
g‘
(
key
);

48 ; 
	g™”
->
V®id
(); i‹r->
Next
()) {

49 
Sliû
 
	gkey
 = 
™”
->
key
();

50 
	gm‘a
->
	gÏrge¡
.
DecodeFrom
(
key
);

51 
	gbud”
->
Add
(
key
, 
™”
->
v®ue
());

56 
	gs
 = 
bud”
->
Fšish
();

57 ià(
	gs
.
ok
()) {

58 
	gm‘a
->
	gfe_size
 = 
bud”
->
FeSize
();

59 
as£¹
(
m‘a
->
fe_size
 > 0);

61 
d–‘e
 
	gbud”
;

64 ià(
	gs
.
ok
()) {

65 
	gs
 = 
fe
->
Sync
();

67 ià(
	gs
.
ok
()) {

68 
	gs
 = 
fe
->
Clo£
();

70 
d–‘e
 
	gfe
;

71 
	gfe
 = 
nuÎ±r
;

73 ià(
	gs
.
ok
()) {

75 
I‹¿tÜ
* 
	g™
 = 
bË_ÿche
->
NewI‹¿tÜ
(
R—dO±iÚs
(), 
m‘a
->
numb”
,

76 
m‘a
->
fe_size
);

77 
	gs
 = 
™
->
¡©us
();

78 
d–‘e
 
	g™
;

83 ià(!
	g™”
->
¡©us
().
ok
()) {

84 
	gs
 = 
™”
->
¡©us
();

87 ià(
	gs
.
ok
(è&& 
	gm‘a
->
	gfe_size
 > 0) {

90 
	g’v
->
D–‘eFe
(
âame
);

92  
	gs
;

	@db/builder.h

5 #iâdeà
STORAGE_LEVELDB_DB_BUILDER_H_


6 
	#STORAGE_LEVELDB_DB_BUILDER_H_


	)

8 
	~"Ëv–db/¡©us.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 
	gO±iÚs
;

13 
	gFeM‘aD©a
;

15 
şass
 
	gEnv
;

16 
şass
 
	gI‹¿tÜ
;

17 
şass
 
	gTabËCache
;

18 
şass
 
	gV”siÚEd™
;

20 
şass
 
	gFH
;

27 
Stus
 
BudTabË
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, 
Env
* 
’v
, cÚ¡ 
O±iÚs
& 
İtiÚs
,

28 
TabËCache
* 
bË_ÿche
, 
I‹¿tÜ
* 
™”
, 
FeM‘aD©a
* 
m‘a
, 
FH
 *
fh
);

	@db/c.cc

5 
	~"Ëv–db/c.h
"

7 
	~<¡dlib.h
>

9 
	~"Ëv–db/ÿche.h
"

10 
	~"Ëv–db/com·¿tÜ.h
"

11 
	~"Ëv–db/db.h
"

12 
	~"Ëv–db/’v.h
"

13 
	~"Ëv–db/f‹r_pŞicy.h
"

14 
	~"Ëv–db/™”©Ü.h
"

15 
	~"Ëv–db/İtiÚs.h
"

16 
	~"Ëv–db/¡©us.h
"

17 
	~"Ëv–db/wr™e_b©ch.h
"

19 
usšg
 
	gËv–db
::
Cache
;

20 
usšg
 
	gËv–db
::
Com·¿tÜ
;

21 
usšg
 
	gËv–db
::
Com´essiÚTy³
;

22 
usšg
 
	gËv–db
::
DB
;

23 
usšg
 
	gËv–db
::
Env
;

24 
usšg
 
	gËv–db
::
FeLock
;

25 
usšg
 
	gËv–db
::
F‹rPŞicy
;

26 
usšg
 
	gËv–db
::
I‹¿tÜ
;

27 
usšg
 
	gËv–db
::
kMajÜV”siÚ
;

28 
usšg
 
	gËv–db
::
kMšÜV”siÚ
;

29 
usšg
 
	gËv–db
::
Logg”
;

30 
usšg
 
	gËv–db
::
NewBloomF‹rPŞicy
;

31 
usšg
 
	gËv–db
::
NewLRUCache
;

32 
usšg
 
	gËv–db
::
O±iÚs
;

33 
usšg
 
	gËv–db
::
RªdomAcûssFe
;

34 
usšg
 
	gËv–db
::
Rªge
;

35 
usšg
 
	gËv–db
::
R—dO±iÚs
;

36 
usšg
 
	gËv–db
::
Sequ’tŸlFe
;

37 
usšg
 
	gËv–db
::
Sliû
;

38 
usšg
 
	gËv–db
::
SÇpshÙ
;

39 
usšg
 
	gËv–db
::
Stus
;

40 
usšg
 
	gËv–db
::
Wr™abËFe
;

41 
usšg
 
	gËv–db
::
Wr™eB©ch
;

42 
usšg
 
	gËv–db
::
Wr™eO±iÚs
;

46 
	sËv–db_t
 {

47 
DB
* 
»p
;

49 
	sËv–db_™”©Ü_t
 {

50 
I‹¿tÜ
* 
»p
;

52 
	sËv–db_wr™eb©ch_t
 {

53 
Wr™eB©ch
 
»p
;

55 
	sËv–db_¢­shÙ_t
 {

56 cÚ¡ 
SÇpshÙ
* 
»p
;

58 
	sËv–db_»adİtiÚs_t
 {

59 
R—dO±iÚs
 
»p
;

61 
	sËv–db_wr™eİtiÚs_t
 {

62 
Wr™eO±iÚs
 
»p
;

64 
	sËv–db_İtiÚs_t
 {

65 
O±iÚs
 
»p
;

67 
	sËv–db_ÿche_t
 {

68 
Cache
* 
»p
;

70 
	sËv–db_£qfe_t
 {

71 
Sequ’tŸlFe
* 
»p
;

73 
	sËv–db_¿ndomfe_t
 {

74 
RªdomAcûssFe
* 
»p
;

76 
	sËv–db_wr™abËfe_t
 {

77 
Wr™abËFe
* 
»p
;

79 
	sËv–db_logg”_t
 {

80 
Logg”
* 
»p
;

82 
	sËv–db_f–ock_t
 {

83 
FeLock
* 
»p
;

86 
Ëv–db_com·¿tÜ_t
 : 
public
 
Com·¿tÜ
 {

87 
vœtu®
 ~
Ëv–db_com·¿tÜ_t
(è{ (*
de¡ruùÜ_
)(
¡©e_
); }

89 
vœtu®
 
Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const {

90  (*
com·»_
)(
¡©e_
, 
a
.
d©a
(),‡.
size
(), 
b
.data(), b.size());

93 
vœtu®
 cÚ¡ * 
Name
(ècÚ¡ {  (*
Çme_
)(
¡©e_
); }

96 
vœtu®
 
FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
*, cÚ¡ 
Sliû
&) const {}

97 
vœtu®
 
FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const {}

99 * 
¡©e_
;

100 (*
de¡ruùÜ_
)(*);

101 (*
com·»_
)(*, cÚ¡ * 
a
, 
size_t
 
®’
, cÚ¡ * 
b
,

102 
size_t
 
bËn
);

103 cÚ¡ * (*
Çme_
)(*);

106 
Ëv–db_f‹½Şicy_t
 : 
public
 
F‹rPŞicy
 {

107 
vœtu®
 ~
Ëv–db_f‹½Şicy_t
(è{ (*
de¡ruùÜ_
)(
¡©e_
); }

109 
vœtu®
 cÚ¡ * 
Name
(ècÚ¡ {  (*
Çme_
)(
¡©e_
); }

111 
vœtu®
 
C»©eF‹r
(cÚ¡ 
Sliû
* 
keys
, 
n
, 
¡d
::
¡ršg
* 
d¡
) const {

112 
¡d
::
veùÜ
<cÚ¡ *> 
key_poš‹rs
(
n
);

113 
¡d
::
veùÜ
<
size_t
> 
key_sizes
(
n
);

114 
i
 = 0; i < 
n
; i++) {

115 
key_poš‹rs
[
i
] = 
keys
[i].
d©a
();

116 
key_sizes
[
i
] = 
keys
[i].
size
();

118 
size_t
 
Ën
;

119 * 
f‹r
 = (*
ü—‹_
)(
¡©e_
, &
key_poš‹rs
[0], &
key_sizes
[0], 
n
, &
Ën
);

120 
d¡
->
­³nd
(
f‹r
, 
Ën
);

121 
ä“
(
f‹r
);

124 
vœtu®
 
boŞ
 
KeyMayM©ch
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
f‹r
) const {

125  (*
key_m©ch_
)(
¡©e_
, 
key
.
d©a
(), key.
size
(), 
f‹r
.data(),

126 
f‹r
.
size
());

129 * 
¡©e_
;

130 (*
de¡ruùÜ_
)(*);

131 cÚ¡ * (*
Çme_
)(*);

132 * (*
ü—‹_
)(*, cÚ¡ * cÚ¡* 
key_¬¿y
,

133 cÚ¡ 
size_t
* 
key_Ëngth_¬¿y
, 
num_keys
,

134 
size_t
* 
f‹r_Ëngth
);

135 (*
key_m©ch_
)(*, cÚ¡ * 
key
, 
size_t
 
Ëngth
,

136 cÚ¡ * 
f‹r
, 
size_t
 
f‹r_Ëngth
);

139 
	sËv–db_’v_t
 {

140 
Env
* 
»p
;

141 
boŞ
 
is_deçuÉ
;

144 
boŞ
 
SaveE¼Ü
(** 
”½Œ
, cÚ¡ 
Stus
& 
s
) {

145 
as£¹
(
”½Œ
 !ğ
nuÎ±r
);

146 ià(
s
.
ok
()) {

147  
çl£
;

148 } ià(*
”½Œ
 =ğ
nuÎ±r
) {

149 *
”½Œ
 = 
¡rdup
(
s
.
ToSŒšg
().
c_¡r
());

152 
ä“
(*
”½Œ
);

153 *
”½Œ
 = 
¡rdup
(
s
.
ToSŒšg
().
c_¡r
());

155  
Œue
;

158 * 
CİySŒšg
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
) {

159 * 
»suÉ
 = 
»š‹½»t_ÿ¡
<*>(
m®loc
((è* 
¡r
.
size
()));

160 
memıy
(
»suÉ
, 
¡r
.
d©a
(), (è* sŒ.
size
());

161  
»suÉ
;

164 
Ëv–db_t
* 
Ëv–db_İ’
(cÚ¡ 
Ëv–db_İtiÚs_t
* 
İtiÚs
, cÚ¡ * 
Çme
,

165 ** 
”½Œ
) {

166 
DB
* 
db
;

167 ià(
SaveE¼Ü
(
”½Œ
, 
DB
::
O³n
(
İtiÚs
->
»p
, 
¡d
::
¡ršg
(
Çme
), &
db
))) {

168  
nuÎ±r
;

170 
Ëv–db_t
* 
»suÉ
 = 
Ãw
†eveldb_t;

171 
»suÉ
->
»p
 = 
db
;

172  
»suÉ
;

175 
Ëv–db_şo£
(
Ëv–db_t
* 
db
) {

176 
d–‘e
 
db
->
»p
;

177 
d–‘e
 
db
;

180 
Ëv–db_put
(
Ëv–db_t
* 
db
, cÚ¡ 
Ëv–db_wr™eİtiÚs_t
* 
İtiÚs
,

181 cÚ¡ * 
key
, 
size_t
 
keyËn
, cÚ¡ * 
v®
, size_ˆ
v®Ën
,

182 ** 
”½Œ
) {

183 
SaveE¼Ü
(
”½Œ
,

184 
db
->
»p
->
Put
(
İtiÚs
->»p, 
Sliû
(
key
, 
keyËn
), Sliû(
v®
, 
v®Ën
)));

187 
Ëv–db_d–‘e
(
Ëv–db_t
* 
db
, cÚ¡ 
Ëv–db_wr™eİtiÚs_t
* 
İtiÚs
,

188 cÚ¡ * 
key
, 
size_t
 
keyËn
, ** 
”½Œ
) {

189 
SaveE¼Ü
(
”½Œ
, 
db
->
»p
->
D–‘e
(
İtiÚs
->»p, 
Sliû
(
key
, 
keyËn
)));

192 
Ëv–db_wr™e
(
Ëv–db_t
* 
db
, cÚ¡ 
Ëv–db_wr™eİtiÚs_t
* 
İtiÚs
,

193 
Ëv–db_wr™eb©ch_t
* 
b©ch
, ** 
”½Œ
) {

194 
SaveE¼Ü
(
”½Œ
, 
db
->
»p
->
Wr™e
(
İtiÚs
->»p, &
b©ch
->rep));

197 * 
Ëv–db_g‘
(
Ëv–db_t
* 
db
, cÚ¡ 
Ëv–db_»adİtiÚs_t
* 
İtiÚs
,

198 cÚ¡ * 
key
, 
size_t
 
keyËn
, size_t* 
v®Ën
,

199 ** 
”½Œ
) {

200 * 
»suÉ
 = 
nuÎ±r
;

201 
¡d
::
¡ršg
 
tmp
;

202 
Stus
 
s
 = 
db
->
»p
->
G‘
(
İtiÚs
->»p, 
Sliû
(
key
, 
keyËn
), &
tmp
);

203 ià(
s
.
ok
()) {

204 *
v®Ën
 = 
tmp
.
size
();

205 
»suÉ
 = 
CİySŒšg
(
tmp
);

207 *
v®Ën
 = 0;

208 ià(!
s
.
IsNÙFound
()) {

209 
SaveE¼Ü
(
”½Œ
, 
s
);

212  
»suÉ
;

215 
Ëv–db_™”©Ü_t
* 
Ëv–db_ü—‹_™”©Ü
(

216 
Ëv–db_t
* 
db
, cÚ¡ 
Ëv–db_»adİtiÚs_t
* 
İtiÚs
) {

217 
Ëv–db_™”©Ü_t
* 
»suÉ
 = 
Ãw
†eveldb_iterator_t;

218 
»suÉ
->
»p
 = 
db
->»p->
NewI‹¿tÜ
(
İtiÚs
->rep);

219  
»suÉ
;

222 cÚ¡ 
Ëv–db_¢­shÙ_t
* 
Ëv–db_ü—‹_¢­shÙ
(
Ëv–db_t
* 
db
) {

223 
Ëv–db_¢­shÙ_t
* 
»suÉ
 = 
Ãw
†eveldb_snapshot_t;

224 
»suÉ
->
»p
 = 
db
->»p->
G‘SÇpshÙ
();

225  
»suÉ
;

228 
Ëv–db_»Ëa£_¢­shÙ
(
Ëv–db_t
* 
db
,

229 cÚ¡ 
Ëv–db_¢­shÙ_t
* 
¢­shÙ
) {

230 
db
->
»p
->
R–—£SÇpshÙ
(
¢­shÙ
->rep);

231 
d–‘e
 
¢­shÙ
;

234 * 
Ëv–db_´İ”ty_v®ue
(
Ëv–db_t
* 
db
, cÚ¡ * 
´İÇme
) {

235 
¡d
::
¡ršg
 
tmp
;

236 ià(
db
->
»p
->
G‘Prİ”ty
(
Sliû
(
´İÇme
), &
tmp
)) {

238  
¡rdup
(
tmp
.
c_¡r
());

240  
nuÎ±r
;

244 
Ëv–db_­´oxim©e_sizes
(
Ëv–db_t
* 
db
, 
num_¿nges
,

245 cÚ¡ * cÚ¡* 
¿nge_¡¬t_key
,

246 cÚ¡ 
size_t
* 
¿nge_¡¬t_key_Ën
,

247 cÚ¡ * cÚ¡* 
¿nge_lim™_key
,

248 cÚ¡ 
size_t
* 
¿nge_lim™_key_Ën
,

249 
ušt64_t
* 
sizes
) {

250 
Rªge
* 
¿nges
 = 
Ãw
 Rªge[
num_¿nges
];

251 
i
 = 0; i < 
num_¿nges
; i++) {

252 
¿nges
[
i
].
¡¬t
 = 
Sliû
(
¿nge_¡¬t_key
[i], 
¿nge_¡¬t_key_Ën
[i]);

253 
¿nges
[
i
].
lim™
 = 
Sliû
(
¿nge_lim™_key
[i], 
¿nge_lim™_key_Ën
[i]);

255 
db
->
»p
->
G‘Aµroxim©eSizes
(
¿nges
, 
num_¿nges
, 
sizes
);

256 
d–‘e
[] 
¿nges
;

259 
Ëv–db_com·ù_¿nge
(
Ëv–db_t
* 
db
, cÚ¡ * 
¡¬t_key
,

260 
size_t
 
¡¬t_key_Ën
, cÚ¡ * 
lim™_key
,

261 
size_t
 
lim™_key_Ën
) {

262 
Sliû
 
a
, 
b
;

263 
db
->
»p
->
Com·ùRªge
(

265 (
¡¬t_key
 ? (
a
 = 
Sliû
(¡¬t_key, 
¡¬t_key_Ën
), &aè: 
nuÎ±r
),

266 (
lim™_key
 ? (
b
 = 
Sliû
Öim™_key, 
lim™_key_Ën
), &bè: 
nuÎ±r
));

269 
Ëv–db_de¡roy_db
(cÚ¡ 
Ëv–db_İtiÚs_t
* 
İtiÚs
, cÚ¡ * 
Çme
,

270 ** 
”½Œ
) {

271 
SaveE¼Ü
(
”½Œ
, 
De¡royDB
(
Çme
, 
İtiÚs
->
»p
));

274 
Ëv–db_»·œ_db
(cÚ¡ 
Ëv–db_İtiÚs_t
* 
İtiÚs
, cÚ¡ * 
Çme
,

275 ** 
”½Œ
) {

276 
SaveE¼Ü
(
”½Œ
, 
R•aœDB
(
Çme
, 
İtiÚs
->
»p
));

279 
Ëv–db_™”_de¡roy
(
Ëv–db_™”©Ü_t
* 
™”
) {

280 
d–‘e
 
™”
->
»p
;

281 
d–‘e
 
™”
;

284 
Ëv–db_™”_v®id
(cÚ¡ 
Ëv–db_™”©Ü_t
* 
™”
) {

285  
™”
->
»p
->
V®id
();

288 
Ëv–db_™”_£ek_to_fœ¡
(
Ëv–db_™”©Ü_t
* 
™”
) {

289 
™”
->
»p
->
S“kToFœ¡
();

292 
Ëv–db_™”_£ek_to_Ï¡
(
Ëv–db_™”©Ü_t
* 
™”
) {

293 
™”
->
»p
->
S“kToLa¡
();

296 
Ëv–db_™”_£ek
(
Ëv–db_™”©Ü_t
* 
™”
, cÚ¡ * 
k
, 
size_t
 
kËn
) {

297 
™”
->
»p
->
S“k
(
Sliû
(
k
, 
kËn
));

300 
Ëv–db_™”_Ãxt
(
Ëv–db_™”©Ü_t
* 
™”
è{ i‹r->
»p
->
Next
(); }

302 
Ëv–db_™”_´ev
(
Ëv–db_™”©Ü_t
* 
™”
è{ i‹r->
»p
->
P»v
(); }

304 cÚ¡ * 
Ëv–db_™”_key
(cÚ¡ 
Ëv–db_™”©Ü_t
* 
™”
, 
size_t
* 
kËn
) {

305 
Sliû
 
s
 = 
™”
->
»p
->
key
();

306 *
kËn
 = 
s
.
size
();

307  
s
.
d©a
();

310 cÚ¡ * 
Ëv–db_™”_v®ue
(cÚ¡ 
Ëv–db_™”©Ü_t
* 
™”
, 
size_t
* 
vËn
) {

311 
Sliû
 
s
 = 
™”
->
»p
->
v®ue
();

312 *
vËn
 = 
s
.
size
();

313  
s
.
d©a
();

316 
Ëv–db_™”_g‘_”rÜ
(cÚ¡ 
Ëv–db_™”©Ü_t
* 
™”
, ** 
”½Œ
) {

317 
SaveE¼Ü
(
”½Œ
, 
™”
->
»p
->
¡©us
());

320 
Ëv–db_wr™eb©ch_t
* 
Ëv–db_wr™eb©ch_ü—‹
() {

321  
Ãw
 
Ëv–db_wr™eb©ch_t
;

324 
Ëv–db_wr™eb©ch_de¡roy
(
Ëv–db_wr™eb©ch_t
* 
b
è{ 
d–‘e
 b; }

326 
Ëv–db_wr™eb©ch_ş—r
(
Ëv–db_wr™eb©ch_t
* 
b
è{ b->
»p
.
CË¬
(); }

328 
Ëv–db_wr™eb©ch_put
(
Ëv–db_wr™eb©ch_t
* 
b
, cÚ¡ * 
key
,

329 
size_t
 
kËn
, cÚ¡ * 
v®
, size_ˆ
vËn
) {

330 
b
->
»p
.
Put
(
Sliû
(
key
, 
kËn
), Sliû(
v®
, 
vËn
));

333 
Ëv–db_wr™eb©ch_d–‘e
(
Ëv–db_wr™eb©ch_t
* 
b
, cÚ¡ * 
key
,

334 
size_t
 
kËn
) {

335 
b
->
»p
.
D–‘e
(
Sliû
(
key
, 
kËn
));

338 
Ëv–db_wr™eb©ch_™”©e
(cÚ¡ 
Ëv–db_wr™eb©ch_t
* 
b
, * 
¡©e
,

339 (*
put
)(*, cÚ¡ * 
k
, 
size_t
 
kËn
,

340 cÚ¡ * 
v
, 
size_t
 
vËn
),

341 (*
d–‘ed
)(*, cÚ¡ * 
k
,

342 
size_t
 
kËn
)) {

343 şas 
	cH
 : 
public
 
Wr™eB©ch
::
HªdËr
 {

344 
public
:

345 * 
¡©e_
;

346 (*
put_
)(*, cÚ¡ * 
k
, 
size_t
 
kËn
, cÚ¡ * 
v
, size_ˆ
vËn
);

347 (*
d–‘ed_
)(*, cÚ¡ * 
k
, 
size_t
 
kËn
);

348 
vœtu®
 
Put
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

349 (*
put_
)(
¡©e_
, 
key
.
d©a
(), key.
size
(), 
v®ue
.data(), value.size());

351 
vœtu®
 
D–‘e
(cÚ¡ 
Sliû
& 
key
) {

352 (*
d–‘ed_
)(
¡©e_
, 
key
.
d©a
(), key.
size
());

355 
H
 
hªdËr
;

356 
hªdËr
.
¡©e_
 = 
¡©e
;

357 
hªdËr
.
put_
 = 
put
;

358 
hªdËr
.
d–‘ed_
 = 
d–‘ed
;

359 
b
->
»p
.
I‹¿‹
(&
hªdËr
);

362 
	$Ëv–db_wr™eb©ch_­³nd
(
Ëv–db_wr™eb©ch_t
* 
de¡š©iÚ
,

363 cÚ¡ 
Ëv–db_wr™eb©ch_t
* 
sourû
) {

364 
de¡š©iÚ
->
»p
.
	`Aµ’d
(
sourû
->rep);

365 
	}
}

367 
Ëv–db_İtiÚs_t
* 
	$Ëv–db_İtiÚs_ü—‹
(è{  
Ãw
 
Ëv–db_İtiÚs_t
; 
	}
}

369 
	$Ëv–db_İtiÚs_de¡roy
(
Ëv–db_İtiÚs_t
* 
İtiÚs
è{ 
d–‘e
 o±iÚs; 
	}
}

371 
	$Ëv–db_İtiÚs_£t_com·¿tÜ
(
Ëv–db_İtiÚs_t
* 
İt
,

372 
Ëv–db_com·¿tÜ_t
* 
cmp
) {

373 
İt
->
»p
.
com·¿tÜ
 = 
cmp
;

374 
	}
}

376 
	$Ëv–db_İtiÚs_£t_f‹r_pŞicy
(
Ëv–db_İtiÚs_t
* 
İt
,

377 
Ëv–db_f‹½Şicy_t
* 
pŞicy
) {

378 
İt
->
»p
.
f‹r_pŞicy
 = 
pŞicy
;

379 
	}
}

381 
	$Ëv–db_İtiÚs_£t_ü—‹_if_missšg
(
Ëv–db_İtiÚs_t
* 
İt
,

382 
v
) {

383 
İt
->
»p
.
ü—‹_if_missšg
 = 
v
;

384 
	}
}

386 
	$Ëv–db_İtiÚs_£t_”rÜ_if_exi¡s
(
Ëv–db_İtiÚs_t
* 
İt
,

387 
v
) {

388 
İt
->
»p
.
”rÜ_if_exi¡s
 = 
v
;

389 
	}
}

391 
	$Ëv–db_İtiÚs_£t_·¿noid_checks
(
Ëv–db_İtiÚs_t
* 
İt
,

392 
v
) {

393 
İt
->
»p
.
·¿noid_checks
 = 
v
;

394 
	}
}

396 
	$Ëv–db_İtiÚs_£t_’v
(
Ëv–db_İtiÚs_t
* 
İt
, 
Ëv–db_’v_t
* 
’v
) {

397 
İt
->
»p
.
’v
 = (’v ?ƒnv->»°: 
nuÎ±r
);

398 
	}
}

400 
	$Ëv–db_İtiÚs_£t_šfo_log
(
Ëv–db_İtiÚs_t
* 
İt
, 
Ëv–db_logg”_t
* 
l
) {

401 
İt
->
»p
.
šfo_log
 = (
l
 ?†->»°: 
nuÎ±r
);

402 
	}
}

404 
	$Ëv–db_İtiÚs_£t_wr™e_bufãr_size
(
Ëv–db_İtiÚs_t
* 
İt
, 
size_t
 
s
) {

405 
İt
->
»p
.
wr™e_bufãr_size
 = 
s
;

406 
	}
}

408 
	$Ëv–db_İtiÚs_£t_max_İ’_fes
(
Ëv–db_İtiÚs_t
* 
İt
, 
n
) {

409 
İt
->
»p
.
max_İ’_fes
 = 
n
;

410 
	}
}

412 
	$Ëv–db_İtiÚs_£t_ÿche
(
Ëv–db_İtiÚs_t
* 
İt
, 
Ëv–db_ÿche_t
* 
c
) {

413 
İt
->
»p
.
block_ÿche
 = 
c
->rep;

414 
	}
}

416 
	$Ëv–db_İtiÚs_£t_block_size
(
Ëv–db_İtiÚs_t
* 
İt
, 
size_t
 
s
) {

417 
İt
->
»p
.
block_size
 = 
s
;

418 
	}
}

420 
	$Ëv–db_İtiÚs_£t_block_»¡¬t_š‹rv®
(
Ëv–db_İtiÚs_t
* 
İt
, 
n
) {

421 
İt
->
»p
.
block_»¡¬t_š‹rv®
 = 
n
;

422 
	}
}

424 
	$Ëv–db_İtiÚs_£t_max_fe_size
(
Ëv–db_İtiÚs_t
* 
İt
, 
size_t
 
s
) {

425 
İt
->
»p
.
max_fe_size
 = 
s
;

426 
	}
}

428 
	$Ëv–db_İtiÚs_£t_com´essiÚ
(
Ëv–db_İtiÚs_t
* 
İt
, 
t
) {

429 
İt
->
»p
.
com´essiÚ
 = 
¡©ic_ÿ¡
<
Com´essiÚTy³
>(
t
);

430 
	}
}

432 
Ëv–db_com·¿tÜ_t
* 
	$Ëv–db_com·¿tÜ_ü—‹
(

433 * 
¡©e
, (*
de¡ruùÜ
)(*),

434 (*
com·»
)(*, cÚ¡ * 
a
, 
size_t
 
®’
, cÚ¡ * 
b
,

435 
size_t
 
bËn
),

436 cÚ¡ * (*
Çme
)(*)) {

437 
Ëv–db_com·¿tÜ_t
* 
»suÉ
 = 
Ãw
†eveldb_comparator_t;

438 
»suÉ
->
¡©e_
 = 
¡©e
;

439 
»suÉ
->
de¡ruùÜ_
 = 
de¡ruùÜ
;

440 
»suÉ
->
com·»_
 = 
com·»
;

441 
»suÉ
->
Çme_
 = 
Çme
;

442  
»suÉ
;

443 
	}
}

445 
	$Ëv–db_com·¿tÜ_de¡roy
(
Ëv–db_com·¿tÜ_t
* 
cmp
è{ 
d–‘e
 cmp; 
	}
}

447 
Ëv–db_f‹½Şicy_t
* 
	$Ëv–db_f‹½Şicy_ü—‹
(

448 * 
¡©e
, (*
de¡ruùÜ
)(*),

449 * (*
ü—‹_f‹r
)(*, cÚ¡ * cÚ¡* 
key_¬¿y
,

450 cÚ¡ 
size_t
* 
key_Ëngth_¬¿y
, 
num_keys
,

451 
size_t
* 
f‹r_Ëngth
),

452 (*
key_may_m©ch
)(*, cÚ¡ * 
key
, 
size_t
 
Ëngth
,

453 cÚ¡ * 
f‹r
, 
size_t
 
f‹r_Ëngth
),

454 cÚ¡ * (*
Çme
)(*)) {

455 
Ëv–db_f‹½Şicy_t
* 
»suÉ
 = 
Ãw
†eveldb_filterpolicy_t;

456 
»suÉ
->
¡©e_
 = 
¡©e
;

457 
»suÉ
->
de¡ruùÜ_
 = 
de¡ruùÜ
;

458 
»suÉ
->
ü—‹_
 = 
ü—‹_f‹r
;

459 
»suÉ
->
key_m©ch_
 = 
key_may_m©ch
;

460 
»suÉ
->
Çme_
 = 
Çme
;

461  
»suÉ
;

462 
	}
}

464 
	$Ëv–db_f‹½Şicy_de¡roy
(
Ëv–db_f‹½Şicy_t
* 
f‹r
) {

465 
d–‘e
 
f‹r
;

466 
	}
}

468 
Ëv–db_f‹½Şicy_t
* 
	$Ëv–db_f‹½Şicy_ü—‹_bloom
(
b™s_³r_key
) {

472 
W¿µ”
 : 
public
 
Ëv–db_f‹½Şicy_t
 {

473 
	`DoNÙhšg
(*) {}

475 ~
	`W¿µ”
(è{ 
d–‘e
 
»p_
; }

476 cÚ¡ * 
	`Name
(ècÚ¡ {  
»p_
->Name(); }

477 
	`C»©eF‹r
(cÚ¡ 
Sliû
* 
keys
, 
n
, 
¡d
::
¡ršg
* 
d¡
) const {

478  
»p_
->
	`C»©eF‹r
(
keys
, 
n
, 
d¡
);

480 
boŞ
 
	`KeyMayM©ch
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
f‹r
) const {

481  
»p_
->
	`KeyMayM©ch
(
key
, 
f‹r
);

484 cÚ¡ 
F‹rPŞicy
* 
»p_
;

486 
W¿µ”
* 
w¿µ”
 = 
Ãw
 Wrapper;

487 
w¿µ”
->
»p_
 = 
	`NewBloomF‹rPŞicy
(
b™s_³r_key
);

488 
w¿µ”
->
¡©e_
 = 
nuÎ±r
;

489 
w¿µ”
->
de¡ruùÜ_
 = &
W¿µ”
::
DoNÙhšg
;

490  
w¿µ”
;

491 
	}
}

493 
Ëv–db_»adİtiÚs_t
* 
	$Ëv–db_»adİtiÚs_ü—‹
() {

494  
Ãw
 
Ëv–db_»adİtiÚs_t
;

495 
	}
}

497 
	$Ëv–db_»adİtiÚs_de¡roy
(
Ëv–db_»adİtiÚs_t
* 
İt
è{ 
d–‘e
 o±; 
	}
}

499 
	$Ëv–db_»adİtiÚs_£t_v”ify_checksums
(
Ëv–db_»adİtiÚs_t
* 
İt
,

500 
v
) {

501 
İt
->
»p
.
v”ify_checksums
 = 
v
;

502 
	}
}

504 
	$Ëv–db_»adİtiÚs_£t_fl_ÿche
(
Ëv–db_»adİtiÚs_t
* 
İt
,

505 
v
) {

506 
İt
->
»p
.
fl_ÿche
 = 
v
;

507 
	}
}

509 
	$Ëv–db_»adİtiÚs_£t_¢­shÙ
(
Ëv–db_»adİtiÚs_t
* 
İt
,

510 cÚ¡ 
Ëv–db_¢­shÙ_t
* 
¢­
) {

511 
İt
->
»p
.
¢­shÙ
 = (
¢­
 ? sÇp->»°: 
nuÎ±r
);

512 
	}
}

514 
Ëv–db_wr™eİtiÚs_t
* 
	$Ëv–db_wr™eİtiÚs_ü—‹
() {

515  
Ãw
 
Ëv–db_wr™eİtiÚs_t
;

516 
	}
}

518 
	$Ëv–db_wr™eİtiÚs_de¡roy
(
Ëv–db_wr™eİtiÚs_t
* 
İt
è{ 
d–‘e
 o±; 
	}
}

520 
	$Ëv–db_wr™eİtiÚs_£t_sync
(
Ëv–db_wr™eİtiÚs_t
* 
İt
,

521 
v
) {

522 
İt
->
»p
.
sync
 = 
v
;

523 
	}
}

525 
Ëv–db_ÿche_t
* 
	$Ëv–db_ÿche_ü—‹_Ìu
(
size_t
 
ÿ·c™y
) {

526 
Ëv–db_ÿche_t
* 
c
 = 
Ãw
†eveldb_cache_t;

527 
c
->
»p
 = 
	`NewLRUCache
(
ÿ·c™y
);

528  
c
;

529 
	}
}

531 
	$Ëv–db_ÿche_de¡roy
(
Ëv–db_ÿche_t
* 
ÿche
) {

532 
d–‘e
 
ÿche
->
»p
;

533 
d–‘e
 
ÿche
;

534 
	}
}

536 
Ëv–db_’v_t
* 
	$Ëv–db_ü—‹_deçuÉ_’v
() {

537 
Ëv–db_’v_t
* 
»suÉ
 = 
Ãw
†eveldb_env_t;

538 
»suÉ
->
»p
 = 
Env
::
	`DeçuÉ
();

539 
»suÉ
->
is_deçuÉ
 = 
Œue
;

540  
»suÉ
;

541 
	}
}

543 
	$Ëv–db_’v_de¡roy
(
Ëv–db_’v_t
* 
’v
) {

544 ià(!
’v
->
is_deçuÉ
è
d–‘e
ƒnv->
»p
;

545 
d–‘e
 
’v
;

546 
	}
}

548 * 
	$Ëv–db_’v_g‘_‹¡_dœeùÜy
(
Ëv–db_’v_t
* 
’v
) {

549 
¡d
::
¡ršg
 
»suÉ
;

550 ià(!
’v
->
»p
->
	`G‘Te¡DœeùÜy
(&
»suÉ
).
	`ok
()) {

551  
nuÎ±r
;

554 * 
bufãr
 = 
¡©ic_ÿ¡
<*>(
	`m®loc
(
»suÉ
.
	`size
() + 1));

555 
	`memıy
(
bufãr
, 
»suÉ
.
	`d©a
(),„esuÉ.
	`size
());

556 
bufãr
[
»suÉ
.
	`size
()] = '\0';

557  
bufãr
;

558 
	}
}

560 
	$Ëv–db_ä“
(* 
±r
è{ 
	`ä“
ÕŒ); 
	}
}

562 
	$Ëv–db_majÜ_v”siÚ
(è{  
kMajÜV”siÚ
; 
	}
}

564 
	$Ëv–db_mšÜ_v”siÚ
(è{  
kMšÜV”siÚ
; 
	}
}

	@db/c_test.c

5 
	~"Ëv–db/c.h
"

7 
	~<¡ddef.h
>

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

12 cÚ¡ * 
	gpha£
 = "";

14 
	$S¹Pha£
(cÚ¡ * 
Çme
) {

15 
	`årštf
(
¡d”r
, "==ğTe¡ %s\n", 
Çme
);

16 
pha£
 = 
Çme
;

17 
	}
}

19 
	#CheckNoE¼Ü
(
”r
) \

20 ià((
”r
è!ğ
NULL
) { \

21 
	`årštf
(
¡d”r
, "%s:%d: %s: %s\n", 
__FILE__
, 
__LINE__
, 
pha£
, (
”r
)); \

22 
	`abÜt
(); \

23 }

	)

25 
	#CheckCÚd™iÚ
(
cÚd
) \

26 ià(!(
cÚd
)) { \

27 
	`årštf
(
¡d”r
, "%s:%d: %s: %s\n", 
__FILE__
, 
__LINE__
, 
pha£
, #cond); \

28 
	`abÜt
(); \

29 }

	)

31 
	$CheckEqu®
(cÚ¡ * 
ex³ùed
, cÚ¡ * 
v
, 
size_t
 
n
) {

32 ià(
ex³ùed
 =ğ
NULL
 && 
v
 == NULL) {

34 } ià(
ex³ùed
 !ğ
NULL
 && 
v
 !ğNULL && 
n
 =ğ
	`¡¾’
(expected) &&

35 
	`memcmp
(
ex³ùed
, 
v
, 
n
) == 0) {

39 
	`årštf
(
¡d”r
, "%s:ƒxpected '%s', got '%s'\n",

40 
pha£
,

41 (
ex³ùed
 ?ƒxpected : "(null)"),

42 (
v
 ? v : "(null"));

43 
	`abÜt
();

45 
	}
}

47 
	$F»e
(** 
±r
) {

48 ià(*
±r
) {

49 
	`ä“
(*
±r
);

50 *
±r
 = 
NULL
;

52 
	}
}

54 
	$CheckG‘
(

55 
Ëv–db_t
* 
db
,

56 cÚ¡ 
Ëv–db_»adİtiÚs_t
* 
İtiÚs
,

57 cÚ¡ * 
key
,

58 cÚ¡ * 
ex³ùed
) {

59 * 
”r
 = 
NULL
;

60 
size_t
 
v®_Ën
;

61 * 
v®
;

62 
v®
 = 
	`Ëv–db_g‘
(
db
, 
İtiÚs
, 
key
, 
	`¡¾’
(key), &
v®_Ën
, &
”r
);

63 
	`CheckNoE¼Ü
(
”r
);

64 
	`CheckEqu®
(
ex³ùed
, 
v®
, 
v®_Ën
);

65 
	`F»e
(&
v®
);

66 
	}
}

68 
	$CheckI‹r
(
Ëv–db_™”©Ü_t
* 
™”
,

69 cÚ¡ * 
key
, cÚ¡ * 
v®
) {

70 
size_t
 
Ën
;

71 cÚ¡ * 
¡r
;

72 
¡r
 = 
	`Ëv–db_™”_key
(
™”
, &
Ën
);

73 
	`CheckEqu®
(
key
, 
¡r
, 
Ën
);

74 
¡r
 = 
	`Ëv–db_™”_v®ue
(
™”
, &
Ën
);

75 
	`CheckEqu®
(
v®
, 
¡r
, 
Ën
);

76 
	}
}

79 
	$CheckPut
(* 
±r
,

80 cÚ¡ * 
k
, 
size_t
 
kËn
,

81 cÚ¡ * 
v
, 
size_t
 
vËn
) {

82 * 
¡©e
 = (*è
±r
;

83 
	`CheckCÚd™iÚ
(*
¡©e
 < 2);

84 *
¡©e
) {

86 
	`CheckEqu®
("b¬", 
k
, 
kËn
);

87 
	`CheckEqu®
("b", 
v
, 
vËn
);

90 
	`CheckEqu®
("box", 
k
, 
kËn
);

91 
	`CheckEqu®
("c", 
v
, 
vËn
);

94 (*
¡©e
)++;

95 
	}
}

98 
	$CheckD–
(* 
±r
, cÚ¡ * 
k
, 
size_t
 
kËn
) {

99 * 
¡©e
 = (*è
±r
;

100 
	`CheckCÚd™iÚ
(*
¡©e
 == 2);

101 
	`CheckEqu®
("b¬", 
k
, 
kËn
);

102 (*
¡©e
)++;

103 
	}
}

105 
	$CmpDe¡roy
(* 
¬g
è{ 
	}
}

107 
	$CmpCom·»
(* 
¬g
, cÚ¡ * 
a
, 
size_t
 
®’
,

108 cÚ¡ * 
b
, 
size_t
 
bËn
) {

109 
n
 = (
®’
 < 
bËn
) ?‡len : blen;

110 
r
 = 
	`memcmp
(
a
, 
b
, 
n
);

111 ià(
r
 == 0) {

112 ià(
®’
 < 
bËn
è
r
 = -1;

113 ià(
®’
 > 
bËn
è
r
 = +1;

115  
r
;

116 
	}
}

118 cÚ¡ * 
	$CmpName
(* 
¬g
) {

120 
	}
}

123 
	gçke_f‹r_»suÉ
 = 1;

124 
	$F‹rDe¡roy
(* 
¬g
è{ 
	}
}

125 cÚ¡ * 
	$F‹rName
(* 
¬g
) {

127 
	}
}

128 * 
	$F‹rC»©e
(

129 * 
¬g
,

130 cÚ¡ * cÚ¡* 
key_¬¿y
, cÚ¡ 
size_t
* 
key_Ëngth_¬¿y
,

131 
num_keys
,

132 
size_t
* 
f‹r_Ëngth
) {

133 *
f‹r_Ëngth
 = 4;

134 * 
»suÉ
 = 
	`m®loc
(4);

135 
	`memıy
(
»suÉ
, "fake", 4);

136  
»suÉ
;

137 
	}
}

138 
	$F‹rKeyM©ch
(

139 * 
¬g
,

140 cÚ¡ * 
key
, 
size_t
 
Ëngth
,

141 cÚ¡ * 
f‹r
, 
size_t
 
f‹r_Ëngth
) {

142 
	`CheckCÚd™iÚ
(
f‹r_Ëngth
 == 4);

143 
	`CheckCÚd™iÚ
(
	`memcmp
(
f‹r
, "fake", 4) == 0);

144  
çke_f‹r_»suÉ
;

145 
	}
}

147 
	$maš
(
¬gc
, ** 
¬gv
) {

148 
Ëv–db_t
* 
db
;

149 
Ëv–db_com·¿tÜ_t
* 
cmp
;

150 
Ëv–db_ÿche_t
* 
ÿche
;

151 
Ëv–db_’v_t
* 
’v
;

152 
Ëv–db_İtiÚs_t
* 
İtiÚs
;

153 
Ëv–db_»adİtiÚs_t
* 
rİtiÚs
;

154 
Ëv–db_wr™eİtiÚs_t
* 
wİtiÚs
;

155 * 
dbÇme
;

156 * 
”r
 = 
NULL
;

157 
run
 = -1;

159 
	`CheckCÚd™iÚ
(
	`Ëv–db_majÜ_v”siÚ
() >= 1);

160 
	`CheckCÚd™iÚ
(
	`Ëv–db_mšÜ_v”siÚ
() >= 1);

162 
	`S¹Pha£
("create_objects");

163 
cmp
 = 
	`Ëv–db_com·¿tÜ_ü—‹
(
NULL
, 
CmpDe¡roy
, 
CmpCom·»
, 
CmpName
);

164 
’v
 = 
	`Ëv–db_ü—‹_deçuÉ_’v
();

165 
ÿche
 = 
	`Ëv–db_ÿche_ü—‹_Ìu
(100000);

166 
dbÇme
 = 
	`Ëv–db_’v_g‘_‹¡_dœeùÜy
(
’v
);

167 
	`CheckCÚd™iÚ
(
dbÇme
 !ğ
NULL
);

169 
İtiÚs
 = 
	`Ëv–db_İtiÚs_ü—‹
();

170 
	`Ëv–db_İtiÚs_£t_com·¿tÜ
(
İtiÚs
, 
cmp
);

171 
	`Ëv–db_İtiÚs_£t_”rÜ_if_exi¡s
(
İtiÚs
, 1);

172 
	`Ëv–db_İtiÚs_£t_ÿche
(
İtiÚs
, 
ÿche
);

173 
	`Ëv–db_İtiÚs_£t_’v
(
İtiÚs
, 
’v
);

174 
	`Ëv–db_İtiÚs_£t_šfo_log
(
İtiÚs
, 
NULL
);

175 
	`Ëv–db_İtiÚs_£t_wr™e_bufãr_size
(
İtiÚs
, 100000);

176 
	`Ëv–db_İtiÚs_£t_·¿noid_checks
(
İtiÚs
, 1);

177 
	`Ëv–db_İtiÚs_£t_max_İ’_fes
(
İtiÚs
, 10);

178 
	`Ëv–db_İtiÚs_£t_block_size
(
İtiÚs
, 1024);

179 
	`Ëv–db_İtiÚs_£t_block_»¡¬t_š‹rv®
(
İtiÚs
, 8);

180 
	`Ëv–db_İtiÚs_£t_max_fe_size
(
İtiÚs
, 3 << 20);

181 
	`Ëv–db_İtiÚs_£t_com´essiÚ
(
İtiÚs
, 
Ëv–db_no_com´essiÚ
);

183 
rİtiÚs
 = 
	`Ëv–db_»adİtiÚs_ü—‹
();

184 
	`Ëv–db_»adİtiÚs_£t_v”ify_checksums
(
rİtiÚs
, 1);

185 
	`Ëv–db_»adİtiÚs_£t_fl_ÿche
(
rİtiÚs
, 0);

187 
wİtiÚs
 = 
	`Ëv–db_wr™eİtiÚs_ü—‹
();

188 
	`Ëv–db_wr™eİtiÚs_£t_sync
(
wİtiÚs
, 1);

190 
	`S¹Pha£
("destroy");

191 
	`Ëv–db_de¡roy_db
(
İtiÚs
, 
dbÇme
, &
”r
);

192 
	`F»e
(&
”r
);

194 
	`S¹Pha£
("open_error");

195 
db
 = 
	`Ëv–db_İ’
(
İtiÚs
, 
dbÇme
, &
”r
);

196 
	`CheckCÚd™iÚ
(
”r
 !ğ
NULL
);

197 
	`F»e
(&
”r
);

199 
	`S¹Pha£
("leveldb_free");

200 
db
 = 
	`Ëv–db_İ’
(
İtiÚs
, 
dbÇme
, &
”r
);

201 
	`CheckCÚd™iÚ
(
”r
 !ğ
NULL
);

202 
	`Ëv–db_ä“
(
”r
);

203 
”r
 = 
NULL
;

205 
	`S¹Pha£
("open");

206 
	`Ëv–db_İtiÚs_£t_ü—‹_if_missšg
(
İtiÚs
, 1);

207 
db
 = 
	`Ëv–db_İ’
(
İtiÚs
, 
dbÇme
, &
”r
);

208 
	`CheckNoE¼Ü
(
”r
);

209 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", 
NULL
);

211 
	`S¹Pha£
("put");

212 
	`Ëv–db_put
(
db
, 
wİtiÚs
, "foo", 3, "h–lo", 5, &
”r
);

213 
	`CheckNoE¼Ü
(
”r
);

214 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", "hello");

216 
	`S¹Pha£
("compactall");

217 
	`Ëv–db_com·ù_¿nge
(
db
, 
NULL
, 0, NULL, 0);

218 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", "hello");

220 
	`S¹Pha£
("compactrange");

221 
	`Ëv–db_com·ù_¿nge
(
db
, "a", 1, "z", 1);

222 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", "hello");

224 
	`S¹Pha£
("writebatch");

226 
Ëv–db_wr™eb©ch_t
* 
wb
 = 
	`Ëv–db_wr™eb©ch_ü—‹
();

227 
	`Ëv–db_wr™eb©ch_put
(
wb
, "foo", 3, "a", 1);

228 
	`Ëv–db_wr™eb©ch_ş—r
(
wb
);

229 
	`Ëv–db_wr™eb©ch_put
(
wb
, "bar", 3, "b", 1);

230 
	`Ëv–db_wr™eb©ch_put
(
wb
, "box", 3, "c", 1);

232 
Ëv–db_wr™eb©ch_t
* 
wb2
 = 
	`Ëv–db_wr™eb©ch_ü—‹
();

233 
	`Ëv–db_wr™eb©ch_d–‘e
(
wb2
, "bar", 3);

234 
	`Ëv–db_wr™eb©ch_­³nd
(
wb
, 
wb2
);

235 
	`Ëv–db_wr™eb©ch_de¡roy
(
wb2
);

237 
	`Ëv–db_wr™e
(
db
, 
wİtiÚs
, 
wb
, &
”r
);

238 
	`CheckNoE¼Ü
(
”r
);

239 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", "hello");

240 
	`CheckG‘
(
db
, 
rİtiÚs
, "b¬", 
NULL
);

241 
	`CheckG‘
(
db
, 
rİtiÚs
, "box", "c");

243 
pos
 = 0;

244 
	`Ëv–db_wr™eb©ch_™”©e
(
wb
, &
pos
, 
CheckPut
, 
CheckD–
);

245 
	`CheckCÚd™iÚ
(
pos
 == 3);

246 
	`Ëv–db_wr™eb©ch_de¡roy
(
wb
);

249 
	`S¹Pha£
("iter");

251 
Ëv–db_™”©Ü_t
* 
™”
 = 
	`Ëv–db_ü—‹_™”©Ü
(
db
, 
rİtiÚs
);

252 
	`CheckCÚd™iÚ
(!
	`Ëv–db_™”_v®id
(
™”
));

253 
	`Ëv–db_™”_£ek_to_fœ¡
(
™”
);

254 
	`CheckCÚd™iÚ
(
	`Ëv–db_™”_v®id
(
™”
));

255 
	`CheckI‹r
(
™”
, "box", "c");

256 
	`Ëv–db_™”_Ãxt
(
™”
);

257 
	`CheckI‹r
(
™”
, "foo", "hello");

258 
	`Ëv–db_™”_´ev
(
™”
);

259 
	`CheckI‹r
(
™”
, "box", "c");

260 
	`Ëv–db_™”_´ev
(
™”
);

261 
	`CheckCÚd™iÚ
(!
	`Ëv–db_™”_v®id
(
™”
));

262 
	`Ëv–db_™”_£ek_to_Ï¡
(
™”
);

263 
	`CheckI‹r
(
™”
, "foo", "hello");

264 
	`Ëv–db_™”_£ek
(
™”
, "b", 1);

265 
	`CheckI‹r
(
™”
, "box", "c");

266 
	`Ëv–db_™”_g‘_”rÜ
(
™”
, &
”r
);

267 
	`CheckNoE¼Ü
(
”r
);

268 
	`Ëv–db_™”_de¡roy
(
™”
);

271 
	`S¹Pha£
("approximate_sizes");

273 
i
;

274 
n
 = 20000;

275 
keybuf
[100];

276 
v®buf
[100];

277 
ušt64_t
 
sizes
[2];

278 cÚ¡ * 
¡¬t
[2] = { "a", "k00000000000000010000" };

279 
size_t
 
¡¬t_Ën
[2] = { 1, 21 };

280 cÚ¡ * 
lim™
[2] = { "k00000000000000010000", "z" };

281 
size_t
 
lim™_Ën
[2] = { 21, 1 };

282 
	`Ëv–db_wr™eİtiÚs_£t_sync
(
wİtiÚs
, 0);

283 
i
 = 0; i < 
n
; i++) {

284 
	`¢´štf
(
keybuf
, (keybuf), "k%020d", 
i
);

285 
	`¢´štf
(
v®buf
, (v®buf), "v%020d", 
i
);

286 
	`Ëv–db_put
(
db
, 
wİtiÚs
, 
keybuf
, 
	`¡¾’
(keybuf), 
v®buf
, strlen(valbuf),

287 &
”r
);

288 
	`CheckNoE¼Ü
(
”r
);

290 
	`Ëv–db_­´oxim©e_sizes
(
db
, 2, 
¡¬t
, 
¡¬t_Ën
, 
lim™
, 
lim™_Ën
, 
sizes
);

291 
	`CheckCÚd™iÚ
(
sizes
[0] > 0);

292 
	`CheckCÚd™iÚ
(
sizes
[1] > 0);

295 
	`S¹Pha£
("property");

297 * 
´İ
 = 
	`Ëv–db_´İ”ty_v®ue
(
db
, "nosuchprop");

298 
	`CheckCÚd™iÚ
(
´İ
 =ğ
NULL
);

299 
´İ
 = 
	`Ëv–db_´İ”ty_v®ue
(
db
, "leveldb.stats");

300 
	`CheckCÚd™iÚ
(
´İ
 !ğ
NULL
);

301 
	`F»e
(&
´İ
);

304 
	`S¹Pha£
("snapshot");

306 cÚ¡ 
Ëv–db_¢­shÙ_t
* 
¢­
;

307 
¢­
 = 
	`Ëv–db_ü—‹_¢­shÙ
(
db
);

308 
	`Ëv–db_d–‘e
(
db
, 
wİtiÚs
, "foo", 3, &
”r
);

309 
	`CheckNoE¼Ü
(
”r
);

310 
	`Ëv–db_»adİtiÚs_£t_¢­shÙ
(
rİtiÚs
, 
¢­
);

311 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", "hello");

312 
	`Ëv–db_»adİtiÚs_£t_¢­shÙ
(
rİtiÚs
, 
NULL
);

313 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", 
NULL
);

314 
	`Ëv–db_»Ëa£_¢­shÙ
(
db
, 
¢­
);

317 
	`S¹Pha£
("repair");

319 
	`Ëv–db_şo£
(
db
);

320 
	`Ëv–db_İtiÚs_£t_ü—‹_if_missšg
(
İtiÚs
, 0);

321 
	`Ëv–db_İtiÚs_£t_”rÜ_if_exi¡s
(
İtiÚs
, 0);

322 
	`Ëv–db_»·œ_db
(
İtiÚs
, 
dbÇme
, &
”r
);

323 
	`CheckNoE¼Ü
(
”r
);

324 
db
 = 
	`Ëv–db_İ’
(
İtiÚs
, 
dbÇme
, &
”r
);

325 
	`CheckNoE¼Ü
(
”r
);

326 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", 
NULL
);

327 
	`CheckG‘
(
db
, 
rİtiÚs
, "b¬", 
NULL
);

328 
	`CheckG‘
(
db
, 
rİtiÚs
, "box", "c");

329 
	`Ëv–db_İtiÚs_£t_ü—‹_if_missšg
(
İtiÚs
, 1);

330 
	`Ëv–db_İtiÚs_£t_”rÜ_if_exi¡s
(
İtiÚs
, 1);

333 
	`S¹Pha£
("filter");

334 
run
 = 0;„un < 2;„un++) {

336 
	`CheckNoE¼Ü
(
”r
);

337 
Ëv–db_f‹½Şicy_t
* 
pŞicy
;

338 ià(
run
 == 0) {

339 
pŞicy
 = 
	`Ëv–db_f‹½Şicy_ü—‹
(

340 
NULL
, 
F‹rDe¡roy
, 
F‹rC»©e
, 
F‹rKeyM©ch
, 
F‹rName
);

342 
pŞicy
 = 
	`Ëv–db_f‹½Şicy_ü—‹_bloom
(10);

346 
	`Ëv–db_şo£
(
db
);

347 
	`Ëv–db_de¡roy_db
(
İtiÚs
, 
dbÇme
, &
”r
);

348 
	`Ëv–db_İtiÚs_£t_f‹r_pŞicy
(
İtiÚs
, 
pŞicy
);

349 
db
 = 
	`Ëv–db_İ’
(
İtiÚs
, 
dbÇme
, &
”r
);

350 
	`CheckNoE¼Ü
(
”r
);

351 
	`Ëv–db_put
(
db
, 
wİtiÚs
, "foo", 3, "foov®ue", 8, &
”r
);

352 
	`CheckNoE¼Ü
(
”r
);

353 
	`Ëv–db_put
(
db
, 
wİtiÚs
, "b¬", 3, "b¬v®ue", 8, &
”r
);

354 
	`CheckNoE¼Ü
(
”r
);

355 
	`Ëv–db_com·ù_¿nge
(
db
, 
NULL
, 0, NULL, 0);

357 
çke_f‹r_»suÉ
 = 1;

358 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", "foovalue");

359 
	`CheckG‘
(
db
, 
rİtiÚs
, "bar", "barvalue");

360 ià(
pha£
 == 0) {

362 
çke_f‹r_»suÉ
 = 0;

363 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", 
NULL
);

364 
	`CheckG‘
(
db
, 
rİtiÚs
, "b¬", 
NULL
);

365 
çke_f‹r_»suÉ
 = 1;

367 
	`CheckG‘
(
db
, 
rİtiÚs
, "foo", "foovalue");

368 
	`CheckG‘
(
db
, 
rİtiÚs
, "bar", "barvalue");

370 
	`Ëv–db_İtiÚs_£t_f‹r_pŞicy
(
İtiÚs
, 
NULL
);

371 
	`Ëv–db_f‹½Şicy_de¡roy
(
pŞicy
);

374 
	`S¹Pha£
("cleanup");

375 
	`Ëv–db_şo£
(
db
);

376 
	`Ëv–db_İtiÚs_de¡roy
(
İtiÚs
);

377 
	`Ëv–db_»adİtiÚs_de¡roy
(
rİtiÚs
);

378 
	`Ëv–db_wr™eİtiÚs_de¡roy
(
wİtiÚs
);

379 
	`Ëv–db_ä“
(
dbÇme
);

380 
	`Ëv–db_ÿche_de¡roy
(
ÿche
);

381 
	`Ëv–db_com·¿tÜ_de¡roy
(
cmp
);

382 
	`Ëv–db_’v_de¡roy
(
’v
);

384 
	`årštf
(
¡d”r
, "PASS\n");

386 
	}
}

	@db/corruption_test.cc

5 
	~<sys/ty³s.h
>

7 
	~"db/db_im¶.h
"

8 
	~"db/f’ame.h
"

9 
	~"db/log_fÜm©.h
"

10 
	~"db/v”siÚ_£t.h
"

11 
	~"Ëv–db/ÿche.h
"

12 
	~"Ëv–db/db.h
"

13 
	~"Ëv–db/bË.h
"

14 
	~"Ëv–db/wr™e_b©ch.h
"

15 
	~"ut/loggšg.h
"

16 
	~"ut/‹¡h¬Ãss.h
"

17 
	~"ut/‹¡ut.h
"

19 
Çme¥aû
 
	gËv–db
 {

21 cÚ¡ 
	gkV®ueSize
 = 1000;

23 şas 
	cCÜru±iÚTe¡
 {

24 
	gpublic
:

25 
CÜru±iÚTe¡
()

26 : 
db_
(
nuÎ±r
),

27 
dbÇme_
("/memenv/corruption_test"),

28 
tšy_ÿche_
(
NewLRUCache
(100)) {

29 
	gİtiÚs_
.
	g’v
 = &
’v_
;

30 
	gİtiÚs_
.
	gblock_ÿche
 = 
tšy_ÿche_
;

31 
De¡royDB
(
dbÇme_
, 
İtiÚs_
);

33 
	gİtiÚs_
.
	gü—‹_if_missšg
 = 
Œue
;

34 
Reİ’
();

35 
	gİtiÚs_
.
	gü—‹_if_missšg
 = 
çl£
;

38 ~
CÜru±iÚTe¡
() {

39 
d–‘e
 
	gdb_
;

40 
d–‘e
 
	gtšy_ÿche_
;

43 
Stus
 
TryReİ’
() {

44 
d–‘e
 
	gdb_
;

45 
	gdb_
 = 
nuÎ±r
;

46  
	gDB
::
O³n
(
İtiÚs_
, 
dbÇme_
, &
db_
);

49 
Reİ’
(è{ 
ASSERT_OK
(
TryReİ’
()); }

51 
R•aœDB
() {

52 
d–‘e
 
	gdb_
;

53 
	gdb_
 = 
nuÎ±r
;

54 
ASSERT_OK
(::
Ëv–db
::
R•aœDB
(
dbÇme_
, 
İtiÚs_
));

57 
Bud
(
n
) {

58 
	g¡d
::
¡ršg
 
key_¥aû
, 
	gv®ue_¥aû
;

59 
Wr™eB©ch
 
	gb©ch
;

60 
	gi
 = 0; i < 
	gn
; i++) {

62 
Sliû
 
	gkey
 = 
Key
(
i
, &
key_¥aû
);

63 
	gb©ch
.
CË¬
();

64 
	gb©ch
.
Put
(
key
, 
V®ue
(
i
, &
v®ue_¥aû
));

65 
Wr™eO±iÚs
 
	gİtiÚs
;

68 ià(
	gi
 =ğ
n
 - 1) {

69 
İtiÚs
.
sync
 = 
Œue
;

71 
ASSERT_OK
(
db_
->
Wr™e
(
İtiÚs
, &
b©ch
));

75 
Check
(
mš_ex³ùed
, 
max_ex³ùed
) {

76 
	gÃxt_ex³ùed
 = 0;

77 
	gmis£d
 = 0;

78 
	gbad_keys
 = 0;

79 
	gbad_v®ues
 = 0;

80 
	gcÜ»ù
 = 0;

81 
	g¡d
::
¡ršg
 
v®ue_¥aû
;

82 
I‹¿tÜ
* 
	g™”
 = 
db_
->
NewI‹¿tÜ
(
R—dO±iÚs
());

83 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

84 
ušt64_t
 
	gkey
;

85 
Sliû
 
š
(
™”
->
key
());

86 ià(
	gš
 =ğ"" || 
š
 == "~") {

90 ià(!
CÚsumeDecim®Numb”
(&
š
, &
key
è|| !
	gš
.
em±y
() ||

91 
	gkey
 < 
	gÃxt_ex³ùed
) {

92 
	gbad_keys
++;

95 
	gmis£d
 +ğ(
key
 - 
Ãxt_ex³ùed
);

96 
	gÃxt_ex³ùed
 = 
key
 + 1;

97 ià(
	g™”
->
v®ue
(è!ğ
V®ue
(
key
, &
v®ue_¥aû
)) {

98 
	gbad_v®ues
++;

100 
	gcÜ»ù
++;

103 
d–‘e
 
	g™”
;

105 
årštf
(
¡d”r
,

107 
mš_ex³ùed
, 
max_ex³ùed
, 
cÜ»ù
, 
bad_keys
, 
bad_v®ues
, 
mis£d
);

108 
ASSERT_LE
(
mš_ex³ùed
, 
cÜ»ù
);

109 
ASSERT_GE
(
max_ex³ùed
, 
cÜ»ù
);

112 
CÜru±
(
FeTy³
 
f‘y³
, 
off£t
, 
by‹s_to_cÜru±
) {

114 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
f’ames
;

115 
ASSERT_OK
(
’v_
.
rg‘
()->
G‘Chd»n
(
dbÇme_
, &
f’ames
));

116 
ušt64_t
 
	gnumb”
;

117 
FeTy³
 
	gty³
;

118 
	g¡d
::
¡ršg
 
âame
;

119 
	gpicked_numb”
 = -1;

120 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

121 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
è&& 
	gty³
 =ğ
f‘y³
 &&

122 (
numb”
è> 
picked_numb”
) {

123 
âame
 = 
dbÇme_
 + "/" + 
f’ames
[
i
];

124 
	gpicked_numb”
 = 
numb”
;

127 
ASSERT_TRUE
(!
âame
.
em±y
()è<< 
	gf‘y³
;

129 
ušt64_t
 
	gfe_size
;

130 
ASSERT_OK
(
’v_
.
rg‘
()->
G‘FeSize
(
âame
, &
fe_size
));

132 ià(
	goff£t
 < 0) {

134 ià(-
	goff£t
 > 
	gfe_size
) {

135 
	goff£t
 = 0;

137 
	goff£t
 = 
fe_size
 + 
off£t
;

140 ià(
	goff£t
 > 
	gfe_size
) {

141 
	goff£t
 = 
fe_size
;

143 ià(
	goff£t
 + 
	gby‹s_to_cÜru±
 > 
	gfe_size
) {

144 
	gby‹s_to_cÜru±
 = 
fe_size
 - 
off£t
;

148 
	g¡d
::
¡ršg
 
cÚ‹Ás
;

149 
Stus
 
	gs
 = 
R—dFeToSŒšg
(
’v_
.
rg‘
(), 
âame
, &
cÚ‹Ás
);

150 
ASSERT_TRUE
(
s
.
ok
()è<< 
	gs
.
ToSŒšg
();

151 
	gi
 = 0; i < 
	gby‹s_to_cÜru±
; i++) {

152 
	gcÚ‹Ás
[
i
 + 
off£t
] ^= 0x80;

154 
	gs
 = 
Wr™eSŒšgToFe
(
’v_
.
rg‘
(), 
cÚ‹Ás
, 
âame
);

155 
ASSERT_TRUE
(
s
.
ok
()è<< 
	gs
.
ToSŒšg
();

158 
Prİ”ty
(cÚ¡ 
¡d
::
¡ršg
& 
Çme
) {

159 
¡d
::
¡ršg
 
´İ”ty
;

160 
	g»suÉ
;

161 ià(
	gdb_
->
G‘Prİ”ty
(
Çme
, &
´İ”ty
) &&

162 
ssÿnf
(
´İ”ty
.
c_¡r
(), "%d", &
»suÉ
) == 1) {

163  
»suÉ
;

170 
Sliû
 
Key
(
i
, 
¡d
::
¡ršg
* 
¡Üage
) {

171 
buf
[100];

172 
¢´štf
(
buf
, (buf), "%016d", 
i
);

173 
	g¡Üage
->
assign
(
buf
, 
¡¾’
(buf));

174  
Sliû
(*
¡Üage
);

178 
Sliû
 
V®ue
(
k
, 
¡d
::
¡ršg
* 
¡Üage
) {

179 
Rªdom
 
r
(
k
);

180  
	g‹¡
::
RªdomSŒšg
(&
r
, 
kV®ueSize
, 
¡Üage
);

183 
	g‹¡
::
E¼ÜEnv
 
’v_
;

184 
O±iÚs
 
	gİtiÚs_
;

185 
DB
* 
	gdb_
;

187 
	g´iv©e
:

188 
¡d
::
¡ršg
 
dbÇme_
;

189 
Cache
* 
	gtšy_ÿche_
;

192 
	$TEST
(
CÜru±iÚTe¡
, 
Recov”y
) {

193 
	`Bud
(100);

194 
	`Check
(100, 100);

195 
	`CÜru±
(
kLogFe
, 19, 1);

196 
	`CÜru±
(
kLogFe
, 
log
::
kBlockSize
 + 1000, 1);

197 
	`Reİ’
();

200 
	`Check
(36, 36);

201 
	}
}

203 
	$TEST
(
CÜru±iÚTe¡
, 
Recov”Wr™eE¼Ü
) {

204 
’v_
.
wr™abË_fe_”rÜ_
 = 
Œue
;

205 
Stus
 
s
 = 
	`TryReİ’
();

206 
	`ASSERT_TRUE
(!
s
.
	`ok
());

207 
	}
}

209 
	$TEST
(
CÜru±iÚTe¡
, 
NewFeE¼ÜDuršgWr™e
) {

211 
’v_
.
wr™abË_fe_”rÜ_
 = 
Œue
;

212 cÚ¡ 
num
 = 3 + (
	`O±iÚs
().
wr™e_bufãr_size
 / 
kV®ueSize
);

213 
¡d
::
¡ršg
 
v®ue_¡Üage
;

214 
Stus
 
s
;

215 
i
 = 0; 
s
.
	`ok
(è&& i < 
num
; i++) {

216 
Wr™eB©ch
 
b©ch
;

217 
b©ch
.
	`Put
("a", 
	`V®ue
(100, &
v®ue_¡Üage
));

218 
s
 = 
db_
->
	`Wr™e
(
	`Wr™eO±iÚs
(), &
b©ch
);

220 
	`ASSERT_TRUE
(!
s
.
	`ok
());

221 
	`ASSERT_GE
(
’v_
.
num_wr™abË_fe_”rÜs_
, 1);

222 
’v_
.
wr™abË_fe_”rÜ_
 = 
çl£
;

223 
	`Reİ’
();

224 
	}
}

226 
	$TEST
(
CÜru±iÚTe¡
, 
TabËFe
) {

227 
	`Bud
(100);

228 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

229 
dbi
->
	`TEST_Com·ùMemTabË
();

230 
dbi
->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
,‚ullptr);

231 
dbi
->
	`TEST_Com·ùRªge
(1, 
nuÎ±r
,‚ullptr);

233 
	`CÜru±
(
kTabËFe
, 100, 1);

234 
	`Check
(90, 99);

235 
	}
}

237 
	$TEST
(
CÜru±iÚTe¡
, 
TabËFeR•aœ
) {

238 
İtiÚs_
.
block_size
 = 2 * 
kV®ueSize
;

239 
İtiÚs_
.
·¿noid_checks
 = 
Œue
;

240 
	`Reİ’
();

241 
	`Bud
(100);

242 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

243 
dbi
->
	`TEST_Com·ùMemTabË
();

244 
dbi
->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
,‚ullptr);

245 
dbi
->
	`TEST_Com·ùRªge
(1, 
nuÎ±r
,‚ullptr);

247 
	`CÜru±
(
kTabËFe
, 100, 1);

248 
	`R•aœDB
();

249 
	`Reİ’
();

250 
	`Check
(95, 99);

251 
	}
}

253 
	$TEST
(
CÜru±iÚTe¡
, 
TabËFeIndexD©a
) {

254 
	`Bud
(10000);

255 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

256 
dbi
->
	`TEST_Com·ùMemTabË
();

258 
	`CÜru±
(
kTabËFe
, -2000, 500);

259 
	`Reİ’
();

260 
	`Check
(5000, 9999);

261 
	}
}

263 
	$TEST
(
CÜru±iÚTe¡
, 
MissšgDesütÜ
) {

264 
	`Bud
(1000);

265 
	`R•aœDB
();

266 
	`Reİ’
();

267 
	`Check
(1000, 1000);

268 
	}
}

270 
	$TEST
(
CÜru±iÚTe¡
, 
Sequ’ûNumb”Recov”y
) {

271 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v1"));

272 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v2"));

273 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v3"));

274 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v4"));

275 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v5"));

276 
	`R•aœDB
();

277 
	`Reİ’
();

278 
¡d
::
¡ršg
 
v
;

279 
	`ASSERT_OK
(
db_
->
	`G‘
(
	`R—dO±iÚs
(), "foo", &
v
));

280 
	`ASSERT_EQ
("v5", 
v
);

283 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v6"));

284 
	`ASSERT_OK
(
db_
->
	`G‘
(
	`R—dO±iÚs
(), "foo", &
v
));

285 
	`ASSERT_EQ
("v6", 
v
);

286 
	`Reİ’
();

287 
	`ASSERT_OK
(
db_
->
	`G‘
(
	`R—dO±iÚs
(), "foo", &
v
));

288 
	`ASSERT_EQ
("v6", 
v
);

289 
	}
}

291 
	$TEST
(
CÜru±iÚTe¡
, 
CÜru±edDesütÜ
) {

292 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "hello"));

293 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

294 
dbi
->
	`TEST_Com·ùMemTabË
();

295 
dbi
->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
,‚ullptr);

297 
	`CÜru±
(
kDesütÜFe
, 0, 1000);

298 
Stus
 
s
 = 
	`TryReİ’
();

299 
	`ASSERT_TRUE
(!
s
.
	`ok
());

301 
	`R•aœDB
();

302 
	`Reİ’
();

303 
¡d
::
¡ršg
 
v
;

304 
	`ASSERT_OK
(
db_
->
	`G‘
(
	`R—dO±iÚs
(), "foo", &
v
));

305 
	`ASSERT_EQ
("h–lo", 
v
);

306 
	}
}

308 
	$TEST
(
CÜru±iÚTe¡
, 
Com·ùiÚIÅutE¼Ü
) {

309 
	`Bud
(10);

310 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

311 
dbi
->
	`TEST_Com·ùMemTabË
();

312 cÚ¡ 
Ï¡
 = 
cÚfig
::
kMaxMemCom·ùLev–
;

313 
	`ASSERT_EQ
(1, 
	`Prİ”ty
("Ëv–db.num-fes-©-Ëv–" + 
	`Numb”ToSŒšg
(
Ï¡
)));

315 
	`CÜru±
(
kTabËFe
, 100, 1);

316 
	`Check
(5, 9);

319 
	`Bud
(10000);

320 
	`Check
(10000, 10000);

321 
	}
}

323 
	$TEST
(
CÜru±iÚTe¡
, 
Com·ùiÚIÅutE¼ÜP¬ªoid
) {

324 
İtiÚs_
.
·¿noid_checks
 = 
Œue
;

325 
İtiÚs_
.
wr™e_bufãr_size
 = 512 << 10;

326 
	`Reİ’
();

327 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

330 
i
 = 0; i < 2; i++) {

331 
	`Bud
(10);

332 
dbi
->
	`TEST_Com·ùMemTabË
();

333 
	`CÜru±
(
kTabËFe
, 100, 1);

334 
’v_
.
	`SË•FÜMiüo£cÚds
(100000);

336 
dbi
->
	`Com·ùRªge
(
nuÎ±r
,‚ullptr);

339 
¡d
::
¡ršg
 
tmp1
, 
tmp2
;

340 
Stus
 
s
 = 
db_
->
	`Put
(
	`Wr™eO±iÚs
(), 
	`Key
(5, &
tmp1
), 
	`V®ue
(5, &
tmp2
));

341 
	`ASSERT_TRUE
(!
s
.
	`ok
()) << "write did‚ot fail in corrupted…aranoid db";

342 
	}
}

344 
	$TEST
(
CÜru±iÚTe¡
, 
UÄ–©edKeys
) {

345 
	`Bud
(10);

346 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db_
);

347 
dbi
->
	`TEST_Com·ùMemTabË
();

348 
	`CÜru±
(
kTabËFe
, 100, 1);

350 
¡d
::
¡ršg
 
tmp1
, 
tmp2
;

351 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), 
	`Key
(1000, &
tmp1
), 
	`V®ue
(1000, &
tmp2
)));

352 
¡d
::
¡ršg
 
v
;

353 
	`ASSERT_OK
(
db_
->
	`G‘
(
	`R—dO±iÚs
(), 
	`Key
(1000, &
tmp1
), &
v
));

354 
	`ASSERT_EQ
(
	`V®ue
(1000, &
tmp2
).
	`ToSŒšg
(), 
v
);

355 
dbi
->
	`TEST_Com·ùMemTabË
();

356 
	`ASSERT_OK
(
db_
->
	`G‘
(
	`R—dO±iÚs
(), 
	`Key
(1000, &
tmp1
), &
v
));

357 
	`ASSERT_EQ
(
	`V®ue
(1000, &
tmp2
).
	`ToSŒšg
(), 
v
);

358 
	}
}

362 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/db_bench.cc

5 
	~<¡dio.h
>

6 
	~<¡dlib.h
>

7 
	~<sys/ty³s.h
>

9 
	~"Ëv–db/ÿche.h
"

10 
	~"Ëv–db/db.h
"

11 
	~"Ëv–db/’v.h
"

12 
	~"Ëv–db/f‹r_pŞicy.h
"

13 
	~"Ëv–db/wr™e_b©ch.h
"

14 
	~"pÜt/pÜt.h
"

15 
	~"ut/üc32c.h
"

16 
	~"ut/hi¡og¿m.h
"

17 
	~"ut/mu‹xlock.h
"

18 
	~"ut/¿ndom.h
"

19 
	~"ut/‹¡ut.h
"

43 cÚ¡ * 
	gFLAGS_b’chm¬ks
 =

62 
	gFLAGS_num
 = 1000000;

65 
	gFLAGS_»ads
 = -1;

68 
	gFLAGS_th»ads
 = 1;

71 
	gFLAGS_v®ue_size
 = 100;

75 
	gFLAGS_com´essiÚ_¿tio
 = 0.5;

78 
boŞ
 
	gFLAGS_hi¡og¿m
 = 
çl£
;

82 
	gFLAGS_wr™e_bufãr_size
 = 0;

86 
	gFLAGS_max_fe_size
 = 0;

90 
	gFLAGS_block_size
 = 0;

94 
	gFLAGS_ÿche_size
 = -1;

97 
	gFLAGS_İ’_fes
 = 0;

101 
	gFLAGS_bloom_b™s
 = -1;

106 
boŞ
 
	gFLAGS_u£_exi¡šg_db
 = 
çl£
;

109 
boŞ
 
	gFLAGS_»u£_logs
 = 
çl£
;

112 cÚ¡ * 
	gFLAGS_db
 = 
nuÎ±r
;

114 
Çme¥aû
 
	gËv–db
 {

116 
	gÇme¥aû
 {

117 
	gËv–db
::
Env
* 
g_’v
 = 
nuÎ±r
;

120 şas 
	cRªdomG’”©Ü
 {

121 
	g´iv©e
:

122 
¡d
::
¡ršg
 
d©a_
;

123 
	gpos_
;

125 
	gpublic
:

126 
RªdomG’”©Ü
() {

130 
Rªdom
 
ºd
(301);

131 
	g¡d
::
¡ršg
 
p›û
;

132 
	gd©a_
.
size
() < 1048576) {

135 
	g‹¡
::
Com´essibËSŒšg
(&
ºd
, 
FLAGS_com´essiÚ_¿tio
, 100, &
p›û
);

136 
	gd©a_
.
­³nd
(
p›û
);

138 
	gpos_
 = 0;

141 
Sliû
 
G’”©e
(
size_t
 
Ën
) {

142 ià(
	gpos_
 + 
	gËn
 > 
	gd©a_
.
size
()) {

143 
	gpos_
 = 0;

144 
as£¹
(
Ën
 < 
d©a_
.
size
());

146 
	gpos_
 +ğ
Ën
;

147  
Sliû
(
d©a_
.
d©a
(è+ 
pos_
 - 
Ën
,†en);

151 #ià
defšed
(
__lšux
)

152 
Sliû
 
TrimS·û
(Sliû 
s
) {

153 
size_t
 
	g¡¬t
 = 0;

154 
	g¡¬t
 < 
	gs
.
size
(è&& 
is¥aû
(
s
[
¡¬t
])) {

155 
	g¡¬t
++;

157 
size_t
 
	glim™
 = 
s
.
size
();

158 
	glim™
 > 
	g¡¬t
 && 
is¥aû
(
s
[
lim™
 - 1])) {

159 
	glim™
--;

161  
Sliû
(
s
.
d©a
(è+ 
¡¬t
, 
lim™
 - start);

165 
Aµ’dW™hS·û
(
¡d
::
¡ršg
* 
¡r
, 
Sliû
 
msg
) {

166 ià(
	gmsg
.
em±y
()) ;

167 ià(!
	g¡r
->
em±y
()) {

168 
	g¡r
->
push_back
(' ');

170 
	g¡r
->
­³nd
(
msg
.
d©a
(), msg.
size
());

173 şas 
	cSts
 {

174 
	g´iv©e
:

175 
¡¬t_
;

176 
	gfšish_
;

177 
	g£cÚds_
;

178 
	gdÚe_
;

179 
	gÃxt_»pÜt_
;

180 
št64_t
 
	gby‹s_
;

181 
	gÏ¡_İ_fšish_
;

182 
Hi¡og¿m
 
	ghi¡_
;

183 
	g¡d
::
¡ršg
 
mes§ge_
;

185 
	gpublic
:

186 
Sts
(è{ 
S¹
(); }

188 
S¹
() {

189 
	gÃxt_»pÜt_
 = 100;

190 
	gÏ¡_İ_fšish_
 = 
¡¬t_
;

191 
	ghi¡_
.
CË¬
();

192 
	gdÚe_
 = 0;

193 
	gby‹s_
 = 0;

194 
	g£cÚds_
 = 0;

195 
	g¡¬t_
 = 
g_’v
->
NowMiüos
();

196 
	gfšish_
 = 
¡¬t_
;

197 
	gmes§ge_
.
ş—r
();

200 
M”ge
(cÚ¡ 
Sts
& 
Ùh”
) {

201 
	ghi¡_
.
M”ge
(
Ùh”
.
hi¡_
);

202 
	gdÚe_
 +ğ
Ùh”
.
dÚe_
;

203 
	gby‹s_
 +ğ
Ùh”
.
by‹s_
;

204 
	g£cÚds_
 +ğ
Ùh”
.
£cÚds_
;

205 ià(
	gÙh”
.
	g¡¬t_
 < s¹_è¡¬t_ = 
Ùh”
.
¡¬t_
;

206 ià(
	gÙh”
.
	gfšish_
 > fšish_èfšish_ = 
Ùh”
.
fšish_
;

209 ià(
	gmes§ge_
.
em±y
()èmes§ge_ = 
Ùh”
.
mes§ge_
;

212 
Stİ
() {

213 
	gfšish_
 = 
g_’v
->
NowMiüos
();

214 
	g£cÚds_
 = (
fšish_
 - 
¡¬t_
) * 1e-6;

217 
AddMes§ge
(
Sliû
 
msg
è{ 
Aµ’dW™hS·û
(&
mes§ge_
, msg); }

219 
FšishedSšgËOp
() {

220 ià(
	gFLAGS_hi¡og¿m
) {

221 
	gnow
 = 
g_’v
->
NowMiüos
();

222 
	gmiüos
 = 
now
 - 
Ï¡_İ_fšish_
;

223 
	ghi¡_
.
Add
(
miüos
);

224 ià(
	gmiüos
 > 20000) {

225 
årštf
(
¡d”r
, "lÚg op: %.1àmiüos%30s\r", 
miüos
, "");

226 
fæush
(
¡d”r
);

228 
	gÏ¡_İ_fšish_
 = 
now
;

231 
	gdÚe_
++;

232 ià(
	gdÚe_
 >ğ
Ãxt_»pÜt_
) {

233 ià(
Ãxt_»pÜt_
 < 1000)

234 
Ãxt_»pÜt_
 += 100;

235 ià(
	gÃxt_»pÜt_
 < 5000)

236 
	gÃxt_»pÜt_
 += 500;

237 ià(
	gÃxt_»pÜt_
 < 10000)

238 
	gÃxt_»pÜt_
 += 1000;

239 ià(
	gÃxt_»pÜt_
 < 50000)

240 
	gÃxt_»pÜt_
 += 5000;

241 ià(
	gÃxt_»pÜt_
 < 100000)

242 
	gÃxt_»pÜt_
 += 10000;

243 ià(
	gÃxt_»pÜt_
 < 500000)

244 
	gÃxt_»pÜt_
 += 50000;

246 
	gÃxt_»pÜt_
 += 100000;

247 
årštf
(
¡d”r
, "... fšished %d ops%30s\r", 
dÚe_
, "");

248 
fæush
(
¡d”r
);

252 
AddBy‹s
(
št64_t
 
n
è{ 
	gby‹s_
 +=‚; }

254 
R•Üt
(cÚ¡ 
Sliû
& 
Çme
) {

257 ià(
	gdÚe_
 < 1) done_ = 1;

259 
	g¡d
::
¡ršg
 
exŒa
;

260 ià(
	gby‹s_
 > 0) {

263 
	g–­£d
 = (
fšish_
 - 
¡¬t_
) * 1e-6;

264 
	g¿‹
[100];

265 
¢´štf
(
¿‹
, (rate), "%6.1f MB/s",

266 (
by‹s_
 / 1048576.0è/ 
–­£d
);

267 
	gexŒa
 = 
¿‹
;

269 
Aµ’dW™hS·û
(&
exŒa
, 
mes§ge_
);

271 
årštf
(
¡dout
, "%-12 : %11.3àmiüos/İ;%s%s\n", 
Çme
.
ToSŒšg
().
c_¡r
(),

272 
£cÚds_
 * 1e6 / 
dÚe_
, (
exŒa
.
em±y
(è? "" : " "),ƒxŒa.
c_¡r
());

273 ià(
	gFLAGS_hi¡og¿m
) {

274 
årštf
(
¡dout
, "Miüo£cÚd ³¸İ:\n%s\n", 
hi¡_
.
ToSŒšg
().
c_¡r
());

276 
fæush
(
¡dout
);

281 
	sSh¬edS‹
 {

282 
	gpÜt
::
Mu‹x
 
mu
;

283 
	gpÜt
::
CÚdV¬
 
cv
 
GUARDED_BY
(
mu
);

284 
tÙ®
 
GUARDED_BY
(
mu
);

292 
num_š™Ÿlized
 
GUARDED_BY
(
mu
);

293 
num_dÚe
 
GUARDED_BY
(
mu
);

294 
boŞ
 
¡¬t
 
GUARDED_BY
(
mu
);

296 
Sh¬edS‹
(
tÙ®
)

297 : 
cv
(&
mu
), 
tÙ®
ÑÙ®), 
num_š™Ÿlized
(0), 
num_dÚe
(0), 
¡¬t
(
çl£
) {}

301 
	sTh»adS‹
 {

302 
	gtid
;

303 
Rªdom
 
	g¿nd
;

304 
Sts
 
	g¡©s
;

305 
Sh¬edS‹
* 
	gsh¬ed
;

307 
Th»adS‹
(
šdex
è: 
tid
(šdex), 
¿nd
(1000 + index), 
sh¬ed
(
nuÎ±r
) {}

312 şas 
	cB’chm¬k
 {

313 
	g´iv©e
:

314 
Cache
* 
ÿche_
;

315 cÚ¡ 
F‹rPŞicy
* 
	gf‹r_pŞicy_
;

316 
DB
* 
	gdb_
;

317 
	gnum_
;

318 
	gv®ue_size_
;

319 
	g’Œ›s_³r_b©ch_
;

320 
Wr™eO±iÚs
 
	gwr™e_İtiÚs_
;

321 
	g»ads_
;

322 
	gh—p_couÁ”_
;

324 
PrštH—d”
() {

325 cÚ¡ 
	gkKeySize
 = 16;

326 
PrštEnvœÚm’t
();

327 
årštf
(
¡dout
, "Keys: %d by‹ —ch\n", 
kKeySize
);

328 
årštf
(
¡dout
, "Values: %d bytesƒach (%d bytes‡fter compression)\n",

329 
FLAGS_v®ue_size
,

330 
¡©ic_ÿ¡
<>(
FLAGS_v®ue_size
 * 
FLAGS_com´essiÚ_¿tio
 + 0.5));

331 
årštf
(
¡dout
, "EÁr›s: %d\n", 
num_
);

332 
årštf
(
¡dout
, "RawSize: %.1f MB (estimated)\n",

333 ((
¡©ic_ÿ¡
<
št64_t
>(
kKeySize
 + 
FLAGS_v®ue_size
è* 
num_
) /

335 
årštf
(
¡dout
, "FileSize: %.1f MB (estimated)\n",

336 (((
kKeySize
 + 
FLAGS_v®ue_size
 * 
FLAGS_com´essiÚ_¿tio
è* 
num_
) /

338 
PrštW¬nšgs
();

339 
årštf
(
¡dout
, "------------------------------------------------\n");

342 
PrštW¬nšgs
() {

343 #ià
defšed
(
__GNUC__
è&& !defšed(
__OPTIMIZE__
)

344 
årštf
(

345 
¡dout
,

348 #iâdeà
NDEBUG


349 
årštf
(
¡dout
,

354 cÚ¡ 
	g‹xt
[] = "yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy";

355 
	g¡d
::
¡ršg
 
com´es£d
;

356 ià(!
	gpÜt
::
SÇµy_Com´ess
(
‹xt
, Ñext), &
com´es£d
)) {

357 
årštf
(
¡dout
, "WARNING: Snappy compression is‚otƒnabled\n");

358 } ià(
	gcom´es£d
.
size
(è>ğ(
‹xt
)) {

359 
årštf
(
¡dout
, "WARNING: Snappy compression is‚otƒffective\n");

363 
PrštEnvœÚm’t
() {

364 
årštf
(
¡d”r
, "Lev–DB: v”siÚ %d.%d\n", 
kMajÜV”siÚ
,

365 
kMšÜV”siÚ
);

367 #ià
defšed
(
__lšux
)

368 
time_t
 
	gnow
 = 
time
(
nuÎ±r
);

369 
årštf
(
¡d”r
, "D©e: %s", 
ùime
(&
now
));

371 
FILE
* 
	gıušfo
 = 
fİ’
("/proc/cpuinfo", "r");

372 ià(
	gıušfo
 !ğ
nuÎ±r
) {

373 
lše
[1000];

374 
	gnum_ıus
 = 0;

375 
	g¡d
::
¡ršg
 
ıu_ty³
;

376 
	g¡d
::
¡ršg
 
ÿche_size
;

377 
fg‘s
(
lše
, Öše), 
ıušfo
è!ğ
nuÎ±r
) {

378 cÚ¡ * 
£p
 = 
¡rchr
(
lše
, ':');

379 ià(
	g£p
 =ğ
nuÎ±r
) {

382 
Sliû
 
	gkey
 = 
TrimS·û
(Sliû(
lše
, 
£p
 - 1 -†ine));

383 
Sliû
 
	gv®
 = 
TrimS·û
(Sliû(
£p
 + 1));

384 ià(
	gkey
 == "model‚ame") {

385 ++
num_ıus
;

386 
	gıu_ty³
 = 
v®
.
ToSŒšg
();

387 } ià(
	gkey
 == "cache size") {

388 
ÿche_size
 = 
v®
.
ToSŒšg
();

391 
fşo£
(
ıušfo
);

392 
årštf
(
¡d”r
, "CPU: %d * %s\n", 
num_ıus
, 
ıu_ty³
.
c_¡r
());

393 
årštf
(
¡d”r
, "CPUCache: %s\n", 
ÿche_size
.
c_¡r
());

398 
	gpublic
:

399 
B’chm¬k
()

400 : 
ÿche_
(
FLAGS_ÿche_size
 >ğ0 ? 
NewLRUCache
(FLAGS_ÿche_sizeè: 
nuÎ±r
),

401 
f‹r_pŞicy_
(
FLAGS_bloom_b™s
 >= 0

402 ? 
NewBloomF‹rPŞicy
(
FLAGS_bloom_b™s
)

403 : 
nuÎ±r
),

404 
db_
(
nuÎ±r
),

405 
num_
(
FLAGS_num
),

406 
v®ue_size_
(
FLAGS_v®ue_size
),

407 
’Œ›s_³r_b©ch_
(1),

408 
»ads_
(
FLAGS_»ads
 < 0 ? 
FLAGS_num
 : FLAGS_reads),

409 
h—p_couÁ”_
(0) {

410 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
fes
;

411 
	gg_’v
->
G‘Chd»n
(
FLAGS_db
, &
fes
);

412 
size_t
 
	gi
 = 0; i < 
	gfes
.
size
(); i++) {

413 ià(
Sliû
(
fes
[
i
]).
¡¬ts_w™h
("heap-")) {

414 
	gg_’v
->
D–‘eFe
(
¡d
::
¡ršg
(
FLAGS_db
è+ "/" + 
fes
[
i
]);

417 ià(!
	gFLAGS_u£_exi¡šg_db
) {

418 
De¡royDB
(
FLAGS_db
, 
O±iÚs
());

422 ~
B’chm¬k
() {

423 
d–‘e
 
	gdb_
;

424 
d–‘e
 
	gÿche_
;

425 
d–‘e
 
	gf‹r_pŞicy_
;

428 
Run
() {

429 
PrštH—d”
();

430 
O³n
();

432 cÚ¡ * 
	gb’chm¬ks
 = 
FLAGS_b’chm¬ks
;

433 
	gb’chm¬ks
 !ğ
nuÎ±r
) {

434 cÚ¡ * 
£p
 = 
¡rchr
(
b’chm¬ks
, ',');

435 
Sliû
 
	gÇme
;

436 ià(
	g£p
 =ğ
nuÎ±r
) {

437 
Çme
 = 
b’chm¬ks
;

438 
	gb’chm¬ks
 = 
nuÎ±r
;

440 
	gÇme
 = 
Sliû
(
b’chm¬ks
, 
£p
 - benchmarks);

441 
	gb’chm¬ks
 = 
£p
 + 1;

445 
	gnum_
 = 
FLAGS_num
;

446 
	g»ads_
 = (
FLAGS_»ads
 < 0 ? 
FLAGS_num
 : FLAGS_reads);

447 
	gv®ue_size_
 = 
FLAGS_v®ue_size
;

448 
	g’Œ›s_³r_b©ch_
 = 1;

449 
	gwr™e_İtiÚs_
 = 
Wr™eO±iÚs
();

451 (
	gB’chm¬k
::*
m‘hod
)(
Th»adS‹
*èğ
nuÎ±r
;

452 
boŞ
 
	gäesh_db
 = 
çl£
;

453 
	gnum_th»ads
 = 
FLAGS_th»ads
;

455 ià(
	gÇme
 =ğ
Sliû
("open")) {

456 
m‘hod
 = &
B’chm¬k
::
O³nB’ch
;

457 
	gnum_
 /= 10000;

458 ià(
	gnum_
 < 1)‚um_ = 1;

459 } ià(
	gÇme
 =ğ
Sliû
("fillseq")) {

460 
äesh_db
 = 
Œue
;

461 
	gm‘hod
 = &
B’chm¬k
::
Wr™eSeq
;

462 } ià(
	gÇme
 =ğ
Sliû
("fillbatch")) {

463 
äesh_db
 = 
Œue
;

464 
	g’Œ›s_³r_b©ch_
 = 1000;

465 
	gm‘hod
 = &
B’chm¬k
::
Wr™eSeq
;

466 } ià(
	gÇme
 =ğ
Sliû
("fillrandom")) {

467 
äesh_db
 = 
Œue
;

468 
	gm‘hod
 = &
B’chm¬k
::
Wr™eRªdom
;

469 } ià(
	gÇme
 =ğ
Sliû
("overwrite")) {

470 
äesh_db
 = 
çl£
;

471 
	gm‘hod
 = &
B’chm¬k
::
Wr™eRªdom
;

472 } ià(
	gÇme
 =ğ
Sliû
("fillsync")) {

473 
äesh_db
 = 
Œue
;

474 
	gnum_
 /= 1000;

475 
	gwr™e_İtiÚs_
.
	gsync
 = 
Œue
;

476 
	gm‘hod
 = &
B’chm¬k
::
Wr™eRªdom
;

477 } ià(
	gÇme
 =ğ
Sliû
("fill100K")) {

478 
äesh_db
 = 
Œue
;

479 
	gnum_
 /= 1000;

480 
	gv®ue_size_
 = 100 * 1000;

481 
	gm‘hod
 = &
B’chm¬k
::
Wr™eRªdom
;

482 } ià(
	gÇme
 =ğ
Sliû
("readseq")) {

483 
m‘hod
 = &
B’chm¬k
::
R—dSequ’tŸl
;

484 } ià(
	gÇme
 =ğ
Sliû
("readreverse")) {

485 
m‘hod
 = &
B’chm¬k
::
R—dRev”£
;

486 } ià(
	gÇme
 =ğ
Sliû
("readrandom")) {

487 
m‘hod
 = &
B’chm¬k
::
R—dRªdom
;

488 } ià(
	gÇme
 =ğ
Sliû
("readmissing")) {

489 
m‘hod
 = &
B’chm¬k
::
R—dMissšg
;

490 } ià(
	gÇme
 =ğ
Sliû
("seekrandom")) {

491 
m‘hod
 = &
B’chm¬k
::
S“kRªdom
;

492 } ià(
	gÇme
 =ğ
Sliû
("readhot")) {

493 
m‘hod
 = &
B’chm¬k
::
R—dHÙ
;

494 } ià(
	gÇme
 =ğ
Sliû
("readrandomsmall")) {

495 
»ads_
 /= 1000;

496 
	gm‘hod
 = &
B’chm¬k
::
R—dRªdom
;

497 } ià(
	gÇme
 =ğ
Sliû
("deleteseq")) {

498 
m‘hod
 = &
B’chm¬k
::
D–‘eSeq
;

499 } ià(
	gÇme
 =ğ
Sliû
("deleterandom")) {

500 
m‘hod
 = &
B’chm¬k
::
D–‘eRªdom
;

501 } ià(
	gÇme
 =ğ
Sliû
("readwhilewriting")) {

502 
num_th»ads
++;

503 
	gm‘hod
 = &
B’chm¬k
::
R—dWheWr™šg
;

504 } ià(
	gÇme
 =ğ
Sliû
("compact")) {

505 
m‘hod
 = &
B’chm¬k
::
Com·ù
;

506 } ià(
	gÇme
 =ğ
Sliû
("crc32c")) {

507 
m‘hod
 = &
B’chm¬k
::
Crc32c
;

508 } ià(
	gÇme
 =ğ
Sliû
("snappycomp")) {

509 
m‘hod
 = &
B’chm¬k
::
SÇµyCom´ess
;

510 } ià(
	gÇme
 =ğ
Sliû
("snappyuncomp")) {

511 
m‘hod
 = &
B’chm¬k
::
SÇµyUncom´ess
;

512 } ià(
	gÇme
 =ğ
Sliû
("heapprofile")) {

513 
H—pProfe
();

514 } ià(
	gÇme
 =ğ
Sliû
("stats")) {

515 
PrštSts
("leveldb.stats");

516 } ià(
	gÇme
 =ğ
Sliû
("sstables")) {

517 
PrštSts
("leveldb.sstables");

519 ià(!
	gÇme
.
em±y
()) {

520 
årštf
(
¡d”r
, "unknowÀb’chm¬k '%s'\n", 
Çme
.
ToSŒšg
().
c_¡r
());

524 ià(
	gäesh_db
) {

525 ià(
	gFLAGS_u£_exi¡šg_db
) {

526 
årštf
(
¡dout
, "%-12s : skipped (--use_existing_db isrue)\n",

527 
Çme
.
ToSŒšg
().
c_¡r
());

528 
	gm‘hod
 = 
nuÎ±r
;

530 
d–‘e
 
	gdb_
;

531 
	gdb_
 = 
nuÎ±r
;

532 
De¡royDB
(
FLAGS_db
, 
O±iÚs
());

533 
O³n
();

537 ià(
	gm‘hod
 !ğ
nuÎ±r
) {

538 
RunB’chm¬k
(
num_th»ads
, 
Çme
, 
m‘hod
);

543 
	g´iv©e
:

544 
	sTh»adArg
 {

545 
B’chm¬k
* 
bm
;

546 
Sh¬edS‹
* 
	gsh¬ed
;

547 
Th»adS‹
* 
	gth»ad
;

548 (
	gB’chm¬k
::*
m‘hod
)(
Th»adS‹
*);

551 
Th»adBody
(* 
v
) {

552 
Th»adArg
* 
	g¬g
 = 
»š‹½»t_ÿ¡
<Th»adArg*>(
v
);

553 
Sh¬edS‹
* 
	gsh¬ed
 = 
¬g
->
sh¬ed
;

554 
Th»adS‹
* 
	gth»ad
 = 
¬g
->
th»ad
;

556 
Mu‹xLock
 
l
(&
sh¬ed
->
mu
);

557 
	gsh¬ed
->
	gnum_š™Ÿlized
++;

558 ià(
	gsh¬ed
->
	gnum_š™Ÿlized
 >ğ
sh¬ed
->
tÙ®
) {

559 
sh¬ed
->
cv
.
SigÇlAÎ
();

561 !
	gsh¬ed
->
	g¡¬t
) {

562 
	gsh¬ed
->
	gcv
.
Wa™
();

566 
	gth»ad
->
	g¡©s
.
S¹
();

567 (
	g¬g
->
	gbm
->*×rg->
	gm‘hod
))(
	gth»ad
);

568 
	gth»ad
->
	g¡©s
.
Stİ
();

571 
Mu‹xLock
 
l
(&
sh¬ed
->
mu
);

572 
	gsh¬ed
->
	gnum_dÚe
++;

573 ià(
	gsh¬ed
->
	gnum_dÚe
 >ğ
sh¬ed
->
tÙ®
) {

574 
sh¬ed
->
cv
.
SigÇlAÎ
();

579 
RunB’chm¬k
(
n
, 
Sliû
 
Çme
,

580 (
B’chm¬k
::*
m‘hod
)(
Th»adS‹
*)) {

581 
Sh¬edS‹
 
sh¬ed
(
n
);

583 
Th»adArg
* 
	g¬g
 = 
Ãw
 Th»adArg[
n
];

584 
	gi
 = 0; i < 
	gn
; i++) {

585 
	g¬g
[
i
].
	gbm
 = 
this
;

586 
	g¬g
[
i
].
	gm‘hod
 = 
m‘hod
;

587 
	g¬g
[
i
].
	gsh¬ed
 = &
sh¬ed
;

588 
	g¬g
[
i
].
	gth»ad
 = 
Ãw
 
Th»adS‹
(i);

589 
	g¬g
[
i
].
	gth»ad
->
	gsh¬ed
 = &
sh¬ed
;

590 
	gg_’v
->
S¹Th»ad
(
Th»adBody
, &
¬g
[
i
]);

593 
	gsh¬ed
.
	gmu
.
Lock
();

594 
	gsh¬ed
.
	gnum_š™Ÿlized
 < 
	gn
) {

595 
	gsh¬ed
.
	gcv
.
Wa™
();

598 
	gsh¬ed
.
	g¡¬t
 = 
Œue
;

599 
	gsh¬ed
.
	gcv
.
SigÇlAÎ
();

600 
	gsh¬ed
.
	gnum_dÚe
 < 
	gn
) {

601 
	gsh¬ed
.
	gcv
.
Wa™
();

603 
	gsh¬ed
.
	gmu
.
UÆock
();

605 
	gi
 = 1; i < 
	gn
; i++) {

606 
	g¬g
[0].
	gth»ad
->
	g¡©s
.
M”ge
(
¬g
[
i
].
th»ad
->
¡©s
);

608 
	g¬g
[0].
	gth»ad
->
	g¡©s
.
R•Üt
(
Çme
);

610 
	gi
 = 0; i < 
	gn
; i++) {

611 
d–‘e
 
	g¬g
[
i
].
	gth»ad
;

613 
	gd–‘e
[] 
	g¬g
;

616 
Crc32c
(
Th»adS‹
* 
th»ad
) {

618 cÚ¡ 
	gsize
 = 4096;

619 cÚ¡ * 
	gÏb–
 = "(4K…er op)";

620 
	g¡d
::
¡ršg
 
d©a
(
size
, 'x');

621 
št64_t
 
	gby‹s
 = 0;

622 
ušt32_t
 
	güc
 = 0;

623 
	gby‹s
 < 500 * 1048576) {

624 
	güc
 = 
üc32c
::
V®ue
(
d©a
.d©a(), 
size
);

625 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

626 
	gby‹s
 +ğ
size
;

629 
årštf
(
¡d”r
, "... crc=0x%x\r", 
¡©ic_ÿ¡
<>(
üc
));

631 
	gth»ad
->
	g¡©s
.
AddBy‹s
(
by‹s
);

632 
	gth»ad
->
	g¡©s
.
AddMes§ge
(
Ïb–
);

635 
SÇµyCom´ess
(
Th»adS‹
* 
th»ad
) {

636 
RªdomG’”©Ü
 
	gg’
;

637 
Sliû
 
	gšput
 = 
g’
.
G’”©e
(
O±iÚs
().
block_size
);

638 
št64_t
 
	gby‹s
 = 0;

639 
št64_t
 
	g´oduûd
 = 0;

640 
boŞ
 
	gok
 = 
Œue
;

641 
	g¡d
::
¡ršg
 
com´es£d
;

642 
	gok
 && 
	gby‹s
 < 1024 * 1048576) {

643 
	gok
 = 
pÜt
::
SÇµy_Com´ess
(
šput
.
d©a
(), iÅut.
size
(), &
com´es£d
);

644 
	g´oduûd
 +ğ
com´es£d
.
size
();

645 
	gby‹s
 +ğ
šput
.
size
();

646 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

649 ià(!
	gok
) {

650 
	gth»ad
->
	g¡©s
.
AddMes§ge
("(snappy failure)");

652 
	gbuf
[100];

653 
¢´štf
(
buf
, (buf), "(output: %.1f%%)",

654 (
´oduûd
 * 100.0è/ 
by‹s
);

655 
	gth»ad
->
	g¡©s
.
AddMes§ge
(
buf
);

656 
	gth»ad
->
	g¡©s
.
AddBy‹s
(
by‹s
);

660 
SÇµyUncom´ess
(
Th»adS‹
* 
th»ad
) {

661 
RªdomG’”©Ü
 
	gg’
;

662 
Sliû
 
	gšput
 = 
g’
.
G’”©e
(
O±iÚs
().
block_size
);

663 
	g¡d
::
¡ršg
 
com´es£d
;

664 
boŞ
 
	gok
 = 
pÜt
::
SÇµy_Com´ess
(
šput
.
d©a
(), iÅut.
size
(), &
com´es£d
);

665 
št64_t
 
	gby‹s
 = 0;

666 * 
	guncom´es£d
 = 
Ãw
 [
šput
.
size
()];

667 
	gok
 && 
	gby‹s
 < 1024 * 1048576) {

668 
	gok
 = 
pÜt
::
SÇµy_Uncom´ess
(
com´es£d
.
d©a
(), com´es£d.
size
(),

669 
uncom´es£d
);

670 
	gby‹s
 +ğ
šput
.
size
();

671 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

673 
	gd–‘e
[] 
	guncom´es£d
;

675 ià(!
	gok
) {

676 
	gth»ad
->
	g¡©s
.
AddMes§ge
("(snappy failure)");

678 
	gth»ad
->
	g¡©s
.
AddBy‹s
(
by‹s
);

682 
O³n
() {

683 
as£¹
(
db_
 =ğ
nuÎ±r
);

684 
O±iÚs
 
	gİtiÚs
;

685 
	gİtiÚs
.
	g’v
 = 
g_’v
;

686 
	gİtiÚs
.
	gü—‹_if_missšg
 = !
FLAGS_u£_exi¡šg_db
;

687 
	gİtiÚs
.
	gblock_ÿche
 = 
ÿche_
;

688 
	gİtiÚs
.
	gwr™e_bufãr_size
 = 
FLAGS_wr™e_bufãr_size
;

689 
	gİtiÚs
.
	gmax_fe_size
 = 
FLAGS_max_fe_size
;

690 
	gİtiÚs
.
	gblock_size
 = 
FLAGS_block_size
;

691 
	gİtiÚs
.
	gmax_İ’_fes
 = 
FLAGS_İ’_fes
;

692 
	gİtiÚs
.
	gf‹r_pŞicy
 = 
f‹r_pŞicy_
;

693 
	gİtiÚs
.
	g»u£_logs
 = 
FLAGS_»u£_logs
;

694 
Stus
 
	gs
 = 
DB
::
O³n
(
İtiÚs
, 
FLAGS_db
, &
db_
);

695 ià(!
	gs
.
ok
()) {

696 
årštf
(
¡d”r
, "İ’ƒ¼Ü: %s\n", 
s
.
ToSŒšg
().
c_¡r
());

697 
ex™
(1);

701 
O³nB’ch
(
Th»adS‹
* 
th»ad
) {

702 
	gi
 = 0; i < 
	gnum_
; i++) {

703 
d–‘e
 
	gdb_
;

704 
O³n
();

705 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

709 
Wr™eSeq
(
Th»adS‹
* 
th»ad
è{ 
DoWr™e
Ñh»ad, 
Œue
); }

711 
Wr™eRªdom
(
Th»adS‹
* 
th»ad
è{ 
DoWr™e
Ñh»ad, 
çl£
); }

713 
DoWr™e
(
Th»adS‹
* 
th»ad
, 
boŞ
 
£q
) {

714 ià(
	gnum_
 !ğ
FLAGS_num
) {

715 
msg
[100];

716 
¢´štf
(
msg
, (msg), "(%d ops)", 
num_
);

717 
	gth»ad
->
	g¡©s
.
AddMes§ge
(
msg
);

720 
RªdomG’”©Ü
 
	gg’
;

721 
Wr™eB©ch
 
	gb©ch
;

722 
Stus
 
	gs
;

723 
št64_t
 
	gby‹s
 = 0;

724 
	gi
 = 0; i < 
	gnum_
; i +ğ
’Œ›s_³r_b©ch_
) {

725 
b©ch
.
CË¬
();

726 
	gj
 = 0; j < 
	g’Œ›s_³r_b©ch_
; j++) {

727 cÚ¡ 
	gk
 = 
£q
 ? 
i
 + 
j
 : (
th»ad
->
¿nd
.
Next
(è% 
FLAGS_num
);

728 
	gkey
[100];

729 
¢´štf
(
key
, (key), "%016d", 
k
);

730 
	gb©ch
.
Put
(
key
, 
g’
.
G’”©e
(
v®ue_size_
));

731 
	gby‹s
 +ğ
v®ue_size_
 + 
¡¾’
(
key
);

732 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

734 
	gs
 = 
db_
->
Wr™e
(
wr™e_İtiÚs_
, &
b©ch
);

735 ià(!
	gs
.
ok
()) {

736 
årštf
(
¡d”r
, "puˆ”rÜ: %s\n", 
s
.
ToSŒšg
().
c_¡r
());

737 
ex™
(1);

740 
	gth»ad
->
	g¡©s
.
AddBy‹s
(
by‹s
);

743 
R—dSequ’tŸl
(
Th»adS‹
* 
th»ad
) {

744 
I‹¿tÜ
* 
	g™”
 = 
db_
->
NewI‹¿tÜ
(
R—dO±iÚs
());

745 
	gi
 = 0;

746 
št64_t
 
	gby‹s
 = 0;

747 
	g™”
->
S“kToFœ¡
(); 
	gi
 < 
	g»ads_
 && i‹r->
V®id
(); i‹r->
Next
()) {

748 
	gby‹s
 +ğ
™”
->
key
().
size
(è+ i‹r->
v®ue
().size();

749 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

750 ++
	gi
;

752 
d–‘e
 
	g™”
;

753 
	gth»ad
->
	g¡©s
.
AddBy‹s
(
by‹s
);

756 
R—dRev”£
(
Th»adS‹
* 
th»ad
) {

757 
I‹¿tÜ
* 
	g™”
 = 
db_
->
NewI‹¿tÜ
(
R—dO±iÚs
());

758 
	gi
 = 0;

759 
št64_t
 
	gby‹s
 = 0;

760 
	g™”
->
S“kToLa¡
(); 
	gi
 < 
	g»ads_
 && i‹r->
V®id
(); i‹r->
P»v
()) {

761 
	gby‹s
 +ğ
™”
->
key
().
size
(è+ i‹r->
v®ue
().size();

762 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

763 ++
	gi
;

765 
d–‘e
 
	g™”
;

766 
	gth»ad
->
	g¡©s
.
AddBy‹s
(
by‹s
);

769 
R—dRªdom
(
Th»adS‹
* 
th»ad
) {

770 
R—dO±iÚs
 
	gİtiÚs
;

771 
	g¡d
::
¡ršg
 
v®ue
;

772 
	gfound
 = 0;

773 
	gi
 = 0; i < 
	g»ads_
; i++) {

774 
	gkey
[100];

775 cÚ¡ 
	gk
 = 
th»ad
->
¿nd
.
Next
(è% 
FLAGS_num
;

776 
¢´štf
(
key
, (key), "%016d", 
k
);

777 ià(
	gdb_
->
G‘
(
İtiÚs
, 
key
, &
v®ue
).
ok
()) {

778 
	gfound
++;

780 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

782 
	gmsg
[100];

783 
¢´štf
(
msg
, (msg), "(%d oà%d found)", 
found
, 
num_
);

784 
	gth»ad
->
	g¡©s
.
AddMes§ge
(
msg
);

787 
R—dMissšg
(
Th»adS‹
* 
th»ad
) {

788 
R—dO±iÚs
 
	gİtiÚs
;

789 
	g¡d
::
¡ršg
 
v®ue
;

790 
	gi
 = 0; i < 
	g»ads_
; i++) {

791 
	gkey
[100];

792 cÚ¡ 
	gk
 = 
th»ad
->
¿nd
.
Next
(è% 
FLAGS_num
;

793 
¢´štf
(
key
, (key), "%016d.", 
k
);

794 
	gdb_
->
G‘
(
İtiÚs
, 
key
, &
v®ue
);

795 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

799 
R—dHÙ
(
Th»adS‹
* 
th»ad
) {

800 
R—dO±iÚs
 
	gİtiÚs
;

801 
	g¡d
::
¡ršg
 
v®ue
;

802 cÚ¡ 
	g¿nge
 = (
FLAGS_num
 + 99) / 100;

803 
	gi
 = 0; i < 
	g»ads_
; i++) {

804 
	gkey
[100];

805 cÚ¡ 
	gk
 = 
th»ad
->
¿nd
.
Next
(è% 
¿nge
;

806 
¢´štf
(
key
, (key), "%016d", 
k
);

807 
	gdb_
->
G‘
(
İtiÚs
, 
key
, &
v®ue
);

808 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

812 
S“kRªdom
(
Th»adS‹
* 
th»ad
) {

813 
R—dO±iÚs
 
	gİtiÚs
;

814 
	gfound
 = 0;

815 
	gi
 = 0; i < 
	g»ads_
; i++) {

816 
I‹¿tÜ
* 
	g™”
 = 
db_
->
NewI‹¿tÜ
(
İtiÚs
);

817 
	gkey
[100];

818 cÚ¡ 
	gk
 = 
th»ad
->
¿nd
.
Next
(è% 
FLAGS_num
;

819 
¢´štf
(
key
, (key), "%016d", 
k
);

820 
	g™”
->
S“k
(
key
);

821 ià(
	g™”
->
V®id
(è&& i‹r->
key
(è=ğkeyè
found
++;

822 
d–‘e
 
	g™”
;

823 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

825 
	gmsg
[100];

826 
¢´štf
(
msg
, (msg), "(%d oà%d found)", 
found
, 
num_
);

827 
	gth»ad
->
	g¡©s
.
AddMes§ge
(
msg
);

830 
DoD–‘e
(
Th»adS‹
* 
th»ad
, 
boŞ
 
£q
) {

831 
RªdomG’”©Ü
 
	gg’
;

832 
Wr™eB©ch
 
	gb©ch
;

833 
Stus
 
	gs
;

834 
	gi
 = 0; i < 
	gnum_
; i +ğ
’Œ›s_³r_b©ch_
) {

835 
b©ch
.
CË¬
();

836 
	gj
 = 0; j < 
	g’Œ›s_³r_b©ch_
; j++) {

837 cÚ¡ 
	gk
 = 
£q
 ? 
i
 + 
j
 : (
th»ad
->
¿nd
.
Next
(è% 
FLAGS_num
);

838 
	gkey
[100];

839 
¢´štf
(
key
, (key), "%016d", 
k
);

840 
	gb©ch
.
D–‘e
(
key
);

841 
	gth»ad
->
	g¡©s
.
FšishedSšgËOp
();

843 
	gs
 = 
db_
->
Wr™e
(
wr™e_İtiÚs_
, &
b©ch
);

844 ià(!
	gs
.
ok
()) {

845 
årštf
(
¡d”r
, "d–ƒ¼Ü: %s\n", 
s
.
ToSŒšg
().
c_¡r
());

846 
ex™
(1);

851 
D–‘eSeq
(
Th»adS‹
* 
th»ad
è{ 
DoD–‘e
Ñh»ad, 
Œue
); }

853 
D–‘eRªdom
(
Th»adS‹
* 
th»ad
è{ 
DoD–‘e
Ñh»ad, 
çl£
); }

855 
R—dWheWr™šg
(
Th»adS‹
* 
th»ad
) {

856 ià(
	gth»ad
->
	gtid
 > 0) {

857 
R—dRªdom
(
th»ad
);

860 
RªdomG’”©Ü
 
	gg’
;

861 
	gŒue
) {

863 
Mu‹xLock
 
l
(&
th»ad
->
sh¬ed
->
mu
);

864 ià(
	gth»ad
->
	gsh¬ed
->
	gnum_dÚe
 + 1 >ğ
th»ad
->
sh¬ed
->
num_š™Ÿlized
) {

870 cÚ¡ 
	gk
 = 
th»ad
->
¿nd
.
Next
(è% 
FLAGS_num
;

871 
	gkey
[100];

872 
¢´štf
(
key
, (key), "%016d", 
k
);

873 
Stus
 
	gs
 = 
db_
->
Put
(
wr™e_İtiÚs_
, 
key
, 
g’
.
G’”©e
(
v®ue_size_
));

874 ià(!
	gs
.
ok
()) {

875 
årštf
(
¡d”r
, "puˆ”rÜ: %s\n", 
s
.
ToSŒšg
().
c_¡r
());

876 
ex™
(1);

881 
	gth»ad
->
	g¡©s
.
S¹
();

885 
Com·ù
(
Th»adS‹
* 
th»ad
è{ 
	gdb_
->
Com·ùRªge
(
nuÎ±r
,‚ullptr); }

887 
PrštSts
(cÚ¡ * 
key
) {

888 
	g¡d
::
¡ršg
 
¡©s
;

889 ià(!
	gdb_
->
G‘Prİ”ty
(
key
, &
¡©s
)) {

890 
	g¡©s
 = "(failed)";

892 
årštf
(
¡dout
, "\n%s\n", 
¡©s
.
c_¡r
());

895 
Wr™eToFe
(* 
¬g
, cÚ¡ * 
buf
, 
n
) {

896 
	g»š‹½»t_ÿ¡
<
	gWr™abËFe
*>(
	g¬g
)->
Aµ’d
(
Sliû
(
buf
, 
n
));

899 
H—pProfe
() {

900 
	gâame
[100];

901 
¢´štf
(
âame
, (âame), "%s/h—p-%04d", 
FLAGS_db
, ++
h—p_couÁ”_
);

902 
Wr™abËFe
* 
	gfe
;

903 
Stus
 
	gs
 = 
g_’v
->
NewWr™abËFe
(
âame
, &
fe
);

904 ià(!
	gs
.
ok
()) {

905 
årštf
(
¡d”r
, "%s\n", 
s
.
ToSŒšg
().
c_¡r
());

908 
boŞ
 
	gok
 = 
pÜt
::
G‘H—pProfe
(
Wr™eToFe
, 
fe
);

909 
d–‘e
 
	gfe
;

910 ià(!
	gok
) {

911 
årštf
(
¡d”r
, "heap…rofiling‚ot supported\n");

912 
	gg_’v
->
D–‘eFe
(
âame
);

919 
	$maš
(
¬gc
, ** 
¬gv
) {

920 
FLAGS_wr™e_bufãr_size
 = 
Ëv–db
::
	`O±iÚs
().
wr™e_bufãr_size
;

921 
FLAGS_max_fe_size
 = 
Ëv–db
::
	`O±iÚs
().
max_fe_size
;

922 
FLAGS_block_size
 = 
Ëv–db
::
	`O±iÚs
().
block_size
;

923 
FLAGS_İ’_fes
 = 
Ëv–db
::
	`O±iÚs
().
max_İ’_fes
;

924 
¡d
::
¡ršg
 
deçuÉ_db_·th
;

926 
i
 = 1; i < 
¬gc
; i++) {

927 
d
;

928 
n
;

929 
junk
;

930 ià(
Ëv–db
::
	`Sliû
(
¬gv
[
i
]).
	`¡¬ts_w™h
("--benchmarks=")) {

931 
FLAGS_b’chm¬ks
 = 
¬gv
[
i
] + 
	`¡¾’
("--benchmarks=");

932 } ià(
	`ssÿnf
(
¬gv
[
i
], "--com´essiÚ_¿tio=%lf%c", &
d
, &
junk
) == 1) {

933 
FLAGS_com´essiÚ_¿tio
 = 
d
;

934 } ià(
	`ssÿnf
(
¬gv
[
i
], "--hi¡og¿m=%d%c", &
n
, &
junk
) == 1 &&

935 (
n
 == 0 ||‚ == 1)) {

936 
FLAGS_hi¡og¿m
 = 
n
;

937 } ià(
	`ssÿnf
(
¬gv
[
i
], "--u£_exi¡šg_db=%d%c", &
n
, &
junk
) == 1 &&

938 (
n
 == 0 ||‚ == 1)) {

939 
FLAGS_u£_exi¡šg_db
 = 
n
;

940 } ià(
	`ssÿnf
(
¬gv
[
i
], "--»u£_logs=%d%c", &
n
, &
junk
) == 1 &&

941 (
n
 == 0 ||‚ == 1)) {

942 
FLAGS_»u£_logs
 = 
n
;

943 } ià(
	`ssÿnf
(
¬gv
[
i
], "--num=%d%c", &
n
, &
junk
) == 1) {

944 
FLAGS_num
 = 
n
;

945 } ià(
	`ssÿnf
(
¬gv
[
i
], "--»ads=%d%c", &
n
, &
junk
) == 1) {

946 
FLAGS_»ads
 = 
n
;

947 } ià(
	`ssÿnf
(
¬gv
[
i
], "--th»ads=%d%c", &
n
, &
junk
) == 1) {

948 
FLAGS_th»ads
 = 
n
;

949 } ià(
	`ssÿnf
(
¬gv
[
i
], "--v®ue_size=%d%c", &
n
, &
junk
) == 1) {

950 
FLAGS_v®ue_size
 = 
n
;

951 } ià(
	`ssÿnf
(
¬gv
[
i
], "--wr™e_bufãr_size=%d%c", &
n
, &
junk
) == 1) {

952 
FLAGS_wr™e_bufãr_size
 = 
n
;

953 } ià(
	`ssÿnf
(
¬gv
[
i
], "--max_fe_size=%d%c", &
n
, &
junk
) == 1) {

954 
FLAGS_max_fe_size
 = 
n
;

955 } ià(
	`ssÿnf
(
¬gv
[
i
], "--block_size=%d%c", &
n
, &
junk
) == 1) {

956 
FLAGS_block_size
 = 
n
;

957 } ià(
	`ssÿnf
(
¬gv
[
i
], "--ÿche_size=%d%c", &
n
, &
junk
) == 1) {

958 
FLAGS_ÿche_size
 = 
n
;

959 } ià(
	`ssÿnf
(
¬gv
[
i
], "--bloom_b™s=%d%c", &
n
, &
junk
) == 1) {

960 
FLAGS_bloom_b™s
 = 
n
;

961 } ià(
	`ssÿnf
(
¬gv
[
i
], "--İ’_fes=%d%c", &
n
, &
junk
) == 1) {

962 
FLAGS_İ’_fes
 = 
n
;

963 } ià(
	`¡ºcmp
(
¬gv
[
i
], "--db=", 5) == 0) {

964 
FLAGS_db
 = 
¬gv
[
i
] + 5;

966 
	`årštf
(
¡d”r
, "Inv®id fÏg '%s'\n", 
¬gv
[
i
]);

967 
	`ex™
(1);

971 
Ëv–db
::
g_’v
 =†ev–db::
Env
::
	`DeçuÉ
();

974 ià(
FLAGS_db
 =ğ
nuÎ±r
) {

975 
Ëv–db
::
g_’v
->
	`G‘Te¡DœeùÜy
(&
deçuÉ_db_·th
);

976 
deçuÉ_db_·th
 += "/dbbench";

977 
FLAGS_db
 = 
deçuÉ_db_·th
.
	`c_¡r
();

980 
Ëv–db
::
B’chm¬k
 
b’chm¬k
;

981 
b’chm¬k
.
	`Run
();

983 
	}
}

	@db/db_impl.cc

5 
	~"db/db_im¶.h
"

7 
	~<¡dšt.h
>

8 
	~<¡dio.h
>

10 
	~<®gÜ™hm
>

11 
	~<©omic
>

12 
	~<£t
>

13 
	~<¡ršg
>

14 
	~<veùÜ
>

16 
	~"db/bud”.h
"

17 
	~"db/db_™”.h
"

18 
	~"db/dbfÜm©.h
"

19 
	~"db/f’ame.h
"

20 
	~"db/log_»ad”.h
"

21 
	~"db/log_wr™”.h
"

22 
	~"db/membË.h
"

23 
	~"db/bË_ÿche.h
"

24 
	~"db/v”siÚ_£t.h
"

25 
	~"db/wr™e_b©ch_š‹º®.h
"

26 
	~"Ëv–db/db.h
"

27 
	~"Ëv–db/’v.h
"

28 
	~"Ëv–db/¡©us.h
"

29 
	~"Ëv–db/bË.h
"

30 
	~"Ëv–db/bË_bud”.h
"

31 
	~"pÜt/pÜt.h
"

32 
	~"bË/block.h
"

33 
	~"bË/m”g”.h
"

34 
	~"bË/two_Ëv–_™”©Ü.h
"

35 
	~"ut/codšg.h
"

36 
	~"ut/loggšg.h
"

37 
	~"ut/mu‹xlock.h
"

39 
	~"db/fh.h
"

41 
Çme¥aû
 
	gËv–db
 {

43 cÚ¡ 
	gkNumNÚTabËCacheFes
 = 10;

46 
	gDBIm¶
::
Wr™”
 {

47 
ex¶ic™
 
Wr™”
(
pÜt
::
Mu‹x
* 
mu
)

48 : 
b©ch
(
nuÎ±r
), 
sync
(
çl£
), 
dÚe
(çl£), 
cv
(
mu
) {}

50 
Stus
 
	g¡©us
;

51 
Wr™eB©ch
* 
	gb©ch
;

52 
boŞ
 
	gsync
;

53 
boŞ
 
	gdÚe
;

54 
	gpÜt
::
CÚdV¬
 
cv
;

57 
	gDBIm¶
::
Com·ùiÚS‹
 {

59 
	sOuut
 {

60 
ušt64_t
 
numb”
;

61 
ušt64_t
 
	gfe_size
;

62 
IÁ”ÇlKey
 
	gsm®Ë¡
, 
	gÏrge¡
;

64 
	gfs
;

67 
Ouut
* 
cu¼’t_ouut
(è{  &
	gouuts
[
ouuts
.
size
() - 1]; }

69 
ex¶ic™
 
Com·ùiÚS‹
(
Com·ùiÚ
* 
c
)

70 : 
com·ùiÚ
(
c
),

71 
sm®Ë¡_¢­shÙ
(0),

72 
outfe
(
nuÎ±r
),

73 
bud”
(
nuÎ±r
),

74 
tÙ®_by‹s
(0) {}

76 
Com·ùiÚ
* cÚ¡ 
	gcom·ùiÚ
;

82 
Sequ’ûNumb”
 
	gsm®Ë¡_¢­shÙ
;

84 
	g¡d
::
veùÜ
<
Ouut
> 
ouuts
;

87 
Wr™abËFe
* 
	goutfe
;

88 
TabËBud”
* 
	gbud”
;

90 
ušt64_t
 
	gtÙ®_by‹s
;

94 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gV
>

95 
ClToRªge
(
T
* 
±r
, 
V
 
mšv®ue
, V 
maxv®ue
) {

96 ià(
	g¡©ic_ÿ¡
<
	gV
>(*
	g±r
è> 
	gmaxv®ue
è*±¸ğ
maxv®ue
;

97 ià(
	g¡©ic_ÿ¡
<
	gV
>(*
	g±r
è< 
	gmšv®ue
è*±¸ğ
mšv®ue
;

99 
O±iÚs
 
Sª™izeO±iÚs
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
,

100 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
* 
icmp
,

101 cÚ¡ 
IÁ”ÇlF‹rPŞicy
* 
Şicy
,

102 cÚ¡ 
O±iÚs
& 
¤c
) {

103 
O±iÚs
 
	g»suÉ
 = 
¤c
;

104 
	g»suÉ
.
	gcom·¿tÜ
 = 
icmp
;

105 
	g»suÉ
.
	gf‹r_pŞicy
 = (
¤c
.
f‹r_pŞicy
 !ğ
nuÎ±r
è? 
Şicy
 :‚ullptr;

106 
ClToRªge
(&
»suÉ
.
max_İ’_fes
, 64 + 
kNumNÚTabËCacheFes
, 50000);

107 
ClToRªge
(&
»suÉ
.
wr™e_bufãr_size
, 64 << 10, 1 << 30);

108 
ClToRªge
(&
»suÉ
.
max_fe_size
, 1 << 20, 1 << 30);

109 
ClToRªge
(&
»suÉ
.
block_size
, 1 << 10, 4 << 20);

110 ià(
	g»suÉ
.
	gšfo_log
 =ğ
nuÎ±r
) {

112 
¤c
.
’v
->
C»©eDœ
(
dbÇme
);

113 
	g¤c
.
	g’v
->
R’ameFe
(
InfoLogFeName
(
dbÇme
), 
OldInfoLogFeName
(dbname));

114 
Stus
 
	gs
 = 
¤c
.
’v
->
NewLogg”
(
InfoLogFeName
(
dbÇme
), &
»suÉ
.
šfo_log
);

115 ià(!
	gs
.
ok
()) {

117 
	g»suÉ
.
	gšfo_log
 = 
nuÎ±r
;

120 ià(
	g»suÉ
.
	gblock_ÿche
 =ğ
nuÎ±r
) {

121 
»suÉ
.
block_ÿche
 = 
NewLRUCache
(8 << 20);

123  
	g»suÉ
;

126 
TabËCacheSize
(cÚ¡ 
O±iÚs
& 
§n™ized_İtiÚs
) {

128  
	g§n™ized_İtiÚs
.
	gmax_İ’_fes
 - 
	gkNumNÚTabËCacheFes
;

131 
	gDBIm¶
::
DBIm¶
(cÚ¡ 
O±iÚs
& 
¿w_İtiÚs
, cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
)

132 : 
’v_
(
¿w_İtiÚs
.
’v
),

133 
š‹º®_com·¿tÜ_
(
¿w_İtiÚs
.
com·¿tÜ
),

134 
š‹º®_f‹r_pŞicy_
(
¿w_İtiÚs
.
f‹r_pŞicy
),

135 
İtiÚs_
(
Sª™izeO±iÚs
(
dbÇme
, &
š‹º®_com·¿tÜ_
,

136 &
š‹º®_f‹r_pŞicy_
, 
¿w_İtiÚs
)),

137 
owns_šfo_log_
(
İtiÚs_
.
šfo_log
 !ğ
¿w_İtiÚs
.info_log),

138 
owns_ÿche_
(
İtiÚs_
.
block_ÿche
 !ğ
¿w_İtiÚs
.block_cache),

139 
dbÇme_
(
dbÇme
),

140 
bË_ÿche_
(
Ãw
 
TabËCache
(
dbÇme_
, 
İtiÚs_
, 
TabËCacheSize
(options_))),

141 
db_lock_
(
nuÎ±r
),

142 
shu‰šg_down_
(
çl£
),

143 
background_wÜk_fšished_sigÇl_
(&
mu‹x_
),

144 
mem_
(
nuÎ±r
),

145 
imm_
(
nuÎ±r
),

146 
has_imm_
(
çl£
),

147 
logfe_
(
nuÎ±r
),

148 
logfe_numb”_
(0),

149 
log_
(
nuÎ±r
),

150 
£ed_
(0),

151 
tmp_b©ch_
(
Ãw
 
Wr™eB©ch
),

152 
background_com·ùiÚ_scheduËd_
(
çl£
),

153 
mªu®_com·ùiÚ_
(
nuÎ±r
),

154 
v”siÚs_
(
Ãw
 
V”siÚS‘
(
dbÇme_
, &
İtiÚs_
, 
bË_ÿche_
,

155 &
š‹º®_com·¿tÜ_
)) {}

157 
	gDBIm¶
::~
DBIm¶
() {

159 
mu‹x_
.
Lock
();

160 
	gshu‰šg_down_
.
¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

161 
	gbackground_com·ùiÚ_scheduËd_
) {

162 
	gbackground_wÜk_fšished_sigÇl_
.
Wa™
();

164 
	gmu‹x_
.
UÆock
();

166 ià(
	gdb_lock_
 !ğ
nuÎ±r
) {

167 
’v_
->
UÆockFe
(
db_lock_
);

170 
d–‘e
 
	gv”siÚs_
;

171 ià(
	gmem_
 !ğ
nuÎ±r
è
mem_
->
UÄef
();

172 ià(
	gimm_
 !ğ
nuÎ±r
è
imm_
->
UÄef
();

173 
d–‘e
 
	gtmp_b©ch_
;

174 
d–‘e
 
	glog_
;

175 
d–‘e
 
	glogfe_
;

176 
d–‘e
 
	gbË_ÿche_
;

178 ià(
	gowns_šfo_log_
) {

179 
d–‘e
 
	gİtiÚs_
.
	gšfo_log
;

181 ià(
	gowns_ÿche_
) {

182 
d–‘e
 
	gİtiÚs_
.
	gblock_ÿche
;

186 
Stus
 
	gDBIm¶
::
NewDB
() {

187 
V”siÚEd™
 
Ãw_db
;

188 
	gÃw_db
.
S‘Com·¿tÜName
(
u£r_com·¿tÜ
()->
Name
());

189 
	gÃw_db
.
S‘LogNumb”
(0);

190 
	gÃw_db
.
S‘NextFe
(2);

191 
	gÃw_db
.
S‘La¡Sequ’û
(0);

193 cÚ¡ 
	g¡d
::
¡ršg
 
mªiã¡
 = 
DesütÜFeName
(
dbÇme_
, 1);

194 
Wr™abËFe
* 
	gfe
;

195 
Stus
 
	gs
 = 
’v_
->
NewWr™abËFe
(
mªiã¡
, &
fe
);

196 ià(!
	gs
.
ok
()) {

197  
	gs
;

200 
	glog
::
Wr™”
 
log
(
fe
);

201 
	g¡d
::
¡ršg
 
»cÜd
;

202 
	gÃw_db
.
EncodeTo
(&
»cÜd
);

203 
	gs
 = 
log
.
AddRecÜd
(
»cÜd
);

204 ià(
	gs
.
ok
()) {

205 
	gs
 = 
fe
->
Clo£
();

208 
d–‘e
 
	gfe
;

209 ià(
	gs
.
ok
()) {

211 
	gs
 = 
S‘Cu¼’tFe
(
’v_
, 
dbÇme_
, 1);

213 
	g’v_
->
D–‘eFe
(
mªiã¡
);

215  
	gs
;

218 
	gDBIm¶
::
MaybeIgnÜeE¼Ü
(
Stus
* 
s
) const {

219 ià(
s
->
ok
(è|| 
İtiÚs_
.
·¿noid_checks
) {

222 
Log
(
İtiÚs_
.
šfo_log
, "IgnÜšgƒ¼Ü %s", 
s
->
ToSŒšg
().
c_¡r
());

223 *
	gs
 = 
Stus
::
OK
();

227 
	gDBIm¶
::
D–‘eObsŞ‘eFes
() {

228 
mu‹x_
.
As£¹H–d
();

230 ià(!
	gbg_”rÜ_
.
ok
()) {

237 
	g¡d
::
£t
<
ušt64_t
> 
live
 = 
³ndšg_ouuts_
;

238 
	gv”siÚs_
->
AddLiveFes
(&
live
);

240 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
f’ames
;

241 
	g’v_
->
G‘Chd»n
(
dbÇme_
, &
f’ames
);

242 
ušt64_t
 
	gnumb”
;

243 
FeTy³
 
	gty³
;

244 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

245 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
)) {

246 
boŞ
 
	gk“p
 = 
Œue
;

247 
	gty³
) {

248 
	gkLogFe
:

249 
k“p
 = ((
numb”
 >ğ
v”siÚs_
->
LogNumb”
()) ||

250 (
numb”
 =ğ
v”siÚs_
->
P»vLogNumb”
()));

252 
	gkDesütÜFe
:

255 
k“p
 = (
numb”
 >ğ
v”siÚs_
->
Mªiã¡FeNumb”
());

257 
	gkTabËFe
:

258 
k“p
 = (
live
.
fšd
(
numb”
è!ğlive.
’d
());

260 
	gkTempFe
:

263 
k“p
 = (
live
.
fšd
(
numb”
è!ğlive.
’d
());

265 
	gkCu¼’tFe
:

266 
kDBLockFe
:

267 
kInfoLogFe
:

268 
k“p
 = 
Œue
;

272 ià(!
	gk“p
) {

273 ià(
	gty³
 =ğ
kTabËFe
) {

274 
bË_ÿche_
->
Eviù
(
numb”
);

276 
Log
(
İtiÚs_
.
šfo_log
, "D–‘ty³=%d #%Îd\n", 
¡©ic_ÿ¡
<>(
ty³
),

277 
¡©ic_ÿ¡
<>(
numb”
));

278 
	g’v_
->
D–‘eFe
(
dbÇme_
 + "/" + 
f’ames
[
i
]);

284 
Stus
 
	gDBIm¶
::
Recov”
(
V”siÚEd™
* 
ed™
, 
boŞ
* 
§ve_mªiã¡
) {

285 
	gmu‹x_
.
As£¹H–d
();

290 
	g’v_
->
C»©eDœ
(
dbÇme_
);

291 
as£¹
(
db_lock_
 =ğ
nuÎ±r
);

292 
Stus
 
	gs
 = 
’v_
->
LockFe
(
LockFeName
(
dbÇme_
), &
db_lock_
);

293 ià(!
	gs
.
ok
()) {

294  
	gs
;

297 ià(!
	g’v_
->
FeExi¡s
(
Cu¼’tFeName
(
dbÇme_
))) {

298 ià(
	gİtiÚs_
.
	gü—‹_if_missšg
) {

299 
	gs
 = 
NewDB
();

300 ià(!
	gs
.
ok
()) {

301  
	gs
;

304  
	gStus
::
Inv®idArgum’t
(

305 
dbÇme_
, "does‚otƒxist (create_if_missing is false)");

308 ià(
	gİtiÚs_
.
	g”rÜ_if_exi¡s
) {

309  
	gStus
::
Inv®idArgum’t
(
dbÇme_
,

314 
	gs
 = 
v”siÚs_
->
Recov”
(
§ve_mªiã¡
);

315 ià(!
	gs
.
ok
()) {

316  
	gs
;

318 
Sequ’ûNumb”
 
max_£qu’û
(0);

327 cÚ¡ 
ušt64_t
 
	gmš_log
 = 
v”siÚs_
->
LogNumb”
();

328 cÚ¡ 
ušt64_t
 
	g´ev_log
 = 
v”siÚs_
->
P»vLogNumb”
();

329 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
f’ames
;

330 
	gs
 = 
’v_
->
G‘Chd»n
(
dbÇme_
, &
f’ames
);

331 ià(!
	gs
.
ok
()) {

332  
	gs
;

334 
	g¡d
::
£t
<
ušt64_t
> 
ex³ùed
;

335 
	gv”siÚs_
->
AddLiveFes
(&
ex³ùed
);

336 
ušt64_t
 
	gnumb”
;

337 
FeTy³
 
	gty³
;

338 
	g¡d
::
veùÜ
<
ušt64_t
> 
logs
;

339 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

340 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
)) {

341 
	gex³ùed
.
”a£
(
numb”
);

342 ià(
	gty³
 =ğ
kLogFe
 && ((
numb”
 >ğ
mš_log
è|| (numb” =ğ
´ev_log
)))

343 
logs
.
push_back
(
numb”
);

346 ià(!
	gex³ùed
.
em±y
()) {

347 
	gbuf
[50];

348 
¢´štf
(
buf
, (buf), "%d missing files;ƒ.g.",

349 
¡©ic_ÿ¡
<>(
ex³ùed
.
size
()));

350  
	gStus
::
CÜru±iÚ
(
buf
, 
TabËFeName
(
dbÇme_
, *(
ex³ùed
.
begš
())));

354 
	g¡d
::
sÜt
(
logs
.
begš
(),†ogs.
’d
());

355 
size_t
 
	gi
 = 0; i < 
	glogs
.
size
(); i++) {

356 
	gs
 = 
Recov”LogFe
(
logs
[
i
], (˜=ğlogs.
size
(è- 1), 
§ve_mªiã¡
, 
ed™
,

357 &
max_£qu’û
);

358 ià(!
	gs
.
ok
()) {

359  
	gs
;

365 
	gv”siÚs_
->
M¬kFeNumb”U£d
(
logs
[
i
]);

368 ià(
	gv”siÚs_
->
La¡Sequ’û
(è< 
	gmax_£qu’û
) {

369 
	gv”siÚs_
->
S‘La¡Sequ’û
(
max_£qu’û
);

372  
	gStus
::
OK
();

375 
Stus
 
	gDBIm¶
::
Recov”LogFe
(
ušt64_t
 
log_numb”
, 
boŞ
 
Ï¡_log
,

376 
boŞ
* 
§ve_mªiã¡
, 
V”siÚEd™
* 
ed™
,

377 
Sequ’ûNumb”
* 
max_£qu’û
) {

378 
	gLogR•Ü‹r
 : 
public
 
log
::
R—d”
::
R•Ü‹r
 {

379 
Env
* 
’v
;

380 
Logg”
* 
	gšfo_log
;

381 cÚ¡ * 
	gâame
;

382 
Stus
* 
	g¡©us
;

383 
vœtu®
 
CÜru±iÚ
(
size_t
 
by‹s
, cÚ¡ 
Stus
& 
s
) {

384 
Log
(
šfo_log
, "%s%s: dropping %d bytes; %s",

385 (
this
->
¡©us
 =ğ
nuÎ±r
 ? "(ignÜšgƒ¼Üè" : ""), 
âame
,

386 
¡©ic_ÿ¡
<>(
by‹s
), 
s
.
ToSŒšg
().
c_¡r
());

387 ià(
	gthis
->
	g¡©us
 !ğ
nuÎ±r
 && 
this
->
¡©us
->
ok
()è*this->¡©u ğ
s
;

391 
	gmu‹x_
.
As£¹H–d
();

394 
	g¡d
::
¡ršg
 
âame
 = 
LogFeName
(
dbÇme_
, 
log_numb”
);

395 
Sequ’tŸlFe
* 
	gfe
;

396 
Stus
 
	g¡©us
 = 
’v_
->
NewSequ’tŸlFe
(
âame
, &
fe
);

397 ià(!
	g¡©us
.
ok
()) {

398 
MaybeIgnÜeE¼Ü
(&
¡©us
);

399  
	g¡©us
;

403 
LogR•Ü‹r
 
	g»pÜ‹r
;

404 
	g»pÜ‹r
.
	g’v
 = 
’v_
;

405 
	g»pÜ‹r
.
	gšfo_log
 = 
İtiÚs_
.
šfo_log
;

406 
	g»pÜ‹r
.
	gâame
 = 
âame
.
c_¡r
();

407 
	g»pÜ‹r
.
	g¡©us
 = (
İtiÚs_
.
·¿noid_checks
 ? &
¡©us
 : 
nuÎ±r
);

412 
	glog
::
R—d”
 
»ad”
(
fe
, &
»pÜ‹r
, 
Œue
 , 0 );

413 
Log
(
İtiÚs_
.
šfo_log
, "Recovering†og #%llu",

414 ()
log_numb”
);

417 
	g¡d
::
¡ršg
 
sü©ch
;

418 
Sliû
 
	g»cÜd
;

419 
Wr™eB©ch
 
	gb©ch
;

420 
	gcom·ùiÚs
 = 0;

421 
MemTabË
* 
	gmem
 = 
nuÎ±r
;

422 
	g»ad”
.
R—dRecÜd
(&
»cÜd
, &
sü©ch
è&& 
	g¡©us
.
ok
()) {

423 ià(
	g»cÜd
.
size
() < 12) {

424 
	g»pÜ‹r
.
CÜru±iÚ
(
»cÜd
.
size
(),

425 
Stus
::
CÜru±iÚ
("log„ecordoo small"));

428 
	gWr™eB©chIÁ”Çl
::
S‘CÚ‹Ás
(&
b©ch
, 
»cÜd
);

430 ià(
	gmem
 =ğ
nuÎ±r
) {

431 
mem
 = 
Ãw
 
MemTabË
(
š‹º®_com·¿tÜ_
);

432 
	gmem
->
Ref
();

434 
	g¡©us
 = 
Wr™eB©chIÁ”Çl
::
In£¹IÁo
(&
b©ch
, 
mem
);

435 
MaybeIgnÜeE¼Ü
(&
¡©us
);

436 ià(!
	g¡©us
.
ok
()) {

439 cÚ¡ 
Sequ’ûNumb”
 
	gÏ¡_£q
 = 
Wr™eB©chIÁ”Çl
::
Sequ’û
(&
b©ch
) +

440 
Wr™eB©chIÁ”Çl
::
CouÁ
(&
b©ch
) - 1;

441 ià(
	gÏ¡_£q
 > *
	gmax_£qu’û
) {

442 *
	gmax_£qu’û
 = 
Ï¡_£q
;

445 ià(
	gmem
->
Aµroxim©eMemÜyU§ge
(è> 
	gİtiÚs_
.
	gwr™e_bufãr_size
) {

446 
	gcom·ùiÚs
++;

447 *
	g§ve_mªiã¡
 = 
Œue
;

448 
	g¡©us
 = 
Wr™eLev–0TabË
(
mem
, 
ed™
, 
nuÎ±r
);

449 
	gmem
->
UÄef
();

450 
	gmem
 = 
nuÎ±r
;

451 ià(!
	g¡©us
.
ok
()) {

459 
d–‘e
 
	gfe
;

462 ià(
	g¡©us
.
ok
(è&& 
	gİtiÚs_
.
	g»u£_logs
 && 
	gÏ¡_log
 && 
	gcom·ùiÚs
 == 0) {

463 
as£¹
(
logfe_
 =ğ
nuÎ±r
);

464 
as£¹
(
log_
 =ğ
nuÎ±r
);

465 
as£¹
(
mem_
 =ğ
nuÎ±r
);

466 
ušt64_t
 
	glfe_size
;

467 ià(
	g’v_
->
G‘FeSize
(
âame
, &
lfe_size
).
ok
() &&

468 
	g’v_
->
NewAµ’dabËFe
(
âame
, &
logfe_
).
ok
()) {

469 
Log
(
İtiÚs_
.
šfo_log
, "Reusšg old†og % \n", 
âame
.
c_¡r
());

470 
	glog_
 = 
Ãw
 
log
::
Wr™”
(
logfe_
, 
lfe_size
);

471 
	glogfe_numb”_
 = 
log_numb”
;

472 ià(
	gmem
 !ğ
nuÎ±r
) {

473 
mem_
 = 
mem
;

474 
	gmem
 = 
nuÎ±r
;

477 
	gmem_
 = 
Ãw
 
MemTabË
(
š‹º®_com·¿tÜ_
);

478 
	gmem_
->
Ref
();

483 ià(
	gmem
 !ğ
nuÎ±r
) {

485 ià(
¡©us
.
ok
()) {

486 *
§ve_mªiã¡
 = 
Œue
;

487 
	g¡©us
 = 
Wr™eLev–0TabË
(
mem
, 
ed™
, 
nuÎ±r
);

489 
	gmem
->
UÄef
();

492  
	g¡©us
;

495 
Stus
 
	gDBIm¶
::
Wr™eLev–0TabË
(
MemTabË
* 
mem
, 
V”siÚEd™
* 
ed™
,

496 
V”siÚ
* 
ba£
) {

497 
	gmu‹x_
.
As£¹H–d
();

498 cÚ¡ 
ušt64_t
 
	g¡¬t_miüos
 = 
’v_
->
NowMiüos
();

499 
FeM‘aD©a
 
	gm‘a
;

500 
	gm‘a
.
	gnumb”
 = 
v”siÚs_
->
NewFeNumb”
();

501 
	g³ndšg_ouuts_
.
š£¹
(
m‘a
.
numb”
);

502 
I‹¿tÜ
* 
	g™”
 = 
mem
->
NewI‹¿tÜ
();

503 
Log
(
İtiÚs_
.
šfo_log
, "Level-0able #%llu: started",

504 ()
m‘a
.
numb”
);

506 
Stus
 
	gs
;

508 
	gmu‹x_
.
UÆock
();

509 
	gs
 = 
BudTabË
(
dbÇme_
, 
’v_
, 
İtiÚs_
, 
bË_ÿche_
, 
™”
, &
m‘a
, &
fh
);

510 
	gmu‹x_
.
Lock
();

513 
Log
(
İtiÚs_
.
šfo_log
, "Level-0able #%llu: %lld bytes %s",

514 ()
m‘a
.
numb”
, ()m‘a.
fe_size
,

515 
s
.
ToSŒšg
().
c_¡r
());

516 
d–‘e
 
	g™”
;

517 
	g³ndšg_ouuts_
.
”a£
(
m‘a
.
numb”
);

521 
	gËv–
 = 0;

522 ià(
	gs
.
ok
(è&& 
	gm‘a
.
	gfe_size
 > 0) {

523 cÚ¡ 
Sliû
 
	gmš_u£r_key
 = 
m‘a
.
sm®Ë¡
.
u£r_key
();

524 cÚ¡ 
Sliû
 
	gmax_u£r_key
 = 
m‘a
.
Ïrge¡
.
u£r_key
();

525 ià(
	gba£
 !ğ
nuÎ±r
) {

526 
Ëv–
 = 
ba£
->
PickLev–FÜMemTabËOuut
(
mš_u£r_key
, 
max_u£r_key
);

528 
	ged™
->
AddFe
(
Ëv–
, 
m‘a
.
numb”
, m‘a.
fe_size
, m‘a.
sm®Ë¡
,

529 
m‘a
.
Ïrge¡
,m‘a.
fs
);

532 
Com·ùiÚSts
 
	g¡©s
;

533 
	g¡©s
.
	gmiüos
 = 
’v_
->
NowMiüos
(è- 
¡¬t_miüos
;

534 
	g¡©s
.
	gby‹s_wr™‹n
 = 
m‘a
.
fe_size
;

535 
	g¡©s_
[
Ëv–
].
Add
(
¡©s
);

536  
	gs
;

539 
	gDBIm¶
::
Com·ùMemTabË
() {

540 
mu‹x_
.
As£¹H–d
();

541 
as£¹
(
imm_
 !ğ
nuÎ±r
);

544 
V”siÚEd™
 
	ged™
;

545 
V”siÚ
* 
	gba£
 = 
v”siÚs_
->
cu¼’t
();

546 
	gba£
->
Ref
();

547 
Stus
 
	gs
 = 
Wr™eLev–0TabË
(
imm_
, &
ed™
, 
ba£
);

548 
	gba£
->
UÄef
();

550 ià(
	gs
.
ok
(è&& 
	gshu‰šg_down_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

551 
s
 = 
Stus
::
IOE¼Ü
("Deleting DB during memtable compaction");

555 ià(
	gs
.
ok
()) {

556 
	ged™
.
S‘P»vLogNumb”
(0);

557 
	ged™
.
S‘LogNumb”
(
logfe_numb”_
);

558 
	gs
 = 
v”siÚs_
->
LogAndAµly
(&
ed™
, &
mu‹x_
);

561 ià(
	gs
.
ok
()) {

563 
	gimm_
->
UÄef
();

564 
	gimm_
 = 
nuÎ±r
;

565 
	ghas_imm_
.
¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

566 
D–‘eObsŞ‘eFes
();

568 
RecÜdBackgroundE¼Ü
(
s
);

572 
	gDBIm¶
::
Com·ùRªge
(cÚ¡ 
Sliû
* 
begš
, cÚ¡ Sliû* 
’d
) {

573 
	gmax_Ëv–_w™h_fes
 = 1;

575 
Mu‹xLock
 
l
(&
mu‹x_
);

576 
V”siÚ
* 
	gba£
 = 
v”siÚs_
->
cu¼’t
();

577 
	gËv–
 = 1;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

578 ià(
	gba£
->
Ov”ÏpInLev–
(
Ëv–
, 
begš
, 
’d
)) {

579 
	gmax_Ëv–_w™h_fes
 = 
Ëv–
;

583 
TEST_Com·ùMemTabË
();

584 
	gËv–
 = 0;†ev– < 
	gmax_Ëv–_w™h_fes
;†evel++) {

585 
TEST_Com·ùRªge
(
Ëv–
, 
begš
, 
’d
);

589 
	gDBIm¶
::
TEST_Com·ùRªge
(
Ëv–
, cÚ¡ 
Sliû
* 
begš
,

590 cÚ¡ 
Sliû
* 
’d
) {

591 
as£¹
(
Ëv–
 >= 0);

592 
as£¹
(
Ëv–
 + 1 < 
cÚfig
::
kNumLev–s
);

594 
IÁ”ÇlKey
 
	gbegš_¡Üage
, 
	g’d_¡Üage
;

596 
Mªu®Com·ùiÚ
 
	gmªu®
;

597 
	gmªu®
.
	gËv–
 = 
Ëv–
;

598 
	gmªu®
.
	gdÚe
 = 
çl£
;

599 ià(
	gbegš
 =ğ
nuÎ±r
) {

600 
mªu®
.
begš
 = 
nuÎ±r
;

602 
	gbegš_¡Üage
 = 
IÁ”ÇlKey
(*
begš
, 
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
);

603 
	gmªu®
.
	gbegš
 = &
begš_¡Üage
;

605 ià(
	g’d
 =ğ
nuÎ±r
) {

606 
mªu®
.
’d
 = 
nuÎ±r
;

608 
	g’d_¡Üage
 = 
IÁ”ÇlKey
(*
’d
, 0, 
¡©ic_ÿ¡
<
V®ueTy³
>(0));

609 
	gmªu®
.
	g’d
 = &
’d_¡Üage
;

612 
Mu‹xLock
 
l
(&
mu‹x_
);

613 !
	gmªu®
.
	gdÚe
 && !
	gshu‰šg_down_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
) &&

614 
bg_”rÜ_
.
ok
()) {

615 ià(
mªu®_com·ùiÚ_
 =ğ
nuÎ±r
) {

616 
mªu®_com·ùiÚ_
 = &
mªu®
;

617 
MaybeScheduËCom·ùiÚ
();

619 
	gbackground_wÜk_fšished_sigÇl_
.
Wa™
();

622 ià(
	gmªu®_com·ùiÚ_
 =ğ&
mªu®
) {

624 
mªu®_com·ùiÚ_
 = 
nuÎ±r
;

628 
Stus
 
	gDBIm¶
::
TEST_Com·ùMemTabË
() {

630 
Stus
 
s
 = 
Wr™e
(
Wr™eO±iÚs
(), 
nuÎ±r
);

631 ià(
	gs
.
ok
()) {

633 
Mu‹xLock
 
l
(&
mu‹x_
);

634 
	gimm_
 !ğ
nuÎ±r
 && 
bg_”rÜ_
.
ok
()) {

635 
background_wÜk_fšished_sigÇl_
.
Wa™
();

637 ià(
	gimm_
 !ğ
nuÎ±r
) {

638 
s
 = 
bg_”rÜ_
;

641  
	gs
;

644 
	gDBIm¶
::
RecÜdBackgroundE¼Ü
(cÚ¡ 
Stus
& 
s
) {

645 
mu‹x_
.
As£¹H–d
();

646 ià(
	gbg_”rÜ_
.
ok
()) {

647 
	gbg_”rÜ_
 = 
s
;

648 
	gbackground_wÜk_fšished_sigÇl_
.
SigÇlAÎ
();

652 
	gDBIm¶
::
MaybeScheduËCom·ùiÚ
() {

653 
mu‹x_
.
As£¹H–d
();

654 ià(
	gbackground_com·ùiÚ_scheduËd_
) {

656 } ià(
	gshu‰šg_down_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

658 } ià(!
bg_”rÜ_
.
ok
()) {

660 } ià(
imm_
 =ğ
nuÎ±r
 && 
mªu®_com·ùiÚ_
 ==‚ullptr &&

661 !
v”siÚs_
->
N“dsCom·ùiÚ
()) {

664 
background_com·ùiÚ_scheduËd_
 = 
Œue
;

665 
	g’v_
->
ScheduË
(&
DBIm¶
::
BGWÜk
, 
this
);

669 
	gDBIm¶
::
BGWÜk
(* 
db
) {

670 
»š‹½»t_ÿ¡
<
DBIm¶
*>(
db
)->
BackgroundC®l
();

673 
	gDBIm¶
::
BackgroundC®l
() {

674 
Mu‹xLock
 
l
(&
mu‹x_
);

675 
as£¹
(
background_com·ùiÚ_scheduËd_
);

676 ià(
	gshu‰šg_down_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

678 } ià(!
bg_”rÜ_
.
ok
()) {

681 
BackgroundCom·ùiÚ
();

684 
	gbackground_com·ùiÚ_scheduËd_
 = 
çl£
;

688 
MaybeScheduËCom·ùiÚ
();

689 
	gbackground_wÜk_fšished_sigÇl_
.
SigÇlAÎ
();

692 
	gDBIm¶
::
BackgroundCom·ùiÚ
() {

693 
mu‹x_
.
As£¹H–d
();

695 ià(
	gimm_
 !ğ
nuÎ±r
) {

696 
Com·ùMemTabË
();

700 
Com·ùiÚ
* 
	gc
;

701 
boŞ
 
	gis_mªu®
 = (
mªu®_com·ùiÚ_
 !ğ
nuÎ±r
);

702 
IÁ”ÇlKey
 
	gmªu®_’d
;

703 ià(
	gis_mªu®
) {

704 
Mªu®Com·ùiÚ
* 
	gm
 = 
mªu®_com·ùiÚ_
;

705 
	gc
 = 
v”siÚs_
->
Com·ùRªge
(
m
->
Ëv–
, m->
begš
, m->
’d
);

706 
	gm
->
	gdÚe
 = (
c
 =ğ
nuÎ±r
);

707 ià(
	gc
 !ğ
nuÎ±r
) {

708 
mªu®_’d
 = 
c
->
šput
(0, c->
num_šput_fes
(0è- 1)->
	gÏrge¡
;

710 
Log
(
İtiÚs_
.
šfo_log
,

712 
m
->
Ëv–
, (m->
begš
 ? m->begš->
DebugSŒšg
().
c_¡r
() : "(begin)"),

713 (
m
->
’d
 ? m->’d->
DebugSŒšg
().
c_¡r
() : "(end)"),

714 (
m
->
dÚe
 ? "Ónd)" : 
mªu®_’d
.
DebugSŒšg
().
c_¡r
()));

716 
	gc
 = 
v”siÚs_
->
PickCom·ùiÚ
();

719 
Stus
 
	g¡©us
;

720 ià(
	gc
 =ğ
nuÎ±r
) {

722 } ià(!
is_mªu®
 && 
c
->
IsTrivŸlMove
()) {

724 
as£¹
(
c
->
num_šput_fes
(0) == 1);

725 
FeM‘aD©a
* 
	gf
 = 
c
->
šput
(0, 0);

726 
	gc
->
ed™
()->
D–‘eFe
(
c
->
Ëv–
(), 
f
->
numb”
);

727 
	gc
->
ed™
()->
AddFe
(
c
->
Ëv–
(è+ 1, 
f
->
numb”
, f->
fe_size
, f->
sm®Ë¡
,

728 
f
->
Ïrge¡
,f->
fs
);

729 
	g¡©us
 = 
v”siÚs_
->
LogAndAµly
(
c
->
ed™
(), &
mu‹x_
);

730 ià(!
	g¡©us
.
ok
()) {

731 
RecÜdBackgroundE¼Ü
(
¡©us
);

733 
	gV”siÚS‘
::
Lev–Summ¬yStÜage
 
tmp
;

734 
Log
(
İtiÚs_
.
šfo_log
, "Moved #%lldo†evel-%d %lld bytes %s: %s\n",

735 
¡©ic_ÿ¡
<>(
f
->
numb”
), 
c
->
Ëv–
() + 1,

736 
¡©ic_ÿ¡
<>(
f
->
fe_size
),

737 
¡©us
.
ToSŒšg
().
c_¡r
(), 
v”siÚs_
->
Lev–Summ¬y
(&
tmp
));

739 
Com·ùiÚS‹
* 
	gcom·ù
 = 
Ãw
 Com·ùiÚS‹(
c
);

740 
	g¡©us
 = 
DoCom·ùiÚWÜk
(
com·ù
);

741 ià(!
	g¡©us
.
ok
()) {

742 
RecÜdBackgroundE¼Ü
(
¡©us
);

744 
CËªupCom·ùiÚ
(
com·ù
);

745 
	gc
->
R–—£IÅuts
();

746 
D–‘eObsŞ‘eFes
();

748 
d–‘e
 
	gc
;

750 ià(
	g¡©us
.
ok
()) {

752 } ià(
	gshu‰šg_down_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

755 
Log
(
İtiÚs_
.
šfo_log
, "Com·ùiÚƒ¼Ü: %s", 
¡©us
.
ToSŒšg
().
c_¡r
());

758 ià(
	gis_mªu®
) {

759 
Mªu®Com·ùiÚ
* 
	gm
 = 
mªu®_com·ùiÚ_
;

760 ià(!
	g¡©us
.
ok
()) {

761 
	gm
->
	gdÚe
 = 
Œue
;

763 ià(!
	gm
->
	gdÚe
) {

766 
	gm
->
	gtmp_¡Üage
 = 
mªu®_’d
;

767 
	gm
->
	gbegš
 = &
m
->
tmp_¡Üage
;

769 
	gmªu®_com·ùiÚ_
 = 
nuÎ±r
;

773 
	gDBIm¶
::
CËªupCom·ùiÚ
(
Com·ùiÚS‹
* 
com·ù
) {

774 
mu‹x_
.
As£¹H–d
();

775 ià(
	gcom·ù
->
	gbud”
 !ğ
nuÎ±r
) {

777 
com·ù
->
bud”
->
AbªdÚ
();

778 
d–‘e
 
	gcom·ù
->
	gbud”
;

780 
as£¹
(
com·ù
->
outfe
 =ğ
nuÎ±r
);

782 
d–‘e
 
	gcom·ù
->
	goutfe
;

783 
size_t
 
	gi
 = 0; i < 
	gcom·ù
->
	gouuts
.
size
(); i++) {

784 cÚ¡ 
	gCom·ùiÚS‹
::
Ouut
& 
out
 = 
com·ù
->
ouuts
[
i
];

785 
	g³ndšg_ouuts_
.
”a£
(
out
.
numb”
);

787 
d–‘e
 
	gcom·ù
;

790 
Stus
 
	gDBIm¶
::
O³nCom·ùiÚOuutFe
(
Com·ùiÚS‹
* 
com·ù
) {

791 
as£¹
(
com·ù
 !ğ
nuÎ±r
);

792 
as£¹
(
com·ù
->
bud”
 =ğ
nuÎ±r
);

793 
ušt64_t
 
	gfe_numb”
;

795 
	gmu‹x_
.
Lock
();

796 
	gfe_numb”
 = 
v”siÚs_
->
NewFeNumb”
();

797 
	g³ndšg_ouuts_
.
š£¹
(
fe_numb”
);

798 
	gCom·ùiÚS‹
::
Ouut
 
out
;

799 
	gout
.
	gnumb”
 = 
fe_numb”
;

800 
	gout
.
	gsm®Ë¡
.
CË¬
();

801 
	gout
.
	gÏrge¡
.
CË¬
();

802 
	gcom·ù
->
	gouuts
.
push_back
(
out
);

803 
	gmu‹x_
.
UÆock
();

807 
	g¡d
::
¡ršg
 
âame
 = 
TabËFeName
(
dbÇme_
, 
fe_numb”
);

808 
Stus
 
	gs
 = 
’v_
->
NewWr™abËFe
(
âame
, &
com·ù
->
outfe
);

809 ià(
	gs
.
ok
()) {

810 
	gcom·ù
->
	gbud”
 = 
Ãw
 
TabËBud”
(
İtiÚs_
, 
com·ù
->
outfe
);

812  
	gs
;

815 
Stus
 
	gDBIm¶
::
FšishCom·ùiÚOuutFe
(
Com·ùiÚS‹
* 
com·ù
,

816 
I‹¿tÜ
* 
šput
) {

817 
as£¹
(
com·ù
 !ğ
nuÎ±r
);

818 
as£¹
(
com·ù
->
outfe
 !ğ
nuÎ±r
);

819 
as£¹
(
com·ù
->
bud”
 !ğ
nuÎ±r
);

821 cÚ¡ 
ušt64_t
 
	gouut_numb”
 = 
com·ù
->
cu¼’t_ouut
()->
numb”
;

822 
as£¹
(
ouut_numb”
 != 0);

825 
Stus
 
	gs
 = 
šput
->
¡©us
();

826 cÚ¡ 
ušt64_t
 
	gcu¼’t_’Œ›s
 = 
com·ù
->
bud”
->
NumEÁr›s
();

827 ià(
	gs
.
ok
()) {

828 
	gs
 = 
com·ù
->
bud”
->
Fšish
();

830 
	gcom·ù
->
	gbud”
->
AbªdÚ
();

832 cÚ¡ 
ušt64_t
 
	gcu¼’t_by‹s
 = 
com·ù
->
bud”
->
FeSize
();

833 
	gcom·ù
->
cu¼’t_ouut
()->
	gfe_size
 = 
cu¼’t_by‹s
;

834 
	gcom·ù
->
	gtÙ®_by‹s
 +ğ
cu¼’t_by‹s
;

835 
d–‘e
 
	gcom·ù
->
	gbud”
;

836 
	gcom·ù
->
	gbud”
 = 
nuÎ±r
;

839 ià(
	gs
.
ok
()) {

840 
	gs
 = 
com·ù
->
outfe
->
Sync
();

842 ià(
	gs
.
ok
()) {

843 
	gs
 = 
com·ù
->
outfe
->
Clo£
();

845 
d–‘e
 
	gcom·ù
->
	goutfe
;

846 
	gcom·ù
->
	goutfe
 = 
nuÎ±r
;

848 ià(
	gs
.
ok
(è&& 
	gcu¼’t_’Œ›s
 > 0) {

850 
I‹¿tÜ
* 
	g™”
 =

851 
bË_ÿche_
->
NewI‹¿tÜ
(
R—dO±iÚs
(), 
ouut_numb”
, 
cu¼’t_by‹s
);

852 
	gs
 = 
™”
->
¡©us
();

853 
d–‘e
 
	g™”
;

854 ià(
	gs
.
ok
()) {

855 
Log
(
İtiÚs_
.
šfo_log
, "Generatedable #%llu@%d: %lld keys, %lld bytes",

856 ()
ouut_numb”
, 
com·ù
->
com·ùiÚ
->
Ëv–
(),

857 ()
cu¼’t_’Œ›s
,

858 ()
cu¼’t_by‹s
);

861  
	gs
;

864 
Stus
 
	gDBIm¶
::
In¡®lCom·ùiÚResuÉs
(
Com·ùiÚS‹
* 
com·ù
) {

865 
mu‹x_
.
As£¹H–d
();

866 
Log
(
İtiÚs_
.
šfo_log
, "Compacted %d@%d + %d@%d files => %lld bytes",

867 
com·ù
->
com·ùiÚ
->
num_šput_fes
(0), com·ù->com·ùiÚ->
Ëv–
(),

868 
com·ù
->
com·ùiÚ
->
num_šput_fes
(1), com·ù->com·ùiÚ->
Ëv–
() + 1,

869 
¡©ic_ÿ¡
<>(
com·ù
->
tÙ®_by‹s
));

872 
	gcom·ù
->
	gcom·ùiÚ
->
AddIÅutD–‘iÚs
(
com·ù
->
com·ùiÚ
->
ed™
());

873 cÚ¡ 
	gËv–
 = 
com·ù
->
com·ùiÚ
->
Ëv–
();

874 
size_t
 
	gi
 = 0; i < 
	gcom·ù
->
	gouuts
.
size
(); i++) {

875 cÚ¡ 
	gCom·ùiÚS‹
::
Ouut
& 
out
 = 
com·ù
->
ouuts
[
i
];

876 
	gcom·ù
->
	gcom·ùiÚ
->
ed™
()->
AddFe
(
Ëv–
 + 1, 
out
.
numb”
, out.
fe_size
,

877 
out
.
sm®Ë¡
, out.
Ïrge¡
,out.
fs
);

879  
	gv”siÚs_
->
LogAndAµly
(
com·ù
->
com·ùiÚ
->
ed™
(), &
mu‹x_
);

882 
Stus
 
	gDBIm¶
::
DoCom·ùiÚWÜk
(
Com·ùiÚS‹
* 
com·ù
) {

883 cÚ¡ 
ušt64_t
 
¡¬t_miüos
 = 
’v_
->
NowMiüos
();

884 
št64_t
 
	gimm_miüos
 = 0;

886 
Log
(
İtiÚs_
.
šfo_log
, "Compacting %d@%d + %d@%d files",

887 
com·ù
->
com·ùiÚ
->
num_šput_fes
(0), com·ù->com·ùiÚ->
Ëv–
(),

888 
com·ù
->
com·ùiÚ
->
num_šput_fes
(1),

889 
com·ù
->
com·ùiÚ
->
Ëv–
() + 1);

891 
as£¹
(
v”siÚs_
->
NumLev–Fes
(
com·ù
->
com·ùiÚ
->
Ëv–
()) > 0);

892 
as£¹
(
com·ù
->
bud”
 =ğ
nuÎ±r
);

893 
as£¹
(
com·ù
->
outfe
 =ğ
nuÎ±r
);

894 ià(
	g¢­shÙs_
.
em±y
()) {

895 
	gcom·ù
->
	gsm®Ë¡_¢­shÙ
 = 
v”siÚs_
->
La¡Sequ’û
();

897 
	gcom·ù
->
	gsm®Ë¡_¢­shÙ
 = 
¢­shÙs_
.
Şde¡
()->
£qu’û_numb”
();

901 
	gmu‹x_
.
UÆock
();

903 
I‹¿tÜ
* 
	gšput
 = 
v”siÚs_
->
MakeIÅutI‹¿tÜ
(
com·ù
->
com·ùiÚ
);

904 
	gšput
->
S“kToFœ¡
();

905 
Stus
 
	g¡©us
;

906 
P¬£dIÁ”ÇlKey
 
	gikey
;

907 
	g¡d
::
¡ršg
 
cu¼’t_u£r_key
;

908 
boŞ
 
	ghas_cu¼’t_u£r_key
 = 
çl£
;

909 
Sequ’ûNumb”
 
	gÏ¡_£qu’û_fÜ_key
 = 
kMaxSequ’ûNumb”
;

910 ; 
	gšput
->
V®id
(è&& !
	gshu‰šg_down_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
);) {

912 ià(
	ghas_imm_
.
lßd
(
¡d
::
memÜy_Üd”_»Ïxed
)) {

913 cÚ¡ 
ušt64_t
 
imm_¡¬t
 = 
’v_
->
NowMiüos
();

914 
	gmu‹x_
.
Lock
();

915 ià(
	gimm_
 !ğ
nuÎ±r
) {

916 
Com·ùMemTabË
();

918 
	gbackground_wÜk_fšished_sigÇl_
.
SigÇlAÎ
();

920 
	gmu‹x_
.
UÆock
();

921 
	gimm_miüos
 +ğ(
’v_
->
NowMiüos
(è- 
imm_¡¬t
);

924 
Sliû
 
	gkey
 = 
šput
->
key
();

925 ià(
	gcom·ù
->
	gcom·ùiÚ
->
ShouldStİBefÜe
(
key
) &&

926 
	gcom·ù
->
	gbud”
 !ğ
nuÎ±r
) {

927 
¡©us
 = 
FšishCom·ùiÚOuutFe
(
com·ù
, 
šput
);

928 ià(!
	g¡©us
.
ok
()) {

934 
boŞ
 
	gdrİ
 = 
çl£
;

935 ià(!
P¬£IÁ”ÇlKey
(
key
, &
ikey
)) {

937 
	gcu¼’t_u£r_key
.
ş—r
();

938 
	ghas_cu¼’t_u£r_key
 = 
çl£
;

939 
	gÏ¡_£qu’û_fÜ_key
 = 
kMaxSequ’ûNumb”
;

941 ià(!
	ghas_cu¼’t_u£r_key
 ||

942 
u£r_com·¿tÜ
()->
Com·»
(
ikey
.
u£r_key
, 
Sliû
(
cu¼’t_u£r_key
)) !=

945 
cu¼’t_u£r_key
.
assign
(
ikey
.
u£r_key
.
d©a
(), ikey.u£r_key.
size
());

946 
	ghas_cu¼’t_u£r_key
 = 
Œue
;

947 
	gÏ¡_£qu’û_fÜ_key
 = 
kMaxSequ’ûNumb”
;

950 ià(
	gÏ¡_£qu’û_fÜ_key
 <ğ
com·ù
->
sm®Ë¡_¢­shÙ
) {

952 
drİ
 = 
Œue
;

953 } ià(
	gikey
.
	gty³
 =ğ
kTy³D–‘iÚ
 &&

954 
ikey
.
£qu’û
 <ğ
com·ù
->
sm®Ë¡_¢­shÙ
 &&

955 
com·ù
->
com·ùiÚ
->
IsBa£Lev–FÜKey
(
ikey
.
u£r_key
)) {

963 
drİ
 = 
Œue
;

966 
	gÏ¡_£qu’û_fÜ_key
 = 
ikey
.
£qu’û
;

969 
Log
(
İtiÚs_
.
šfo_log
,

972 
ikey
.
u£r_key
.
ToSŒšg
().
c_¡r
(),

973 ()
ikey
.
£qu’û
, ikey.
ty³
, 
kTy³V®ue
, 
drİ
,

974 
com·ù
->
com·ùiÚ
->
IsBa£Lev–FÜKey
(
ikey
.
u£r_key
),

975 ()
Ï¡_£qu’û_fÜ_key
, ()
com·ù
->
sm®Ë¡_¢­shÙ
);

978 ià(!
	gdrİ
) {

980 ià(
	gcom·ù
->
	gbud”
 =ğ
nuÎ±r
) {

981 
¡©us
 = 
O³nCom·ùiÚOuutFe
(
com·ù
);

982 ià(!
	g¡©us
.
ok
()) {

986 ià(
	gcom·ù
->
	gbud”
->
NumEÁr›s
() == 0) {

987 
com·ù
->
cu¼’t_ouut
()->
sm®Ë¡
.
DecodeFrom
(
key
);

989 
	gcom·ù
->
cu¼’t_ouut
()->
	gÏrge¡
.
DecodeFrom
(
key
);

990 
	gcom·ù
->
	gbud”
->
Add
(
key
, 
šput
->
v®ue
());

993 ià(
	gcom·ù
->
	gbud”
->
FeSize
() >=

994 
com·ù
->
com·ùiÚ
->
MaxOuutFeSize
()) {

995 
¡©us
 = 
FšishCom·ùiÚOuutFe
(
com·ù
, 
šput
);

996 ià(!
	g¡©us
.
ok
()) {

1002 
	gšput
->
Next
();

1005 ià(
	g¡©us
.
ok
(è&& 
	gshu‰šg_down_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

1006 
¡©us
 = 
Stus
::
IOE¼Ü
("Deleting DB during compaction");

1008 ià(
	g¡©us
.
ok
(è&& 
	gcom·ù
->
	gbud”
 !ğ
nuÎ±r
) {

1009 
¡©us
 = 
FšishCom·ùiÚOuutFe
(
com·ù
, 
šput
);

1011 ià(
	g¡©us
.
ok
()) {

1012 
	g¡©us
 = 
šput
->
¡©us
();

1014 
d–‘e
 
	gšput
;

1015 
	gšput
 = 
nuÎ±r
;

1017 
Com·ùiÚSts
 
	g¡©s
;

1018 
	g¡©s
.
	gmiüos
 = 
’v_
->
NowMiüos
(è- 
¡¬t_miüos
 - 
imm_miüos
;

1019 
	gwhich
 = 0; which < 2; which++) {

1020 
	gi
 = 0; i < 
	gcom·ù
->
	gcom·ùiÚ
->
num_šput_fes
(
which
); i++) {

1021 
	g¡©s
.
	gby‹s_»ad
 +ğ
com·ù
->
com·ùiÚ
->
šput
(
which
, 
i
)->
	gfe_size
;

1024 
size_t
 
	gi
 = 0; i < 
	gcom·ù
->
	gouuts
.
size
(); i++) {

1025 
	g¡©s
.
	gby‹s_wr™‹n
 +ğ
com·ù
->
ouuts
[
i
].
fe_size
;

1028 
	gmu‹x_
.
Lock
();

1029 
	g¡©s_
[
com·ù
->
com·ùiÚ
->
Ëv–
(è+ 1].
Add
(
¡©s
);

1031 ià(
	g¡©us
.
ok
()) {

1032 
	g¡©us
 = 
In¡®lCom·ùiÚResuÉs
(
com·ù
);

1034 ià(!
	g¡©us
.
ok
()) {

1035 
RecÜdBackgroundE¼Ü
(
¡©us
);

1037 
	gV”siÚS‘
::
Lev–Summ¬yStÜage
 
tmp
;

1038 
Log
(
İtiÚs_
.
šfo_log
, "com·ùedo: %s", 
v”siÚs_
->
Lev–Summ¬y
(&
tmp
));

1039  
	g¡©us
;

1042 
	gÇme¥aû
 {

1044 
	sI‹rS‹
 {

1045 
	gpÜt
::
Mu‹x
* cÚ¡ 
mu
;

1046 
V”siÚ
* cÚ¡ 
v”siÚ
 
GUARDED_BY
(
mu
);

1047 
MemTabË
* cÚ¡ 
mem
 
GUARDED_BY
(
mu
);

1048 
MemTabË
* cÚ¡ 
imm
 
GUARDED_BY
(
mu
);

1050 
I‹rS‹
(
pÜt
::
Mu‹x
* 
mu‹x
, 
MemTabË
* 
mem
, MemTabË* 
imm
, 
V”siÚ
* 
v”siÚ
)

1051 : 
mu
(
mu‹x
), 
v”siÚ
(v”siÚ), 
mem
(mem), 
imm
(imm) {}

1054 
CËªupI‹¿tÜS‹
(* 
¬g1
, * 
¬g2
) {

1055 
I‹rS‹
* 
	g¡©e
 = 
»š‹½»t_ÿ¡
<I‹rS‹*>(
¬g1
);

1056 
	g¡©e
->
	gmu
->
Lock
();

1057 
	g¡©e
->
	gmem
->
UÄef
();

1058 ià(
	g¡©e
->
	gimm
 !ğ
nuÎ±r
è
¡©e
->
imm
->
UÄef
();

1059 
	g¡©e
->
	gv”siÚ
->
UÄef
();

1060 
	g¡©e
->
	gmu
->
UÆock
();

1061 
d–‘e
 
	g¡©e
;

1066 
I‹¿tÜ
* 
	gDBIm¶
::
NewIÁ”ÇlI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

1067 
Sequ’ûNumb”
* 
Ï‹¡_¢­shÙ
,

1068 
ušt32_t
* 
£ed
) {

1069 
	gmu‹x_
.
Lock
();

1070 *
	gÏ‹¡_¢­shÙ
 = 
v”siÚs_
->
La¡Sequ’û
();

1073 
	g¡d
::
veùÜ
<
I‹¿tÜ
*> 
li¡
;

1074 
	gli¡
.
push_back
(
mem_
->
NewI‹¿tÜ
());

1075 
	gmem_
->
Ref
();

1076 ià(
	gimm_
 !ğ
nuÎ±r
) {

1077 
li¡
.
push_back
(
imm_
->
NewI‹¿tÜ
());

1078 
	gimm_
->
Ref
();

1080 
	gv”siÚs_
->
cu¼’t
()->
AddI‹¿tÜs
(
İtiÚs
, &
li¡
);

1081 
I‹¿tÜ
* 
	gš‹º®_™”
 =

1082 
NewM”gšgI‹¿tÜ
(&
š‹º®_com·¿tÜ_
, &
li¡
[0],†i¡.
size
());

1083 
	gv”siÚs_
->
cu¼’t
()->
Ref
();

1085 
I‹rS‹
* 
	gş—nup
 = 
Ãw
 I‹rS‹(&
mu‹x_
, 
mem_
, 
imm_
, 
v”siÚs_
->
cu¼’t
());

1086 
	gš‹º®_™”
->
Regi¡”CËªup
(
CËªupI‹¿tÜS‹
, 
ş—nup
, 
nuÎ±r
);

1088 *
	g£ed
 = ++
£ed_
;

1089 
	gmu‹x_
.
UÆock
();

1090  
	gš‹º®_™”
;

1093 
I‹¿tÜ
* 
	gDBIm¶
::
TEST_NewIÁ”ÇlI‹¿tÜ
() {

1094 
Sequ’ûNumb”
 
ignÜed
;

1095 
ušt32_t
 
	gignÜed_£ed
;

1096  
NewIÁ”ÇlI‹¿tÜ
(
R—dO±iÚs
(), &
ignÜed
, &
ignÜed_£ed
);

1099 
št64_t
 
	gDBIm¶
::
TEST_MaxNextLev–Ov”ÏµšgBy‹s
() {

1100 
Mu‹xLock
 
l
(&
mu‹x_
);

1101  
	gv”siÚs_
->
MaxNextLev–Ov”ÏµšgBy‹s
();

1104 
Stus
 
	gDBIm¶
::
G‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
key
,

1105 
¡d
::
¡ršg
* 
v®ue
) {

1106 
Stus
 
s
;

1107 
Mu‹xLock
 
l
(&
mu‹x_
);

1108 
Sequ’ûNumb”
 
	g¢­shÙ
;

1109 ià(
	gİtiÚs
.
	g¢­shÙ
 !ğ
nuÎ±r
) {

1110 
¢­shÙ
 =

1111 
¡©ic_ÿ¡
<cÚ¡ 
SÇpshÙIm¶
*>(
İtiÚs
.
¢­shÙ
)->
£qu’û_numb”
();

1113 
	g¢­shÙ
 = 
v”siÚs_
->
La¡Sequ’û
();

1116 
MemTabË
* 
	gmem
 = 
mem_
;

1117 
MemTabË
* 
	gimm
 = 
imm_
;

1118 
V”siÚ
* 
	gcu¼’t
 = 
v”siÚs_
->
cu¼’t
();

1119 
	gmem
->
Ref
();

1120 ià(
	gimm
 !ğ
nuÎ±r
è
imm
->
Ref
();

1121 
	gcu¼’t
->
Ref
();

1123 
boŞ
 
	ghave_¡©_upd©e
 = 
çl£
;

1124 
	gV”siÚ
::
G‘Sts
 
¡©s
;

1126 
	gfh
.
add
(
key
);

1130 
	gmu‹x_
.
UÆock
();

1132 
LookupKey
 
lkey
(
key
, 
¢­shÙ
);

1133 ià(
	gmem
->
G‘
(
lkey
, 
v®ue
, &
s
)) {

1135 } ià(
	gimm
 !ğ
nuÎ±r
 && 
imm
->
G‘
(
lkey
, 
v®ue
, &
s
)) {

1138 
	gs
 = 
cu¼’t
->
G‘
(
İtiÚs
, 
lkey
, 
v®ue
, &
¡©s
);

1139 
	ghave_¡©_upd©e
 = 
Œue
;

1141 
	gmu‹x_
.
Lock
();

1144 ià(
	ghave_¡©_upd©e
 && 
	gcu¼’t
->
Upd©eSts
(
¡©s
)) {

1145 
MaybeScheduËCom·ùiÚ
();

1147 
	gmem
->
UÄef
();

1148 ià(
	gimm
 !ğ
nuÎ±r
è
imm
->
UÄef
();

1149 
	gcu¼’t
->
UÄef
();

1150  
	gs
;

1153 
I‹¿tÜ
* 
	gDBIm¶
::
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
) {

1154 
Sequ’ûNumb”
 
Ï‹¡_¢­shÙ
;

1155 
ušt32_t
 
	g£ed
;

1156 
I‹¿tÜ
* 
	g™”
 = 
NewIÁ”ÇlI‹¿tÜ
(
İtiÚs
, &
Ï‹¡_¢­shÙ
, &
£ed
);

1157  
NewDBI‹¿tÜ
(
this
, 
u£r_com·¿tÜ
(), 
™”
,

1158 (
İtiÚs
.
¢­shÙ
 !ğ
nuÎ±r


1159 ? 
¡©ic_ÿ¡
<cÚ¡ 
SÇpshÙIm¶
*>(
İtiÚs
.
¢­shÙ
)

1160 ->
£qu’û_numb”
()

1161 : 
Ï‹¡_¢­shÙ
),

1162 
£ed
);

1165 
	gDBIm¶
::
RecÜdR—dSam¶e
(
Sliû
 
key
) {

1166 
Mu‹xLock
 
l
(&
mu‹x_
);

1167 ià(
	gv”siÚs_
->
cu¼’t
()->
RecÜdR—dSam¶e
(
key
)) {

1168 
MaybeScheduËCom·ùiÚ
();

1172 cÚ¡ 
SÇpshÙ
* 
	gDBIm¶
::
G‘SÇpshÙ
() {

1173 
Mu‹xLock
 
l
(&
mu‹x_
);

1174  
	g¢­shÙs_
.
New
(
v”siÚs_
->
La¡Sequ’û
());

1177 
	gDBIm¶
::
R–—£SÇpshÙ
(cÚ¡ 
SÇpshÙ
* 
¢­shÙ
) {

1178 
Mu‹xLock
 
l
(&
mu‹x_
);

1179 
	g¢­shÙs_
.
D–‘e
(
¡©ic_ÿ¡
<cÚ¡ 
SÇpshÙIm¶
*>(
¢­shÙ
));

1183 
Stus
 
	gDBIm¶
::
Put
(cÚ¡ 
Wr™eO±iÚs
& 
o
, cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®
) {

1184  
	gDB
::
Put
(
o
, 
key
, 
v®
);

1187 
Stus
 
	gDBIm¶
::
D–‘e
(cÚ¡ 
Wr™eO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
key
) {

1188  
	gDB
::
D–‘e
(
İtiÚs
, 
key
);

1191 
Stus
 
	gDBIm¶
::
Wr™e
(cÚ¡ 
Wr™eO±iÚs
& 
İtiÚs
, 
Wr™eB©ch
* 
upd©es
) {

1192 
Wr™”
 
w
(&
mu‹x_
);

1193 
	gw
.
	gb©ch
 = 
upd©es
;

1194 
	gw
.
	gsync
 = 
İtiÚs
.
sync
;

1195 
	gw
.
	gdÚe
 = 
çl£
;

1197 
Mu‹xLock
 
l
(&
mu‹x_
);

1198 
	gfh
.
add
(
Wr™eB©chIÁ”Çl
::
CÚ‹Ás
(
upd©es
));

1199 
	gwr™”s_
.
push_back
(&
w
);

1200 !
	gw
.
	gdÚe
 && &w !ğ
wr™”s_
.
äÚt
()) {

1201 
w
.
cv
.
Wa™
();

1203 ià(
	gw
.
	gdÚe
) {

1204  
	gw
.
	g¡©us
;

1208 
Stus
 
	g¡©us
 = 
MakeRoomFÜWr™e
(
upd©es
 =ğ
nuÎ±r
);

1209 
ušt64_t
 
	gÏ¡_£qu’û
 = 
v”siÚs_
->
La¡Sequ’û
();

1210 
Wr™”
* 
	gÏ¡_wr™”
 = &
w
;

1211 ià(
	g¡©us
.
ok
(è&& 
	gupd©es
 !ğ
nuÎ±r
) {

1212 
Wr™eB©ch
* 
upd©es
 = 
BudB©chGroup
(&
Ï¡_wr™”
);

1213 
	gWr™eB©chIÁ”Çl
::
S‘Sequ’û
(
upd©es
, 
Ï¡_£qu’û
 + 1);

1214 
	gÏ¡_£qu’û
 +ğ
Wr™eB©chIÁ”Çl
::
CouÁ
(
upd©es
);

1221 
	gmu‹x_
.
UÆock
();

1222 
	g¡©us
 = 
log_
->
AddRecÜd
(
Wr™eB©chIÁ”Çl
::
CÚ‹Ás
(
upd©es
));

1223 
boŞ
 
	gsync_”rÜ
 = 
çl£
;

1224 ià(
	g¡©us
.
ok
(è&& 
	gİtiÚs
.
	gsync
) {

1225 
	g¡©us
 = 
logfe_
->
Sync
();

1226 ià(!
	g¡©us
.
ok
()) {

1227 
	gsync_”rÜ
 = 
Œue
;

1230 ià(
	g¡©us
.
ok
()) {

1231 
	g¡©us
 = 
Wr™eB©chIÁ”Çl
::
In£¹IÁo
(
upd©es
, 
mem_
);

1233 
	gmu‹x_
.
Lock
();

1234 ià(
	gsync_”rÜ
) {

1238 
RecÜdBackgroundE¼Ü
(
¡©us
);

1241 ià(
	gupd©es
 =ğ
tmp_b©ch_
ètmp_b©ch_->
CË¬
();

1243 
	gv”siÚs_
->
S‘La¡Sequ’û
(
Ï¡_£qu’û
);

1246 
	gŒue
) {

1247 
Wr™”
* 
	g»ady
 = 
wr™”s_
.
äÚt
();

1248 
	gwr™”s_
.
pİ_äÚt
();

1249 ià(
	g»ady
 !ğ&
w
) {

1250 
»ady
->
¡©us
 = status;

1251 
	g»ady
->
	gdÚe
 = 
Œue
;

1252 
	g»ady
->
	gcv
.
SigÇl
();

1254 ià(
	g»ady
 =ğ
Ï¡_wr™”
) ;

1258 ià(!
	gwr™”s_
.
em±y
()) {

1259 
	gwr™”s_
.
äÚt
()->
	gcv
.
SigÇl
();

1262  
	g¡©us
;

1267 
Wr™eB©ch
* 
	gDBIm¶
::
BudB©chGroup
(
Wr™”
** 
Ï¡_wr™”
) {

1268 
mu‹x_
.
As£¹H–d
();

1269 
as£¹
(!
wr™”s_
.
em±y
());

1270 
Wr™”
* 
	gfœ¡
 = 
wr™”s_
.
äÚt
();

1271 
Wr™eB©ch
* 
	g»suÉ
 = 
fœ¡
->
b©ch
;

1272 
as£¹
(
»suÉ
 !ğ
nuÎ±r
);

1274 
size_t
 
	gsize
 = 
Wr™eB©chIÁ”Çl
::
By‹Size
(
fœ¡
->
b©ch
);

1279 
size_t
 
	gmax_size
 = 1 << 20;

1280 ià(
	gsize
 <= (128 << 10)) {

1281 
max_size
 = 
size
 + (128 << 10);

1284 *
	gÏ¡_wr™”
 = 
fœ¡
;

1285 
	g¡d
::
deque
<
Wr™”
*>::
™”©Ü
 
™”
 = 
wr™”s_
.
begš
();

1286 ++
	g™”
;

1287 ; 
	g™”
 !ğ
wr™”s_
.
’d
(); ++iter) {

1288 
Wr™”
* 
	gw
 = *
™”
;

1289 ià(
	gw
->
	gsync
 && !
	gfœ¡
->sync) {

1294 ià(
	gw
->
	gb©ch
 !ğ
nuÎ±r
) {

1295 
size
 +ğ
Wr™eB©chIÁ”Çl
::
By‹Size
(
w
->
b©ch
);

1296 ià(
	gsize
 > 
	gmax_size
) {

1302 ià(
	g»suÉ
 =ğ
fœ¡
->
b©ch
) {

1304 
»suÉ
 = 
tmp_b©ch_
;

1305 
as£¹
(
Wr™eB©chIÁ”Çl
::
CouÁ
(
»suÉ
) == 0);

1306 
	gWr™eB©chIÁ”Çl
::
Aµ’d
(
»suÉ
, 
fœ¡
->
b©ch
);

1308 
	gWr™eB©chIÁ”Çl
::
Aµ’d
(
»suÉ
, 
w
->
b©ch
);

1310 *
	gÏ¡_wr™”
 = 
w
;

1312  
	g»suÉ
;

1317 
Stus
 
	gDBIm¶
::
MakeRoomFÜWr™e
(
boŞ
 
fÜû
) {

1318 
mu‹x_
.
As£¹H–d
();

1319 
as£¹
(!
wr™”s_
.
em±y
());

1320 
boŞ
 
	g®low_d–ay
 = !
fÜû
;

1321 
Stus
 
	gs
;

1322 
	gŒue
) {

1323 ià(!
	gbg_”rÜ_
.
ok
()) {

1325 
	gs
 = 
bg_”rÜ_
;

1327 } ià(
	g®low_d–ay
 && 
	gv”siÚs_
->
NumLev–Fes
(0) >=

1328 
cÚfig
::
kL0_SlowdownWr™esTrigg”
) {

1335 
mu‹x_
.
UÆock
();

1336 
	g’v_
->
SË•FÜMiüo£cÚds
(1000);

1337 
	g®low_d–ay
 = 
çl£
;

1338 
	gmu‹x_
.
Lock
();

1339 } ià(!
	gfÜû
 &&

1340 (
	gmem_
->
Aµroxim©eMemÜyU§ge
(è<ğ
İtiÚs_
.
wr™e_bufãr_size
)) {

1343 } ià(
	gimm_
 !ğ
nuÎ±r
) {

1346 
Log
(
İtiÚs_
.
šfo_log
, "Current memtable full; waiting...\n");

1347 
	gbackground_wÜk_fšished_sigÇl_
.
Wa™
();

1348 } ià(
	gv”siÚs_
->
NumLev–Fes
(0è>ğ
cÚfig
::
kL0_StİWr™esTrigg”
) {

1350 
Log
(
İtiÚs_
.
šfo_log
, "Too many L0 files; waiting...\n");

1351 
	gbackground_wÜk_fšished_sigÇl_
.
Wa™
();

1354 
as£¹
(
v”siÚs_
->
P»vLogNumb”
() == 0);

1355 
ušt64_t
 
	gÃw_log_numb”
 = 
v”siÚs_
->
NewFeNumb”
();

1356 
Wr™abËFe
* 
	glfe
 = 
nuÎ±r
;

1357 
	gs
 = 
’v_
->
NewWr™abËFe
(
LogFeName
(
dbÇme_
, 
Ãw_log_numb”
), &
lfe
);

1358 ià(!
	gs
.
ok
()) {

1360 
	gv”siÚs_
->
Reu£FeNumb”
(
Ãw_log_numb”
);

1363 
d–‘e
 
	glog_
;

1364 
d–‘e
 
	glogfe_
;

1365 
	glogfe_
 = 
lfe
;

1366 
	glogfe_numb”_
 = 
Ãw_log_numb”
;

1367 
	glog_
 = 
Ãw
 
log
::
Wr™”
(
lfe
);

1368 
	gimm_
 = 
mem_
;

1369 
	ghas_imm_
.
¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1370 
	gmem_
 = 
Ãw
 
MemTabË
(
š‹º®_com·¿tÜ_
);

1371 
	gmem_
->
Ref
();

1372 
	gfÜû
 = 
çl£
;

1373 
MaybeScheduËCom·ùiÚ
();

1376  
	gs
;

1379 
boŞ
 
	gDBIm¶
::
G‘Prİ”ty
(cÚ¡ 
Sliû
& 
´İ”ty
, 
¡d
::
¡ršg
* 
v®ue
) {

1380 
v®ue
->
ş—r
();

1382 
Mu‹xLock
 
l
(&
mu‹x_
);

1383 
Sliû
 
	gš
 = 
´İ”ty
;

1384 
Sliû
 
´efix
("leveldb.");

1385 ià(!
	gš
.
¡¬ts_w™h
(
´efix
)è 
	gçl£
;

1386 
	gš
.
»move_´efix
(
´efix
.
size
());

1388 ià(
	gš
.
¡¬ts_w™h
("num-files-at-level")) {

1389 
	gš
.
»move_´efix
(
¡¾’
("num-files-at-level"));

1390 
ušt64_t
 
	gËv–
;

1391 
boŞ
 
	gok
 = 
CÚsumeDecim®Numb”
(&
š
, &
Ëv–
è&& 
	gš
.
em±y
();

1392 ià(!
	gok
 || 
	gËv–
 >ğ
cÚfig
::
kNumLev–s
) {

1393  
çl£
;

1395 
	gbuf
[100];

1396 
¢´štf
(
buf
, (buf), "%d",

1397 
v”siÚs_
->
NumLev–Fes
(
¡©ic_ÿ¡
<>(
Ëv–
)));

1398 *
	gv®ue
 = 
buf
;

1399  
	gŒue
;

1401 } ià(
	gš
 == "stats") {

1402 
buf
[200];

1403 
¢´štf
(
buf
, (buf),

1407 
	gv®ue
->
­³nd
(
buf
);

1408 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

1409 
	gfes
 = 
v”siÚs_
->
NumLev–Fes
(
Ëv–
);

1410 ià(
	g¡©s_
[
Ëv–
].
	gmiüos
 > 0 || 
	gfes
 > 0) {

1411 
¢´štf
(
buf
, (buf), "%3d %8d %8.0à%9.0à%8.0à%9.0f\n", 
Ëv–
,

1412 
fes
, 
v”siÚs_
->
NumLev–By‹s
(
Ëv–
) / 1048576.0,

1413 
¡©s_
[
Ëv–
].
miüos
 / 1e6,

1414 
¡©s_
[
Ëv–
].
by‹s_»ad
 / 1048576.0,

1415 
¡©s_
[
Ëv–
].
by‹s_wr™‹n
 / 1048576.0);

1416 
	gv®ue
->
­³nd
(
buf
);

1419  
	gŒue
;

1420 } ià(
	gš
 == "sstables") {

1421 *
v®ue
 = 
v”siÚs_
->
cu¼’t
()->
DebugSŒšg
();

1422  
	gŒue
;

1423 } ià(
	gš
 == "approximate-memory-usage") {

1424 
size_t
 
tÙ®_u§ge
 = 
İtiÚs_
.
block_ÿche
->
TÙ®Ch¬ge
();

1425 ià(
	gmem_
) {

1426 
	gtÙ®_u§ge
 +ğ
mem_
->
Aµroxim©eMemÜyU§ge
();

1428 ià(
	gimm_
) {

1429 
	gtÙ®_u§ge
 +ğ
imm_
->
Aµroxim©eMemÜyU§ge
();

1431 
	gbuf
[50];

1432 
¢´štf
(
buf
, (buf), "%llu",

1433 
¡©ic_ÿ¡
<>(
tÙ®_u§ge
));

1434 
	gv®ue
->
­³nd
(
buf
);

1435  
	gŒue
;

1438  
	gçl£
;

1441 
	gDBIm¶
::
G‘Aµroxim©eSizes
(cÚ¡ 
Rªge
* 
¿nge
, 
n
, 
ušt64_t
* 
sizes
) {

1443 
V”siÚ
* 
	gv
;

1445 
Mu‹xLock
 
l
(&
mu‹x_
);

1446 
	gv”siÚs_
->
cu¼’t
()->
Ref
();

1447 
	gv
 = 
v”siÚs_
->
cu¼’t
();

1450 
	gi
 = 0; i < 
	gn
; i++) {

1452 
IÁ”ÇlKey
 
k1
(
¿nge
[
i
].
¡¬t
, 
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
);

1453 
IÁ”ÇlKey
 
k2
(
¿nge
[
i
].
lim™
, 
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
);

1454 
ušt64_t
 
	g¡¬t
 = 
v”siÚs_
->
Aµroxim©eOff£tOf
(
v
, 
k1
);

1455 
ušt64_t
 
	glim™
 = 
v”siÚs_
->
Aµroxim©eOff£tOf
(
v
, 
k2
);

1456 
	gsizes
[
i
] = (
lim™
 >ğ
¡¬t
 ?†imit - start : 0);

1460 
Mu‹xLock
 
l
(&
mu‹x_
);

1461 
	gv
->
UÄef
();

1467 
Stus
 
	gDB
::
Put
(cÚ¡ 
Wr™eO±iÚs
& 
İt
, cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

1468 
Wr™eB©ch
 
	gb©ch
;

1469 
	gb©ch
.
Put
(
key
, 
v®ue
);

1470  
Wr™e
(
İt
, &
b©ch
);

1473 
Stus
 
	gDB
::
D–‘e
(cÚ¡ 
Wr™eO±iÚs
& 
İt
, cÚ¡ 
Sliû
& 
key
) {

1474 
Wr™eB©ch
 
	gb©ch
;

1475 
	gb©ch
.
D–‘e
(
key
);

1476  
Wr™e
(
İt
, &
b©ch
);

1479 
	gDB
::~
DB
() {}

1481 
Stus
 
DB
::
O³n
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, DB** 
db±r
) {

1482 *
	gdb±r
 = 
nuÎ±r
;

1484 
DBIm¶
* 
	gim¶
 = 
Ãw
 DBIm¶(
İtiÚs
, 
dbÇme
);

1485 
	gim¶
->
	gmu‹x_
.
Lock
();

1486 
V”siÚEd™
 
	ged™
;

1488 
boŞ
 
	g§ve_mªiã¡
 = 
çl£
;

1489 
Stus
 
	gs
 = 
im¶
->
Recov”
(&
ed™
, &
§ve_mªiã¡
);

1490 ià(
	gs
.
ok
(è&& 
	gim¶
->
	gmem_
 =ğ
nuÎ±r
) {

1492 
ušt64_t
 
Ãw_log_numb”
 = 
im¶
->
v”siÚs_
->
NewFeNumb”
();

1493 
Wr™abËFe
* 
	glfe
;

1494 
	gs
 = 
İtiÚs
.
’v
->
NewWr™abËFe
(
LogFeName
(
dbÇme
, 
Ãw_log_numb”
),

1495 &
lfe
);

1496 ià(
	gs
.
ok
()) {

1497 
	ged™
.
S‘LogNumb”
(
Ãw_log_numb”
);

1498 
	gim¶
->
	glogfe_
 = 
lfe
;

1499 
	gim¶
->
	glogfe_numb”_
 = 
Ãw_log_numb”
;

1500 
	gim¶
->
	glog_
 = 
Ãw
 
log
::
Wr™”
(
lfe
);

1501 
	gim¶
->
	gmem_
 = 
Ãw
 
MemTabË
(
im¶
->
š‹º®_com·¿tÜ_
);

1502 
	gim¶
->
	gmem_
->
Ref
();

1505 ià(
	gs
.
ok
(è&& 
	g§ve_mªiã¡
) {

1506 
	ged™
.
S‘P»vLogNumb”
(0);

1507 
	ged™
.
S‘LogNumb”
(
im¶
->
logfe_numb”_
);

1508 
	gs
 = 
im¶
->
v”siÚs_
->
LogAndAµly
(&
ed™
, &im¶->
mu‹x_
);

1510 ià(
	gs
.
ok
()) {

1511 
	gim¶
->
D–‘eObsŞ‘eFes
();

1512 
	gim¶
->
MaybeScheduËCom·ùiÚ
();

1514 
	gim¶
->
	gmu‹x_
.
UÆock
();

1515 ià(
	gs
.
ok
()) {

1516 
as£¹
(
im¶
->
mem_
 !ğ
nuÎ±r
);

1517 *
	gdb±r
 = 
im¶
;

1519 
d–‘e
 
	gim¶
;

1521  
	gs
;

1524 
	gSÇpshÙ
::~
SÇpshÙ
() {}

1526 
Stus
 
De¡royDB
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, cÚ¡ 
O±iÚs
& 
İtiÚs
) {

1527 
Env
* 
	g’v
 = 
İtiÚs
.
’v
;

1528 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
f’ames
;

1529 
Stus
 
	g»suÉ
 = 
’v
->
G‘Chd»n
(
dbÇme
, &
f’ames
);

1530 ià(!
	g»suÉ
.
ok
()) {

1532  
	gStus
::
OK
();

1535 
FeLock
* 
	glock
;

1536 cÚ¡ 
	g¡d
::
¡ršg
 
lockÇme
 = 
LockFeName
(
dbÇme
);

1537 
	g»suÉ
 = 
’v
->
LockFe
(
lockÇme
, &
lock
);

1538 ià(
	g»suÉ
.
ok
()) {

1539 
ušt64_t
 
	gnumb”
;

1540 
FeTy³
 
	gty³
;

1541 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

1542 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
) &&

1543 
	gty³
 !ğ
kDBLockFe
) {

1544 
Stus
 
d–
 = 
’v
->
D–‘eFe
(
dbÇme
 + "/" + 
f’ames
[
i
]);

1545 ià(
	g»suÉ
.
ok
(è&& !
	gd–
.ok()) {

1546 
	g»suÉ
 = 
d–
;

1550 
	g’v
->
UÆockFe
(
lock
);

1551 
	g’v
->
D–‘eFe
(
lockÇme
);

1552 
	g’v
->
D–‘eDœ
(
dbÇme
);

1554  
	g»suÉ
;

	@db/db_impl.h

5 #iâdeà
STORAGE_LEVELDB_DB_DB_IMPL_H_


6 
	#STORAGE_LEVELDB_DB_DB_IMPL_H_


	)

8 
	~<©omic
>

9 
	~<deque
>

10 
	~<£t
>

11 
	~<¡ršg
>

13 
	~"db/dbfÜm©.h
"

14 
	~"db/log_wr™”.h
"

15 
	~"db/¢­shÙ.h
"

16 
	~"Ëv–db/db.h
"

17 
	~"Ëv–db/’v.h
"

18 
	~"pÜt/pÜt.h
"

19 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

21 
	~"db/fh.h
"

23 
Çme¥aû
 
	gËv–db
 {

25 
şass
 
	gMemTabË
;

26 
şass
 
	gTabËCache
;

27 
şass
 
	gV”siÚ
;

28 
şass
 
	gV”siÚEd™
;

29 
şass
 
	gV”siÚS‘
;

31 
şass
 
	gFH
;

33 şas 
	cDBIm¶
 : 
public
 
DB
 {

34 
public
:

35 
DBIm¶
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
);

37 
DBIm¶
(cÚ¡ DBIm¶&èğ
d–‘e
;

38 
	gDBIm¶
& 
	gİ”©Ü
=(cÚ¡ 
DBIm¶
&èğ
d–‘e
;

40 
	gvœtu®
 ~
DBIm¶
();

43 
vœtu®
 
Stus
 
Put
(cÚ¡ 
Wr™eO±iÚs
&, cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
);

44 
vœtu®
 
Stus
 
D–‘e
(cÚ¡ 
Wr™eO±iÚs
&, cÚ¡ 
Sliû
& 
key
);

45 
vœtu®
 
Stus
 
Wr™e
(cÚ¡ 
Wr™eO±iÚs
& 
İtiÚs
, 
Wr™eB©ch
* 
upd©es
);

46 
vœtu®
 
Stus
 
G‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
key
,

47 
¡d
::
¡ršg
* 
v®ue
);

48 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
&);

49 
vœtu®
 cÚ¡ 
SÇpshÙ
* 
G‘SÇpshÙ
();

50 
vœtu®
 
R–—£SÇpshÙ
(cÚ¡ 
SÇpshÙ
* 
¢­shÙ
);

51 
vœtu®
 
boŞ
 
G‘Prİ”ty
(cÚ¡ 
Sliû
& 
´İ”ty
, 
¡d
::
¡ršg
* 
v®ue
);

52 
vœtu®
 
G‘Aµroxim©eSizes
(cÚ¡ 
Rªge
* 
¿nge
, 
n
, 
ušt64_t
* 
sizes
);

53 
vœtu®
 
Com·ùRªge
(cÚ¡ 
Sliû
* 
begš
, cÚ¡ Sliû* 
’d
);

58 
TEST_Com·ùRªge
(
Ëv–
, cÚ¡ 
Sliû
* 
begš
, cÚ¡ Sliû* 
’d
);

61 
Stus
 
TEST_Com·ùMemTabË
();

66 
I‹¿tÜ
* 
TEST_NewIÁ”ÇlI‹¿tÜ
();

70 
št64_t
 
TEST_MaxNextLev–Ov”ÏµšgBy‹s
();

75 
RecÜdR—dSam¶e
(
Sliû
 
key
);

77 
	g´iv©e
:

78 
ä›nd
 
şass
 
DB
;

79 
	gCom·ùiÚS‹
;

80 
	gWr™”
;

83 
	sMªu®Com·ùiÚ
 {

84 
	gËv–
;

85 
boŞ
 
	gdÚe
;

86 cÚ¡ 
IÁ”ÇlKey
* 
	gbegš
;

87 cÚ¡ 
IÁ”ÇlKey
* 
	g’d
;

88 
IÁ”ÇlKey
 
	gtmp_¡Üage
;

93 
	sCom·ùiÚSts
 {

94 
Com·ùiÚSts
(è: 
miüos
(0), 
by‹s_»ad
(0), 
by‹s_wr™‹n
(0) {}

96 
Add
(cÚ¡ 
Com·ùiÚSts
& 
c
) {

97 
	gthis
->
	gmiüos
 +ğ
c
.
miüos
;

98 
	gthis
->
	gby‹s_»ad
 +ğ
c
.
by‹s_»ad
;

99 
	gthis
->
	gby‹s_wr™‹n
 +ğ
c
.
by‹s_wr™‹n
;

102 
št64_t
 
	gmiüos
;

103 
št64_t
 
	gby‹s_»ad
;

104 
št64_t
 
	gby‹s_wr™‹n
;

107 
I‹¿tÜ
* 
NewIÁ”ÇlI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
&,

108 
Sequ’ûNumb”
* 
Ï‹¡_¢­shÙ
,

109 
ušt32_t
* 
£ed
);

111 
Stus
 
NewDB
();

116 
Stus
 
Recov”
(
V”siÚEd™
* 
ed™
, 
boŞ
* 
§ve_mªiã¡
)

117 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

119 
MaybeIgnÜeE¼Ü
(
Stus
* 
s
) const;

122 
D–‘eObsŞ‘eFes
(è
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

127 
Com·ùMemTabË
(è
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

129 
Stus
 
Recov”LogFe
(
ušt64_t
 
log_numb”
, 
boŞ
 
Ï¡_log
, boŞ* 
§ve_mªiã¡
,

130 
V”siÚEd™
* 
ed™
, 
Sequ’ûNumb”
* 
max_£qu’û
)

131 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

133 
Stus
 
Wr™eLev–0TabË
(
MemTabË
* 
mem
, 
V”siÚEd™
* 
ed™
, 
V”siÚ
* 
ba£
)

134 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

136 
Stus
 
MakeRoomFÜWr™e
(
boŞ
 
fÜû
 )

137 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

138 
Wr™eB©ch
* 
BudB©chGroup
(
Wr™”
** 
Ï¡_wr™”
)

139 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

141 
RecÜdBackgroundE¼Ü
(cÚ¡ 
Stus
& 
s
);

143 
MaybeScheduËCom·ùiÚ
(è
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

144 
BGWÜk
(* 
db
);

145 
BackgroundC®l
();

146 
BackgroundCom·ùiÚ
(è
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

147 
CËªupCom·ùiÚ
(
Com·ùiÚS‹
* 
com·ù
)

148 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

149 
Stus
 
DoCom·ùiÚWÜk
(
Com·ùiÚS‹
* 
com·ù
)

150 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

152 
Stus
 
O³nCom·ùiÚOuutFe
(
Com·ùiÚS‹
* 
com·ù
);

153 
Stus
 
FšishCom·ùiÚOuutFe
(
Com·ùiÚS‹
* 
com·ù
, 
I‹¿tÜ
* 
šput
);

154 
Stus
 
In¡®lCom·ùiÚResuÉs
(
Com·ùiÚS‹
* 
com·ù
)

155 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

157 cÚ¡ 
Com·¿tÜ
* 
u£r_com·¿tÜ
() const {

158  
	gš‹º®_com·¿tÜ_
.
u£r_com·¿tÜ
();

162 
Env
* cÚ¡ 
	g’v_
;

163 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
 
	gš‹º®_com·¿tÜ_
;

164 cÚ¡ 
IÁ”ÇlF‹rPŞicy
 
	gš‹º®_f‹r_pŞicy_
;

165 cÚ¡ 
O±iÚs
 
	gİtiÚs_
;

166 cÚ¡ 
boŞ
 
	gowns_šfo_log_
;

167 cÚ¡ 
boŞ
 
	gowns_ÿche_
;

168 cÚ¡ 
	g¡d
::
¡ršg
 
dbÇme_
;

171 
FH
 
	gfh
;

174 
TabËCache
* cÚ¡ 
	gbË_ÿche_
;

177 
FeLock
* 
	gdb_lock_
;

180 
	gpÜt
::
Mu‹x
 
mu‹x_
;

181 
	g¡d
::
©omic
<
boŞ
> 
shu‰šg_down_
;

182 
	gpÜt
::
CÚdV¬
 
background_wÜk_fšished_sigÇl_
 
GUARDED_BY
(
mu‹x_
);

183 
MemTabË
* 
	gmem_
;

184 
MemTabË
* 
imm_
 
GUARDED_BY
(
mu‹x_
);

185 
	g¡d
::
©omic
<
boŞ
> 
has_imm_
;

186 
Wr™abËFe
* 
	glogfe_
;

187 
ušt64_t
 
logfe_numb”_
 
GUARDED_BY
(
mu‹x_
);

188 
	glog
::
Wr™”
* 
log_
;

189 
ušt32_t
 
£ed_
 
GUARDED_BY
(
mu‹x_
);

192 
	g¡d
::
deque
<
Wr™”
*> 
wr™”s_
 
GUARDED_BY
(
mu‹x_
);

193 
Wr™eB©ch
* 
tmp_b©ch_
 
GUARDED_BY
(
mu‹x_
);

195 
SÇpshÙLi¡
 
¢­shÙs_
 
GUARDED_BY
(
mu‹x_
);

199 
	g¡d
::
£t
<
ušt64_t
> 
³ndšg_ouuts_
 
GUARDED_BY
(
mu‹x_
);

202 
boŞ
 
background_com·ùiÚ_scheduËd_
 
GUARDED_BY
(
mu‹x_
);

204 
Mªu®Com·ùiÚ
* 
mªu®_com·ùiÚ_
 
GUARDED_BY
(
mu‹x_
);

206 
V”siÚS‘
* cÚ¡ 
	gv”siÚs_
;

209 
Stus
 
bg_”rÜ_
 
GUARDED_BY
(
mu‹x_
);

211 
Com·ùiÚSts
 
	g¡©s_
[
cÚfig
::
kNumLev–s
] 
GUARDED_BY
(
mu‹x_
);

216 
O±iÚs
 
Sª™izeO±iÚs
(cÚ¡ 
¡d
::
¡ršg
& 
db
,

217 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
* 
icmp
,

218 cÚ¡ 
IÁ”ÇlF‹rPŞicy
* 
Şicy
,

219 cÚ¡ 
O±iÚs
& 
¤c
);

	@db/db_iter.cc

5 
	~"db/db_™”.h
"

7 
	~"db/db_im¶.h
"

8 
	~"db/dbfÜm©.h
"

9 
	~"db/f’ame.h
"

10 
	~"Ëv–db/’v.h
"

11 
	~"Ëv–db/™”©Ü.h
"

12 
	~"pÜt/pÜt.h
"

13 
	~"ut/loggšg.h
"

14 
	~"ut/mu‹xlock.h
"

15 
	~"ut/¿ndom.h
"

17 
Çme¥aû
 
	gËv–db
 {

20 
DumpIÁ”ÇlI‹r
(
I‹¿tÜ
* 
™”
) {

21 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

22 
P¬£dIÁ”ÇlKey
 
	gk
;

23 ià(!
P¬£IÁ”ÇlKey
(
™”
->
key
(), &
k
)) {

24 
årštf
(
¡d”r
, "CÜru± '%s'\n", 
Esÿ³SŒšg
(
™”
->
key
()).
c_¡r
());

26 
årštf
(
¡d”r
, "@ '%s'\n", 
k
.
DebugSŒšg
().
c_¡r
());

32 
	gÇme¥aû
 {

39 şas 
	cDBI‹r
 : 
public
 
I‹¿tÜ
 {

40 
public
:

46 
	eDœeùiÚ
 { 
kFÜw¬d
, 
	gkRev”£
 };

48 
DBI‹r
(
DBIm¶
* 
db
, cÚ¡ 
Com·¿tÜ
* 
cmp
, 
I‹¿tÜ
* 
™”
, 
Sequ’ûNumb”
 
s
,

49 
ušt32_t
 
£ed
)

50 : 
db_
(
db
),

51 
u£r_com·¿tÜ_
(
cmp
),

52 
™”_
(
™”
),

53 
£qu’û_
(
s
),

54 
dœeùiÚ_
(
kFÜw¬d
),

55 
v®id_
(
çl£
),

56 
ºd_
(
£ed
),

57 
by‹s_uÁ_»ad_§m¶šg_
(
RªdomCom·ùiÚP”iod
()) {}

59 
DBI‹r
(cÚ¡ DBI‹r&èğ
d–‘e
;

60 
	gDBI‹r
& 
	gİ”©Ü
=(cÚ¡ 
DBI‹r
&èğ
d–‘e
;

62 
	gvœtu®
 ~
DBI‹r
(è{ 
d–‘e
 
	g™”_
; }

63 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  
	gv®id_
; }

64 
vœtu®
 
Sliû
 
key
() const {

65 
as£¹
(
v®id_
);

66  (
	gdœeùiÚ_
 =ğ
kFÜw¬d
è? 
ExŒaùU£rKey
(
™”_
->
key
()è: 
§ved_key_
;

68 
vœtu®
 
Sliû
 
v®ue
() const {

69 
as£¹
(
v®id_
);

70  (
	gdœeùiÚ_
 =ğ
kFÜw¬d
è? 
™”_
->
v®ue
(è: 
§ved_v®ue_
;

72 
vœtu®
 
Stus
 
¡©us
() const {

73 ià(
	g¡©us_
.
ok
()) {

74  
	g™”_
->
¡©us
();

76  
	g¡©us_
;

80 
vœtu®
 
Next
();

81 
vœtu®
 
P»v
();

82 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
rg‘
);

83 
vœtu®
 
S“kToFœ¡
();

84 
vœtu®
 
S“kToLa¡
();

86 
	g´iv©e
:

87 
FšdNextU£rEÁry
(
boŞ
 
skpšg
, 
¡d
::
¡ršg
* 
sk
);

88 
FšdP»vU£rEÁry
();

89 
boŞ
 
P¬£Key
(
P¬£dIÁ”ÇlKey
* 
key
);

91 
šlše
 
SaveKey
(cÚ¡ 
Sliû
& 
k
, 
¡d
::
¡ršg
* 
d¡
) {

92 
d¡
->
assign
(
k
.
d©a
(), k.
size
());

95 
šlše
 
CË¬SavedV®ue
() {

96 ià(
	g§ved_v®ue_
.
ÿ·c™y
() > 1048576) {

97 
	g¡d
::
¡ršg
 
em±y
;

98 
sw­
(
em±y
, 
§ved_v®ue_
);

100 
	g§ved_v®ue_
.
ş—r
();

105 
size_t
 
RªdomCom·ùiÚP”iod
() {

106  
	gºd_
.
UnifÜm
(2 * 
cÚfig
::
kR—dBy‹sP”iod
);

109 
DBIm¶
* 
	gdb_
;

110 cÚ¡ 
Com·¿tÜ
* cÚ¡ 
	gu£r_com·¿tÜ_
;

111 
I‹¿tÜ
* cÚ¡ 
	g™”_
;

112 
Sequ’ûNumb”
 cÚ¡ 
	g£qu’û_
;

113 
Stus
 
	g¡©us_
;

114 
	g¡d
::
¡ršg
 
§ved_key_
;

115 
	g¡d
::
¡ršg
 
§ved_v®ue_
;

116 
DœeùiÚ
 
	gdœeùiÚ_
;

117 
boŞ
 
	gv®id_
;

118 
Rªdom
 
	gºd_
;

119 
size_t
 
	gby‹s_uÁ_»ad_§m¶šg_
;

122 
šlše
 
boŞ
 
	gDBI‹r
::
P¬£Key
(
P¬£dIÁ”ÇlKey
* 
ikey
) {

123 
Sliû
 
k
 = 
™”_
->
key
();

125 
size_t
 
	gby‹s_»ad
 = 
k
.
size
(è+ 
™”_
->
v®ue
().size();

126 
	gby‹s_uÁ_»ad_§m¶šg_
 < 
	gby‹s_»ad
) {

127 
	gby‹s_uÁ_»ad_§m¶šg_
 +ğ
RªdomCom·ùiÚP”iod
();

128 
	gdb_
->
RecÜdR—dSam¶e
(
k
);

130 
as£¹
(
by‹s_uÁ_»ad_§m¶šg_
 >ğ
by‹s_»ad
);

131 
	gby‹s_uÁ_»ad_§m¶šg_
 -ğ
by‹s_»ad
;

133 ià(!
P¬£IÁ”ÇlKey
(
k
, 
ikey
)) {

134 
	g¡©us_
 = 
Stus
::
CÜru±iÚ
("corrupted internal key in DBIter");

135  
	gçl£
;

137  
	gŒue
;

141 
	gDBI‹r
::
Next
() {

142 
as£¹
(
v®id_
);

144 ià(
	gdœeùiÚ_
 =ğ
kRev”£
) {

145 
dœeùiÚ_
 = 
kFÜw¬d
;

149 ià(!
	g™”_
->
V®id
()) {

150 
	g™”_
->
S“kToFœ¡
();

152 
	g™”_
->
Next
();

154 ià(!
	g™”_
->
V®id
()) {

155 
	gv®id_
 = 
çl£
;

156 
	g§ved_key_
.
ş—r
();

162 
SaveKey
(
ExŒaùU£rKey
(
™”_
->
key
()), &
§ved_key_
);

165 
FšdNextU£rEÁry
(
Œue
, &
§ved_key_
);

168 
	gDBI‹r
::
FšdNextU£rEÁry
(
boŞ
 
skpšg
, 
¡d
::
¡ršg
* 
sk
) {

170 
as£¹
(
™”_
->
V®id
());

171 
as£¹
(
dœeùiÚ_
 =ğ
kFÜw¬d
);

173 
P¬£dIÁ”ÇlKey
 
	gikey
;

174 ià(
P¬£Key
(&
ikey
è&& 
	gikey
.
	g£qu’û
 <ğ
£qu’û_
) {

175 
ikey
.
ty³
) {

176 
kTy³D–‘iÚ
:

179 
SaveKey
(
ikey
.
u£r_key
, 
sk
);

180 
	gskpšg
 = 
Œue
;

182 
	gkTy³V®ue
:

183 ià(
skpšg
 &&

184 
u£r_com·¿tÜ_
->
Com·»
(
ikey
.
u£r_key
, *
sk
) <= 0) {

187 
v®id_
 = 
Œue
;

188 
	g§ved_key_
.
ş—r
();

194 
	g™”_
->
Next
();

195 } 
	g™”_
->
V®id
());

196 
	g§ved_key_
.
ş—r
();

197 
	gv®id_
 = 
çl£
;

200 
	gDBI‹r
::
P»v
() {

201 
as£¹
(
v®id_
);

203 ià(
	gdœeùiÚ_
 =ğ
kFÜw¬d
) {

206 
as£¹
(
™”_
->
V®id
());

207 
SaveKey
(
ExŒaùU£rKey
(
™”_
->
key
()), &
§ved_key_
);

208 
	gŒue
) {

209 
	g™”_
->
P»v
();

210 ià(!
	g™”_
->
V®id
()) {

211 
	gv®id_
 = 
çl£
;

212 
	g§ved_key_
.
ş—r
();

213 
CË¬SavedV®ue
();

216 ià(
	gu£r_com·¿tÜ_
->
Com·»
(
ExŒaùU£rKey
(
™”_
->
key
()), 
§ved_key_
) <

221 
	gdœeùiÚ_
 = 
kRev”£
;

224 
FšdP»vU£rEÁry
();

227 
	gDBI‹r
::
FšdP»vU£rEÁry
() {

228 
as£¹
(
dœeùiÚ_
 =ğ
kRev”£
);

230 
V®ueTy³
 
	gv®ue_ty³
 = 
kTy³D–‘iÚ
;

231 ià(
	g™”_
->
V®id
()) {

233 
P¬£dIÁ”ÇlKey
 
	gikey
;

234 ià(
P¬£Key
(&
ikey
è&& 
	gikey
.
	g£qu’û
 <ğ
£qu’û_
) {

235 ià((
v®ue_ty³
 !ğ
kTy³D–‘iÚ
) &&

236 
u£r_com·¿tÜ_
->
Com·»
(
ikey
.
u£r_key
, 
§ved_key_
) < 0) {

240 
	gv®ue_ty³
 = 
ikey
.
ty³
;

241 ià(
	gv®ue_ty³
 =ğ
kTy³D–‘iÚ
) {

242 
§ved_key_
.
ş—r
();

243 
CË¬SavedV®ue
();

245 
Sliû
 
	g¿w_v®ue
 = 
™”_
->
v®ue
();

246 ià(
	g§ved_v®ue_
.
ÿ·c™y
(è> 
	g¿w_v®ue
.
size
() + 1048576) {

247 
	g¡d
::
¡ršg
 
em±y
;

248 
sw­
(
em±y
, 
§ved_v®ue_
);

250 
SaveKey
(
ExŒaùU£rKey
(
™”_
->
key
()), &
§ved_key_
);

251 
	g§ved_v®ue_
.
assign
(
¿w_v®ue
.
d©a
(),„aw_v®ue.
size
());

254 
	g™”_
->
P»v
();

255 } 
	g™”_
->
V®id
());

258 ià(
	gv®ue_ty³
 =ğ
kTy³D–‘iÚ
) {

260 
v®id_
 = 
çl£
;

261 
	g§ved_key_
.
ş—r
();

262 
CË¬SavedV®ue
();

263 
	gdœeùiÚ_
 = 
kFÜw¬d
;

265 
	gv®id_
 = 
Œue
;

269 
	gDBI‹r
::
S“k
(cÚ¡ 
Sliû
& 
rg‘
) {

270 
dœeùiÚ_
 = 
kFÜw¬d
;

271 
CË¬SavedV®ue
();

272 
	g§ved_key_
.
ş—r
();

273 
Aµ’dIÁ”ÇlKey
(&
§ved_key_
,

274 
P¬£dIÁ”ÇlKey
(
rg‘
, 
£qu’û_
, 
kV®ueTy³FÜS“k
));

275 
	g™”_
->
S“k
(
§ved_key_
);

276 ià(
	g™”_
->
V®id
()) {

277 
FšdNextU£rEÁry
(
çl£
, &
§ved_key_
 );

279 
	gv®id_
 = 
çl£
;

283 
	gDBI‹r
::
S“kToFœ¡
() {

284 
dœeùiÚ_
 = 
kFÜw¬d
;

285 
CË¬SavedV®ue
();

286 
	g™”_
->
S“kToFœ¡
();

287 ià(
	g™”_
->
V®id
()) {

288 
FšdNextU£rEÁry
(
çl£
, &
§ved_key_
 );

290 
	gv®id_
 = 
çl£
;

294 
	gDBI‹r
::
S“kToLa¡
() {

295 
dœeùiÚ_
 = 
kRev”£
;

296 
CË¬SavedV®ue
();

297 
	g™”_
->
S“kToLa¡
();

298 
FšdP»vU£rEÁry
();

303 
I‹¿tÜ
* 
	$NewDBI‹¿tÜ
(
DBIm¶
* 
db
, cÚ¡ 
Com·¿tÜ
* 
u£r_key_com·¿tÜ
,

304 
I‹¿tÜ
* 
š‹º®_™”
, 
Sequ’ûNumb”
 
£qu’û
,

305 
ušt32_t
 
£ed
) {

306  
Ãw
 
	`DBI‹r
(
db
, 
u£r_key_com·¿tÜ
, 
š‹º®_™”
, 
£qu’û
, 
£ed
);

307 
	}
}

	@db/db_iter.h

5 #iâdeà
STORAGE_LEVELDB_DB_DB_ITER_H_


6 
	#STORAGE_LEVELDB_DB_DB_ITER_H_


	)

8 
	~<¡dšt.h
>

10 
	~"db/dbfÜm©.h
"

11 
	~"Ëv–db/db.h
"

13 
Çme¥aû
 
	gËv–db
 {

15 
şass
 
	gDBIm¶
;

20 
I‹¿tÜ
* 
NewDBI‹¿tÜ
(
DBIm¶
* 
db
, cÚ¡ 
Com·¿tÜ
* 
u£r_key_com·¿tÜ
,

21 
I‹¿tÜ
* 
š‹º®_™”
, 
Sequ’ûNumb”
 
£qu’û
,

22 
ušt32_t
 
£ed
);

	@db/db_test.cc

5 
	~"Ëv–db/db.h
"

7 
	~<©omic
>

8 
	~<¡ršg
>

10 
	~"db/db_im¶.h
"

11 
	~"db/f’ame.h
"

12 
	~"db/v”siÚ_£t.h
"

13 
	~"db/wr™e_b©ch_š‹º®.h
"

14 
	~"Ëv–db/ÿche.h
"

15 
	~"Ëv–db/’v.h
"

16 
	~"Ëv–db/f‹r_pŞicy.h
"

17 
	~"Ëv–db/bË.h
"

18 
	~"pÜt/pÜt.h
"

19 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

20 
	~"ut/hash.h
"

21 
	~"ut/loggšg.h
"

22 
	~"ut/mu‹xlock.h
"

23 
	~"ut/‹¡h¬Ãss.h
"

24 
	~"ut/‹¡ut.h
"

26 
Çme¥aû
 
	gËv–db
 {

28 
	g¡d
::
¡ršg
 
RªdomSŒšg
(
Rªdom
* 
ºd
, 
Ën
) {

29 
	g¡d
::
¡ršg
 
r
;

30 
	g‹¡
::
RªdomSŒšg
(
ºd
, 
Ën
, &
r
);

31  
	gr
;

34 
	g¡d
::
¡ršg
 
RªdomKey
(
Rªdom
* 
ºd
) {

35 
Ën
 =

36 (
ºd
->
OÃIn
(3) ? 1

37 : (
ºd
->
OÃIn
(100è?„nd->
Skewed
(10è:„nd->
UnifÜm
(10)));

38  
	g‹¡
::
RªdomKey
(
ºd
, 
Ën
);

41 
	gÇme¥aû
 {

42 şas 
	cAtomicCouÁ”
 {

43 
	gpublic
:

44 
AtomicCouÁ”
(è: 
couÁ_
(0) {}

45 
Inüem’t
(è{ 
Inüem’tBy
(1); }

46 
Inüem’tBy
(
couÁ
è
LOCKS_EXCLUDED
(
mu_
) {

47 
Mu‹xLock
 
l
(&
mu_
);

48 
	gcouÁ_
 +ğ
couÁ
;

50 
R—d
(è
LOCKS_EXCLUDED
(
mu_
) {

51 
Mu‹xLock
 
l
(&
mu_
);

52  
	gcouÁ_
;

54 
Re£t
(è
LOCKS_EXCLUDED
(
mu_
) {

55 
Mu‹xLock
 
l
(&
mu_
);

56 
	gcouÁ_
 = 0;

59 
	g´iv©e
:

60 
pÜt
::
Mu‹x
 
mu_
;

61 
couÁ_
 
GUARDED_BY
(
mu_
);

64 
D–ayMli£cÚds
(
mlis
) {

65 
	gEnv
::
DeçuÉ
()->
SË•FÜMiüo£cÚds
(
mlis
 * 1000);

70 şas 
	cTe¡Env
 : 
public
 
EnvW¿µ”
 {

71 
public
:

72 
ex¶ic™
 
Te¡Env
(
Env
* 
ba£
è: 
EnvW¿µ”
(ba£), 
ignÜe_dÙ_fes_
(
çl£
) {}

74 
S‘IgnÜeDÙFes
(
boŞ
 
ignÜed
è{ 
	gignÜe_dÙ_fes_
 = ignored; }

76 
Stus
 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
dœ
,

77 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
»suÉ
è
ov”ride
 {

78 
Stus
 
s
 = 
rg‘
()->
G‘Chd»n
(
dœ
, 
»suÉ
);

79 ià(!
	gs
.
ok
(è|| !
	gignÜe_dÙ_fes_
) {

80  
	gs
;

83 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>::
™”©Ü
 
™
 = 
»suÉ
->
begš
();

84 
	g™
 !ğ
»suÉ
->
’d
()) {

85 ià((*
™
 == ".") || (*it == "..")) {

86 
™
 = 
»suÉ
->
”a£
(it);

88 ++
	g™
;

92  
	gs
;

95 
	g´iv©e
:

96 
boŞ
 
ignÜe_dÙ_fes_
;

100 şas 
	cS³cŸlEnv
 : 
public
 
EnvW¿µ”
 {

101 
public
:

103 
¡d
::
©omic
<
boŞ
> 
d–ay_d©a_sync_
;

106 
	g¡d
::
©omic
<
boŞ
> 
d©a_sync_”rÜ_
;

109 
	g¡d
::
©omic
<
boŞ
> 
no_¥aû_
;

112 
	g¡d
::
©omic
<
boŞ
> 
nÚ_wr™abË_
;

115 
	g¡d
::
©omic
<
boŞ
> 
mªiã¡_sync_”rÜ_
;

118 
	g¡d
::
©omic
<
boŞ
> 
mªiã¡_wr™e_”rÜ_
;

120 
boŞ
 
	gcouÁ_¿ndom_»ads_
;

121 
AtomicCouÁ”
 
	g¿ndom_»ad_couÁ”_
;

123 
ex¶ic™
 
S³cŸlEnv
(
Env
* 
ba£
)

124 : 
EnvW¿µ”
(
ba£
),

125 
d–ay_d©a_sync_
(
çl£
),

126 
d©a_sync_”rÜ_
(
çl£
),

127 
no_¥aû_
(
çl£
),

128 
nÚ_wr™abË_
(
çl£
),

129 
mªiã¡_sync_”rÜ_
(
çl£
),

130 
mªiã¡_wr™e_”rÜ_
(
çl£
),

131 
couÁ_¿ndom_»ads_
(
çl£
) {}

133 
Stus
 
NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
, 
Wr™abËFe
** 
r
) {

134 şas 
	cD©aFe
 : 
public
 
Wr™abËFe
 {

135 
´iv©e
:

136 
S³cŸlEnv
* cÚ¡ 
’v_
;

137 
Wr™abËFe
* cÚ¡ 
	gba£_
;

139 
	gpublic
:

140 
D©aFe
(
S³cŸlEnv
* 
’v
, 
Wr™abËFe
* 
ba£
è: 
’v_
Ónv), 
ba£_
(base) {}

141 ~
D©aFe
(è{ 
d–‘e
 
	gba£_
; }

142 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
) {

143 ià(
	g’v_
->
	gno_¥aû_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

145  
Stus
::
OK
();

147  
	gba£_
->
Aµ’d
(
d©a
);

150 
Stus
 
Clo£
(è{  
	gba£_
->Close(); }

151 
Stus
 
Flush
(è{  
	gba£_
->Flush(); }

152 
Stus
 
Sync
() {

153 ià(
	g’v_
->
	gd©a_sync_”rÜ_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

154  
Stus
::
IOE¼Ü
("simulated data syncƒrror");

156 
	g’v_
->
	gd–ay_d©a_sync_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

157 
D–ayMli£cÚds
(100);

159  
	gba£_
->
Sync
();

162 şas 
	cMªiã¡Fe
 : 
public
 
Wr™abËFe
 {

163 
´iv©e
:

164 
S³cŸlEnv
* 
’v_
;

165 
Wr™abËFe
* 
	gba£_
;

167 
	gpublic
:

168 
Mªiã¡Fe
(
S³cŸlEnv
* 
’v
, 
Wr™abËFe
* 
b
è: 
’v_
Ónv), 
ba£_
(b) {}

169 ~
Mªiã¡Fe
(è{ 
d–‘e
 
	gba£_
; }

170 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
) {

171 ià(
	g’v_
->
	gmªiã¡_wr™e_”rÜ_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

172  
Stus
::
IOE¼Ü
("simulated writerƒrror");

174  
	gba£_
->
Aµ’d
(
d©a
);

177 
Stus
 
Clo£
(è{  
	gba£_
->Close(); }

178 
Stus
 
Flush
(è{  
	gba£_
->Flush(); }

179 
Stus
 
Sync
() {

180 ià(
	g’v_
->
	gmªiã¡_sync_”rÜ_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

181  
Stus
::
IOE¼Ü
("simulated syncƒrror");

183  
	gba£_
->
Sync
();

188 ià(
	gnÚ_wr™abË_
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

189  
Stus
::
IOE¼Ü
("simulated writeƒrror");

192 
Stus
 
	gs
 = 
rg‘
()->
NewWr™abËFe
(
f
, 
r
);

193 ià(
	gs
.
ok
()) {

194 ià(
¡r¡r
(
f
.
c_¡r
(), ".ldb"è!ğ
nuÎ±r
 ||

195 
¡r¡r
(
f
.
c_¡r
(), ".log"è!ğ
nuÎ±r
) {

196 *
r
 = 
Ãw
 
D©aFe
(
this
, *r);

197 } ià(
¡r¡r
(
f
.
c_¡r
(), "MANIFEST"è!ğ
nuÎ±r
) {

198 *
r
 = 
Ãw
 
Mªiã¡Fe
(
this
, *r);

201  
	gs
;

204 
Stus
 
NewRªdomAcûssFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
, 
RªdomAcûssFe
** 
r
) {

205 şas 
	cCouÁšgFe
 : 
public
 
RªdomAcûssFe
 {

206 
´iv©e
:

207 
RªdomAcûssFe
* 
rg‘_
;

208 
AtomicCouÁ”
* 
	gcouÁ”_
;

210 
	gpublic
:

211 
CouÁšgFe
(
RªdomAcûssFe
* 
rg‘
, 
AtomicCouÁ”
* 
couÁ”
)

212 : 
rg‘_
(
rg‘
), 
couÁ”_
(
couÁ”
) {}

213 
	gvœtu®
 ~
CouÁšgFe
(è{ 
d–‘e
 
	grg‘_
; }

214 
vœtu®
 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

215 * 
sü©ch
) const {

216 
	gcouÁ”_
->
Inüem’t
();

217  
	grg‘_
->
R—d
(
off£t
, 
n
, 
»suÉ
, 
sü©ch
);

221 
Stus
 
	gs
 = 
rg‘
()->
NewRªdomAcûssFe
(
f
, 
r
);

222 ià(
	gs
.
ok
(è&& 
	gcouÁ_¿ndom_»ads_
) {

223 *
	gr
 = 
Ãw
 
CouÁšgFe
(*
r
, &
¿ndom_»ad_couÁ”_
);

225  
	gs
;

229 şas 
	cDBTe¡
 {

230 
	gpublic
:

231 
¡d
::
¡ršg
 
dbÇme_
;

232 
S³cŸlEnv
* 
	g’v_
;

233 
DB
* 
	gdb_
;

235 
O±iÚs
 
	gÏ¡_İtiÚs_
;

237 
DBTe¡
(è: 
’v_
(
Ãw
 
S³cŸlEnv
(
Env
::
DeçuÉ
())), 
İtiÚ_cÚfig_
(
kDeçuÉ
) {

238 
	gf‹r_pŞicy_
 = 
NewBloomF‹rPŞicy
(10);

239 
	gdbÇme_
 = 
‹¡
::
TmpDœ
() + "/db_test";

240 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

241 
	gdb_
 = 
nuÎ±r
;

242 
Reİ’
();

245 ~
DBTe¡
() {

246 
d–‘e
 
	gdb_
;

247 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

248 
d–‘e
 
	g’v_
;

249 
d–‘e
 
	gf‹r_pŞicy_
;

254 
boŞ
 
ChªgeO±iÚs
() {

255 
	gİtiÚ_cÚfig_
++;

256 ià(
	gİtiÚ_cÚfig_
 >ğ
kEnd
) {

257  
çl£
;

259 
De¡royAndReİ’
();

260  
	gŒue
;

265 
O±iÚs
 
Cu¼’tO±iÚs
() {

266 
O±iÚs
 
	gİtiÚs
;

267 
	gİtiÚs
.
	g»u£_logs
 = 
çl£
;

268 
	gİtiÚ_cÚfig_
) {

269 
	gkReu£
:

270 
İtiÚs
.
»u£_logs
 = 
Œue
;

272 
	gkF‹r
:

273 
İtiÚs
.
f‹r_pŞicy
 = 
f‹r_pŞicy_
;

275 
	gkUncom´es£d
:

276 
İtiÚs
.
com´essiÚ
 = 
kNoCom´essiÚ
;

281  
	gİtiÚs
;

284 
DBIm¶
* 
dbfuÎ
(è{  
	g»š‹½»t_ÿ¡
<
	gDBIm¶
*>(
	gdb_
); }

286 
Reİ’
(
O±iÚs
* 
İtiÚs
 = 
nuÎ±r
è{ 
ASSERT_OK
(
TryReİ’
(options)); }

288 
Clo£
() {

289 
d–‘e
 
	gdb_
;

290 
	gdb_
 = 
nuÎ±r
;

293 
De¡royAndReİ’
(
O±iÚs
* 
İtiÚs
 = 
nuÎ±r
) {

294 
d–‘e
 
db_
;

295 
	gdb_
 = 
nuÎ±r
;

296 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

297 
ASSERT_OK
(
TryReİ’
(
İtiÚs
));

300 
Stus
 
TryReİ’
(
O±iÚs
* 
İtiÚs
) {

301 
d–‘e
 
	gdb_
;

302 
	gdb_
 = 
nuÎ±r
;

303 
O±iÚs
 
	gİts
;

304 ià(
	gİtiÚs
 !ğ
nuÎ±r
) {

305 
İts
 = *
İtiÚs
;

307 
	gİts
 = 
Cu¼’tO±iÚs
();

308 
	gİts
.
	gü—‹_if_missšg
 = 
Œue
;

310 
	gÏ¡_İtiÚs_
 = 
İts
;

312  
	gDB
::
O³n
(
İts
, 
dbÇme_
, &
db_
);

315 
Stus
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
k
, cÚ¡ std::¡ršg& 
v
) {

316  
db_
->
Put
(
Wr™eO±iÚs
(), 
k
, 
v
);

319 
Stus
 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
k
è{  
db_
->D–‘e(
Wr™eO±iÚs
(), k); }

321 
	g¡d
::
¡ršg
 
G‘
(cÚ¡ 
¡d
::¡ršg& 
k
, cÚ¡ 
SÇpshÙ
* 
¢­shÙ
 = 
nuÎ±r
) {

322 
R—dO±iÚs
 
İtiÚs
;

323 
	gİtiÚs
.
	g¢­shÙ
 = 
¢­shÙ
;

324 
	g¡d
::
¡ršg
 
»suÉ
;

325 
Stus
 
	gs
 = 
db_
->
G‘
(
İtiÚs
, 
k
, &
»suÉ
);

326 ià(
	gs
.
IsNÙFound
()) {

327 
	g»suÉ
 = "NOT_FOUND";

328 } ià(!
	gs
.
ok
()) {

329 
	g»suÉ
 = 
s
.
ToSŒšg
();

331  
	g»suÉ
;

336 
	g¡d
::
¡ršg
 
CÚ‹Ás
() {

337 
¡d
::
veùÜ
<¡d::
¡ršg
> 
fÜw¬d
;

338 
	g¡d
::
¡ršg
 
»suÉ
;

339 
I‹¿tÜ
* 
	g™”
 = 
db_
->
NewI‹¿tÜ
(
R—dO±iÚs
());

340 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

341 
	g¡d
::
¡ršg
 
s
 = 
I‹rStus
(
™”
);

342 
	g»suÉ
.
push_back
('(');

343 
	g»suÉ
.
­³nd
(
s
);

344 
	g»suÉ
.
push_back
(')');

345 
	gfÜw¬d
.
push_back
(
s
);

349 
size_t
 
	gm©ched
 = 0;

350 
	g™”
->
S“kToLa¡
(); i‹r->
V®id
(); i‹r->
P»v
()) {

351 
ASSERT_LT
(
m©ched
, 
fÜw¬d
.
size
());

352 
ASSERT_EQ
(
I‹rStus
(
™”
), 
fÜw¬d
[fÜw¬d.
size
(è- 
m©ched
 - 1]);

353 
	gm©ched
++;

355 
ASSERT_EQ
(
m©ched
, 
fÜw¬d
.
size
());

357 
d–‘e
 
	g™”
;

358  
	g»suÉ
;

361 
	g¡d
::
¡ršg
 
AÎEÁr›sFÜ
(cÚ¡ 
Sliû
& 
u£r_key
) {

362 
I‹¿tÜ
* 
™”
 = 
dbfuÎ
()->
TEST_NewIÁ”ÇlI‹¿tÜ
();

363 
IÁ”ÇlKey
 
rg‘
(
u£r_key
, 
kMaxSequ’ûNumb”
, 
kTy³V®ue
);

364 
	g™”
->
S“k
(
rg‘
.
Encode
());

365 
	g¡d
::
¡ršg
 
»suÉ
;

366 ià(!
	g™”
->
¡©us
().
ok
()) {

367 
	g»suÉ
 = 
™”
->
¡©us
().
ToSŒšg
();

369 
	g»suÉ
 = "[ ";

370 
boŞ
 
	gfœ¡
 = 
Œue
;

371 
	g™”
->
V®id
()) {

372 
P¬£dIÁ”ÇlKey
 
	gikey
;

373 ià(!
P¬£IÁ”ÇlKey
(
™”
->
key
(), &
ikey
)) {

374 
	g»suÉ
 += "CORRUPTED";

376 ià(
	gÏ¡_İtiÚs_
.
	gcom·¿tÜ
->
Com·»
(
ikey
.
u£r_key
, user_key) != 0) {

379 ià(!
	gfœ¡
) {

380 
	g»suÉ
 += ", ";

382 
	gfœ¡
 = 
çl£
;

383 
	gikey
.
	gty³
) {

384 
	gkTy³V®ue
:

385 
»suÉ
 +ğ
™”
->
v®ue
().
ToSŒšg
();

387 
	gkTy³D–‘iÚ
:

388 
»suÉ
 += "DEL";

392 
	g™”
->
Next
();

394 ià(!
	gfœ¡
) {

395 
	g»suÉ
 += " ";

397 
	g»suÉ
 += "]";

399 
d–‘e
 
	g™”
;

400  
	g»suÉ
;

403 
NumTabËFesAtLev–
(
Ëv–
) {

404 
	g¡d
::
¡ršg
 
´İ”ty
;

405 
ASSERT_TRUE
(
db_
->
G‘Prİ”ty
(

406 "Ëv–db.num-fes-©-Ëv–" + 
Numb”ToSŒšg
(
Ëv–
), &
´İ”ty
));

407  
	g¡d
::
¡oi
(
´İ”ty
);

410 
TÙ®TabËFes
() {

411 
	g»suÉ
 = 0;

412 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

413 
	g»suÉ
 +ğ
NumTabËFesAtLev–
(
Ëv–
);

415  
	g»suÉ
;

419 
	g¡d
::
¡ršg
 
FesP”Lev–
() {

420 
¡d
::
¡ršg
 
»suÉ
;

421 
	gÏ¡_nÚ_z”o_off£t
 = 0;

422 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

423 
	gf
 = 
NumTabËFesAtLev–
(
Ëv–
);

424 
	gbuf
[100];

425 
¢´štf
(
buf
, (buf), "%s%d", (
Ëv–
 ? "," : ""), 
f
);

426 
	g»suÉ
 +ğ
buf
;

427 ià(
	gf
 > 0) {

428 
	gÏ¡_nÚ_z”o_off£t
 = 
»suÉ
.
size
();

431 
	g»suÉ
.
»size
(
Ï¡_nÚ_z”o_off£t
);

432  
	g»suÉ
;

435 
CouÁFes
() {

436 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
fes
;

437 
	g’v_
->
G‘Chd»n
(
dbÇme_
, &
fes
);

438  
	g¡©ic_ÿ¡
<>(
	gfes
.
size
());

441 
ušt64_t
 
Size
(cÚ¡ 
Sliû
& 
¡¬t
, cÚ¡ Sliû& 
lim™
) {

442 
Rªge
 
r
(
¡¬t
, 
lim™
);

443 
ušt64_t
 
	gsize
;

444 
	gdb_
->
G‘Aµroxim©eSizes
(&
r
, 1, &
size
);

445  
	gsize
;

448 
Com·ù
(cÚ¡ 
Sliû
& 
¡¬t
, cÚ¡ Sliû& 
lim™
) {

449 
	gdb_
->
Com·ùRªge
(&
¡¬t
, &
lim™
);

454 
MakeTabËs
(
n
, cÚ¡ 
¡d
::
¡ršg
& 
sm®l_key
,

455 cÚ¡ 
¡d
::
¡ršg
& 
Ïrge_key
) {

456 
i
 = 0; 
	gi
 < 
	gn
; i++) {

457 
Put
(
sm®l_key
, "begin");

458 
Put
(
Ïrge_key
, "end");

459 
dbfuÎ
()->
TEST_Com·ùMemTabË
();

465 
FlLev–s
(cÚ¡ 
¡d
::
¡ršg
& 
sm®Ë¡
, cÚ¡ std::¡ršg& 
Ïrge¡
) {

466 
MakeTabËs
(
cÚfig
::
kNumLev–s
, 
sm®Ë¡
, 
Ïrge¡
);

469 
DumpFeCouÁs
(cÚ¡ * 
Ïb–
) {

470 
årštf
(
¡d”r
, "---\n%s:\n", 
Ïb–
);

471 
årštf
(

472 
¡d”r
, "maxoverlap: %lld\n",

473 
¡©ic_ÿ¡
<>(
dbfuÎ
()->
TEST_MaxNextLev–Ov”ÏµšgBy‹s
()));

474 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

475 
	gnum
 = 
NumTabËFesAtLev–
(
Ëv–
);

476 ià(
	gnum
 > 0) {

477 
årštf
(
¡d”r
, "†ev– %3d : %d fes\n", 
Ëv–
, 
num
);

482 
	g¡d
::
¡ršg
 
DumpSSTabËLi¡
() {

483 
¡d
::
¡ršg
 
´İ”ty
;

484 
	gdb_
->
G‘Prİ”ty
("Ëv–db.s¡abËs", &
´İ”ty
);

485  
	g´İ”ty
;

488 
	g¡d
::
¡ršg
 
I‹rStus
(
I‹¿tÜ
* 
™”
) {

489 
¡d
::
¡ršg
 
»suÉ
;

490 ià(
	g™”
->
V®id
()) {

491 
	g»suÉ
 = 
™”
->
key
().
ToSŒšg
(è+ "->" + i‹r->
v®ue
().ToString();

493 
	g»suÉ
 = "(invalid)";

495  
	g»suÉ
;

498 
boŞ
 
D–‘eAnSSTFe
() {

499 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
f’ames
;

500 
ASSERT_OK
(
’v_
->
G‘Chd»n
(
dbÇme_
, &
f’ames
));

501 
ušt64_t
 
	gnumb”
;

502 
FeTy³
 
	gty³
;

503 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

504 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
è&& 
	gty³
 =ğ
kTabËFe
) {

505 
ASSERT_OK
(
’v_
->
D–‘eFe
(
TabËFeName
(
dbÇme_
, 
numb”
)));

506  
	gŒue
;

509  
	gçl£
;

513 
R’ameLDBToSST
() {

514 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
f’ames
;

515 
ASSERT_OK
(
’v_
->
G‘Chd»n
(
dbÇme_
, &
f’ames
));

516 
ušt64_t
 
	gnumb”
;

517 
FeTy³
 
	gty³
;

518 
	gfes_»Çmed
 = 0;

519 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

520 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
è&& 
	gty³
 =ğ
kTabËFe
) {

521 cÚ¡ 
¡d
::
¡ršg
 
äom
 = 
TabËFeName
(
dbÇme_
, 
numb”
);

522 cÚ¡ 
	g¡d
::
¡ršg
 
to
 = 
SSTTabËFeName
(
dbÇme_
, 
numb”
);

523 
ASSERT_OK
(
’v_
->
R’ameFe
(
äom
, 
to
));

524 
	gfes_»Çmed
++;

527  
	gfes_»Çmed
;

530 
	g´iv©e
:

532 
	eO±iÚCÚfig
 { 
kDeçuÉ
, 
	gkReu£
, 
	gkF‹r
, 
	gkUncom´es£d
, 
	gkEnd
 };

534 cÚ¡ 
F‹rPŞicy
* 
	gf‹r_pŞicy_
;

535 
	gİtiÚ_cÚfig_
;

538 
	$TEST
(
DBTe¡
, 
Em±y
) {

540 
	`ASSERT_TRUE
(
db_
 !ğ
nuÎ±r
);

541 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("foo"));

542 } 
	`ChªgeO±iÚs
());

543 
	}
}

545 
	$TEST
(
DBTe¡
, 
Em±yKey
) {

547 
	`ASSERT_OK
(
	`Put
("", "v1"));

548 
	`ASSERT_EQ
("v1", 
	`G‘
(""));

549 
	`ASSERT_OK
(
	`Put
("", "v2"));

550 
	`ASSERT_EQ
("v2", 
	`G‘
(""));

551 } 
	`ChªgeO±iÚs
());

552 
	}
}

554 
	$TEST
(
DBTe¡
, 
Em±yV®ue
) {

556 
	`ASSERT_OK
(
	`Put
("key", "v1"));

557 
	`ASSERT_EQ
("v1", 
	`G‘
("key"));

558 
	`ASSERT_OK
(
	`Put
("key", ""));

559 
	`ASSERT_EQ
("", 
	`G‘
("key"));

560 
	`ASSERT_OK
(
	`Put
("key", "v2"));

561 
	`ASSERT_EQ
("v2", 
	`G‘
("key"));

562 } 
	`ChªgeO±iÚs
());

563 
	}
}

565 
	$TEST
(
DBTe¡
, 
R—dWr™e
) {

567 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

568 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

569 
	`ASSERT_OK
(
	`Put
("bar", "v2"));

570 
	`ASSERT_OK
(
	`Put
("foo", "v3"));

571 
	`ASSERT_EQ
("v3", 
	`G‘
("foo"));

572 
	`ASSERT_EQ
("v2", 
	`G‘
("bar"));

573 } 
	`ChªgeO±iÚs
());

574 
	}
}

576 
	$TEST
(
DBTe¡
, 
PutD–‘eG‘
) {

578 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v1"));

579 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

580 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), "foo", "v2"));

581 
	`ASSERT_EQ
("v2", 
	`G‘
("foo"));

582 
	`ASSERT_OK
(
db_
->
	`D–‘e
(
	`Wr™eO±iÚs
(), "foo"));

583 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("foo"));

584 } 
	`ChªgeO±iÚs
());

585 
	}
}

587 
	$TEST
(
DBTe¡
, 
G‘FromImmubËLay”
) {

589 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

590 
İtiÚs
.
’v
 = 
’v_
;

591 
İtiÚs
.
wr™e_bufãr_size
 = 100000;

592 
	`Reİ’
(&
İtiÚs
);

594 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

595 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

598 
’v_
->
d–ay_d©a_sync_
.
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

599 
	`Put
("k1", 
¡d
::
	`¡ršg
(100000, 'x'));

600 
	`Put
("k2", 
¡d
::
	`¡ršg
(100000, 'y'));

601 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

603 
’v_
->
d–ay_d©a_sync_
.
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

604 } 
	`ChªgeO±iÚs
());

605 
	}
}

607 
	$TEST
(
DBTe¡
, 
G‘FromV”siÚs
) {

609 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

610 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

611 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

612 } 
	`ChªgeO±iÚs
());

613 
	}
}

615 
	$TEST
(
DBTe¡
, 
G‘MemU§ge
) {

617 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

618 
¡d
::
¡ršg
 
v®
;

619 
	`ASSERT_TRUE
(
db_
->
	`G‘Prİ”ty
("Ëv–db.­´oxim©e-memÜy-u§ge", &
v®
));

620 
mem_u§ge
 = 
¡d
::
	`¡oi
(
v®
);

621 
	`ASSERT_GT
(
mem_u§ge
, 0);

622 
	`ASSERT_LT
(
mem_u§ge
, 5 * 1024 * 1024);

623 } 
	`ChªgeO±iÚs
());

624 
	}
}

626 
	$TEST
(
DBTe¡
, 
G‘SÇpshÙ
) {

629 
i
 = 0; i < 2; i++) {

630 
¡d
::
¡ršg
 
key
 = (
i
 =ğ0è? std::
	`¡ršg
("foo") : std::string(200, 'x');

631 
	`ASSERT_OK
(
	`Put
(
key
, "v1"));

632 cÚ¡ 
SÇpshÙ
* 
s1
 = 
db_
->
	`G‘SÇpshÙ
();

633 
	`ASSERT_OK
(
	`Put
(
key
, "v2"));

634 
	`ASSERT_EQ
("v2", 
	`G‘
(
key
));

635 
	`ASSERT_EQ
("v1", 
	`G‘
(
key
, 
s1
));

636 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

637 
	`ASSERT_EQ
("v2", 
	`G‘
(
key
));

638 
	`ASSERT_EQ
("v1", 
	`G‘
(
key
, 
s1
));

639 
db_
->
	`R–—£SÇpshÙ
(
s1
);

641 } 
	`ChªgeO±iÚs
());

642 
	}
}

644 
	$TEST
(
DBTe¡
, 
G‘Id’tiÿlSÇpshÙs
) {

647 
i
 = 0; i < 2; i++) {

648 
¡d
::
¡ršg
 
key
 = (
i
 =ğ0è? std::
	`¡ršg
("foo") : std::string(200, 'x');

649 
	`ASSERT_OK
(
	`Put
(
key
, "v1"));

650 cÚ¡ 
SÇpshÙ
* 
s1
 = 
db_
->
	`G‘SÇpshÙ
();

651 cÚ¡ 
SÇpshÙ
* 
s2
 = 
db_
->
	`G‘SÇpshÙ
();

652 cÚ¡ 
SÇpshÙ
* 
s3
 = 
db_
->
	`G‘SÇpshÙ
();

653 
	`ASSERT_OK
(
	`Put
(
key
, "v2"));

654 
	`ASSERT_EQ
("v2", 
	`G‘
(
key
));

655 
	`ASSERT_EQ
("v1", 
	`G‘
(
key
, 
s1
));

656 
	`ASSERT_EQ
("v1", 
	`G‘
(
key
, 
s2
));

657 
	`ASSERT_EQ
("v1", 
	`G‘
(
key
, 
s3
));

658 
db_
->
	`R–—£SÇpshÙ
(
s1
);

659 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

660 
	`ASSERT_EQ
("v2", 
	`G‘
(
key
));

661 
	`ASSERT_EQ
("v1", 
	`G‘
(
key
, 
s2
));

662 
db_
->
	`R–—£SÇpshÙ
(
s2
);

663 
	`ASSERT_EQ
("v1", 
	`G‘
(
key
, 
s3
));

664 
db_
->
	`R–—£SÇpshÙ
(
s3
);

666 } 
	`ChªgeO±iÚs
());

667 
	}
}

669 
	$TEST
(
DBTe¡
, 
I‹¿‹Ov”Em±ySÇpshÙ
) {

671 cÚ¡ 
SÇpshÙ
* 
¢­shÙ
 = 
db_
->
	`G‘SÇpshÙ
();

672 
R—dO±iÚs
 
»ad_İtiÚs
;

673 
»ad_İtiÚs
.
¢­shÙ
 = snapshot;

674 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

675 
	`ASSERT_OK
(
	`Put
("foo", "v2"));

677 
I‹¿tÜ
* 
™”©Ü1
 = 
db_
->
	`NewI‹¿tÜ
(
»ad_İtiÚs
);

678 
™”©Ü1
->
	`S“kToFœ¡
();

679 
	`ASSERT_TRUE
(!
™”©Ü1
->
	`V®id
());

680 
d–‘e
 
™”©Ü1
;

682 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

684 
I‹¿tÜ
* 
™”©Ü2
 = 
db_
->
	`NewI‹¿tÜ
(
»ad_İtiÚs
);

685 
™”©Ü2
->
	`S“kToFœ¡
();

686 
	`ASSERT_TRUE
(!
™”©Ü2
->
	`V®id
());

687 
d–‘e
 
™”©Ü2
;

689 
db_
->
	`R–—£SÇpshÙ
(
¢­shÙ
);

690 } 
	`ChªgeO±iÚs
());

691 
	}
}

693 
	$TEST
(
DBTe¡
, 
G‘Lev–0Ord”šg
) {

699 
	`ASSERT_OK
(
	`Put
("bar", "b"));

700 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

701 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

702 
	`ASSERT_OK
(
	`Put
("foo", "v2"));

703 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

704 
	`ASSERT_EQ
("v2", 
	`G‘
("foo"));

705 } 
	`ChªgeO±iÚs
());

706 
	}
}

708 
	$TEST
(
DBTe¡
, 
G‘Ord”edByLev–s
) {

710 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

711 
	`Com·ù
("a", "z");

712 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

713 
	`ASSERT_OK
(
	`Put
("foo", "v2"));

714 
	`ASSERT_EQ
("v2", 
	`G‘
("foo"));

715 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

716 
	`ASSERT_EQ
("v2", 
	`G‘
("foo"));

717 } 
	`ChªgeO±iÚs
());

718 
	}
}

720 
	$TEST
(
DBTe¡
, 
G‘PicksCÜ»ùFe
) {

723 
	`ASSERT_OK
(
	`Put
("a", "va"));

724 
	`Com·ù
("a", "b");

725 
	`ASSERT_OK
(
	`Put
("x", "vx"));

726 
	`Com·ù
("x", "y");

727 
	`ASSERT_OK
(
	`Put
("f", "vf"));

728 
	`Com·ù
("f", "g");

729 
	`ASSERT_EQ
("va", 
	`G‘
("a"));

730 
	`ASSERT_EQ
("vf", 
	`G‘
("f"));

731 
	`ASSERT_EQ
("vx", 
	`G‘
("x"));

732 } 
	`ChªgeO±iÚs
());

733 
	}
}

735 
	$TEST
(
DBTe¡
, 
G‘EncouÁ”sEm±yLev–
) {

746 
com·ùiÚ_couÁ
 = 0;

747 
	`NumTabËFesAtLev–
(0) == 0 || NumTableFilesAtLevel(2) == 0) {

748 
	`ASSERT_LE
(
com·ùiÚ_couÁ
, 100) << "could‚ot fill†evels 0‡nd 2";

749 
com·ùiÚ_couÁ
++;

750 
	`Put
("a", "begin");

751 
	`Put
("z", "end");

752 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

756 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(1, 
nuÎ±r
,‚ullptr);

757 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 1);

758 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(1), 0);

759 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(2), 1);

762 
i
 = 0; i < 1000; i++) {

763 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("missing"));

767 
	`D–ayMli£cÚds
(1000);

769 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 0);

770 } 
	`ChªgeO±iÚs
());

771 
	}
}

773 
	$TEST
(
DBTe¡
, 
I‹rEm±y
) {

774 
I‹¿tÜ
* 
™”
 = 
db_
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

776 
™”
->
	`S“kToFœ¡
();

777 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

779 
™”
->
	`S“kToLa¡
();

780 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

782 
™”
->
	`S“k
("foo");

783 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

785 
d–‘e
 
™”
;

786 
	}
}

788 
	$TEST
(
DBTe¡
, 
I‹rSšgË
) {

789 
	`ASSERT_OK
(
	`Put
("a", "va"));

790 
I‹¿tÜ
* 
™”
 = 
db_
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

792 
™”
->
	`S“kToFœ¡
();

793 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

794 
™”
->
	`Next
();

795 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

796 
™”
->
	`S“kToFœ¡
();

797 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

798 
™”
->
	`P»v
();

799 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

801 
™”
->
	`S“kToLa¡
();

802 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

803 
™”
->
	`Next
();

804 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

805 
™”
->
	`S“kToLa¡
();

806 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

807 
™”
->
	`P»v
();

808 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

810 
™”
->
	`S“k
("");

811 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

812 
™”
->
	`Next
();

813 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

815 
™”
->
	`S“k
("a");

816 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

817 
™”
->
	`Next
();

818 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

820 
™”
->
	`S“k
("b");

821 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

823 
d–‘e
 
™”
;

824 
	}
}

826 
	$TEST
(
DBTe¡
, 
I‹rMuÉi
) {

827 
	`ASSERT_OK
(
	`Put
("a", "va"));

828 
	`ASSERT_OK
(
	`Put
("b", "vb"));

829 
	`ASSERT_OK
(
	`Put
("c", "vc"));

830 
I‹¿tÜ
* 
™”
 = 
db_
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

832 
™”
->
	`S“kToFœ¡
();

833 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

834 
™”
->
	`Next
();

835 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

836 
™”
->
	`Next
();

837 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

838 
™”
->
	`Next
();

839 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

840 
™”
->
	`S“kToFœ¡
();

841 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

842 
™”
->
	`P»v
();

843 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

845 
™”
->
	`S“kToLa¡
();

846 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

847 
™”
->
	`P»v
();

848 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

849 
™”
->
	`P»v
();

850 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

851 
™”
->
	`P»v
();

852 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

853 
™”
->
	`S“kToLa¡
();

854 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

855 
™”
->
	`Next
();

856 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

858 
™”
->
	`S“k
("");

859 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

860 
™”
->
	`S“k
("a");

861 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

862 
™”
->
	`S“k
("ax");

863 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

864 
™”
->
	`S“k
("b");

865 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

866 
™”
->
	`S“k
("z");

867 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

870 
™”
->
	`S“kToLa¡
();

871 
™”
->
	`P»v
();

872 
™”
->
	`P»v
();

873 
™”
->
	`Next
();

874 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

877 
™”
->
	`S“kToFœ¡
();

878 
™”
->
	`Next
();

879 
™”
->
	`Next
();

880 
™”
->
	`P»v
();

881 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

884 
	`ASSERT_OK
(
	`Put
("a", "va2"));

885 
	`ASSERT_OK
(
	`Put
("a2", "va3"));

886 
	`ASSERT_OK
(
	`Put
("b", "vb2"));

887 
	`ASSERT_OK
(
	`Put
("c", "vc2"));

888 
	`ASSERT_OK
(
	`D–‘e
("b"));

889 
™”
->
	`S“kToFœ¡
();

890 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

891 
™”
->
	`Next
();

892 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

893 
™”
->
	`Next
();

894 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

895 
™”
->
	`Next
();

896 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

897 
™”
->
	`S“kToLa¡
();

898 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

899 
™”
->
	`P»v
();

900 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->vb");

901 
™”
->
	`P»v
();

902 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

903 
™”
->
	`P»v
();

904 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

906 
d–‘e
 
™”
;

907 
	}
}

909 
	$TEST
(
DBTe¡
, 
I‹rSm®lAndL¬geMix
) {

910 
	`ASSERT_OK
(
	`Put
("a", "va"));

911 
	`ASSERT_OK
(
	`Put
("b", 
¡d
::
	`¡ršg
(100000, 'b')));

912 
	`ASSERT_OK
(
	`Put
("c", "vc"));

913 
	`ASSERT_OK
(
	`Put
("d", 
¡d
::
	`¡ršg
(100000, 'd')));

914 
	`ASSERT_OK
(
	`Put
("e", 
¡d
::
	`¡ršg
(100000, 'e')));

916 
I‹¿tÜ
* 
™”
 = 
db_
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

918 
™”
->
	`S“kToFœ¡
();

919 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

920 
™”
->
	`Next
();

921 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->" + 
¡d
::
	`¡ršg
(100000, 'b'));

922 
™”
->
	`Next
();

923 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

924 
™”
->
	`Next
();

925 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "d->" + 
¡d
::
	`¡ršg
(100000, 'd'));

926 
™”
->
	`Next
();

927 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "e->" + 
¡d
::
	`¡ršg
(100000, 'e'));

928 
™”
->
	`Next
();

929 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

931 
™”
->
	`S“kToLa¡
();

932 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "e->" + 
¡d
::
	`¡ršg
(100000, 'e'));

933 
™”
->
	`P»v
();

934 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "d->" + 
¡d
::
	`¡ršg
(100000, 'd'));

935 
™”
->
	`P»v
();

936 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

937 
™”
->
	`P»v
();

938 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "b->" + 
¡d
::
	`¡ršg
(100000, 'b'));

939 
™”
->
	`P»v
();

940 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

941 
™”
->
	`P»v
();

942 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "(invalid)");

944 
d–‘e
 
™”
;

945 
	}
}

947 
	$TEST
(
DBTe¡
, 
I‹rMuÉiW™hD–‘e
) {

949 
	`ASSERT_OK
(
	`Put
("a", "va"));

950 
	`ASSERT_OK
(
	`Put
("b", "vb"));

951 
	`ASSERT_OK
(
	`Put
("c", "vc"));

952 
	`ASSERT_OK
(
	`D–‘e
("b"));

953 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("b"));

955 
I‹¿tÜ
* 
™”
 = 
db_
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

956 
™”
->
	`S“k
("c");

957 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "c->vc");

958 
™”
->
	`P»v
();

959 
	`ASSERT_EQ
(
	`I‹rStus
(
™”
), "a->va");

960 
d–‘e
 
™”
;

961 } 
	`ChªgeO±iÚs
());

962 
	}
}

964 
	$TEST
(
DBTe¡
, 
Recov”
) {

966 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

967 
	`ASSERT_OK
(
	`Put
("baz", "v5"));

969 
	`Reİ’
();

970 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

972 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

973 
	`ASSERT_EQ
("v5", 
	`G‘
("baz"));

974 
	`ASSERT_OK
(
	`Put
("bar", "v2"));

975 
	`ASSERT_OK
(
	`Put
("foo", "v3"));

977 
	`Reİ’
();

978 
	`ASSERT_EQ
("v3", 
	`G‘
("foo"));

979 
	`ASSERT_OK
(
	`Put
("foo", "v4"));

980 
	`ASSERT_EQ
("v4", 
	`G‘
("foo"));

981 
	`ASSERT_EQ
("v2", 
	`G‘
("bar"));

982 
	`ASSERT_EQ
("v5", 
	`G‘
("baz"));

983 } 
	`ChªgeO±iÚs
());

984 
	}
}

986 
	$TEST
(
DBTe¡
, 
Recov”yW™hEm±yLog
) {

988 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

989 
	`ASSERT_OK
(
	`Put
("foo", "v2"));

990 
	`Reİ’
();

991 
	`Reİ’
();

992 
	`ASSERT_OK
(
	`Put
("foo", "v3"));

993 
	`Reİ’
();

994 
	`ASSERT_EQ
("v3", 
	`G‘
("foo"));

995 } 
	`ChªgeO±iÚs
());

996 
	}
}

1000 
	$TEST
(
DBTe¡
, 
Recov”DuršgMembËCom·ùiÚ
) {

1002 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1003 
İtiÚs
.
’v
 = 
’v_
;

1004 
İtiÚs
.
wr™e_bufãr_size
 = 1000000;

1005 
	`Reİ’
(&
İtiÚs
);

1008 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

1009 
	`ASSERT_OK
(
	`Put
("big1", 
¡d
::
	`¡ršg
(10000000, 'x')));

1010 
	`ASSERT_OK
(
	`Put
("big2", 
¡d
::
	`¡ršg
(1000, 'y')));

1011 
	`ASSERT_OK
(
	`Put
("bar", "v2"));

1013 
	`Reİ’
(&
İtiÚs
);

1014 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

1015 
	`ASSERT_EQ
("v2", 
	`G‘
("bar"));

1016 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
(10000000, 'x'), 
	`G‘
("big1"));

1017 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
(1000, 'y'), 
	`G‘
("big2"));

1018 } 
	`ChªgeO±iÚs
());

1019 
	}
}

1021 
	g¡d
::
¡ršg
 
	$Key
(
i
) {

1022 
buf
[100];

1023 
	`¢´štf
(
buf
, (buf), "key%06d", 
i
);

1024  
¡d
::
	`¡ršg
(
buf
);

1025 
	}
}

1027 
	$TEST
(
DBTe¡
, 
MšÜCom·ùiÚsH­³n
) {

1028 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1029 
İtiÚs
.
wr™e_bufãr_size
 = 10000;

1030 
	`Reİ’
(&
İtiÚs
);

1032 cÚ¡ 
N
 = 500;

1034 
¡¬tšg_num_bËs
 = 
	`TÙ®TabËFes
();

1035 
i
 = 0; i < 
N
; i++) {

1036 
	`ASSERT_OK
(
	`Put
(
	`Key
(
i
), Key(iè+ 
¡d
::
	`¡ršg
(1000, 'v')));

1038 
’dšg_num_bËs
 = 
	`TÙ®TabËFes
();

1039 
	`ASSERT_GT
(
’dšg_num_bËs
, 
¡¬tšg_num_bËs
);

1041 
i
 = 0; i < 
N
; i++) {

1042 
	`ASSERT_EQ
(
	`Key
(
i
è+ 
¡d
::
	`¡ršg
(1000, 'v'), 
	`G‘
(Key(i)));

1045 
	`Reİ’
();

1047 
i
 = 0; i < 
N
; i++) {

1048 
	`ASSERT_EQ
(
	`Key
(
i
è+ 
¡d
::
	`¡ršg
(1000, 'v'), 
	`G‘
(Key(i)));

1050 
	}
}

1052 
	$TEST
(
DBTe¡
, 
Recov”W™hL¬geLog
) {

1054 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1055 
	`Reİ’
(&
İtiÚs
);

1056 
	`ASSERT_OK
(
	`Put
("big1", 
¡d
::
	`¡ršg
(200000, '1')));

1057 
	`ASSERT_OK
(
	`Put
("big2", 
¡d
::
	`¡ršg
(200000, '2')));

1058 
	`ASSERT_OK
(
	`Put
("sm®l3", 
¡d
::
	`¡ršg
(10, '3')));

1059 
	`ASSERT_OK
(
	`Put
("sm®l4", 
¡d
::
	`¡ršg
(10, '4')));

1060 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 0);

1065 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1066 
İtiÚs
.
wr™e_bufãr_size
 = 100000;

1067 
	`Reİ’
(&
İtiÚs
);

1068 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 3);

1069 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
(200000, '1'), 
	`G‘
("big1"));

1070 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
(200000, '2'), 
	`G‘
("big2"));

1071 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
(10, '3'), 
	`G‘
("small3"));

1072 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
(10, '4'), 
	`G‘
("small4"));

1073 
	`ASSERT_GT
(
	`NumTabËFesAtLev–
(0), 1);

1074 
	}
}

1076 
	$TEST
(
DBTe¡
, 
Com·ùiÚsG’”©eMuÉËFes
) {

1077 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1078 
İtiÚs
.
wr™e_bufãr_size
 = 100000000;

1079 
	`Reİ’
(&
İtiÚs
);

1081 
Rªdom
 
	`ºd
(301);

1084 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 0);

1085 
¡d
::
veùÜ
<¡d::
¡ršg
> 
v®ues
;

1086 
i
 = 0; i < 80; i++) {

1087 
v®ues
.
	`push_back
(
	`RªdomSŒšg
(&
ºd
, 100000));

1088 
	`ASSERT_OK
(
	`Put
(
	`Key
(
i
), 
v®ues
[i]));

1092 
	`Reİ’
(&
İtiÚs
);

1093 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
,‚ullptr);

1095 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 0);

1096 
	`ASSERT_GT
(
	`NumTabËFesAtLev–
(1), 1);

1097 
i
 = 0; i < 80; i++) {

1098 
	`ASSERT_EQ
(
	`G‘
(
	`Key
(
i
)), 
v®ues
[i]);

1100 
	}
}

1102 
	$TEST
(
DBTe¡
, 
R•—‹dWr™esToSameKey
) {

1103 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1104 
İtiÚs
.
’v
 = 
’v_
;

1105 
İtiÚs
.
wr™e_bufãr_size
 = 100000;

1106 
	`Reİ’
(&
İtiÚs
);

1110 cÚ¡ 
kMaxFes
 = 
cÚfig
::
kNumLev–s
 + cÚfig::
kL0_StİWr™esTrigg”
;

1112 
Rªdom
 
	`ºd
(301);

1113 
¡d
::
¡ršg
 
v®ue
 = 
	`RªdomSŒšg
(&
ºd
, 2 * 
İtiÚs
.
wr™e_bufãr_size
);

1114 
i
 = 0; i < 5 * 
kMaxFes
; i++) {

1115 
	`Put
("key", 
v®ue
);

1116 
	`ASSERT_LE
(
	`TÙ®TabËFes
(), 
kMaxFes
);

1117 
	`årštf
(
¡d”r
, "aá” %d: %d fes\n", 
i
 + 1, 
	`TÙ®TabËFes
());

1119 
	}
}

1121 
	$TEST
(
DBTe¡
, 
S·r£M”ge
) {

1122 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1123 
İtiÚs
.
com´essiÚ
 = 
kNoCom´essiÚ
;

1124 
	`Reİ’
(&
İtiÚs
);

1126 
	`FlLev–s
("A", "Z");

1134 cÚ¡ 
¡d
::
¡ršg
 
	`v®ue
(1000, 'x');

1135 
	`Put
("A", "va");

1137 
i
 = 0; i < 100000; i++) {

1138 
key
[100];

1139 
	`¢´štf
(
key
, (key), "B%010d", 
i
);

1140 
	`Put
(
key
, 
v®ue
);

1142 
	`Put
("C", "vc");

1143 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1144 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
,‚ullptr);

1147 
	`Put
("A", "va2");

1148 
	`Put
("B100", "bvalue2");

1149 
	`Put
("C", "vc2");

1150 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1154 
	`ASSERT_LE
(
	`dbfuÎ
()->
	`TEST_MaxNextLev–Ov”ÏµšgBy‹s
(), 20 * 1048576);

1155 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
,‚ullptr);

1156 
	`ASSERT_LE
(
	`dbfuÎ
()->
	`TEST_MaxNextLev–Ov”ÏµšgBy‹s
(), 20 * 1048576);

1157 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(1, 
nuÎ±r
,‚ullptr);

1158 
	`ASSERT_LE
(
	`dbfuÎ
()->
	`TEST_MaxNextLev–Ov”ÏµšgBy‹s
(), 20 * 1048576);

1159 
	}
}

1161 
boŞ
 
	$B‘w“n
(
ušt64_t
 
v®
, ušt64_ˆ
low
, ušt64_ˆ
high
) {

1162 
boŞ
 
»suÉ
 = (
v®
 >ğ
low
è&& (v® <ğ
high
);

1163 ià(!
»suÉ
) {

1164 
	`årštf
(
¡d”r
, "Value %llu is‚ot in„ange [%llu, %llu]\n",

1165 ()(
v®
), ()(
low
),

1166 ()(
high
));

1168  
»suÉ
;

1169 
	}
}

1171 
	$TEST
(
DBTe¡
, 
Aµroxim©eSizes
) {

1173 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1174 
İtiÚs
.
wr™e_bufãr_size
 = 100000000;

1175 
İtiÚs
.
com´essiÚ
 = 
kNoCom´essiÚ
;

1176 
	`De¡royAndReİ’
();

1178 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", "xyz"), 0, 0));

1179 
	`Reİ’
(&
İtiÚs
);

1180 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", "xyz"), 0, 0));

1183 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 0);

1184 cÚ¡ 
N
 = 80;

1185 cÚ¡ 
S1
 = 100000;

1186 cÚ¡ 
S2
 = 105000;

1187 
Rªdom
 
	`ºd
(301);

1188 
i
 = 0; i < 
N
; i++) {

1189 
	`ASSERT_OK
(
	`Put
(
	`Key
(
i
), 
	`RªdomSŒšg
(&
ºd
, 
S1
)));

1193 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(50)), 0, 0));

1195 ià(
İtiÚs
.
»u£_logs
) {

1198 
	`Reİ’
(&
İtiÚs
);

1199 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(50)), 0, 0));

1204 
run
 = 0;„un < 3;„un++) {

1205 
	`Reİ’
(&
İtiÚs
);

1207 
com·ù_¡¬t
 = 0; com·ù_¡¬ˆ< 
N
; compact_start += 10) {

1208 
i
 = 0; i < 
N
; i += 10) {

1209 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(
i
)), 
S1
 * i, 
S2
 * i));

1210 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(
i
è+ ".suffix"), 
S1
 * (i + 1),

1211 
S2
 * (
i
 + 1)));

1212 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
(
	`Key
(
i
), Key(˜+ 10)), 
S1
 * 10, 
S2
 * 10));

1214 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(50)), 
S1
 * 50, 
S2
 * 50));

1215 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(50è+ ".suffix"), 
S1
 * 50, 
S2
 * 50));

1217 
¡d
::
¡ršg
 
c¡¬t_¡r
 = 
	`Key
(
com·ù_¡¬t
);

1218 
¡d
::
¡ršg
 
ûnd_¡r
 = 
	`Key
(
com·ù_¡¬t
 + 9);

1219 
Sliû
 
c¡¬t
 = 
c¡¬t_¡r
;

1220 
Sliû
 
ûnd
 = 
ûnd_¡r
;

1221 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(0, &
c¡¬t
, &
ûnd
);

1224 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 0);

1225 
	`ASSERT_GT
(
	`NumTabËFesAtLev–
(1), 0);

1227 } 
	`ChªgeO±iÚs
());

1228 
	}
}

1230 
	$TEST
(
DBTe¡
, 
Aµroxim©eSizes_MixOfSm®lAndL¬ge
) {

1232 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1233 
İtiÚs
.
com´essiÚ
 = 
kNoCom´essiÚ
;

1234 
	`Reİ’
();

1236 
Rªdom
 
	`ºd
(301);

1237 
¡d
::
¡ršg
 
big1
 = 
	`RªdomSŒšg
(&
ºd
, 100000);

1238 
	`ASSERT_OK
(
	`Put
(
	`Key
(0), 
	`RªdomSŒšg
(&
ºd
, 10000)));

1239 
	`ASSERT_OK
(
	`Put
(
	`Key
(1), 
	`RªdomSŒšg
(&
ºd
, 10000)));

1240 
	`ASSERT_OK
(
	`Put
(
	`Key
(2), 
big1
));

1241 
	`ASSERT_OK
(
	`Put
(
	`Key
(3), 
	`RªdomSŒšg
(&
ºd
, 10000)));

1242 
	`ASSERT_OK
(
	`Put
(
	`Key
(4), 
big1
));

1243 
	`ASSERT_OK
(
	`Put
(
	`Key
(5), 
	`RªdomSŒšg
(&
ºd
, 10000)));

1244 
	`ASSERT_OK
(
	`Put
(
	`Key
(6), 
	`RªdomSŒšg
(&
ºd
, 300000)));

1245 
	`ASSERT_OK
(
	`Put
(
	`Key
(7), 
	`RªdomSŒšg
(&
ºd
, 10000)));

1247 ià(
İtiÚs
.
»u£_logs
) {

1249 
	`ASSERT_OK
(
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
());

1253 
run
 = 0;„un < 3;„un++) {

1254 
	`Reİ’
(&
İtiÚs
);

1256 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(0)), 0, 0));

1257 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(1)), 10000, 11000));

1258 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(2)), 20000, 21000));

1259 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(3)), 120000, 121000));

1260 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(4)), 130000, 131000));

1261 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(5)), 230000, 231000));

1262 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(6)), 240000, 241000));

1263 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(7)), 540000, 541000));

1264 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", 
	`Key
(8)), 550000, 560000));

1266 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
(
	`Key
(3), Key(5)), 110000, 111000));

1268 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
,‚ullptr);

1270 } 
	`ChªgeO±iÚs
());

1271 
	}
}

1273 
	$TEST
(
DBTe¡
, 
I‹¿tÜPšsRef
) {

1274 
	`Put
("foo", "hello");

1277 
I‹¿tÜ
* 
™”
 = 
db_
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

1280 
	`Put
("foo", "newvalue1");

1281 
i
 = 0; i < 100; i++) {

1282 
	`ASSERT_OK
(
	`Put
(
	`Key
(
i
), Key(iè+ 
¡d
::
	`¡ršg
(100000, 'v')));

1284 
	`Put
("foo", "newvalue2");

1286 
™”
->
	`S“kToFœ¡
();

1287 
	`ASSERT_TRUE
(
™”
->
	`V®id
());

1288 
	`ASSERT_EQ
("foo", 
™”
->
	`key
().
	`ToSŒšg
());

1289 
	`ASSERT_EQ
("h–lo", 
™”
->
	`v®ue
().
	`ToSŒšg
());

1290 
™”
->
	`Next
();

1291 
	`ASSERT_TRUE
(!
™”
->
	`V®id
());

1292 
d–‘e
 
™”
;

1293 
	}
}

1295 
	$TEST
(
DBTe¡
, 
SÇpshÙ
) {

1297 
	`Put
("foo", "v1");

1298 cÚ¡ 
SÇpshÙ
* 
s1
 = 
db_
->
	`G‘SÇpshÙ
();

1299 
	`Put
("foo", "v2");

1300 cÚ¡ 
SÇpshÙ
* 
s2
 = 
db_
->
	`G‘SÇpshÙ
();

1301 
	`Put
("foo", "v3");

1302 cÚ¡ 
SÇpshÙ
* 
s3
 = 
db_
->
	`G‘SÇpshÙ
();

1304 
	`Put
("foo", "v4");

1305 
	`ASSERT_EQ
("v1", 
	`G‘
("foo", 
s1
));

1306 
	`ASSERT_EQ
("v2", 
	`G‘
("foo", 
s2
));

1307 
	`ASSERT_EQ
("v3", 
	`G‘
("foo", 
s3
));

1308 
	`ASSERT_EQ
("v4", 
	`G‘
("foo"));

1310 
db_
->
	`R–—£SÇpshÙ
(
s3
);

1311 
	`ASSERT_EQ
("v1", 
	`G‘
("foo", 
s1
));

1312 
	`ASSERT_EQ
("v2", 
	`G‘
("foo", 
s2
));

1313 
	`ASSERT_EQ
("v4", 
	`G‘
("foo"));

1315 
db_
->
	`R–—£SÇpshÙ
(
s1
);

1316 
	`ASSERT_EQ
("v2", 
	`G‘
("foo", 
s2
));

1317 
	`ASSERT_EQ
("v4", 
	`G‘
("foo"));

1319 
db_
->
	`R–—£SÇpshÙ
(
s2
);

1320 
	`ASSERT_EQ
("v4", 
	`G‘
("foo"));

1321 } 
	`ChªgeO±iÚs
());

1322 
	}
}

1324 
	$TEST
(
DBTe¡
, 
Hidd’V®uesA»Removed
) {

1326 
Rªdom
 
	`ºd
(301);

1327 
	`FlLev–s
("a", "z");

1329 
¡d
::
¡ršg
 
big
 = 
	`RªdomSŒšg
(&
ºd
, 50000);

1330 
	`Put
("foo", 
big
);

1331 
	`Put
("pastfoo", "v");

1332 cÚ¡ 
SÇpshÙ
* 
¢­shÙ
 = 
db_
->
	`G‘SÇpshÙ
();

1333 
	`Put
("foo", "tiny");

1334 
	`Put
("pastfoo2", "v2");

1336 
	`ASSERT_OK
(
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
());

1337 
	`ASSERT_GT
(
	`NumTabËFesAtLev–
(0), 0);

1339 
	`ASSERT_EQ
(
big
, 
	`G‘
("foo", 
¢­shÙ
));

1340 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", "pastfoo"), 50000, 60000));

1341 
db_
->
	`R–—£SÇpshÙ
(
¢­shÙ
);

1342 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[šy, " + 
big
 + " ]");

1343 
Sliû
 
	`x
("x");

1344 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(0, 
nuÎ±r
, &
x
);

1345 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[iny ]");

1346 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(0), 0);

1347 
	`ASSERT_GE
(
	`NumTabËFesAtLev–
(1), 1);

1348 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(1, 
nuÎ±r
, &
x
);

1349 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[iny ]");

1351 
	`ASSERT_TRUE
(
	`B‘w“n
(
	`Size
("", "pastfoo"), 0, 1000));

1352 } 
	`ChªgeO±iÚs
());

1353 
	}
}

1355 
	$TEST
(
DBTe¡
, 
D–‘iÚM¬k”s1
) {

1356 
	`Put
("foo", "v1");

1357 
	`ASSERT_OK
(
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
());

1358 cÚ¡ 
Ï¡
 = 
cÚfig
::
kMaxMemCom·ùLev–
;

1359 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(
Ï¡
), 1);

1362 
	`Put
("a", "begin");

1363 
	`Put
("z", "end");

1364 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1365 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(
Ï¡
), 1);

1366 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(
Ï¡
 - 1), 1);

1368 
	`D–‘e
("foo");

1369 
	`Put
("foo", "v2");

1370 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ v2, DEL, v1 ]");

1371 
	`ASSERT_OK
(
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
());

1372 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ v2, DEL, v1 ]");

1373 
Sliû
 
	`z
("z");

1374 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(
Ï¡
 - 2, 
nuÎ±r
, &
z
);

1377 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ v2, v1 ]");

1378 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(
Ï¡
 - 1, 
nuÎ±r
,‚ullptr);

1381 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ v2 ]");

1382 
	}
}

1384 
	$TEST
(
DBTe¡
, 
D–‘iÚM¬k”s2
) {

1385 
	`Put
("foo", "v1");

1386 
	`ASSERT_OK
(
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
());

1387 cÚ¡ 
Ï¡
 = 
cÚfig
::
kMaxMemCom·ùLev–
;

1388 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(
Ï¡
), 1);

1391 
	`Put
("a", "begin");

1392 
	`Put
("z", "end");

1393 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1394 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(
Ï¡
), 1);

1395 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(
Ï¡
 - 1), 1);

1397 
	`D–‘e
("foo");

1398 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ DEL, v1 ]");

1399 
	`ASSERT_OK
(
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
());

1400 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ DEL, v1 ]");

1401 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(
Ï¡
 - 2, 
nuÎ±r
,‚ullptr);

1403 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ DEL, v1 ]");

1404 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(
Ï¡
 - 1, 
nuÎ±r
,‚ullptr);

1407 
	`ASSERT_EQ
(
	`AÎEÁr›sFÜ
("foo"), "[ ]");

1408 
	}
}

1410 
	$TEST
(
DBTe¡
, 
Ov”ÏpInLev–0
) {

1412 
	`ASSERT_EQ
(
cÚfig
::
kMaxMemCom·ùLev–
, 2) << "Fixesto match config";

1416 
	`ASSERT_OK
(
	`Put
("100", "v100"));

1417 
	`ASSERT_OK
(
	`Put
("999", "v999"));

1418 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1419 
	`ASSERT_OK
(
	`D–‘e
("100"));

1420 
	`ASSERT_OK
(
	`D–‘e
("999"));

1421 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1422 
	`ASSERT_EQ
("0,1,1", 
	`FesP”Lev–
());

1428 
	`ASSERT_OK
(
	`Put
("300", "v300"));

1429 
	`ASSERT_OK
(
	`Put
("500", "v500"));

1430 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1431 
	`ASSERT_OK
(
	`Put
("200", "v200"));

1432 
	`ASSERT_OK
(
	`Put
("600", "v600"));

1433 
	`ASSERT_OK
(
	`Put
("900", "v900"));

1434 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1435 
	`ASSERT_EQ
("2,1,1", 
	`FesP”Lev–
());

1438 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(1, 
nuÎ±r
,‚ullptr);

1439 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(2, 
nuÎ±r
,‚ullptr);

1440 
	`ASSERT_EQ
("2", 
	`FesP”Lev–
());

1445 
	`ASSERT_OK
(
	`D–‘e
("600"));

1446 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1447 
	`ASSERT_EQ
("3", 
	`FesP”Lev–
());

1448 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("600"));

1449 } 
	`ChªgeO±iÚs
());

1450 
	}
}

1452 
	$TEST
(
DBTe¡
, 
L0_Com·ùiÚBug_Issue44_a
) {

1453 
	`Reİ’
();

1454 
	`ASSERT_OK
(
	`Put
("b", "v"));

1455 
	`Reİ’
();

1456 
	`ASSERT_OK
(
	`D–‘e
("b"));

1457 
	`ASSERT_OK
(
	`D–‘e
("a"));

1458 
	`Reİ’
();

1459 
	`ASSERT_OK
(
	`D–‘e
("a"));

1460 
	`Reİ’
();

1461 
	`ASSERT_OK
(
	`Put
("a", "v"));

1462 
	`Reİ’
();

1463 
	`Reİ’
();

1464 
	`ASSERT_EQ
("×->v)", 
	`CÚ‹Ás
());

1465 
	`D–ayMli£cÚds
(1000);

1466 
	`ASSERT_EQ
("×->v)", 
	`CÚ‹Ás
());

1467 
	}
}

1469 
	$TEST
(
DBTe¡
, 
L0_Com·ùiÚBug_Issue44_b
) {

1470 
	`Reİ’
();

1471 
	`Put
("", "");

1472 
	`Reİ’
();

1473 
	`D–‘e
("e");

1474 
	`Put
("", "");

1475 
	`Reİ’
();

1476 
	`Put
("c", "cv");

1477 
	`Reİ’
();

1478 
	`Put
("", "");

1479 
	`Reİ’
();

1480 
	`Put
("", "");

1481 
	`D–ayMli£cÚds
(1000);

1482 
	`Reİ’
();

1483 
	`Put
("d", "dv");

1484 
	`Reİ’
();

1485 
	`Put
("", "");

1486 
	`Reİ’
();

1487 
	`D–‘e
("d");

1488 
	`D–‘e
("b");

1489 
	`Reİ’
();

1490 
	`ASSERT_EQ
("(->)(c->cv)", 
	`CÚ‹Ás
());

1491 
	`D–ayMli£cÚds
(1000);

1492 
	`ASSERT_EQ
("(->)(c->cv)", 
	`CÚ‹Ás
());

1493 
	}
}

1495 
	$TEST
(
DBTe¡
, 
Fæush_Issue474
) {

1496 cÚ¡ 
kNum
 = 100000;

1497 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
());

1498 
i
 = 0; i < 
kNum
; i++) {

1499 
	`fæush
(
nuÎ±r
);

1500 
	`ASSERT_OK
(
	`Put
(
	`RªdomKey
(&
ºd
), 
	`RªdomSŒšg
(&rnd, 100)));

1502 
	}
}

1504 
	$TEST
(
DBTe¡
, 
Com·¿tÜCheck
) {

1505 şas 
	cNewCom·¿tÜ
 : 
public
 
Com·¿tÜ
 {

1506 
public
:

1507 
vœtu®
 cÚ¡ * 
	`Name
() const {  "leveldb.NewComparator"; }

1508 
vœtu®
 
	`Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const {

1509  
	`By‹wi£Com·¿tÜ
()->
	`Com·»
(
a
, 
b
);

1511 
vœtu®
 
	`FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
* 
s
, cÚ¡ 
Sliû
& 
l
) const {

1512 
	`By‹wi£Com·¿tÜ
()->
	`FšdShÜ‹¡S•¬©Ü
(
s
, 
l
);

1514 
vœtu®
 
	`FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const {

1515 
	`By‹wi£Com·¿tÜ
()->
	`FšdShÜtSucûssÜ
(
key
);

1518 
NewCom·¿tÜ
 
cmp
;

1519 
O±iÚs
 
Ãw_İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1520 
Ãw_İtiÚs
.
com·¿tÜ
 = &
cmp
;

1521 
Stus
 
s
 = 
	`TryReİ’
(&
Ãw_İtiÚs
);

1522 
	`ASSERT_TRUE
(!
s
.
	`ok
());

1523 
	`ASSERT_TRUE
(
s
.
	`ToSŒšg
().
	`fšd
("com·¿tÜ"è!ğ
¡d
::
¡ršg
::
Åos
)

1524 << 
s
.
	`ToSŒšg
();

1525 
	}
}

1527 
	$TEST
(
DBTe¡
, 
Cu¡omCom·¿tÜ
) {

1528 şas 
	cNumb”Com·¿tÜ
 : 
public
 
Com·¿tÜ
 {

1529 
public
:

1530 
vœtu®
 cÚ¡ * 
	`Name
() const {  "test.NumberComparator"; }

1531 
vœtu®
 
	`Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const {

1532  
	`ToNumb”
(
a
è- ToNumb”(
b
);

1534 
vœtu®
 
	`FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
* 
s
, cÚ¡ 
Sliû
& 
l
) const {

1535 
	`ToNumb”
(*
s
);

1536 
	`ToNumb”
(
l
);

1538 
vœtu®
 
	`FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const {

1539 
	`ToNumb”
(*
key
);

1542 
´iv©e
:

1543 
	`ToNumb”
(cÚ¡ 
Sliû
& 
x
) {

1545 
	`ASSERT_TRUE
(
x
.
	`size
() >= 2 && x[0] == '[' && x[x.size() - 1] == ']')

1546 << 
	`Esÿ³SŒšg
(
x
);

1547 
v®
;

1548 
ignÜed
;

1549 
	`ASSERT_TRUE
(
	`ssÿnf
(
x
.
	`ToSŒšg
().
	`c_¡r
(), "[%i]%c", &
v®
, &
ignÜed
) == 1)

1550 << 
	`Esÿ³SŒšg
(
x
);

1551  
v®
;

1554 
Numb”Com·¿tÜ
 
cmp
;

1555 
O±iÚs
 
Ãw_İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1556 
Ãw_İtiÚs
.
ü—‹_if_missšg
 = 
Œue
;

1557 
Ãw_İtiÚs
.
com·¿tÜ
 = &
cmp
;

1558 
Ãw_İtiÚs
.
f‹r_pŞicy
 = 
nuÎ±r
;

1559 
Ãw_İtiÚs
.
wr™e_bufãr_size
 = 1000;

1560 
	`De¡royAndReİ’
(&
Ãw_İtiÚs
);

1561 
	`ASSERT_OK
(
	`Put
("[10]", "ten"));

1562 
	`ASSERT_OK
(
	`Put
("[0x14]", "twenty"));

1563 
i
 = 0; i < 2; i++) {

1564 
	`ASSERT_EQ
("‹n", 
	`G‘
("[10]"));

1565 
	`ASSERT_EQ
("‹n", 
	`G‘
("[0xa]"));

1566 
	`ASSERT_EQ
("tw’ty", 
	`G‘
("[20]"));

1567 
	`ASSERT_EQ
("tw’ty", 
	`G‘
("[0x14]"));

1568 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("[15]"));

1569 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("[0xf]"));

1570 
	`Com·ù
("[0]", "[9999]");

1573 
run
 = 0;„un < 2;„un++) {

1574 
i
 = 0; i < 1000; i++) {

1575 
buf
[100];

1576 
	`¢´štf
(
buf
, (buf), "[%d]", 
i
 * 10);

1577 
	`ASSERT_OK
(
	`Put
(
buf
, buf));

1579 
	`Com·ù
("[0]", "[1000000]");

1581 
	}
}

1583 
	$TEST
(
DBTe¡
, 
Mªu®Com·ùiÚ
) {

1584 
	`ASSERT_EQ
(
cÚfig
::
kMaxMemCom·ùLev–
, 2)

1587 
	`MakeTabËs
(3, "p", "q");

1588 
	`ASSERT_EQ
("1,1,1", 
	`FesP”Lev–
());

1591 
	`Com·ù
("", "c");

1592 
	`ASSERT_EQ
("1,1,1", 
	`FesP”Lev–
());

1595 
	`Com·ù
("r", "z");

1596 
	`ASSERT_EQ
("1,1,1", 
	`FesP”Lev–
());

1599 
	`Com·ù
("p1", "p9");

1600 
	`ASSERT_EQ
("0,0,1", 
	`FesP”Lev–
());

1603 
	`MakeTabËs
(3, "c", "e");

1604 
	`ASSERT_EQ
("1,1,2", 
	`FesP”Lev–
());

1607 
	`Com·ù
("b", "f");

1608 
	`ASSERT_EQ
("0,0,2", 
	`FesP”Lev–
());

1611 
	`MakeTabËs
(1, "a", "z");

1612 
	`ASSERT_EQ
("0,1,2", 
	`FesP”Lev–
());

1613 
db_
->
	`Com·ùRªge
(
nuÎ±r
,‚ullptr);

1614 
	`ASSERT_EQ
("0,0,1", 
	`FesP”Lev–
());

1615 
	}
}

1617 
	$TEST
(
DBTe¡
, 
DBO³n_O±iÚs
) {

1618 
¡d
::
¡ršg
 
dbÇme
 = 
‹¡
::
	`TmpDœ
() + "/db_options_test";

1619 
	`De¡royDB
(
dbÇme
, 
	`O±iÚs
());

1622 
DB
* 
db
 = 
nuÎ±r
;

1623 
O±iÚs
 
İts
;

1624 
İts
.
ü—‹_if_missšg
 = 
çl£
;

1625 
Stus
 
s
 = 
DB
::
	`O³n
(
İts
, 
dbÇme
, &
db
);

1626 
	`ASSERT_TRUE
(
	`¡r¡r
(
s
.
	`ToSŒšg
().
	`c_¡r
(), "dÛ nÙƒxi¡"è!ğ
nuÎ±r
);

1627 
	`ASSERT_TRUE
(
db
 =ğ
nuÎ±r
);

1630 
İts
.
ü—‹_if_missšg
 = 
Œue
;

1631 
s
 = 
DB
::
	`O³n
(
İts
, 
dbÇme
, &
db
);

1632 
	`ASSERT_OK
(
s
);

1633 
	`ASSERT_TRUE
(
db
 !ğ
nuÎ±r
);

1635 
d–‘e
 
db
;

1636 
db
 = 
nuÎ±r
;

1639 
İts
.
ü—‹_if_missšg
 = 
çl£
;

1640 
İts
.
”rÜ_if_exi¡s
 = 
Œue
;

1641 
s
 = 
DB
::
	`O³n
(
İts
, 
dbÇme
, &
db
);

1642 
	`ASSERT_TRUE
(
	`¡r¡r
(
s
.
	`ToSŒšg
().
	`c_¡r
(), "exi¡s"è!ğ
nuÎ±r
);

1643 
	`ASSERT_TRUE
(
db
 =ğ
nuÎ±r
);

1646 
İts
.
ü—‹_if_missšg
 = 
Œue
;

1647 
İts
.
”rÜ_if_exi¡s
 = 
çl£
;

1648 
s
 = 
DB
::
	`O³n
(
İts
, 
dbÇme
, &
db
);

1649 
	`ASSERT_OK
(
s
);

1650 
	`ASSERT_TRUE
(
db
 !ğ
nuÎ±r
);

1652 
d–‘e
 
db
;

1653 
db
 = 
nuÎ±r
;

1654 
	}
}

1656 
	$TEST
(
DBTe¡
, 
De¡royEm±yDœ
) {

1657 
¡d
::
¡ršg
 
dbÇme
 = 
‹¡
::
	`TmpDœ
() + "/db_empty_dir";

1658 
Te¡Env
 
	`’v
(
Env
::
	`DeçuÉ
());

1659 
’v
.
	`D–‘eDœ
(
dbÇme
);

1660 
	`ASSERT_TRUE
(!
’v
.
	`FeExi¡s
(
dbÇme
));

1662 
O±iÚs
 
İts
;

1663 
İts
.
’v
 = &env;

1665 
	`ASSERT_OK
(
’v
.
	`C»©eDœ
(
dbÇme
));

1666 
	`ASSERT_TRUE
(
’v
.
	`FeExi¡s
(
dbÇme
));

1667 
¡d
::
veùÜ
<¡d::
¡ršg
> 
chd»n
;

1668 
	`ASSERT_OK
(
’v
.
	`G‘Chd»n
(
dbÇme
, &
chd»n
));

1670 
	`ASSERT_EQ
(2, 
chd»n
.
	`size
());

1671 
	`ASSERT_OK
(
	`De¡royDB
(
dbÇme
, 
İts
));

1672 
	`ASSERT_TRUE
(!
’v
.
	`FeExi¡s
(
dbÇme
));

1675 
’v
.
	`S‘IgnÜeDÙFes
(
Œue
);

1676 
	`ASSERT_OK
(
’v
.
	`C»©eDœ
(
dbÇme
));

1677 
	`ASSERT_TRUE
(
’v
.
	`FeExi¡s
(
dbÇme
));

1678 
	`ASSERT_OK
(
’v
.
	`G‘Chd»n
(
dbÇme
, &
chd»n
));

1679 
	`ASSERT_EQ
(0, 
chd»n
.
	`size
());

1680 
	`ASSERT_OK
(
	`De¡royDB
(
dbÇme
, 
İts
));

1681 
	`ASSERT_TRUE
(!
’v
.
	`FeExi¡s
(
dbÇme
));

1682 
	}
}

1684 
	$TEST
(
DBTe¡
, 
De¡royO³nDB
) {

1685 
¡d
::
¡ršg
 
dbÇme
 = 
‹¡
::
	`TmpDœ
() + "/open_db_dir";

1686 
’v_
->
	`D–‘eDœ
(
dbÇme
);

1687 
	`ASSERT_TRUE
(!
’v_
->
	`FeExi¡s
(
dbÇme
));

1689 
O±iÚs
 
İts
;

1690 
İts
.
ü—‹_if_missšg
 = 
Œue
;

1691 
DB
* 
db
 = 
nuÎ±r
;

1692 
	`ASSERT_OK
(
DB
::
	`O³n
(
İts
, 
dbÇme
, &
db
));

1693 
	`ASSERT_TRUE
(
db
 !ğ
nuÎ±r
);

1696 
	`ASSERT_TRUE
(
’v_
->
	`FeExi¡s
(
dbÇme
));

1697 
	`ASSERT_TRUE
(!
	`De¡royDB
(
dbÇme
, 
	`O±iÚs
()).
	`ok
());

1698 
	`ASSERT_TRUE
(
’v_
->
	`FeExi¡s
(
dbÇme
));

1700 
d–‘e
 
db
;

1701 
db
 = 
nuÎ±r
;

1704 
	`ASSERT_OK
(
	`De¡royDB
(
dbÇme
, 
	`O±iÚs
()));

1705 
	`ASSERT_TRUE
(!
’v_
->
	`FeExi¡s
(
dbÇme
));

1706 
	}
}

1708 
	$TEST
(
DBTe¡
, 
Lockšg
) {

1709 
DB
* 
db2
 = 
nuÎ±r
;

1710 
Stus
 
s
 = 
DB
::
	`O³n
(
	`Cu¼’tO±iÚs
(), 
dbÇme_
, &
db2
);

1711 
	`ASSERT_TRUE
(!
s
.
	`ok
()) << "Locking did‚ot…revent„e-opening db";

1712 
	}
}

1715 
	$TEST
(
DBTe¡
, 
NoS·û
) {

1716 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1717 
İtiÚs
.
’v
 = 
’v_
;

1718 
	`Reİ’
(&
İtiÚs
);

1720 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

1721 
	`ASSERT_EQ
("v1", 
	`G‘
("foo"));

1722 
	`Com·ù
("a", "z");

1723 cÚ¡ 
num_fes
 = 
	`CouÁFes
();

1725 
’v_
->
no_¥aû_
.
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1726 
i
 = 0; i < 10; i++) {

1727 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
 - 1;†evel++) {

1728 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(
Ëv–
, 
nuÎ±r
,‚ullptr);

1731 
’v_
->
no_¥aû_
.
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1732 
	`ASSERT_LT
(
	`CouÁFes
(), 
num_fes
 + 3);

1733 
	}
}

1735 
	$TEST
(
DBTe¡
, 
NÚWr™abËFeSy¡em
) {

1736 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1737 
İtiÚs
.
wr™e_bufãr_size
 = 1000;

1738 
İtiÚs
.
’v
 = 
’v_
;

1739 
	`Reİ’
(&
İtiÚs
);

1740 
	`ASSERT_OK
(
	`Put
("foo", "v1"));

1742 
’v_
->
nÚ_wr™abË_
.
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1743 
¡d
::
¡ršg
 
	`big
(100000, 'x');

1744 
”rÜs
 = 0;

1745 
i
 = 0; i < 20; i++) {

1746 
	`årštf
(
¡d”r
, "™” %d;ƒ¼Ü %d\n", 
i
, 
”rÜs
);

1747 ià(!
	`Put
("foo", 
big
).
	`ok
()) {

1748 
”rÜs
++;

1749 
	`D–ayMli£cÚds
(100);

1752 
	`ASSERT_GT
(
”rÜs
, 0);

1753 
’v_
->
nÚ_wr™abË_
.
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1754 
	}
}

1756 
	$TEST
(
DBTe¡
, 
Wr™eSyncE¼Ü
) {

1760 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1761 
İtiÚs
.
’v
 = 
’v_
;

1762 
	`Reİ’
(&
İtiÚs
);

1763 
’v_
->
d©a_sync_”rÜ_
.
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1766 
Wr™eO±iÚs
 
w
;

1767 
	`ASSERT_OK
(
db_
->
	`Put
(
w
, "k1", "v1"));

1768 
	`ASSERT_EQ
("v1", 
	`G‘
("k1"));

1771 
w
.
sync
 = 
Œue
;

1772 
	`ASSERT_TRUE
(!
db_
->
	`Put
(
w
, "k2", "v2").
	`ok
());

1773 
	`ASSERT_EQ
("v1", 
	`G‘
("k1"));

1774 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("k2"));

1777 
’v_
->
d©a_sync_”rÜ_
.
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1780 
w
.
sync
 = 
çl£
;

1781 
	`ASSERT_TRUE
(!
db_
->
	`Put
(
w
, "k3", "v3").
	`ok
());

1782 
	`ASSERT_EQ
("v1", 
	`G‘
("k1"));

1783 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("k2"));

1784 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("k3"));

1785 
	}
}

1787 
	$TEST
(
DBTe¡
, 
Mªiã¡Wr™eE¼Ü
) {

1796 
™”
 = 0; iter < 2; iter++) {

1797 
¡d
::
©omic
<
boŞ
>* 
”rÜ_ty³
 = (
™”
 =ğ0è? &
’v_
->
mªiã¡_sync_”rÜ_


1798 : &
’v_
->
mªiã¡_wr™e_”rÜ_
;

1801 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1802 
İtiÚs
.
’v
 = 
’v_
;

1803 
İtiÚs
.
ü—‹_if_missšg
 = 
Œue
;

1804 
İtiÚs
.
”rÜ_if_exi¡s
 = 
çl£
;

1805 
	`De¡royAndReİ’
(&
İtiÚs
);

1806 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

1807 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1810 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1811 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1812 cÚ¡ 
Ï¡
 = 
cÚfig
::
kMaxMemCom·ùLev–
;

1813 
	`ASSERT_EQ
(
	`NumTabËFesAtLev–
(
Ï¡
), 1);

1816 
”rÜ_ty³
->
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1817 
	`dbfuÎ
()->
	`TEST_Com·ùRªge
(
Ï¡
, 
nuÎ±r
,‚ullptr);

1818 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1821 
”rÜ_ty³
->
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1822 
	`Reİ’
(&
İtiÚs
);

1823 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1825 
	}
}

1827 
	$TEST
(
DBTe¡
, 
MissšgSSTFe
) {

1828 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

1829 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1832 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1833 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1835 
	`Clo£
();

1836 
	`ASSERT_TRUE
(
	`D–‘eAnSSTFe
());

1837 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1838 
İtiÚs
.
·¿noid_checks
 = 
Œue
;

1839 
Stus
 
s
 = 
	`TryReİ’
(&
İtiÚs
);

1840 
	`ASSERT_TRUE
(!
s
.
	`ok
());

1841 
	`ASSERT_TRUE
(
s
.
	`ToSŒšg
().
	`fšd
("issšg"è!ğ
¡d
::
¡ršg
::
Åos
) << s.ToString();

1842 
	}
}

1844 
	$TEST
(
DBTe¡
, 
StlR—dSST
) {

1845 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

1846 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1849 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1850 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1851 
	`Clo£
();

1852 
	`ASSERT_GT
(
	`R’ameLDBToSST
(), 0);

1853 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1854 
İtiÚs
.
·¿noid_checks
 = 
Œue
;

1855 
Stus
 
s
 = 
	`TryReİ’
(&
İtiÚs
);

1856 
	`ASSERT_TRUE
(
s
.
	`ok
());

1857 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

1858 
	}
}

1860 
	$TEST
(
DBTe¡
, 
FesD–‘edAá”Com·ùiÚ
) {

1861 
	`ASSERT_OK
(
	`Put
("foo", "v2"));

1862 
	`Com·ù
("a", "z");

1863 cÚ¡ 
num_fes
 = 
	`CouÁFes
();

1864 
i
 = 0; i < 10; i++) {

1865 
	`ASSERT_OK
(
	`Put
("foo", "v2"));

1866 
	`Com·ù
("a", "z");

1868 
	`ASSERT_EQ
(
	`CouÁFes
(), 
num_fes
);

1869 
	}
}

1871 
	$TEST
(
DBTe¡
, 
BloomF‹r
) {

1872 
’v_
->
couÁ_¿ndom_»ads_
 = 
Œue
;

1873 
O±iÚs
 
İtiÚs
 = 
	`Cu¼’tO±iÚs
();

1874 
İtiÚs
.
’v
 = 
’v_
;

1875 
İtiÚs
.
block_ÿche
 = 
	`NewLRUCache
(0);

1876 
İtiÚs
.
f‹r_pŞicy
 = 
	`NewBloomF‹rPŞicy
(10);

1877 
	`Reİ’
(&
İtiÚs
);

1880 cÚ¡ 
N
 = 10000;

1881 
i
 = 0; i < 
N
; i++) {

1882 
	`ASSERT_OK
(
	`Put
(
	`Key
(
i
), Key(i)));

1884 
	`Com·ù
("a", "z");

1885 
i
 = 0; i < 
N
; i += 100) {

1886 
	`ASSERT_OK
(
	`Put
(
	`Key
(
i
), Key(i)));

1888 
	`dbfuÎ
()->
	`TEST_Com·ùMemTabË
();

1891 
’v_
->
d–ay_d©a_sync_
.
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1894 
’v_
->
¿ndom_»ad_couÁ”_
.
	`Re£t
();

1895 
i
 = 0; i < 
N
; i++) {

1896 
	`ASSERT_EQ
(
	`Key
(
i
), 
	`G‘
(Key(i)));

1898 
»ads
 = 
’v_
->
¿ndom_»ad_couÁ”_
.
	`R—d
();

1899 
	`årštf
(
¡d”r
, "%d…»£Á => %d„—ds\n", 
N
, 
»ads
);

1900 
	`ASSERT_GE
(
»ads
, 
N
);

1901 
	`ASSERT_LE
(
»ads
, 
N
 + 2 * N / 100);

1904 
’v_
->
¿ndom_»ad_couÁ”_
.
	`Re£t
();

1905 
i
 = 0; i < 
N
; i++) {

1906 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
(
	`Key
(
i
) + ".missing"));

1908 
»ads
 = 
’v_
->
¿ndom_»ad_couÁ”_
.
	`R—d
();

1909 
	`årštf
(
¡d”r
, "%d missšg => %d„—ds\n", 
N
, 
»ads
);

1910 
	`ASSERT_LE
(
»ads
, 3 * 
N
 / 100);

1912 
’v_
->
d–ay_d©a_sync_
.
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1913 
	`Clo£
();

1914 
d–‘e
 
İtiÚs
.
block_ÿche
;

1915 
d–‘e
 
İtiÚs
.
f‹r_pŞicy
;

1916 
	}
}

1919 
	gÇme¥aû
 {

1921 cÚ¡ 
	gkNumTh»ads
 = 4;

1922 cÚ¡ 
	gkTe¡SecÚds
 = 10;

1923 cÚ¡ 
	gkNumKeys
 = 1000;

1925 
	sMTS‹
 {

1926 
DBTe¡
* 
	g‹¡
;

1927 
	g¡d
::
©omic
<
boŞ
> 
¡İ
;

1928 
	g¡d
::
©omic
<> 
couÁ”
[
kNumTh»ads
];

1929 
	g¡d
::
©omic
<
boŞ
> 
th»ad_dÚe
[
kNumTh»ads
];

1932 
	sMTTh»ad
 {

1933 
MTS‹
* 
	g¡©e
;

1934 
	gid
;

1937 
MTTh»adBody
(* 
¬g
) {

1938 
MTTh»ad
* 
	gt
 = 
»š‹½»t_ÿ¡
<MTTh»ad*>(
¬g
);

1939 
	gid
 = 
t
->
id
;

1940 
DB
* 
	gdb
 = 
t
->
¡©e
->
‹¡
->
db_
;

1941 
	gcouÁ”
 = 0;

1942 
årštf
(
¡d”r
, "... s¹šgh»ad %d\n", 
id
);

1943 
Rªdom
 
ºd
(1000 + 
id
);

1944 
	g¡d
::
¡ršg
 
v®ue
;

1945 
	gv®buf
[1500];

1946 !
	gt
->
	g¡©e
->
	g¡İ
.
lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

1947 
t
->
¡©e
->
couÁ”
[
id
].
¡Üe
(couÁ”, 
¡d
::
memÜy_Üd”_»Ëa£
);

1949 
	gkey
 = 
ºd
.
UnifÜm
(
kNumKeys
);

1950 
	gkeybuf
[20];

1951 
¢´štf
(
keybuf
, (keybuf), "%016d", 
key
);

1953 ià(
	gºd
.
OÃIn
(2)) {

1956 
¢´štf
(
v®buf
, (v®buf), "%d.%d.%-1000d", 
key
, 
id
,

1957 
¡©ic_ÿ¡
<>(
couÁ”
));

1958 
ASSERT_OK
(
db
->
Put
(
Wr™eO±iÚs
(), 
Sliû
(
keybuf
), Sliû(
v®buf
)));

1961 
Stus
 
	gs
 = 
db
->
G‘
(
R—dO±iÚs
(), 
Sliû
(
keybuf
), &
v®ue
);

1962 ià(
	gs
.
IsNÙFound
()) {

1966 
ASSERT_OK
(
s
);

1967 
	gk
, 
	gw
, 
	gc
;

1968 
ASSERT_EQ
(3, 
ssÿnf
(
v®ue
.
c_¡r
(), "%d.%d.%d", &
k
, &
w
, &
c
)è<< 
	gv®ue
;

1969 
ASSERT_EQ
(
k
, 
key
);

1970 
ASSERT_GE
(
w
, 0);

1971 
ASSERT_LT
(
w
, 
kNumTh»ads
);

1972 
ASSERT_LE
(
c
, 
t
->
¡©e
->
couÁ”
[
w
].
lßd
(
¡d
::
memÜy_Üd”_acquœe
));

1975 
	gcouÁ”
++;

1977 
	gt
->
	g¡©e
->
	gth»ad_dÚe
[
id
].
¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1978 
årštf
(
¡d”r
, "... stİpšgh»ad %d‡á” %d ops\n", 
id
, 
couÁ”
);

1983 
	$TEST
(
DBTe¡
, 
MuÉiTh»aded
) {

1986 
MTS‹
 
mt
;

1987 
mt
.
‹¡
 = 
this
;

1988 
mt
.
¡İ
.
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1989 
id
 = 0; id < 
kNumTh»ads
; id++) {

1990 
mt
.
couÁ”
[
id
].
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1991 
mt
.
th»ad_dÚe
[
id
].
	`¡Üe
(
çl£
, 
¡d
::
memÜy_Üd”_»Ëa£
);

1995 
MTTh»ad
 
th»ad
[
kNumTh»ads
];

1996 
id
 = 0; id < 
kNumTh»ads
; id++) {

1997 
th»ad
[
id
].
¡©e
 = &
mt
;

1998 
th»ad
[
id
].id = id;

1999 
’v_
->
	`S¹Th»ad
(
MTTh»adBody
, &
th»ad
[
id
]);

2003 
	`D–ayMli£cÚds
(
kTe¡SecÚds
 * 1000);

2006 
mt
.
¡İ
.
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

2007 
id
 = 0; id < 
kNumTh»ads
; id++) {

2008 !
mt
.
th»ad_dÚe
[
id
].
	`lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

2009 
	`D–ayMli£cÚds
(100);

2012 } 
	`ChªgeO±iÚs
());

2013 
	}
}

2015 
	gÇme¥aû
 {

2016 
	g¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, std::¡ršg> 
	tKVM­
;

2019 şas 
	cMod–DB
 : 
public
 
DB
 {

2020 
public
:

2021 şas 
	cMod–SÇpshÙ
 : 
public
 
SÇpshÙ
 {

2022 
public
:

2023 
KVM­
 
m­_
;

2026 
ex¶ic™
 
Mod–DB
(cÚ¡ 
O±iÚs
& 
İtiÚs
è: 
İtiÚs_
(options) {}

2027 ~
Mod–DB
() {}

2028 
vœtu®
 
Stus
 
Put
(cÚ¡ 
Wr™eO±iÚs
& 
o
, cÚ¡ 
Sliû
& 
k
, cÚ¡ Sliû& 
v
) {

2029  
	gDB
::
Put
(
o
, 
k
, 
v
);

2031 
vœtu®
 
Stus
 
D–‘e
(cÚ¡ 
Wr™eO±iÚs
& 
o
, cÚ¡ 
Sliû
& 
key
) {

2032  
	gDB
::
D–‘e
(
o
, 
key
);

2034 
vœtu®
 
Stus
 
G‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
key
,

2035 
¡d
::
¡ršg
* 
v®ue
) {

2036 
as£¹
(
çl£
);

2037  
	gStus
::
NÙFound
(
key
);

2039 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
) {

2040 ià(
	gİtiÚs
.
	g¢­shÙ
 =ğ
nuÎ±r
) {

2041 
KVM­
* 
§ved
 = 
Ãw
 KVMap;

2042 *
	g§ved
 = 
m­_
;

2043  
Ãw
 
Mod–I‹r
(
§ved
, 
Œue
);

2045 cÚ¡ 
KVM­
* 
	g¢­shÙ_¡©e
 =

2046 &(
»š‹½»t_ÿ¡
<cÚ¡ 
Mod–SÇpshÙ
*>(
İtiÚs
.
¢­shÙ
)->
m­_
);

2047  
Ãw
 
Mod–I‹r
(
¢­shÙ_¡©e
, 
çl£
);

2050 
vœtu®
 cÚ¡ 
SÇpshÙ
* 
G‘SÇpshÙ
() {

2051 
Mod–SÇpshÙ
* 
	g¢­shÙ
 = 
Ãw
 ModelSnapshot;

2052 
	g¢­shÙ
->
	gm­_
 = 
m­_
;

2053  
	g¢­shÙ
;

2056 
vœtu®
 
R–—£SÇpshÙ
(cÚ¡ 
SÇpshÙ
* 
¢­shÙ
) {

2057 
d–‘e
 
	g»š‹½»t_ÿ¡
<cÚ¡ 
	gMod–SÇpshÙ
*>(
	g¢­shÙ
);

2059 
vœtu®
 
Stus
 
Wr™e
(cÚ¡ 
Wr™eO±iÚs
& 
İtiÚs
, 
Wr™eB©ch
* 
b©ch
) {

2060 şas 
	cHªdËr
 : 
public
 
Wr™eB©ch
::
HªdËr
 {

2061 
public
:

2062 
KVM­
* 
m­_
;

2063 
vœtu®
 
Put
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

2064 (*
	gm­_
)[
key
.
ToSŒšg
()] = 
v®ue
.ToString();

2066 
vœtu®
 
D–‘e
(cÚ¡ 
Sliû
& 
key
è{ 
	gm­_
->
”a£
(key.
ToSŒšg
()); }

2068 
HªdËr
 
	ghªdËr
;

2069 
	ghªdËr
.
	gm­_
 = &
m­_
;

2070  
	gb©ch
->
I‹¿‹
(&
hªdËr
);

2073 
vœtu®
 
boŞ
 
G‘Prİ”ty
(cÚ¡ 
Sliû
& 
´İ”ty
, 
¡d
::
¡ršg
* 
v®ue
) {

2074  
çl£
;

2076 
vœtu®
 
G‘Aµroxim©eSizes
(cÚ¡ 
Rªge
* 
r
, 
n
, 
ušt64_t
* 
sizes
) {

2077 
	gi
 = 0; i < 
	gn
; i++) {

2078 
	gsizes
[
i
] = 0;

2081 
vœtu®
 
Com·ùRªge
(cÚ¡ 
Sliû
* 
¡¬t
, cÚ¡ Sliû* 
’d
) {}

2083 
	g´iv©e
:

2084 şas 
	cMod–I‹r
 : 
public
 
I‹¿tÜ
 {

2085 
public
:

2086 
Mod–I‹r
(cÚ¡ 
KVM­
* 
m­
, 
boŞ
 
owÃd
)

2087 : 
m­_
(
m­
), 
owÃd_
(
owÃd
), 
™”_
(m­_->
’d
()) {}

2088 ~
Mod–I‹r
() {

2089 ià(
	gowÃd_
è
d–‘e
 
	gm­_
;

2091 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  
	g™”_
 !ğ
m­_
->
’d
(); }

2092 
vœtu®
 
S“kToFœ¡
(è{ 
	g™”_
 = 
m­_
->
begš
(); }

2093 
vœtu®
 
S“kToLa¡
() {

2094 ià(
	gm­_
->
em±y
()) {

2095 
	g™”_
 = 
m­_
->
’d
();

2097 
	g™”_
 = 
m­_
->
fšd
(m­_->
rbegš
()->
fœ¡
);

2100 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
k
) {

2101 
	g™”_
 = 
m­_
->
low”_bound
(
k
.
ToSŒšg
());

2103 
vœtu®
 
Next
(è{ ++
	g™”_
; }

2104 
vœtu®
 
P»v
(è{ --
	g™”_
; }

2105 
vœtu®
 
Sliû
 
key
(ècÚ¡ {  
	g™”_
->
	gfœ¡
; }

2106 
vœtu®
 
Sliû
 
v®ue
(ècÚ¡ {  
	g™”_
->
	g£cÚd
; }

2107 
vœtu®
 
Stus
 
¡©us
(ècÚ¡ {  
	gStus
::
OK
(); }

2109 
	g´iv©e
:

2110 cÚ¡ 
KVM­
* cÚ¡ 
m­_
;

2111 cÚ¡ 
boŞ
 
	gowÃd_
;

2112 
	gKVM­
::
cÚ¡_™”©Ü
 
™”_
;

2114 cÚ¡ 
O±iÚs
 
	gİtiÚs_
;

2115 
KVM­
 
	gm­_
;

2118 
boŞ
 
	$Com·»I‹¿tÜs
(
¡•
, 
DB
* 
mod–
, DB* 
db
,

2119 cÚ¡ 
SÇpshÙ
* 
mod–_¢­
,

2120 cÚ¡ 
SÇpshÙ
* 
db_¢­
) {

2121 
R—dO±iÚs
 
İtiÚs
;

2122 
İtiÚs
.
¢­shÙ
 = 
mod–_¢­
;

2123 
I‹¿tÜ
* 
m™”
 = 
mod–
->
	`NewI‹¿tÜ
(
İtiÚs
);

2124 
İtiÚs
.
¢­shÙ
 = 
db_¢­
;

2125 
I‹¿tÜ
* 
db™”
 = 
db
->
	`NewI‹¿tÜ
(
İtiÚs
);

2126 
boŞ
 
ok
 = 
Œue
;

2127 
couÁ
 = 0;

2128 
m™”
->
	`S“kToFœ¡
(), 
db™”
->SeekToFirst();

2129 
ok
 && 
m™”
->
	`V®id
(è&& 
db™”
->V®id(); m™”->
	`Next
(), dbiter->Next()) {

2130 
couÁ
++;

2131 ià(
m™”
->
	`key
().
	`com·»
(
db™”
->key()) != 0) {

2132 
	`årštf
(
¡d”r
, "¡• %d: Key mism©ch: '%s' vs. '%s'\n", 
¡•
,

2133 
	`Esÿ³SŒšg
(
m™”
->
	`key
()).
	`c_¡r
(),

2134 
	`Esÿ³SŒšg
(
db™”
->
	`key
()).
	`c_¡r
());

2135 
ok
 = 
çl£
;

2139 ià(
m™”
->
	`v®ue
().
	`com·»
(
db™”
->value()) != 0) {

2140 
	`årštf
(
¡d”r
, "step %d: Value mismatch for key '%s': '%s' vs. '%s'\n",

2141 
¡•
, 
	`Esÿ³SŒšg
(
m™”
->
	`key
()).
	`c_¡r
(),

2142 
	`Esÿ³SŒšg
(
m™”
->
	`v®ue
()).
	`c_¡r
(),

2143 
	`Esÿ³SŒšg
(
m™”
->
	`v®ue
()).
	`c_¡r
());

2144 
ok
 = 
çl£
;

2148 ià(
ok
) {

2149 ià(
m™”
->
	`V®id
(è!ğ
db™”
->Valid()) {

2150 
	`årštf
(
¡d”r
, "step %d: Mismatch‡tƒnd of iterators: %d vs. %d\n",

2151 
¡•
, 
m™”
->
	`V®id
(), 
db™”
->Valid());

2152 
ok
 = 
çl£
;

2155 
	`årštf
(
¡d”r
, "%dƒÁr› com·»d: ok=%d\n", 
couÁ
, 
ok
);

2156 
d–‘e
 
m™”
;

2157 
d–‘e
 
db™”
;

2158  
ok
;

2159 
	}
}

2161 
	$TEST
(
DBTe¡
, 
Rªdomized
) {

2162 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
());

2164 
Mod–DB
 
	`mod–
(
	`Cu¼’tO±iÚs
());

2165 cÚ¡ 
N
 = 10000;

2166 cÚ¡ 
SÇpshÙ
* 
mod–_¢­
 = 
nuÎ±r
;

2167 cÚ¡ 
SÇpshÙ
* 
db_¢­
 = 
nuÎ±r
;

2168 
¡d
::
¡ršg
 
k
, 
v
;

2169 
¡•
 = 0; s‹°< 
N
; step++) {

2170 ià(
¡•
 % 100 == 0) {

2171 
	`årštf
(
¡d”r
, "S‹°%d oà%d\n", 
¡•
, 
N
);

2174 
p
 = 
ºd
.
	`UnifÜm
(100);

2175 ià(
p
 < 45) {

2176 
k
 = 
	`RªdomKey
(&
ºd
);

2177 
v
 = 
	`RªdomSŒšg
(

2178 &
ºd
,„nd.
	`OÃIn
(20è? 100 +„nd.
	`UnifÜm
(100) :„nd.Uniform(8));

2179 
	`ASSERT_OK
(
mod–
.
	`Put
(
	`Wr™eO±iÚs
(), 
k
, 
v
));

2180 
	`ASSERT_OK
(
db_
->
	`Put
(
	`Wr™eO±iÚs
(), 
k
, 
v
));

2182 } ià(
p
 < 90) {

2183 
k
 = 
	`RªdomKey
(&
ºd
);

2184 
	`ASSERT_OK
(
mod–
.
	`D–‘e
(
	`Wr™eO±iÚs
(), 
k
));

2185 
	`ASSERT_OK
(
db_
->
	`D–‘e
(
	`Wr™eO±iÚs
(), 
k
));

2188 
Wr™eB©ch
 
b
;

2189 cÚ¡ 
num
 = 
ºd
.
	`UnifÜm
(8);

2190 
i
 = 0; i < 
num
; i++) {

2191 ià(
i
 =ğ0 || !
ºd
.
	`OÃIn
(10)) {

2192 
k
 = 
	`RªdomKey
(&
ºd
);

2197 ià(
ºd
.
	`OÃIn
(2)) {

2198 
v
 = 
	`RªdomSŒšg
(&
ºd
,„nd.
	`UnifÜm
(10));

2199 
b
.
	`Put
(
k
, 
v
);

2201 
b
.
	`D–‘e
(
k
);

2204 
	`ASSERT_OK
(
mod–
.
	`Wr™e
(
	`Wr™eO±iÚs
(), &
b
));

2205 
	`ASSERT_OK
(
db_
->
	`Wr™e
(
	`Wr™eO±iÚs
(), &
b
));

2208 ià((
¡•
 % 100) == 0) {

2209 
	`ASSERT_TRUE
(
	`Com·»I‹¿tÜs
(
¡•
, &
mod–
, 
db_
, 
nuÎ±r
,‚ullptr));

2210 
	`ASSERT_TRUE
(
	`Com·»I‹¿tÜs
(
¡•
, &
mod–
, 
db_
, 
mod–_¢­
, 
db_¢­
));

2214 ià(
mod–_¢­
 !ğ
nuÎ±r
è
mod–
.
	`R–—£SÇpshÙ
(model_snap);

2215 ià(
db_¢­
 !ğ
nuÎ±r
è
db_
->
	`R–—£SÇpshÙ
(db_snap);

2217 
	`Reİ’
();

2218 
	`ASSERT_TRUE
(
	`Com·»I‹¿tÜs
(
¡•
, &
mod–
, 
db_
, 
nuÎ±r
,‚ullptr));

2220 
mod–_¢­
 = 
mod–
.
	`G‘SÇpshÙ
();

2221 
db_¢­
 = 
db_
->
	`G‘SÇpshÙ
();

2224 ià(
mod–_¢­
 !ğ
nuÎ±r
è
mod–
.
	`R–—£SÇpshÙ
(model_snap);

2225 ià(
db_¢­
 !ğ
nuÎ±r
è
db_
->
	`R–—£SÇpshÙ
(db_snap);

2226 } 
	`ChªgeO±iÚs
());

2227 
	}
}

2229 
	g¡d
::
¡ršg
 
	$MakeKey
(
num
) {

2230 
buf
[30];

2231 
	`¢´štf
(
buf
, (buf), "%016u", 
num
);

2232  
¡d
::
	`¡ršg
(
buf
);

2233 
	}
}

2235 
	$BM_LogAndAµly
(
™”s
, 
num_ba£_fes
) {

2236 
¡d
::
¡ršg
 
dbÇme
 = 
‹¡
::
	`TmpDœ
() + "/leveldb_test_benchmark";

2237 
	`De¡royDB
(
dbÇme
, 
	`O±iÚs
());

2239 
DB
* 
db
 = 
nuÎ±r
;

2240 
O±iÚs
 
İts
;

2241 
İts
.
ü—‹_if_missšg
 = 
Œue
;

2242 
Stus
 
s
 = 
DB
::
	`O³n
(
İts
, 
dbÇme
, &
db
);

2243 
	`ASSERT_OK
(
s
);

2244 
	`ASSERT_TRUE
(
db
 !ğ
nuÎ±r
);

2246 
d–‘e
 
db
;

2247 
db
 = 
nuÎ±r
;

2249 
Env
* 
’v
 = Env::
	`DeçuÉ
();

2251 
pÜt
::
Mu‹x
 
mu
;

2252 
Mu‹xLock
 
	`l
(&
mu
);

2254 
IÁ”ÇlKeyCom·¿tÜ
 
	`cmp
(
	`By‹wi£Com·¿tÜ
());

2255 
O±iÚs
 
İtiÚs
;

2256 
V”siÚS‘
 
	`v£t
(
dbÇme
, &
İtiÚs
, 
nuÎ±r
, &
cmp
);

2257 
boŞ
 
§ve_mªiã¡
;

2258 
	`ASSERT_OK
(
v£t
.
	`Recov”
(&
§ve_mªiã¡
));

2259 
V”siÚEd™
 
vba£
;

2260 
ušt64_t
 
âum
 = 1;

2261 
i
 = 0; i < 
num_ba£_fes
; i++) {

2262 
IÁ”ÇlKey
 
	`¡¬t
(
	`MakeKey
(2 * 
âum
), 1, 
kTy³V®ue
);

2263 
IÁ”ÇlKey
 
	`lim™
(
	`MakeKey
(2 * 
âum
 + 1), 1, 
kTy³D–‘iÚ
);

2264 
vba£
.
	`AddFe
(2, 
âum
++, 1 , 
¡¬t
, 
lim™
,0);

2266 
	`ASSERT_OK
(
v£t
.
	`LogAndAµly
(&
vba£
, &
mu
));

2268 
ušt64_t
 
¡¬t_miüos
 = 
’v
->
	`NowMiüos
();

2270 
i
 = 0; i < 
™”s
; i++) {

2271 
V”siÚEd™
 
ved™
;

2272 
ved™
.
	`D–‘eFe
(2, 
âum
);

2273 
IÁ”ÇlKey
 
	`¡¬t
(
	`MakeKey
(2 * 
âum
), 1, 
kTy³V®ue
);

2274 
IÁ”ÇlKey
 
	`lim™
(
	`MakeKey
(2 * 
âum
 + 1), 1, 
kTy³D–‘iÚ
);

2275 
ved™
.
	`AddFe
(2, 
âum
++, 1 , 
¡¬t
, 
lim™
,0);

2276 
v£t
.
	`LogAndAµly
(&
ved™
, &
mu
);

2278 
ušt64_t
 
¡İ_miüos
 = 
’v
->
	`NowMiüos
();

2279 
us
 = 
¡İ_miüos
 - 
¡¬t_miüos
;

2280 
buf
[16];

2281 
	`¢´štf
(
buf
, (buf), "%d", 
num_ba£_fes
);

2282 
	`årštf
(
¡d”r
,

2283 "BM_LogAndAµly/%-6  %8d i‹r : %9u u (%7.0àu / i‹r)\n", 
buf
,

2284 
™”s
, 
us
, (()us) / iters);

2285 
	}
}

2289 
	$maš
(
¬gc
, ** 
¬gv
) {

2290 ià(
¬gc
 > 1 && 
¡d
::
	`¡ršg
(
¬gv
[1]) == "--benchmark") {

2291 
Ëv–db
::
	`BM_LogAndAµly
(1000, 1);

2292 
Ëv–db
::
	`BM_LogAndAµly
(1000, 100);

2293 
Ëv–db
::
	`BM_LogAndAµly
(1000, 10000);

2294 
Ëv–db
::
	`BM_LogAndAµly
(100, 100000);

2298  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
();

2299 
	}
}

	@db/dbformat.cc

5 
	~"db/dbfÜm©.h
"

7 
	~<¡dio.h
>

9 
	~"pÜt/pÜt.h
"

10 
	~"ut/codšg.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 
ušt64_t
 
PackSequ’ûAndTy³
(ušt64_ˆ
£q
, 
V®ueTy³
 
t
) {

15 
as£¹
(
£q
 <ğ
kMaxSequ’ûNumb”
);

16 
as£¹
(
t
 <ğ
kV®ueTy³FÜS“k
);

17  (
	g£q
 << 8è| 
	gt
;

20 
Aµ’dIÁ”ÇlKey
(
¡d
::
¡ršg
* 
»suÉ
, cÚ¡ 
P¬£dIÁ”ÇlKey
& 
key
) {

21 
	g»suÉ
->
­³nd
(
key
.
u£r_key
.
d©a
(), key.u£r_key.
size
());

22 
PutFixed64
(
»suÉ
, 
PackSequ’ûAndTy³
(
key
.
£qu’û
, key.
ty³
));

25 
	g¡d
::
¡ršg
 
P¬£dIÁ”ÇlKey
::
DebugSŒšg
() const {

26 
buf
[50];

27 
¢´štf
(
buf
, (buf), "' @ %Îu : %d", ()
£qu’û
,

28 (
ty³
));

29 
	g¡d
::
¡ršg
 
»suÉ
 = "'";

30 
	g»suÉ
 +ğ
Esÿ³SŒšg
(
u£r_key
.
ToSŒšg
());

31 
	g»suÉ
 +ğ
buf
;

32  
	g»suÉ
;

35 
	g¡d
::
¡ršg
 
IÁ”ÇlKey
::
DebugSŒšg
() const {

36 
¡d
::
¡ršg
 
»suÉ
;

37 
P¬£dIÁ”ÇlKey
 
	g·r£d
;

38 ià(
P¬£IÁ”ÇlKey
(
»p_
, &
·r£d
)) {

39 
	g»suÉ
 = 
·r£d
.
DebugSŒšg
();

41 
	g»suÉ
 = "(bad)";

42 
	g»suÉ
.
­³nd
(
Esÿ³SŒšg
(
»p_
));

44  
	g»suÉ
;

47 cÚ¡ * 
	gIÁ”ÇlKeyCom·¿tÜ
::
Name
() const {

51 
	gIÁ”ÇlKeyCom·¿tÜ
::
Com·»
(cÚ¡ 
Sliû
& 
akey
, cÚ¡ Sliû& 
bkey
) const {

56 
	gr
 = 
u£r_com·¿tÜ_
->
Com·»
(
ExŒaùU£rKey
(
akey
), ExŒaùU£rKey(
bkey
));

57 ià(
	gr
 == 0) {

58 cÚ¡ 
ušt64_t
 
ªum
 = 
DecodeFixed64
(
akey
.
d©a
(è+‡key.
size
() - 8);

59 cÚ¡ 
ušt64_t
 
	gbnum
 = 
DecodeFixed64
(
bkey
.
d©a
(è+ bkey.
size
() - 8);

60 ià(
	gªum
 > 
	gbnum
) {

61 
	gr
 = -1;

62 } ià(
	gªum
 < 
	gbnum
) {

63 
	gr
 = +1;

66  
	gr
;

69 
	gIÁ”ÇlKeyCom·¿tÜ
::
FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
* 
¡¬t
,

70 cÚ¡ 
Sliû
& 
lim™
) const {

72 
Sliû
 
	gu£r_¡¬t
 = 
ExŒaùU£rKey
(*
¡¬t
);

73 
Sliû
 
	gu£r_lim™
 = 
ExŒaùU£rKey
(
lim™
);

74 
	g¡d
::
¡ršg
 
tmp
(
u£r_¡¬t
.
d©a
(), u£r_¡¬t.
size
());

75 
	gu£r_com·¿tÜ_
->
FšdShÜ‹¡S•¬©Ü
(&
tmp
, 
u£r_lim™
);

76 ià(
	gtmp
.
size
(è< 
	gu£r_¡¬t
.size() &&

77 
	gu£r_com·¿tÜ_
->
Com·»
(
u£r_¡¬t
, 
tmp
) < 0) {

80 
PutFixed64
(&
tmp
,

81 
PackSequ’ûAndTy³
(
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
));

82 
as£¹
(
this
->
Com·»
(*
¡¬t
, 
tmp
) < 0);

83 
as£¹
(
this
->
Com·»
(
tmp
, 
lim™
) < 0);

84 
	g¡¬t
->
sw­
(
tmp
);

88 
	gIÁ”ÇlKeyCom·¿tÜ
::
FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const {

89 
Sliû
 
u£r_key
 = 
ExŒaùU£rKey
(*
key
);

90 
	g¡d
::
¡ršg
 
tmp
(
u£r_key
.
d©a
(), u£r_key.
size
());

91 
	gu£r_com·¿tÜ_
->
FšdShÜtSucûssÜ
(&
tmp
);

92 ià(
	gtmp
.
size
(è< 
	gu£r_key
.size() &&

93 
	gu£r_com·¿tÜ_
->
Com·»
(
u£r_key
, 
tmp
) < 0) {

96 
PutFixed64
(&
tmp
,

97 
PackSequ’ûAndTy³
(
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
));

98 
as£¹
(
this
->
Com·»
(*
key
, 
tmp
) < 0);

99 
	gkey
->
sw­
(
tmp
);

103 cÚ¡ * 
	gIÁ”ÇlF‹rPŞicy
::
Name
(ècÚ¡ {  
u£r_pŞicy_
->Name(); }

105 
	gIÁ”ÇlF‹rPŞicy
::
C»©eF‹r
(cÚ¡ 
Sliû
* 
keys
, 
n
,

106 
¡d
::
¡ršg
* 
d¡
) const {

109 
Sliû
* 
mkey
 = 
cÚ¡_ÿ¡
<Sliû*>(
keys
);

110 
	gi
 = 0; i < 
	gn
; i++) {

111 
	gmkey
[
i
] = 
ExŒaùU£rKey
(
keys
[i]);

114 
	gu£r_pŞicy_
->
C»©eF‹r
(
keys
, 
n
, 
d¡
);

117 
boŞ
 
	gIÁ”ÇlF‹rPŞicy
::
KeyMayM©ch
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
f
) const {

118  
	gu£r_pŞicy_
->
KeyMayM©ch
(
ExŒaùU£rKey
(
key
), 
f
);

121 
	gLookupKey
::
LookupKey
(cÚ¡ 
Sliû
& 
u£r_key
, 
Sequ’ûNumb”
 
s
) {

122 
size_t
 
	gusize
 = 
u£r_key
.
size
();

123 
size_t
 
	gÃeded
 = 
usize
 + 13;

124 * 
	gd¡
;

125 ià(
	gÃeded
 <ğ(
¥aû_
)) {

126 
d¡
 = 
¥aû_
;

128 
	gd¡
 = 
Ãw
 [
Ãeded
];

130 
	g¡¬t_
 = 
d¡
;

131 
	gd¡
 = 
EncodeV¬št32
(
d¡
, 
usize
 + 8);

132 
	gk¡¬t_
 = 
d¡
;

133 
memıy
(
d¡
, 
u£r_key
.
d©a
(), 
usize
);

134 
	gd¡
 +ğ
usize
;

135 
EncodeFixed64
(
d¡
, 
PackSequ’ûAndTy³
(
s
, 
kV®ueTy³FÜS“k
));

136 
	gd¡
 += 8;

137 
	g’d_
 = 
d¡
;

	@db/dbformat.h

5 #iâdeà
STORAGE_LEVELDB_DB_DBFORMAT_H_


6 
	#STORAGE_LEVELDB_DB_DBFORMAT_H_


	)

8 
	~<¡dio.h
>

10 
	~"Ëv–db/com·¿tÜ.h
"

11 
	~"Ëv–db/db.h
"

12 
	~"Ëv–db/f‹r_pŞicy.h
"

13 
	~"Ëv–db/¦iû.h
"

14 
	~"Ëv–db/bË_bud”.h
"

15 
	~"ut/codšg.h
"

16 
	~"ut/loggšg.h
"

18 
Çme¥aû
 
	gËv–db
 {

22 
Çme¥aû
 
	gcÚfig
 {

23 cÚ¡ 
	gkNumLev–s
 = 7;

26 cÚ¡ 
	gkL0_Com·ùiÚTrigg”
 = 4;

29 cÚ¡ 
	gkL0_SlowdownWr™esTrigg”
 = 8;

32 cÚ¡ 
	gkL0_StİWr™esTrigg”
 = 12;

40 cÚ¡ 
	gkMaxMemCom·ùLev–
 = 2;

43 cÚ¡ 
	gkR—dBy‹sP”iod
 = 1048576;

47 
şass
 
	gIÁ”ÇlKey
;

52 
	eV®ueTy³
 { 
	gkTy³D–‘iÚ
 = 0x0, 
	gkTy³V®ue
 = 0x1 };

59 cÚ¡ 
V®ueTy³
 
	gkV®ueTy³FÜS“k
 = 
kTy³V®ue
;

61 
ušt64_t
 
	tSequ’ûNumb”
;

65 cÚ¡ 
Sequ’ûNumb”
 
	gkMaxSequ’ûNumb”
 = ((0x1ull << 56) - 1);

67 
	sP¬£dIÁ”ÇlKey
 {

68 
Sliû
 
	gu£r_key
;

69 
Sequ’ûNumb”
 
	g£qu’û
;

70 
V®ueTy³
 
	gty³
;

72 
P¬£dIÁ”ÇlKey
() {}

73 
P¬£dIÁ”ÇlKey
(cÚ¡ 
Sliû
& 
u
, cÚ¡ 
Sequ’ûNumb”
& 
£q
, 
V®ueTy³
 
t
)

74 : 
u£r_key
(
u
), 
£qu’û
(
£q
), 
ty³
(
t
) {}

75 
	g¡d
::
¡ršg
 
DebugSŒšg
() const;

79 
šlše
 
size_t
 
IÁ”ÇlKeyEncodšgL’gth
(cÚ¡ 
P¬£dIÁ”ÇlKey
& 
key
) {

80  
	gkey
.
	gu£r_key
.
size
() + 8;

84 
Aµ’dIÁ”ÇlKey
(
¡d
::
¡ršg
* 
»suÉ
, cÚ¡ 
P¬£dIÁ”ÇlKey
& 
key
);

90 
boŞ
 
P¬£IÁ”ÇlKey
(cÚ¡ 
Sliû
& 
š‹º®_key
, 
P¬£dIÁ”ÇlKey
* 
»suÉ
);

93 
šlše
 
Sliû
 
ExŒaùU£rKey
(cÚ¡ Sliû& 
š‹º®_key
) {

94 
as£¹
(
š‹º®_key
.
size
() >= 8);

95  
Sliû
(
š‹º®_key
.
d©a
(), iÁ”Çl_key.
size
() - 8);

100 şas 
	cIÁ”ÇlKeyCom·¿tÜ
 : 
public
 
Com·¿tÜ
 {

101 
´iv©e
:

102 cÚ¡ 
Com·¿tÜ
* 
u£r_com·¿tÜ_
;

104 
	gpublic
:

105 
ex¶ic™
 
IÁ”ÇlKeyCom·¿tÜ
(cÚ¡ 
Com·¿tÜ
* 
c
è: 
u£r_com·¿tÜ_
(c) {}

106 
vœtu®
 cÚ¡ * 
Name
() const;

107 
vœtu®
 
Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const;

108 
vœtu®
 
FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
* 
¡¬t
,

109 cÚ¡ 
Sliû
& 
lim™
) const;

110 
vœtu®
 
FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const;

112 cÚ¡ 
Com·¿tÜ
* 
u£r_com·¿tÜ
(ècÚ¡ {  
	gu£r_com·¿tÜ_
; }

114 
Com·»
(cÚ¡ 
IÁ”ÇlKey
& 
a
, cÚ¡ IÁ”ÇlKey& 
b
) const;

118 şas 
	cIÁ”ÇlF‹rPŞicy
 : 
public
 
F‹rPŞicy
 {

119 
´iv©e
:

120 cÚ¡ 
F‹rPŞicy
* cÚ¡ 
u£r_pŞicy_
;

122 
	gpublic
:

123 
ex¶ic™
 
IÁ”ÇlF‹rPŞicy
(cÚ¡ 
F‹rPŞicy
* 
p
è: 
u£r_pŞicy_
(p) {}

124 
vœtu®
 cÚ¡ * 
Name
() const;

125 
vœtu®
 
C»©eF‹r
(cÚ¡ 
Sliû
* 
keys
, 
n
, 
¡d
::
¡ršg
* 
d¡
) const;

126 
vœtu®
 
boŞ
 
KeyMayM©ch
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
f‹r
) const;

132 şas 
	cIÁ”ÇlKey
 {

133 
	g´iv©e
:

134 
¡d
::
¡ršg
 
»p_
;

136 
	gpublic
:

137 
IÁ”ÇlKey
() {}

138 
IÁ”ÇlKey
(cÚ¡ 
Sliû
& 
u£r_key
, 
Sequ’ûNumb”
 
s
, 
V®ueTy³
 
t
) {

139 
Aµ’dIÁ”ÇlKey
(&
»p_
, 
P¬£dIÁ”ÇlKey
(
u£r_key
, 
s
, 
t
));

142 
DecodeFrom
(cÚ¡ 
Sliû
& 
s
è{ 
	g»p_
.
assign
(s.
d©a
(), s.
size
()); }

143 
Sliû
 
Encode
() const {

144 
as£¹
(!
»p_
.
em±y
());

145  
	g»p_
;

148 
Sliû
 
u£r_key
(ècÚ¡ {  
ExŒaùU£rKey
(
»p_
); }

150 
S‘From
(cÚ¡ 
P¬£dIÁ”ÇlKey
& 
p
) {

151 
	g»p_
.
ş—r
();

152 
Aµ’dIÁ”ÇlKey
(&
»p_
, 
p
);

155 
CË¬
(è{ 
	g»p_
.
ş—r
(); }

157 
	g¡d
::
¡ršg
 
DebugSŒšg
() const;

160 
šlše
 
	gIÁ”ÇlKeyCom·¿tÜ
::
	$Com·»
(cÚ¡ 
IÁ”ÇlKey
& 
a
,

161 cÚ¡ 
IÁ”ÇlKey
& 
b
) const {

162  
	`Com·»
(
a
.
	`Encode
(), 
b
.Encode());

163 
	}
}

165 
šlše
 
boŞ
 
	$P¬£IÁ”ÇlKey
(cÚ¡ 
Sliû
& 
š‹º®_key
,

166 
P¬£dIÁ”ÇlKey
* 
»suÉ
) {

167 cÚ¡ 
size_t
 
n
 = 
š‹º®_key
.
	`size
();

168 ià(
n
 < 8è 
çl£
;

169 
ušt64_t
 
num
 = 
	`DecodeFixed64
(
š‹º®_key
.
	`d©a
(è+ 
n
 - 8);

170 
c
 = 
num
 & 0xff;

171 
»suÉ
->
£qu’û
 = 
num
 >> 8;

172 
»suÉ
->
ty³
 = 
¡©ic_ÿ¡
<
V®ueTy³
>(
c
);

173 
»suÉ
->
u£r_key
 = 
	`Sliû
(
š‹º®_key
.
	`d©a
(), 
n
 - 8);

174  (
c
 <ğ
¡©ic_ÿ¡
<>(
kTy³V®ue
));

175 
	}
}

178 şas 
	cLookupKey
 {

179 
	gpublic
:

182 
LookupKey
(cÚ¡ 
Sliû
& 
u£r_key
, 
Sequ’ûNumb”
 
£qu’û
);

184 
LookupKey
(cÚ¡ LookupKey&èğ
d–‘e
;

185 
	gLookupKey
& 
	gİ”©Ü
=(cÚ¡ 
LookupKey
&èğ
d–‘e
;

187 ~
LookupKey
();

190 
Sliû
 
membË_key
(ècÚ¡ {  Sliû(
¡¬t_
, 
’d_
 - start_); }

193 
Sliû
 
š‹º®_key
(ècÚ¡ {  Sliû(
k¡¬t_
, 
’d_
 - kstart_); }

196 
Sliû
 
u£r_key
(ècÚ¡ {  Sliû(
k¡¬t_
, 
’d_
 - kstart_ - 8); }

198 
	g´iv©e
:

206 cÚ¡ * 
¡¬t_
;

207 cÚ¡ * 
	gk¡¬t_
;

208 cÚ¡ * 
	g’d_
;

209 
	g¥aû_
[200];

212 
šlše
 
	gLookupKey
::~
	$LookupKey
() {

213 ià(
¡¬t_
 !ğ
¥aû_
è
d–‘e
[] start_;

214 
	}
}

	@db/dbformat_test.cc

5 
	~"db/dbfÜm©.h
"

6 
	~"ut/loggšg.h
"

7 
	~"ut/‹¡h¬Ãss.h
"

9 
Çme¥aû
 
	gËv–db
 {

11 
	g¡d
::
¡ršg
 
IKey
(cÚ¡ 
¡d
::¡ršg& 
u£r_key
, 
ušt64_t
 
£q
,

12 
V®ueTy³
 
vt
) {

13 
	g¡d
::
¡ršg
 
’coded
;

14 
Aµ’dIÁ”ÇlKey
(&
’coded
, 
P¬£dIÁ”ÇlKey
(
u£r_key
, 
£q
, 
vt
));

15  
	g’coded
;

18 
	g¡d
::
¡ršg
 
ShÜ‹n
(cÚ¡ 
¡d
::¡ršg& 
s
, cÚ¡ std::¡ršg& 
l
) {

19 
¡d
::
¡ršg
 
»suÉ
 = 
s
;

20 
IÁ”ÇlKeyCom·¿tÜ
(
By‹wi£Com·¿tÜ
()).
FšdShÜ‹¡S•¬©Ü
(&
»suÉ
, 
l
);

21  
	g»suÉ
;

24 
	g¡d
::
¡ršg
 
ShÜtSucûssÜ
(cÚ¡ 
¡d
::¡ršg& 
s
) {

25 
¡d
::
¡ršg
 
»suÉ
 = 
s
;

26 
IÁ”ÇlKeyCom·¿tÜ
(
By‹wi£Com·¿tÜ
()).
FšdShÜtSucûssÜ
(&
»suÉ
);

27  
	g»suÉ
;

30 
Te¡Key
(cÚ¡ 
¡d
::
¡ršg
& 
key
, 
ušt64_t
 
£q
, 
V®ueTy³
 
vt
) {

31 
	g¡d
::
¡ršg
 
’coded
 = 
IKey
(
key
, 
£q
, 
vt
);

33 
Sliû
 
š
(
’coded
);

34 
P¬£dIÁ”ÇlKey
 
decoded
("", 0, 
kTy³V®ue
);

36 
ASSERT_TRUE
(
P¬£IÁ”ÇlKey
(
š
, &
decoded
));

37 
ASSERT_EQ
(
key
, 
decoded
.
u£r_key
.
ToSŒšg
());

38 
ASSERT_EQ
(
£q
, 
decoded
.
£qu’û
);

39 
ASSERT_EQ
(
vt
, 
decoded
.
ty³
);

41 
ASSERT_TRUE
(!
P¬£IÁ”ÇlKey
(
Sliû
("b¬"), &
decoded
));

44 şas 
	cFÜm©Te¡
 {};

46 
	$TEST
(
FÜm©Te¡
, 
IÁ”ÇlKey_EncodeDecode
) {

47 cÚ¡ * 
keys
[] = {"", "k", "hello", "longggggggggggggggggggggg"};

48 cÚ¡ 
ušt64_t
 
£q
[] = {1,

60 
k
 = 0; k < (
keys
) / (keys[0]); k++) {

61 
s
 = 0; s < (
£q
) / (seq[0]); s++) {

62 
	`Te¡Key
(
keys
[
k
], 
£q
[
s
], 
kTy³V®ue
);

63 
	`Te¡Key
("h–lo", 1, 
kTy³D–‘iÚ
);

66 
	}
}

68 
	$TEST
(
FÜm©Te¡
, 
IÁ”ÇlKeyShÜtS•¬©Ü
) {

70 
	`ASSERT_EQ
(
	`IKey
("foo", 100, 
kTy³V®ue
),

71 
	`ShÜ‹n
(
	`IKey
("foo", 100, 
kTy³V®ue
), IKey("foo", 99, kTypeValue)));

72 
	`ASSERT_EQ
(

73 
	`IKey
("foo", 100, 
kTy³V®ue
),

74 
	`ShÜ‹n
(
	`IKey
("foo", 100, 
kTy³V®ue
), IKey("foo", 101, kTypeValue)));

75 
	`ASSERT_EQ
(

76 
	`IKey
("foo", 100, 
kTy³V®ue
),

77 
	`ShÜ‹n
(
	`IKey
("foo", 100, 
kTy³V®ue
), IKey("foo", 100, kTypeValue)));

78 
	`ASSERT_EQ
(

79 
	`IKey
("foo", 100, 
kTy³V®ue
),

80 
	`ShÜ‹n
(
	`IKey
("foo", 100, 
kTy³V®ue
), IKey("foo", 100, 
kTy³D–‘iÚ
)));

83 
	`ASSERT_EQ
(
	`IKey
("foo", 100, 
kTy³V®ue
),

84 
	`ShÜ‹n
(
	`IKey
("foo", 100, 
kTy³V®ue
), IKey("bar", 99, kTypeValue)));

87 
	`ASSERT_EQ
(

88 
	`IKey
("g", 
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
),

89 
	`ShÜ‹n
(
	`IKey
("foo", 100, 
kTy³V®ue
), IKey("hello", 200, kTypeValue)));

92 
	`ASSERT_EQ
(

93 
	`IKey
("foo", 100, 
kTy³V®ue
),

94 
	`ShÜ‹n
(
	`IKey
("foo", 100, 
kTy³V®ue
), IKey("foobar", 200, kTypeValue)));

97 
	`ASSERT_EQ
(

98 
	`IKey
("foob¬", 100, 
kTy³V®ue
),

99 
	`ShÜ‹n
(
	`IKey
("foob¬", 100, 
kTy³V®ue
), IKey("foo", 200, kTypeValue)));

100 
	}
}

102 
	$TEST
(
FÜm©Te¡
, 
IÁ”ÇlKeyShÜ‹¡SucûssÜ
) {

103 
	`ASSERT_EQ
(
	`IKey
("g", 
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
),

104 
	`ShÜtSucûssÜ
(
	`IKey
("foo", 100, 
kTy³V®ue
)));

105 
	`ASSERT_EQ
(
	`IKey
("\xff\xff", 100, 
kTy³V®ue
),

106 
	`ShÜtSucûssÜ
(
	`IKey
("\xff\xff", 100, 
kTy³V®ue
)));

107 
	}
}

111 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/dumpfile.cc

5 
	~"Ëv–db/dumpfe.h
"

7 
	~<¡dio.h
>

9 
	~"db/dbfÜm©.h
"

10 
	~"db/f’ame.h
"

11 
	~"db/log_»ad”.h
"

12 
	~"db/v”siÚ_ed™.h
"

13 
	~"db/wr™e_b©ch_š‹º®.h
"

14 
	~"Ëv–db/’v.h
"

15 
	~"Ëv–db/™”©Ü.h
"

16 
	~"Ëv–db/İtiÚs.h
"

17 
	~"Ëv–db/¡©us.h
"

18 
	~"Ëv–db/bË.h
"

19 
	~"Ëv–db/wr™e_b©ch.h
"

20 
	~"ut/loggšg.h
"

22 
Çme¥aû
 
	gËv–db
 {

24 
	gÇme¥aû
 {

26 
boŞ
 
GuessTy³
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
FeTy³
* 
ty³
) {

27 
size_t
 
	gpos
 = 
âame
.
rfšd
('/');

28 
	g¡d
::
¡ršg
 
ba£Çme
;

29 ià(
	gpos
 =ğ
¡d
::
¡ršg
::
Åos
) {

30 
ba£Çme
 = 
âame
;

32 
	gba£Çme
 = 
¡d
::
¡ršg
(
âame
.
d©a
(è+ 
pos
 + 1, fÇme.
size
() -…os - 1);

34 
ušt64_t
 
	gignÜed
;

35  
P¬£FeName
(
ba£Çme
, &
ignÜed
, 
ty³
);

39 şas 
	cCÜru±iÚR•Ü‹r
 : 
public
 
log
::
R—d”
::
R•Ü‹r
 {

40 
public
:

41 
vœtu®
 
CÜru±iÚ
(
size_t
 
by‹s
, cÚ¡ 
Stus
& 
¡©us
) {

42 
	g¡d
::
¡ršg
 
r
 = "corruption: ";

43 
Aµ’dNumb”To
(&
r
, 
by‹s
);

44 
	gr
 += " bytes; ";

45 
	gr
 +ğ
¡©us
.
ToSŒšg
();

46 
	gr
.
push_back
('\n');

47 
	gd¡_
->
Aµ’d
(
r
);

50 
Wr™abËFe
* 
	gd¡_
;

54 
Stus
 
PrštLogCÚ‹Ás
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
,

55 (*
func
)(
ušt64_t
, 
Sliû
, 
Wr™abËFe
*),

56 
Wr™abËFe
* 
d¡
) {

57 
Sequ’tŸlFe
* 
	gfe
;

58 
Stus
 
	gs
 = 
’v
->
NewSequ’tŸlFe
(
âame
, &
fe
);

59 ià(!
	gs
.
ok
()) {

60  
	gs
;

62 
CÜru±iÚR•Ü‹r
 
	g»pÜ‹r
;

63 
	g»pÜ‹r
.
	gd¡_
 = 
d¡
;

64 
	glog
::
R—d”
 
»ad”
(
fe
, &
»pÜ‹r
, 
Œue
, 0);

65 
Sliû
 
	g»cÜd
;

66 
	g¡d
::
¡ršg
 
sü©ch
;

67 
	g»ad”
.
R—dRecÜd
(&
»cÜd
, &
sü©ch
)) {

68 (*
	gfunc
)(
	g»ad”
.
La¡RecÜdOff£t
(), 
	g»cÜd
, 
	gd¡
);

70 
d–‘e
 
	gfe
;

71  
	gStus
::
OK
();

75 şas 
	cWr™eB©chI‹mPrš‹r
 : 
public
 
Wr™eB©ch
::
HªdËr
 {

76 
public
:

77 
vœtu®
 
Put
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

78 
	g¡d
::
¡ršg
 
r
 = "…ut '";

79 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
key
);

80 
	gr
 += "' '";

81 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
v®ue
);

82 
	gr
 += "'\n";

83 
	gd¡_
->
Aµ’d
(
r
);

85 
vœtu®
 
D–‘e
(cÚ¡ 
Sliû
& 
key
) {

86 
	g¡d
::
¡ršg
 
r
 = " del '";

87 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
key
);

88 
	gr
 += "'\n";

89 
	gd¡_
->
Aµ’d
(
r
);

92 
Wr™abËFe
* 
	gd¡_
;

97 
Wr™eB©chPrš‹r
(
ušt64_t
 
pos
, 
Sliû
 
»cÜd
, 
Wr™abËFe
* 
d¡
) {

98 
	g¡d
::
¡ršg
 
r
 = "--- offset ";

99 
Aµ’dNumb”To
(&
r
, 
pos
);

100 
	gr
 += "; ";

101 ià(
	g»cÜd
.
size
() < 12) {

102 
	gr
 += "log„ecord†ength ";

103 
Aµ’dNumb”To
(&
r
, 
»cÜd
.
size
());

104 
	gr
 += " isoo small\n";

105 
	gd¡
->
Aµ’d
(
r
);

108 
Wr™eB©ch
 
	gb©ch
;

109 
	gWr™eB©chIÁ”Çl
::
S‘CÚ‹Ás
(&
b©ch
, 
»cÜd
);

110 
	gr
 += "sequence ";

111 
Aµ’dNumb”To
(&
r
, 
Wr™eB©chIÁ”Çl
::
Sequ’û
(&
b©ch
));

112 
	gr
.
push_back
('\n');

113 
	gd¡
->
Aµ’d
(
r
);

114 
Wr™eB©chI‹mPrš‹r
 
	gb©ch_™em_´š‹r
;

115 
	gb©ch_™em_´š‹r
.
	gd¡_
 = 
d¡
;

116 
Stus
 
	gs
 = 
b©ch
.
I‹¿‹
(&
b©ch_™em_´š‹r
);

117 ià(!
	gs
.
ok
()) {

118 
	gd¡
->
Aµ’d
("ƒ¼Ü: " + 
s
.
ToSŒšg
() + "\n");

122 
Stus
 
DumpLog
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Wr™abËFe
* 
d¡
) {

123  
PrštLogCÚ‹Ás
(
’v
, 
âame
, 
Wr™eB©chPrš‹r
, 
d¡
);

128 
V”siÚEd™Prš‹r
(
ušt64_t
 
pos
, 
Sliû
 
»cÜd
, 
Wr™abËFe
* 
d¡
) {

129 
	g¡d
::
¡ršg
 
r
 = "--- offset ";

130 
Aµ’dNumb”To
(&
r
, 
pos
);

131 
	gr
 += "; ";

132 
V”siÚEd™
 
	ged™
;

133 
Stus
 
	gs
 = 
ed™
.
DecodeFrom
(
»cÜd
);

134 ià(!
	gs
.
ok
()) {

135 
	gr
 +ğ
s
.
ToSŒšg
();

136 
	gr
.
push_back
('\n');

138 
	gr
 +ğ
ed™
.
DebugSŒšg
();

140 
	gd¡
->
Aµ’d
(
r
);

143 
Stus
 
DumpDesütÜ
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Wr™abËFe
* 
d¡
) {

144  
PrštLogCÚ‹Ás
(
’v
, 
âame
, 
V”siÚEd™Prš‹r
, 
d¡
);

147 
Stus
 
DumpTabË
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Wr™abËFe
* 
d¡
) {

148 
ušt64_t
 
	gfe_size
;

149 
RªdomAcûssFe
* 
	gfe
 = 
nuÎ±r
;

150 
TabË
* 
	gbË
 = 
nuÎ±r
;

151 
Stus
 
	gs
 = 
’v
->
G‘FeSize
(
âame
, &
fe_size
);

152 ià(
	gs
.
ok
()) {

153 
	gs
 = 
’v
->
NewRªdomAcûssFe
(
âame
, &
fe
);

155 ià(
	gs
.
ok
()) {

160 
	gs
 = 
TabË
::
O³n
(
O±iÚs
(), 
fe
, 
fe_size
, &
bË
);

162 ià(!
	gs
.
ok
()) {

163 
d–‘e
 
	gbË
;

164 
d–‘e
 
	gfe
;

165  
	gs
;

168 
R—dO±iÚs
 
	gro
;

169 
	gro
.
	gfl_ÿche
 = 
çl£
;

170 
I‹¿tÜ
* 
	g™”
 = 
bË
->
NewI‹¿tÜ
(
ro
);

171 
	g¡d
::
¡ršg
 
r
;

172 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

173 
	gr
.
ş—r
();

174 
P¬£dIÁ”ÇlKey
 
	gkey
;

175 ià(!
P¬£IÁ”ÇlKey
(
™”
->
key
(), &key)) {

176 
	gr
 = "badkey '";

177 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
™”
->
key
());

178 
	gr
 += "' => '";

179 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
™”
->
v®ue
());

180 
	gr
 += "'\n";

181 
	gd¡
->
Aµ’d
(
r
);

183 
	gr
 = "'";

184 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
key
.
u£r_key
);

185 
	gr
 += "' @ ";

186 
Aµ’dNumb”To
(&
r
, 
key
.
£qu’û
);

187 
	gr
 += " : ";

188 ià(
	gkey
.
	gty³
 =ğ
kTy³D–‘iÚ
) {

189 
r
 += "del";

190 } ià(
	gkey
.
	gty³
 =ğ
kTy³V®ue
) {

191 
r
 += "val";

193 
Aµ’dNumb”To
(&
r
, 
key
.
ty³
);

195 
	gr
 += " => '";

196 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
™”
->
v®ue
());

197 
	gr
 += "'\n";

198 
	gd¡
->
Aµ’d
(
r
);

201 
	gs
 = 
™”
->
¡©us
();

202 ià(!
	gs
.
ok
()) {

203 
	gd¡
->
Aµ’d
("™”©Üƒ¼Ü: " + 
s
.
ToSŒšg
() + "\n");

206 
d–‘e
 
	g™”
;

207 
d–‘e
 
	gbË
;

208 
d–‘e
 
	gfe
;

209  
	gStus
::
OK
();

214 
Stus
 
	$DumpFe
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Wr™abËFe
* 
d¡
) {

215 
FeTy³
 
áy³
;

216 ià(!
	`GuessTy³
(
âame
, &
áy³
)) {

217  
Stus
::
	`Inv®idArgum’t
(
âame
 + ": unknown fileype");

219 
áy³
) {

220 
kLogFe
:

221  
	`DumpLog
(
’v
, 
âame
, 
d¡
);

222 
kDesütÜFe
:

223  
	`DumpDesütÜ
(
’v
, 
âame
, 
d¡
);

224 
kTabËFe
:

225  
	`DumpTabË
(
’v
, 
âame
, 
d¡
);

229  
Stus
::
	`Inv®idArgum’t
(
âame
 + ":‚ot‡ dump-able fileype");

230 
	}
}

	@db/fault_injection_test.cc

9 
	~<m­
>

10 
	~<£t
>

12 
	~"db/db_im¶.h
"

13 
	~"db/f’ame.h
"

14 
	~"db/log_fÜm©.h
"

15 
	~"db/v”siÚ_£t.h
"

16 
	~"Ëv–db/ÿche.h
"

17 
	~"Ëv–db/db.h
"

18 
	~"Ëv–db/’v.h
"

19 
	~"Ëv–db/bË.h
"

20 
	~"Ëv–db/wr™e_b©ch.h
"

21 
	~"pÜt/pÜt.h
"

22 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

23 
	~"ut/loggšg.h
"

24 
	~"ut/mu‹xlock.h
"

25 
	~"ut/‹¡h¬Ãss.h
"

26 
	~"ut/‹¡ut.h
"

28 
Çme¥aû
 
	gËv–db
 {

30 cÚ¡ 
	gkV®ueSize
 = 1000;

31 cÚ¡ 
	gkMaxNumV®ues
 = 2000;

32 cÚ¡ 
size_t
 
	gkNumI‹¿tiÚs
 = 3;

34 
şass
 
	gFauÉInjeùiÚTe¡Env
;

36 
	gÇme¥aû
 {

39 
	g¡d
::
¡ršg
 
G‘DœName
(cÚ¡ 
¡d
::¡ršg& 
f’ame
) {

40 
size_t
 
found
 = 
f’ame
.
fšd_Ï¡_of
("/\\");

41 ià(
	gfound
 =ğ
¡d
::
¡ršg
::
Åos
) {

44  
	gf’ame
.
sub¡r
(0, 
found
);

48 
Stus
 
SyncDœ
(cÚ¡ 
¡d
::
¡ršg
& 
dœ
) {

50  
Stus
::
OK
();

54 
Stus
 
Trunÿ‹
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
ušt64_t
 
Ëngth
) {

55 
	gËv–db
::
Env
* 
’v
 = 
Ëv–db
::Env::
DeçuÉ
();

57 
Sequ’tŸlFe
* 
	gÜig_fe
;

58 
Stus
 
	gs
 = 
’v
->
NewSequ’tŸlFe
(
f’ame
, &
Üig_fe
);

59 ià(!
	gs
.
ok
())  s;

61 * 
	gsü©ch
 = 
Ãw
 [
Ëngth
];

62 
	gËv–db
::
Sliû
 
»suÉ
;

63 
	gs
 = 
Üig_fe
->
R—d
(
Ëngth
, &
»suÉ
, 
sü©ch
);

64 
d–‘e
 
	gÜig_fe
;

65 ià(
	gs
.
ok
()) {

66 
	g¡d
::
¡ršg
 
tmp_Çme
 = 
G‘DœName
(
f’ame
) + "/truncate.tmp";

67 
Wr™abËFe
* 
	gtmp_fe
;

68 
	gs
 = 
’v
->
NewWr™abËFe
(
tmp_Çme
, &
tmp_fe
);

69 ià(
	gs
.
ok
()) {

70 
	gs
 = 
tmp_fe
->
Aµ’d
(
»suÉ
);

71 
d–‘e
 
	gtmp_fe
;

72 ià(
	gs
.
ok
()) {

73 
	gs
 = 
’v
->
R’ameFe
(
tmp_Çme
, 
f’ame
);

75 
	g’v
->
D–‘eFe
(
tmp_Çme
);

80 
	gd–‘e
[] 
	gsü©ch
;

82  
	gs
;

85 
	sFeS‹
 {

86 
	g¡d
::
¡ršg
 
f’ame_
;

87 
št64_t
 
	gpos_
;

88 
št64_t
 
	gpos_©_Ï¡_sync_
;

89 
št64_t
 
	gpos_©_Ï¡_æush_
;

91 
FeS‹
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
)

92 : 
f’ame_
(
f’ame
),

93 
pos_
(-1),

94 
pos_©_Ï¡_sync_
(-1),

95 
pos_©_Ï¡_æush_
(-1) {}

97 
FeS‹
(è: 
pos_
(-1), 
pos_©_Ï¡_sync_
(-1), 
pos_©_Ï¡_æush_
(-1) {}

99 
boŞ
 
IsFuÎySynûd
(ècÚ¡ {  
	gpos_
 <ğ0 || 
pos_
 =ğ
pos_©_Ï¡_sync_
; }

101 
Stus
 
DrİUnsynûdD©a
() const;

108 şas 
	cTe¡Wr™abËFe
 : 
public
 
Wr™abËFe
 {

109 
public
:

110 
Te¡Wr™abËFe
(cÚ¡ 
FeS‹
& 
¡©e
, 
Wr™abËFe
* 
f
,

111 
FauÉInjeùiÚTe¡Env
* 
’v
);

112 
	gvœtu®
 ~
Te¡Wr™abËFe
();

113 
vœtu®
 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
);

114 
vœtu®
 
Stus
 
Clo£
();

115 
vœtu®
 
Stus
 
Flush
();

116 
vœtu®
 
Stus
 
Sync
();

118 
	g´iv©e
:

119 
FeS‹
 
¡©e_
;

120 
Wr™abËFe
* 
	grg‘_
;

121 
boŞ
 
	gwr™abË_fe_İ’ed_
;

122 
FauÉInjeùiÚTe¡Env
* 
	g’v_
;

124 
Stus
 
SyncP¬’t
();

127 şas 
	cFauÉInjeùiÚTe¡Env
 : 
public
 
EnvW¿µ”
 {

128 
public
:

129 
FauÉInjeùiÚTe¡Env
()

130 : 
EnvW¿µ”
(
Env
::
DeçuÉ
()), 
fesy¡em_aùive_
(
Œue
) {}

131 
	gvœtu®
 ~
FauÉInjeùiÚTe¡Env
() {}

132 
vœtu®
 
Stus
 
NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

133 
Wr™abËFe
** 
»suÉ
);

134 
vœtu®
 
Stus
 
NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

135 
Wr™abËFe
** 
»suÉ
);

136 
vœtu®
 
Stus
 
D–‘eFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
);

137 
vœtu®
 
Stus
 
R’ameFe
(cÚ¡ 
¡d
::
¡ršg
& 
s
, cÚ¡ std::¡ršg& 
t
);

139 
Wr™abËFeClo£d
(cÚ¡ 
FeS‹
& 
¡©e
);

140 
Stus
 
DrİUnsynûdFeD©a
();

141 
Stus
 
D–‘eFesC»©edAá”La¡DœSync
();

142 
DœWasSynûd
();

143 
boŞ
 
IsFeC»©edSšûLa¡DœSync
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
);

144 
Re£tS‹
();

145 
UÁ¿ckFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
);

150 
boŞ
 
IsFesy¡emAùive
(è
LOCKS_EXCLUDED
(
mu‹x_
) {

151 
Mu‹xLock
 
l
(&
mu‹x_
);

152  
	gfesy¡em_aùive_
;

154 
S‘Fesy¡emAùive
(
boŞ
 
aùive
è
LOCKS_EXCLUDED
(
mu‹x_
) {

155 
Mu‹xLock
 
l
(&
mu‹x_
);

156 
	gfesy¡em_aùive_
 = 
aùive
;

159 
	g´iv©e
:

160 
pÜt
::
Mu‹x
 
mu‹x_
;

161 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gFeS‹
> 
db_fe_¡©e_
 
GUARDED_BY
(
mu‹x_
);

162 
	g¡d
::
£t
<
¡d
::
¡ršg
> 
Ãw_fes_sšû_Ï¡_dœ_sync_
 
GUARDED_BY
(
mu‹x_
);

163 
boŞ
 
fesy¡em_aùive_
 
GUARDED_BY
(
mu‹x_
);

166 
	gTe¡Wr™abËFe
::
	$Te¡Wr™abËFe
(cÚ¡ 
FeS‹
& 
¡©e
, 
Wr™abËFe
* 
f
,

167 
FauÉInjeùiÚTe¡Env
* 
’v
)

168 : 
	`¡©e_
(
¡©e
), 
	`rg‘_
(
f
), 
	`wr™abË_fe_İ’ed_
(
Œue
), 
	$’v_
(
’v
) {

169 
	`as£¹
(
f
 !ğ
nuÎ±r
);

170 
	}
}

172 
	gTe¡Wr™abËFe
::~
	$Te¡Wr™abËFe
() {

173 ià(
wr™abË_fe_İ’ed_
) {

174 
	`Clo£
();

176 
d–‘e
 
rg‘_
;

177 
	}
}

179 
Stus
 
	gTe¡Wr™abËFe
::
	$Aµ’d
(cÚ¡ 
Sliû
& 
d©a
) {

180 
Stus
 
s
 = 
rg‘_
->
	`Aµ’d
(
d©a
);

181 ià(
s
.
	`ok
(è&& 
’v_
->
	`IsFesy¡emAùive
()) {

182 
¡©e_
.
pos_
 +ğ
d©a
.
	`size
();

184  
s
;

185 
	}
}

187 
Stus
 
	gTe¡Wr™abËFe
::
	$Clo£
() {

188 
wr™abË_fe_İ’ed_
 = 
çl£
;

189 
Stus
 
s
 = 
rg‘_
->
	`Clo£
();

190 ià(
s
.
	`ok
()) {

191 
’v_
->
	`Wr™abËFeClo£d
(
¡©e_
);

193  
s
;

194 
	}
}

196 
Stus
 
	gTe¡Wr™abËFe
::
	$Flush
() {

197 
Stus
 
s
 = 
rg‘_
->
	`Flush
();

198 ià(
s
.
	`ok
(è&& 
’v_
->
	`IsFesy¡emAùive
()) {

199 
¡©e_
.
pos_©_Ï¡_æush_
 = s‹_.
pos_
;

201  
s
;

202 
	}
}

204 
Stus
 
	gTe¡Wr™abËFe
::
	$SyncP¬’t
() {

205 
Stus
 
s
 = 
	`SyncDœ
(
	`G‘DœName
(
¡©e_
.
f’ame_
));

206 ià(
s
.
	`ok
()) {

207 
’v_
->
	`DœWasSynûd
();

209  
s
;

210 
	}
}

212 
Stus
 
	gTe¡Wr™abËFe
::
	$Sync
() {

213 ià(!
’v_
->
	`IsFesy¡emAùive
()) {

214  
Stus
::
	`OK
();

217 
Stus
 
s
 = 
rg‘_
->
	`Sync
();

218 ià(
s
.
	`ok
()) {

219 
¡©e_
.
pos_©_Ï¡_sync_
 = s‹_.
pos_
;

221 ià(
’v_
->
	`IsFeC»©edSšûLa¡DœSync
(
¡©e_
.
f’ame_
)) {

222 
Stus
 
ps
 = 
	`SyncP¬’t
();

223 ià(
s
.
	`ok
(è&& !
ps
.ok()) {

224 
s
 = 
ps
;

227  
s
;

228 
	}
}

230 
Stus
 
	gFauÉInjeùiÚTe¡Env
::
	$NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

231 
Wr™abËFe
** 
»suÉ
) {

232 
Wr™abËFe
* 
aùu®_wr™abË_fe
;

233 
Stus
 
s
 = 
	`rg‘
()->
	`NewWr™abËFe
(
âame
, &
aùu®_wr™abË_fe
);

234 ià(
s
.
	`ok
()) {

235 
FeS‹
 
	`¡©e
(
âame
);

236 
¡©e
.
pos_
 = 0;

237 *
»suÉ
 = 
Ãw
 
	`Te¡Wr™abËFe
(
¡©e
, 
aùu®_wr™abË_fe
, 
this
);

241 
	`UÁ¿ckFe
(
âame
);

242 
Mu‹xLock
 
	`l
(&
mu‹x_
);

243 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`š£¹
(
âame
);

245  
s
;

246 
	}
}

248 
Stus
 
	gFauÉInjeùiÚTe¡Env
::
	$NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

249 
Wr™abËFe
** 
»suÉ
) {

250 
Wr™abËFe
* 
aùu®_wr™abË_fe
;

251 
Stus
 
s
 = 
	`rg‘
()->
	`NewAµ’dabËFe
(
âame
, &
aùu®_wr™abË_fe
);

252 ià(
s
.
	`ok
()) {

253 
FeS‹
 
	`¡©e
(
âame
);

254 
¡©e
.
pos_
 = 0;

256 
Mu‹xLock
 
	`l
(&
mu‹x_
);

257 ià(
db_fe_¡©e_
.
	`couÁ
(
âame
) == 0) {

258 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`š£¹
(
âame
);

260 
¡©e
 = 
db_fe_¡©e_
[
âame
];

263 *
»suÉ
 = 
Ãw
 
	`Te¡Wr™abËFe
(
¡©e
, 
aùu®_wr™abË_fe
, 
this
);

265  
s
;

266 
	}
}

268 
Stus
 
	gFauÉInjeùiÚTe¡Env
::
	$DrİUnsynûdFeD©a
() {

269 
Stus
 
s
;

270 
Mu‹xLock
 
	`l
(&
mu‹x_
);

271 
¡d
::
m­
<¡d::
¡ršg
, 
FeS‹
>::
cÚ¡_™”©Ü
 
™
 =

272 
db_fe_¡©e_
.
	`begš
();

273 
s
.
	`ok
(è&& 
™
 !ğ
db_fe_¡©e_
.
	`’d
(); ++it) {

274 cÚ¡ 
FeS‹
& 
¡©e
 = 
™
->
£cÚd
;

275 ià(!
¡©e
.
	`IsFuÎySynûd
()) {

276 
s
 = 
¡©e
.
	`DrİUnsynûdD©a
();

279  
s
;

280 
	}
}

282 
	gFauÉInjeùiÚTe¡Env
::
	$DœWasSynûd
() {

283 
Mu‹xLock
 
	`l
(&
mu‹x_
);

284 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`ş—r
();

285 
	}
}

287 
boŞ
 
	gFauÉInjeùiÚTe¡Env
::
	$IsFeC»©edSšûLa¡DœSync
(

288 cÚ¡ 
¡d
::
¡ršg
& 
f’ame
) {

289 
Mu‹xLock
 
	`l
(&
mu‹x_
);

290  
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`fšd
(
f’ame
) !=

291 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`’d
();

292 
	}
}

294 
	gFauÉInjeùiÚTe¡Env
::
	$UÁ¿ckFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
) {

295 
Mu‹xLock
 
	`l
(&
mu‹x_
);

296 
db_fe_¡©e_
.
	`”a£
(
f
);

297 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`”a£
(
f
);

298 
	}
}

300 
Stus
 
	gFauÉInjeùiÚTe¡Env
::
	$D–‘eFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
) {

301 
Stus
 
s
 = 
EnvW¿µ”
::
	`D–‘eFe
(
f
);

302 
	`ASSERT_OK
(
s
);

303 ià(
s
.
	`ok
()) {

304 
	`UÁ¿ckFe
(
f
);

306  
s
;

307 
	}
}

309 
Stus
 
	gFauÉInjeùiÚTe¡Env
::
	$R’ameFe
(cÚ¡ 
¡d
::
¡ršg
& 
s
,

310 cÚ¡ 
¡d
::
¡ršg
& 
t
) {

311 
Stus
 
»t
 = 
EnvW¿µ”
::
	`R’ameFe
(
s
, 
t
);

313 ià(
»t
.
	`ok
()) {

314 
Mu‹xLock
 
	`l
(&
mu‹x_
);

315 ià(
db_fe_¡©e_
.
	`fšd
(
s
è!ğdb_fe_¡©e_.
	`’d
()) {

316 
db_fe_¡©e_
[
t
] = db_fe_¡©e_[
s
];

317 
db_fe_¡©e_
.
	`”a£
(
s
);

320 ià(
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`”a£
(
s
) != 0) {

321 
	`as£¹
(
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`fšd
(
t
) ==

322 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`’d
());

323 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`š£¹
(
t
);

327  
»t
;

328 
	}
}

330 
	gFauÉInjeùiÚTe¡Env
::
	$Re£tS‹
() {

334 
	`S‘Fesy¡emAùive
(
Œue
);

335 
	}
}

337 
Stus
 
	gFauÉInjeùiÚTe¡Env
::
	$D–‘eFesC»©edAá”La¡DœSync
() {

339 
mu‹x_
.
	`Lock
();

340 
¡d
::
£t
<¡d::
¡ršg
> 
	`Ãw_fes
(
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`begš
(),

341 
Ãw_fes_sšû_Ï¡_dœ_sync_
.
	`’d
());

342 
mu‹x_
.
	`UÆock
();

343 
Stus
 
s
;

344 
¡d
::
£t
<¡d::
¡ršg
>::
cÚ¡_™”©Ü
 
™
;

345 
™
 = 
Ãw_fes
.
	`begš
(); 
s
.
	`ok
(è&& iˆ!ğÃw_fes.
	`’d
(); ++it) {

346 
s
 = 
	`D–‘eFe
(*
™
);

348  
s
;

349 
	}
}

351 
	gFauÉInjeùiÚTe¡Env
::
	$Wr™abËFeClo£d
(cÚ¡ 
FeS‹
& 
¡©e
) {

352 
Mu‹xLock
 
	`l
(&
mu‹x_
);

353 
db_fe_¡©e_
[
¡©e
.
f’ame_
] = state;

354 
	}
}

356 
Stus
 
	gFeS‹
::
	$DrİUnsynûdD©a
() const {

357 
št64_t
 
sync_pos
 = 
pos_©_Ï¡_sync_
 == -1 ? 0 :…os_at_last_sync_;

358  
	`Trunÿ‹
(
f’ame_
, 
sync_pos
);

359 
	}
}

361 şas 
	cFauÉInjeùiÚTe¡
 {

362 
	gpublic
:

363 
	eEx³ùedV”ifResuÉ
 { 
VAL_EXPECT_NO_ERROR
, 
	gVAL_EXPECT_ERROR
 };

364 
	eRe£tM‘hod
 { 
	gRESET_DROP_UNSYNCED_DATA
, 
	gRESET_DELETE_UNSYNCED_FILES
 };

366 
FauÉInjeùiÚTe¡Env
* 
	g’v_
;

367 
	g¡d
::
¡ršg
 
dbÇme_
;

368 
Cache
* 
	gtšy_ÿche_
;

369 
O±iÚs
 
	gİtiÚs_
;

370 
DB
* 
	gdb_
;

372 
FauÉInjeùiÚTe¡
()

373 : 
’v_
(
Ãw
 
FauÉInjeùiÚTe¡Env
),

374 
tšy_ÿche_
(
NewLRUCache
(100)),

375 
db_
(
nuÎ±r
) {

376 
	gdbÇme_
 = 
‹¡
::
TmpDœ
() + "/fault_test";

377 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

378 
	gİtiÚs_
.
	g»u£_logs
 = 
Œue
;

379 
	gİtiÚs_
.
	g’v
 = 
’v_
;

380 
	gİtiÚs_
.
	g·¿noid_checks
 = 
Œue
;

381 
	gİtiÚs_
.
	gblock_ÿche
 = 
tšy_ÿche_
;

382 
	gİtiÚs_
.
	gü—‹_if_missšg
 = 
Œue
;

385 ~
FauÉInjeùiÚTe¡
() {

386 
Clo£DB
();

387 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

388 
d–‘e
 
	gtšy_ÿche_
;

389 
d–‘e
 
	g’v_
;

392 
Reu£Logs
(
boŞ
 
»u£
è{ 
	gİtiÚs_
.
	g»u£_logs
 =„euse; }

394 
Bud
(
¡¬t_idx
, 
num_v®s
) {

395 
	g¡d
::
¡ršg
 
key_¥aû
, 
	gv®ue_¥aû
;

396 
Wr™eB©ch
 
	gb©ch
;

397 
	gi
 = 
¡¬t_idx
; i < 
	g¡¬t_idx
 + 
	gnum_v®s
; i++) {

398 
Sliû
 
	gkey
 = 
Key
(
i
, &
key_¥aû
);

399 
	gb©ch
.
CË¬
();

400 
	gb©ch
.
Put
(
key
, 
V®ue
(
i
, &
v®ue_¥aû
));

401 
Wr™eO±iÚs
 
	gİtiÚs
;

402 
ASSERT_OK
(
db_
->
Wr™e
(
İtiÚs
, &
b©ch
));

406 
Stus
 
R—dV®ue
(
i
, 
¡d
::
¡ršg
* 
v®
) const {

407 
¡d
::
¡ršg
 
key_¥aû
, 
	gv®ue_¥aû
;

408 
Sliû
 
	gkey
 = 
Key
(
i
, &
key_¥aû
);

409 
V®ue
(
i
, &
v®ue_¥aû
);

410 
R—dO±iÚs
 
	gİtiÚs
;

411  
	gdb_
->
G‘
(
İtiÚs
, 
key
, 
v®
);

414 
Stus
 
V”ify
(
¡¬t_idx
, 
num_v®s
,

415 
Ex³ùedV”ifResuÉ
 
ex³ùed
) const {

416 
	g¡d
::
¡ršg
 
v®
;

417 
	g¡d
::
¡ršg
 
v®ue_¥aû
;

418 
Stus
 
	gs
;

419 
	gi
 = 
¡¬t_idx
; i < 
	g¡¬t_idx
 + 
	gnum_v®s
 && 
	gs
.
ok
(); i++) {

420 
V®ue
(
i
, &
v®ue_¥aû
);

421 
	gs
 = 
R—dV®ue
(
i
, &
v®
);

422 ià(
	gex³ùed
 =ğ
VAL_EXPECT_NO_ERROR
) {

423 ià(
s
.
ok
()) {

424 
ASSERT_EQ
(
v®ue_¥aû
, 
v®
);

426 } ià(
	gs
.
ok
()) {

427 
årštf
(
¡d”r
, "Ex³ùed‡À”rÜ‡ˆ%d, buˆwa OK\n", 
i
);

428 
	gs
 = 
Stus
::
IOE¼Ü
(
dbÇme_
, "Expected valueƒrror:");

430 
	gs
 = 
Stus
::
OK
();

433  
	gs
;

437 
Sliû
 
Key
(
i
, 
¡d
::
¡ršg
* 
¡Üage
) const {

438 
buf
[100];

439 
¢´štf
(
buf
, (buf), "%016d", 
i
);

440 
	g¡Üage
->
assign
(
buf
, 
¡¾’
(buf));

441  
Sliû
(*
¡Üage
);

445 
Sliû
 
V®ue
(
k
, 
¡d
::
¡ršg
* 
¡Üage
) const {

446 
Rªdom
 
r
(
k
);

447  
	g‹¡
::
RªdomSŒšg
(&
r
, 
kV®ueSize
, 
¡Üage
);

450 
Stus
 
O³nDB
() {

451 
d–‘e
 
	gdb_
;

452 
	gdb_
 = 
nuÎ±r
;

453 
	g’v_
->
Re£tS‹
();

454  
	gDB
::
O³n
(
İtiÚs_
, 
dbÇme_
, &
db_
);

457 
Clo£DB
() {

458 
d–‘e
 
	gdb_
;

459 
	gdb_
 = 
nuÎ±r
;

462 
D–‘eAÎD©a
() {

463 
I‹¿tÜ
* 
	g™”
 = 
db_
->
NewI‹¿tÜ
(
R—dO±iÚs
());

464 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

465 
ASSERT_OK
(
db_
->
D–‘e
(
Wr™eO±iÚs
(), 
™”
->
key
()));

468 
d–‘e
 
	g™”
;

471 
Re£tDBS‹
(
Re£tM‘hod
 
»£t_m‘hod
) {

472 
	g»£t_m‘hod
) {

473 
	gRESET_DROP_UNSYNCED_DATA
:

474 
ASSERT_OK
(
’v_
->
DrİUnsynûdFeD©a
());

476 
	gRESET_DELETE_UNSYNCED_FILES
:

477 
ASSERT_OK
(
’v_
->
D–‘eFesC»©edAá”La¡DœSync
());

480 
as£¹
(
çl£
);

484 
P¬tŸlCom·ùTe¡P»FauÉ
(
num_´e_sync
, 
num_po¡_sync
) {

485 
D–‘eAÎD©a
();

486 
Bud
(0, 
num_´e_sync
);

487 
	gdb_
->
Com·ùRªge
(
nuÎ±r
,‚ullptr);

488 
Bud
(
num_´e_sync
, 
num_po¡_sync
);

491 
P¬tŸlCom·ùTe¡Reİ’W™hFauÉ
(
Re£tM‘hod
 
»£t_m‘hod
,

492 
num_´e_sync
, 
num_po¡_sync
) {

493 
	g’v_
->
S‘Fesy¡emAùive
(
çl£
);

494 
Clo£DB
();

495 
Re£tDBS‹
(
»£t_m‘hod
);

496 
ASSERT_OK
(
O³nDB
());

497 
ASSERT_OK
(
V”ify
(0, 
num_´e_sync
, 
FauÉInjeùiÚTe¡
::
VAL_EXPECT_NO_ERROR
));

498 
ASSERT_OK
(
V”ify
(
num_´e_sync
, 
num_po¡_sync
,

499 
FauÉInjeùiÚTe¡
::
VAL_EXPECT_ERROR
));

502 
NoWr™eTe¡P»FauÉ
() {}

504 
NoWr™eTe¡Reİ’W™hFauÉ
(
Re£tM‘hod
 
»£t_m‘hod
) {

505 
Clo£DB
();

506 
Re£tDBS‹
(
»£t_m‘hod
);

507 
ASSERT_OK
(
O³nDB
());

510 
DoTe¡
() {

511 
Rªdom
 
ºd
(0);

512 
ASSERT_OK
(
O³nDB
());

513 
size_t
 
	gidx
 = 0; idx < 
	gkNumI‹¿tiÚs
; idx++) {

514 
	gnum_´e_sync
 = 
ºd
.
UnifÜm
(
kMaxNumV®ues
);

515 
	gnum_po¡_sync
 = 
ºd
.
UnifÜm
(
kMaxNumV®ues
);

517 
P¬tŸlCom·ùTe¡P»FauÉ
(
num_´e_sync
, 
num_po¡_sync
);

518 
P¬tŸlCom·ùTe¡Reİ’W™hFauÉ
(
RESET_DROP_UNSYNCED_DATA
, 
num_´e_sync
,

519 
num_po¡_sync
);

521 
NoWr™eTe¡P»FauÉ
();

522 
NoWr™eTe¡Reİ’W™hFauÉ
(
RESET_DROP_UNSYNCED_DATA
);

524 
P¬tŸlCom·ùTe¡P»FauÉ
(
num_´e_sync
, 
num_po¡_sync
);

527 
P¬tŸlCom·ùTe¡Reİ’W™hFauÉ
(
RESET_DELETE_UNSYNCED_FILES
,

528 
num_´e_sync
 + 
num_po¡_sync
, 0);

530 
NoWr™eTe¡P»FauÉ
();

531 
NoWr™eTe¡Reİ’W™hFauÉ
(
RESET_DELETE_UNSYNCED_FILES
);

536 
	$TEST
(
FauÉInjeùiÚTe¡
, 
FauÉTe¡NoLogReu£
) {

537 
	`Reu£Logs
(
çl£
);

538 
	`DoTe¡
();

539 
	}
}

541 
	$TEST
(
FauÉInjeùiÚTe¡
, 
FauÉTe¡W™hLogReu£
) {

542 
	`Reu£Logs
(
Œue
);

543 
	`DoTe¡
();

544 
	}
}

548 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/fh.cc

3 
	~"db/fh.h
"

5 
	~"ut/hash.h
"

7 
Çme¥aû
 
	gËv–db
 {

9 
	gFH
::
FH
()

11 
bs
 = 1000;

12 
	gfs
 = 10;

13 
	gfv
 = 
Ãw
 *[
fs
];

14 
	gi
,
	gj
;

15 
	gi
=0;i<
	gfs
;i++)

17 
	gfv
[
i
] = 
Ãw
 [
bs
];

18 
	gj
=0;j<
	gbs
;j++)

19 
	gfv
[
i
][
j
] = 0;

23 
	gFH
::~
FH
()

25 
d–‘e
 
fv
;

27 
	gFH
::
add
(cÚ¡ 
Sliû
& 
key
)

29 
i
,
	ghv
;

30 
	gi
=0;i<
	gfs
;i++)

32 
	ghv
 = 
hash
(
i
,
key
);

33 ià(
	gfv
[
i
][
hv
] < 256)

34 
	gfv
[
i
][
hv
]++;

37 
	gFH
::
g‘
(cÚ¡ 
Sliû
& 
key
)

39 
i
,
	ghv
,
	gsum
;

40 
	gsum
 = 0;

41 
	gi
=0;i<
	gfs
;i++)

43 
	ghv
 = 
hash
(
i
,
key
);

44 
	gsum
 +ğ
fv
[
i
][
hv
];

48 
	gFH
::
hash
(
â
,cÚ¡ 
Sliû
& 
key
)

50  
Hash
(
key
.
d©a
(),key.
size
(),0xbc9f1d34+
â
)%
	gbs
;

	@db/fh.h

3 #iâdeà
STORAGE_LEVELDB_DB_FH_H_


4 
	#STORAGE_LEVELDB_DB_FH_H_


	)

6 
	~"Ëv–db/¦iû.h
"

8 
Çme¥aû
 
	gËv–db
 {

10 şas 
	cFH


12 
	gpublic
:

13 
FH
();

14 ~
FH
();

16 ** 
	gfv
;

17 
	gbs
;

18 
	gfs
;

20 
add
(cÚ¡ 
Sliû
& 
key
);

21 
g‘
(cÚ¡ 
Sliû
& 
key
);

22 
hash
(
â
,cÚ¡ 
Sliû
& 
key
);

	@db/filename.cc

5 
	~"db/f’ame.h
"

7 
	~<ùy³.h
>

8 
	~<¡dio.h
>

10 
	~"db/dbfÜm©.h
"

11 
	~"Ëv–db/’v.h
"

12 
	~"ut/loggšg.h
"

14 
Çme¥aû
 
	gËv–db
 {

17 
Stus
 
Wr™eSŒšgToFeSync
(
Env
* 
’v
, cÚ¡ 
Sliû
& 
d©a
,

18 cÚ¡ 
¡d
::
¡ršg
& 
âame
);

20 
	g¡d
::
¡ršg
 
MakeFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
,

21 cÚ¡ * 
suffix
) {

22 
	gbuf
[100];

23 
¢´štf
(
buf
, (buf), "/%06llu.%s",

24 
¡©ic_ÿ¡
<>(
numb”
), 
suffix
);

25  
	gdbÇme
 + 
	gbuf
;

28 
	g¡d
::
¡ršg
 
LogFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
) {

29 
as£¹
(
numb”
 > 0);

30  
MakeFeName
(
dbÇme
, 
numb”
, "log");

33 
	g¡d
::
¡ršg
 
TabËFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
) {

34 
as£¹
(
numb”
 > 0);

35  
MakeFeName
(
dbÇme
, 
numb”
, "ldb");

38 
	g¡d
::
¡ršg
 
SSTTabËFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
) {

39 
as£¹
(
numb”
 > 0);

40  
MakeFeName
(
dbÇme
, 
numb”
, "sst");

43 
	g¡d
::
¡ršg
 
DesütÜFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
) {

44 
as£¹
(
numb”
 > 0);

45 
	gbuf
[100];

46 
¢´štf
(
buf
, (buf), "/MANIFEST-%06llu",

47 
¡©ic_ÿ¡
<>(
numb”
));

48  
	gdbÇme
 + 
	gbuf
;

51 
	g¡d
::
¡ršg
 
Cu¼’tFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
) {

52  
dbÇme
 + "/CURRENT";

55 
	g¡d
::
¡ršg
 
LockFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
) {  dbname + "/LOCK"; }

57 
	g¡d
::
¡ršg
 
TempFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
) {

58 
as£¹
(
numb”
 > 0);

59  
MakeFeName
(
dbÇme
, 
numb”
, "dbtmp");

62 
	g¡d
::
¡ršg
 
InfoLogFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
) {

63  
dbÇme
 + "/LOG";

67 
	g¡d
::
¡ršg
 
OldInfoLogFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
) {

68  
dbÇme
 + "/LOG.old";

78 
boŞ
 
P¬£FeName
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
ušt64_t
* 
numb”
,

79 
FeTy³
* 
ty³
) {

80 
Sliû
 
»¡
(
f’ame
);

81 ià(
	g»¡
 == "CURRENT") {

82 *
numb”
 = 0;

83 *
	gty³
 = 
kCu¼’tFe
;

84 } ià(
	g»¡
 == "LOCK") {

85 *
numb”
 = 0;

86 *
	gty³
 = 
kDBLockFe
;

87 } ià(
	g»¡
 =ğ"LOG" || 
»¡
 == "LOG.old") {

88 *
numb”
 = 0;

89 *
	gty³
 = 
kInfoLogFe
;

90 } ià(
	g»¡
.
¡¬ts_w™h
("MANIFEST-")) {

91 
	g»¡
.
»move_´efix
(
¡¾’
("MANIFEST-"));

92 
ušt64_t
 
	gnum
;

93 ià(!
CÚsumeDecim®Numb”
(&
»¡
, &
num
)) {

94  
	gçl£
;

96 ià(!
	g»¡
.
em±y
()) {

97  
	gçl£
;

99 *
	gty³
 = 
kDesütÜFe
;

100 *
	gnumb”
 = 
num
;

104 
ušt64_t
 
	gnum
;

105 ià(!
CÚsumeDecim®Numb”
(&
»¡
, &
num
)) {

106  
	gçl£
;

108 
Sliû
 
	gsuffix
 = 
»¡
;

109 ià(
	gsuffix
 =ğ
Sliû
(".log")) {

110 *
ty³
 = 
kLogFe
;

111 } ià(
	gsuffix
 =ğ
Sliû
(".s¡"è|| 
suffix
 == Slice(".ldb")) {

112 *
ty³
 = 
kTabËFe
;

113 } ià(
	gsuffix
 =ğ
Sliû
(".dbtmp")) {

114 *
ty³
 = 
kTempFe
;

116  
	gçl£
;

118 *
	gnumb”
 = 
num
;

120  
	gŒue
;

123 
Stus
 
S‘Cu¼’tFe
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
,

124 
ušt64_t
 
desütÜ_numb”
) {

126 
	g¡d
::
¡ršg
 
mªiã¡
 = 
DesütÜFeName
(
dbÇme
, 
desütÜ_numb”
);

127 
Sliû
 
	gcÚ‹Ás
 = 
mªiã¡
;

128 
as£¹
(
cÚ‹Ás
.
¡¬ts_w™h
(
dbÇme
 + "/"));

129 
	gcÚ‹Ás
.
»move_´efix
(
dbÇme
.
size
() + 1);

130 
	g¡d
::
¡ršg
 
tmp
 = 
TempFeName
(
dbÇme
, 
desütÜ_numb”
);

131 
Stus
 
	gs
 = 
Wr™eSŒšgToFeSync
(
’v
, 
cÚ‹Ás
.
ToSŒšg
(è+ "\n", 
tmp
);

132 ià(
	gs
.
ok
()) {

133 
	gs
 = 
’v
->
R’ameFe
(
tmp
, 
Cu¼’tFeName
(
dbÇme
));

135 ià(!
	gs
.
ok
()) {

136 
	g’v
->
D–‘eFe
(
tmp
);

138  
	gs
;

	@db/filename.h

7 #iâdeà
STORAGE_LEVELDB_DB_FILENAME_H_


8 
	#STORAGE_LEVELDB_DB_FILENAME_H_


	)

10 
	~<¡dšt.h
>

12 
	~<¡ršg
>

14 
	~"Ëv–db/¦iû.h
"

15 
	~"Ëv–db/¡©us.h
"

16 
	~"pÜt/pÜt.h
"

18 
Çme¥aû
 
	gËv–db
 {

20 
şass
 
	gEnv
;

22 
	eFeTy³
 {

23 
	gkLogFe
,

24 
	gkDBLockFe
,

25 
	gkTabËFe
,

26 
	gkDesütÜFe
,

27 
	gkCu¼’tFe
,

28 
	gkTempFe
,

29 
	gkInfoLogFe


35 
	g¡d
::
¡ršg
 
LogFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
);

40 
	g¡d
::
¡ršg
 
TabËFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
);

45 
	g¡d
::
¡ršg
 
SSTTabËFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
);

50 
	g¡d
::
¡ršg
 
DesütÜFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
);

55 
	g¡d
::
¡ršg
 
Cu¼’tFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
);

59 
	g¡d
::
¡ršg
 
LockFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
);

63 
	g¡d
::
¡ršg
 
TempFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
, 
ušt64_t
 
numb”
);

66 
	g¡d
::
¡ršg
 
InfoLogFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
);

69 
	g¡d
::
¡ršg
 
OldInfoLogFeName
(cÚ¡ 
¡d
::¡ršg& 
dbÇme
);

74 
boŞ
 
P¬£FeName
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
ušt64_t
* 
numb”
,

75 
FeTy³
* 
ty³
);

79 
Stus
 
S‘Cu¼’tFe
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
,

80 
ušt64_t
 
desütÜ_numb”
);

	@db/filename_test.cc

5 
	~"db/f’ame.h
"

7 
	~"db/dbfÜm©.h
"

8 
	~"pÜt/pÜt.h
"

9 
	~"ut/loggšg.h
"

10 
	~"ut/‹¡h¬Ãss.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 şas 
	cFeNameTe¡
 {};

16 
	$TEST
(
FeNameTe¡
, 
P¬£
) {

17 
Sliû
 
db
;

18 
FeTy³
 
ty³
;

19 
ušt64_t
 
numb”
;

23 cÚ¡ * 
âame
;

24 
ušt64_t
 
numb”
;

25 
FeTy³
 
ty³
;

26 } 
ÿ£s
[] = {

27 {"100.log", 100, 
kLogFe
},

28 {"0.log", 0, 
kLogFe
},

29 {"0.s¡", 0, 
kTabËFe
},

30 {"0.ldb", 0, 
kTabËFe
},

31 {"CURRENT", 0, 
kCu¼’tFe
},

32 {"LOCK", 0, 
kDBLockFe
},

33 {"MANIFEST-2", 2, 
kDesütÜFe
},

34 {"MANIFEST-7", 7, 
kDesütÜFe
},

35 {"LOG", 0, 
kInfoLogFe
},

36 {"LOG.Şd", 0, 
kInfoLogFe
},

37 {"18446744073709551615.log", 18446744073709551615uÎ, 
kLogFe
},

39 
i
 = 0; i < (
ÿ£s
) / (cases[0]); i++) {

40 
¡d
::
¡ršg
 
f
 = 
ÿ£s
[
i
].
âame
;

41 
	`ASSERT_TRUE
(
	`P¬£FeName
(
f
, &
numb”
, &
ty³
)) << f;

42 
	`ASSERT_EQ
(
ÿ£s
[
i
].
ty³
,y³è<< 
f
;

43 
	`ASSERT_EQ
(
ÿ£s
[
i
].
numb”
,‚umb”è<< 
f
;

47 cÚ¡ * 
”rÜs
[] = {"",

69 
i
 = 0; i < (
”rÜs
) / (errors[0]); i++) {

70 
¡d
::
¡ršg
 
f
 = 
”rÜs
[
i
];

71 
	`ASSERT_TRUE
(!
	`P¬£FeName
(
f
, &
numb”
, &
ty³
)) << f;

73 
	}
}

75 
	$TEST
(
FeNameTe¡
, 
CÚ¡ruùiÚ
) {

76 
ušt64_t
 
numb”
;

77 
FeTy³
 
ty³
;

78 
¡d
::
¡ršg
 
âame
;

80 
âame
 = 
	`Cu¼’tFeName
("foo");

81 
	`ASSERT_EQ
("foo/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

82 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

83 
	`ASSERT_EQ
(0, 
numb”
);

84 
	`ASSERT_EQ
(
kCu¼’tFe
, 
ty³
);

86 
âame
 = 
	`LockFeName
("foo");

87 
	`ASSERT_EQ
("foo/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

88 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

89 
	`ASSERT_EQ
(0, 
numb”
);

90 
	`ASSERT_EQ
(
kDBLockFe
, 
ty³
);

92 
âame
 = 
	`LogFeName
("foo", 192);

93 
	`ASSERT_EQ
("foo/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

94 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

95 
	`ASSERT_EQ
(192, 
numb”
);

96 
	`ASSERT_EQ
(
kLogFe
, 
ty³
);

98 
âame
 = 
	`TabËFeName
("bar", 200);

99 
	`ASSERT_EQ
("b¬/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

100 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

101 
	`ASSERT_EQ
(200, 
numb”
);

102 
	`ASSERT_EQ
(
kTabËFe
, 
ty³
);

104 
âame
 = 
	`DesütÜFeName
("bar", 100);

105 
	`ASSERT_EQ
("b¬/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

106 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

107 
	`ASSERT_EQ
(100, 
numb”
);

108 
	`ASSERT_EQ
(
kDesütÜFe
, 
ty³
);

110 
âame
 = 
	`TempFeName
("tmp", 999);

111 
	`ASSERT_EQ
("tmp/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

112 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

113 
	`ASSERT_EQ
(999, 
numb”
);

114 
	`ASSERT_EQ
(
kTempFe
, 
ty³
);

116 
âame
 = 
	`InfoLogFeName
("foo");

117 
	`ASSERT_EQ
("foo/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

118 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

119 
	`ASSERT_EQ
(0, 
numb”
);

120 
	`ASSERT_EQ
(
kInfoLogFe
, 
ty³
);

122 
âame
 = 
	`OldInfoLogFeName
("foo");

123 
	`ASSERT_EQ
("foo/", 
¡d
::
	`¡ršg
(
âame
.
	`d©a
(), 4));

124 
	`ASSERT_TRUE
(
	`P¬£FeName
(
âame
.
	`c_¡r
(è+ 4, &
numb”
, &
ty³
));

125 
	`ASSERT_EQ
(0, 
numb”
);

126 
	`ASSERT_EQ
(
kInfoLogFe
, 
ty³
);

127 
	}
}

131 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/leveldbutil.cc

5 
	~<¡dio.h
>

7 
	~"Ëv–db/dumpfe.h
"

8 
	~"Ëv–db/’v.h
"

9 
	~"Ëv–db/¡©us.h
"

11 
Çme¥aû
 
	gËv–db
 {

12 
	gÇme¥aû
 {

14 şas 
	cStdoutPrš‹r
 : 
public
 
Wr™abËFe
 {

15 
public
:

16 
vœtu®
 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
) {

17 
fwr™e
(
d©a
.d©a(), 1, d©a.
size
(), 
¡dout
);

18  
	gStus
::
OK
();

20 
vœtu®
 
Stus
 
Clo£
(è{  
	gStus
::
OK
(); }

21 
vœtu®
 
Stus
 
Flush
(è{  
	gStus
::
OK
(); }

22 
vœtu®
 
Stus
 
Sync
(è{  
	gStus
::
OK
(); }

25 
boŞ
 
HªdËDumpCommªd
(
Env
* 
’v
, ** 
fes
, 
num
) {

26 
StdoutPrš‹r
 
	g´š‹r
;

27 
boŞ
 
	gok
 = 
Œue
;

28 
	gi
 = 0; i < 
	gnum
; i++) {

29 
Stus
 
	gs
 = 
DumpFe
(
’v
, 
fes
[
i
], &
´š‹r
);

30 ià(!
	gs
.
ok
()) {

31 
årštf
(
¡d”r
, "%s\n", 
s
.
ToSŒšg
().
c_¡r
());

32 
	gok
 = 
çl£
;

35  
	gok
;

41 
	$U§ge
() {

42 
	`årštf
(
¡d”r
,

45 
	}
}

47 
	$maš
(
¬gc
, ** 
¬gv
) {

48 
Ëv–db
::
Env
* 
’v
 =†ev–db::Env::
	`DeçuÉ
();

49 
boŞ
 
ok
 = 
Œue
;

50 ià(
¬gc
 < 2) {

51 
	`U§ge
();

52 
ok
 = 
çl£
;

54 
¡d
::
¡ršg
 
commªd
 = 
¬gv
[1];

55 ià(
commªd
 == "dump") {

56 
ok
 = 
Ëv–db
::
	`HªdËDumpCommªd
(
’v
, 
¬gv
 + 2, 
¬gc
 - 2);

58 
	`U§ge
();

59 
ok
 = 
çl£
;

62  (
ok
 ? 0 : 1);

63 
	}
}

	@db/log_format.h

8 #iâdeà
STORAGE_LEVELDB_DB_LOG_FORMAT_H_


9 
	#STORAGE_LEVELDB_DB_LOG_FORMAT_H_


	)

11 
Çme¥aû
 
	gËv–db
 {

12 
Çme¥aû
 
	glog
 {

14 
	eRecÜdTy³
 {

16 
	gkZ”oTy³
 = 0,

18 
	gkFuÎTy³
 = 1,

21 
	gkFœ¡Ty³
 = 2,

22 
	gkMiddËTy³
 = 3,

23 
	gkLa¡Ty³
 = 4

25 cÚ¡ 
	gkMaxRecÜdTy³
 = 
kLa¡Ty³
;

27 cÚ¡ 
	gkBlockSize
 = 32768;

30 cÚ¡ 
	gkH—d”Size
 = 4 + 2 + 1;

	@db/log_reader.cc

5 
	~"db/log_»ad”.h
"

7 
	~<¡dio.h
>

9 
	~"Ëv–db/’v.h
"

10 
	~"ut/codšg.h
"

11 
	~"ut/üc32c.h
"

13 
Çme¥aû
 
	gËv–db
 {

14 
Çme¥aû
 
	glog
 {

16 
	gR—d”
::
R•Ü‹r
::~Reporter() {}

18 
R—d”
::R—d”(
Sequ’tŸlFe
* 
fe
, 
R•Ü‹r
* 
»pÜ‹r
, 
boŞ
 
checksum
,

19 
ušt64_t
 
š™Ÿl_off£t
)

20 : 
fe_
(
fe
),

21 
»pÜ‹r_
(
»pÜ‹r
),

22 
checksum_
(
checksum
),

23 
backšg_¡Üe_
(
Ãw
 [
kBlockSize
]),

24 
bufãr_
(),

25 
eof_
(
çl£
),

26 
Ï¡_»cÜd_off£t_
(0),

27 
’d_of_bufãr_off£t_
(0),

28 
š™Ÿl_off£t_
(
š™Ÿl_off£t
),

29 
»syncšg_
(
š™Ÿl_off£t
 > 0) {}

31 
	gR—d”
::~
R—d”
(è{ 
d–‘e
[] 
backšg_¡Üe_
; }

33 
boŞ
 
	gR—d”
::
SkToIn™ŸlBlock
() {

34 cÚ¡ 
size_t
 
off£t_š_block
 = 
š™Ÿl_off£t_
 % 
kBlockSize
;

35 
ušt64_t
 
	gblock_¡¬t_loÿtiÚ
 = 
š™Ÿl_off£t_
 - 
off£t_š_block
;

38 ià(
	goff£t_š_block
 > 
	gkBlockSize
 - 6) {

39 
	gblock_¡¬t_loÿtiÚ
 +ğ
kBlockSize
;

42 
	g’d_of_bufãr_off£t_
 = 
block_¡¬t_loÿtiÚ
;

45 ià(
	gblock_¡¬t_loÿtiÚ
 > 0) {

46 
Stus
 
	gsk_¡©us
 = 
fe_
->
Sk
(
block_¡¬t_loÿtiÚ
);

47 ià(!
	gsk_¡©us
.
ok
()) {

48 
R•ÜtDrİ
(
block_¡¬t_loÿtiÚ
, 
sk_¡©us
);

49  
	gçl£
;

53  
	gŒue
;

56 
boŞ
 
	gR—d”
::
R—dRecÜd
(
Sliû
* 
»cÜd
, 
¡d
::
¡ršg
* 
sü©ch
) {

57 ià(
Ï¡_»cÜd_off£t_
 < 
š™Ÿl_off£t_
) {

58 ià(!
SkToIn™ŸlBlock
()) {

59  
çl£
;

63 
	gsü©ch
->
ş—r
();

64 
	g»cÜd
->
ş—r
();

65 
boŞ
 
	gš_äagm’‹d_»cÜd
 = 
çl£
;

68 
ušt64_t
 
	g´o¥eùive_»cÜd_off£t
 = 0;

70 
Sliû
 
	gäagm’t
;

71 
	gŒue
) {

72 cÚ¡ 
	g»cÜd_ty³
 = 
R—dPhysiÿlRecÜd
(&
äagm’t
);

77 
ušt64_t
 
	gphysiÿl_»cÜd_off£t
 =

78 
’d_of_bufãr_off£t_
 - 
bufãr_
.
size
(è- 
kH—d”Size
 - 
äagm’t
.size();

80 ià(
	g»syncšg_
) {

81 ià(
	g»cÜd_ty³
 =ğ
kMiddËTy³
) {

83 } ià(
	g»cÜd_ty³
 =ğ
kLa¡Ty³
) {

84 
»syncšg_
 = 
çl£
;

87 
	g»syncšg_
 = 
çl£
;

91 
	g»cÜd_ty³
) {

92 
	gkFuÎTy³
:

93 ià(
š_äagm’‹d_»cÜd
) {

98 ià(!
sü©ch
->
em±y
()) {

99 
R•ÜtCÜru±iÚ
(
sü©ch
->
size
(), "partial„ecord withoutƒnd(1)");

102 
	g´o¥eùive_»cÜd_off£t
 = 
physiÿl_»cÜd_off£t
;

103 
	gsü©ch
->
ş—r
();

104 *
	g»cÜd
 = 
äagm’t
;

105 
	gÏ¡_»cÜd_off£t_
 = 
´o¥eùive_»cÜd_off£t
;

106  
	gŒue
;

108 
	gkFœ¡Ty³
:

109 ià(
š_äagm’‹d_»cÜd
) {

114 ià(!
sü©ch
->
em±y
()) {

115 
R•ÜtCÜru±iÚ
(
sü©ch
->
size
(), "partial„ecord withoutƒnd(2)");

118 
	g´o¥eùive_»cÜd_off£t
 = 
physiÿl_»cÜd_off£t
;

119 
	gsü©ch
->
assign
(
äagm’t
.
d©a
(), f¿gm’t.
size
());

120 
	gš_äagm’‹d_»cÜd
 = 
Œue
;

123 
	gkMiddËTy³
:

124 ià(!
š_äagm’‹d_»cÜd
) {

125 
R•ÜtCÜru±iÚ
(
äagm’t
.
size
(),

128 
	gsü©ch
->
­³nd
(
äagm’t
.
d©a
(), f¿gm’t.
size
());

132 
	gkLa¡Ty³
:

133 ià(!
š_äagm’‹d_»cÜd
) {

134 
R•ÜtCÜru±iÚ
(
äagm’t
.
size
(),

137 
	gsü©ch
->
­³nd
(
äagm’t
.
d©a
(), f¿gm’t.
size
());

138 *
	g»cÜd
 = 
Sliû
(*
sü©ch
);

139 
	gÏ¡_»cÜd_off£t_
 = 
´o¥eùive_»cÜd_off£t
;

140  
	gŒue
;

144 
	gkEof
:

145 ià(
š_äagm’‹d_»cÜd
) {

149 
sü©ch
->
ş—r
();

151  
	gçl£
;

153 
	gkBadRecÜd
:

154 ià(
š_äagm’‹d_»cÜd
) {

155 
R•ÜtCÜru±iÚ
(
sü©ch
->
size
(), "error in middle of„ecord");

156 
	gš_äagm’‹d_»cÜd
 = 
çl£
;

157 
	gsü©ch
->
ş—r
();

162 
buf
[40];

163 
¢´štf
(
buf
, (buf), "unknowÀ»cÜdy³ %u", 
»cÜd_ty³
);

164 
R•ÜtCÜru±iÚ
(

165 (
äagm’t
.
size
(è+ (
š_äagm’‹d_»cÜd
 ? 
sü©ch
->size() : 0)),

166 
buf
);

167 
	gš_äagm’‹d_»cÜd
 = 
çl£
;

168 
	gsü©ch
->
ş—r
();

173  
	gçl£
;

176 
ušt64_t
 
	gR—d”
::
La¡RecÜdOff£t
(è{  
Ï¡_»cÜd_off£t_
; }

178 
	gR—d”
::
R•ÜtCÜru±iÚ
(
ušt64_t
 
by‹s
, cÚ¡ * 
»asÚ
) {

179 
R•ÜtDrİ
(
by‹s
, 
Stus
::
CÜru±iÚ
(
»asÚ
));

182 
	gR—d”
::
R•ÜtDrİ
(
ušt64_t
 
by‹s
, cÚ¡ 
Stus
& 
»asÚ
) {

183 ià(
	g»pÜ‹r_
 !ğ
nuÎ±r
 &&

184 
’d_of_bufãr_off£t_
 - 
bufãr_
.
size
(è- 
by‹s
 >ğ
š™Ÿl_off£t_
) {

185 
»pÜ‹r_
->
CÜru±iÚ
(
¡©ic_ÿ¡
<
size_t
>(
by‹s
), 
»asÚ
);

189 
	gR—d”
::
R—dPhysiÿlRecÜd
(
Sliû
* 
»suÉ
) {

190 
Œue
) {

191 ià(
bufãr_
.
size
(è< 
kH—d”Size
) {

192 ià(!
eof_
) {

194 
bufãr_
.
ş—r
();

195 
Stus
 
	g¡©us
 = 
fe_
->
R—d
(
kBlockSize
, &
bufãr_
, 
backšg_¡Üe_
);

196 
	g’d_of_bufãr_off£t_
 +ğ
bufãr_
.
size
();

197 ià(!
	g¡©us
.
ok
()) {

198 
	gbufãr_
.
ş—r
();

199 
R•ÜtDrİ
(
kBlockSize
, 
¡©us
);

200 
	geof_
 = 
Œue
;

201  
	gkEof
;

202 } ià(
	gbufãr_
.
size
(è< 
	gkBlockSize
) {

203 
	geof_
 = 
Œue
;

211 
	gbufãr_
.
ş—r
();

212  
	gkEof
;

217 cÚ¡ * 
	gh—d”
 = 
bufãr_
.
d©a
();

218 cÚ¡ 
ušt32_t
 
	ga
 = 
¡©ic_ÿ¡
<ušt32_t>(
h—d”
[4]) & 0xff;

219 cÚ¡ 
ušt32_t
 
	gb
 = 
¡©ic_ÿ¡
<ušt32_t>(
h—d”
[5]) & 0xff;

220 cÚ¡ 
	gty³
 = 
h—d”
[6];

221 cÚ¡ 
ušt32_t
 
	gËngth
 = 
a
 | (
b
 << 8);

222 ià(
	gkH—d”Size
 + 
	gËngth
 > 
	gbufãr_
.
size
()) {

223 
size_t
 
	gdrİ_size
 = 
bufãr_
.
size
();

224 
	gbufãr_
.
ş—r
();

225 ià(!
	geof_
) {

226 
R•ÜtCÜru±iÚ
(
drİ_size
, "bad„ecord†ength");

227  
	gkBadRecÜd
;

232  
	gkEof
;

235 ià(
	gty³
 =ğ
kZ”oTy³
 && 
Ëngth
 == 0) {

239 
bufãr_
.
ş—r
();

240  
	gkBadRecÜd
;

244 ià(
	gchecksum_
) {

245 
ušt32_t
 
	gex³ùed_üc
 = 
üc32c
::
Unmask
(
DecodeFixed32
(
h—d”
));

246 
ušt32_t
 
	gaùu®_üc
 = 
üc32c
::
V®ue
(
h—d”
 + 6, 1 + 
Ëngth
);

247 ià(
	gaùu®_üc
 !ğ
ex³ùed_üc
) {

252 
size_t
 
drİ_size
 = 
bufãr_
.
size
();

253 
	gbufãr_
.
ş—r
();

254 
R•ÜtCÜru±iÚ
(
drİ_size
, "checksum mismatch");

255  
	gkBadRecÜd
;

259 
	gbufãr_
.
»move_´efix
(
kH—d”Size
 + 
Ëngth
);

262 ià(
	g’d_of_bufãr_off£t_
 - 
	gbufãr_
.
size
(è- 
	gkH—d”Size
 - 
	gËngth
 <

263 
	gš™Ÿl_off£t_
) {

264 
	g»suÉ
->
ş—r
();

265  
	gkBadRecÜd
;

268 *
	g»suÉ
 = 
Sliû
(
h—d”
 + 
kH—d”Size
, 
Ëngth
);

269  
	gty³
;

	@db/log_reader.h

5 #iâdeà
STORAGE_LEVELDB_DB_LOG_READER_H_


6 
	#STORAGE_LEVELDB_DB_LOG_READER_H_


	)

8 
	~<¡dšt.h
>

10 
	~"db/log_fÜm©.h
"

11 
	~"Ëv–db/¦iû.h
"

12 
	~"Ëv–db/¡©us.h
"

14 
Çme¥aû
 
	gËv–db
 {

16 
şass
 
	gSequ’tŸlFe
;

18 
Çme¥aû
 
	glog
 {

20 şas 
	cR—d”
 {

21 
	gpublic
:

23 şas 
	cR•Ü‹r
 {

24 
public
:

25 
vœtu®
 ~
R•Ü‹r
();

29 
vœtu®
 
CÜru±iÚ
(
size_t
 
by‹s
, cÚ¡ 
Stus
& 
¡©us
) = 0;

43 
R—d”
(
Sequ’tŸlFe
* 
fe
, 
R•Ü‹r
* 
»pÜ‹r
, 
boŞ
 
checksum
,

44 
ušt64_t
 
š™Ÿl_off£t
);

46 
R—d”
(cÚ¡ R—d”&èğ
d–‘e
;

47 
	gR—d”
& 
	gİ”©Ü
=(cÚ¡ 
R—d”
&èğ
d–‘e
;

49 ~
R—d”
();

56 
boŞ
 
R—dRecÜd
(
Sliû
* 
»cÜd
, 
¡d
::
¡ršg
* 
sü©ch
);

61 
ušt64_t
 
La¡RecÜdOff£t
();

63 
	g´iv©e
:

66 
kEof
 = 
kMaxRecÜdTy³
 + 1,

72 
	gkBadRecÜd
 = 
kMaxRecÜdTy³
 + 2

78 
boŞ
 
SkToIn™ŸlBlock
();

81 
R—dPhysiÿlRecÜd
(
Sliû
* 
»suÉ
);

85 
R•ÜtCÜru±iÚ
(
ušt64_t
 
by‹s
, cÚ¡ * 
»asÚ
);

86 
R•ÜtDrİ
(
ušt64_t
 
by‹s
, cÚ¡ 
Stus
& 
»asÚ
);

88 
Sequ’tŸlFe
* cÚ¡ 
	gfe_
;

89 
R•Ü‹r
* cÚ¡ 
	g»pÜ‹r_
;

90 
boŞ
 cÚ¡ 
	gchecksum_
;

91 * cÚ¡ 
	gbackšg_¡Üe_
;

92 
Sliû
 
	gbufãr_
;

93 
boŞ
 
	geof_
;

96 
ušt64_t
 
	gÏ¡_»cÜd_off£t_
;

98 
ušt64_t
 
	g’d_of_bufãr_off£t_
;

101 
ušt64_t
 cÚ¡ 
	gš™Ÿl_off£t_
;

106 
boŞ
 
	g»syncšg_
;

	@db/log_test.cc

5 
	~"db/log_»ad”.h
"

6 
	~"db/log_wr™”.h
"

7 
	~"Ëv–db/’v.h
"

8 
	~"ut/codšg.h
"

9 
	~"ut/üc32c.h
"

10 
	~"ut/¿ndom.h
"

11 
	~"ut/‹¡h¬Ãss.h
"

13 
Çme¥aû
 
	gËv–db
 {

14 
Çme¥aû
 
	glog
 {

18 
	g¡d
::
¡ršg
 
BigSŒšg
(cÚ¡ 
¡d
::¡ršg& 
·¹Ÿl_¡ršg
, 
size_t
 
n
) {

19 
	g¡d
::
¡ršg
 
»suÉ
;

20 
	g»suÉ
.
size
(è< 
	gn
) {

21 
	g»suÉ
.
­³nd
(
·¹Ÿl_¡ršg
);

23 
	g»suÉ
.
»size
(
n
);

24  
	g»suÉ
;

28 
	g¡d
::
¡ršg
 
Numb”SŒšg
(
n
) {

29 
buf
[50];

30 
¢´štf
(
buf
, (buf), "%d.", 
n
);

31  
	g¡d
::
¡ršg
(
buf
);

35 
	g¡d
::
¡ršg
 
RªdomSkewedSŒšg
(
i
, 
Rªdom
* 
ºd
) {

36  
BigSŒšg
(
Numb”SŒšg
(
i
), 
ºd
->
Skewed
(17));

39 şas 
	cLogTe¡
 {

40 
	gpublic
:

41 
LogTe¡
()

42 : 
»adšg_
(
çl£
),

43 
wr™”_
(
Ãw
 
Wr™”
(&
de¡_
)),

44 
»ad”_
(
Ãw
 
R—d”
(&
sourû_
, &
»pÜt_
, 
Œue
 ,

47 ~
LogTe¡
() {

48 
d–‘e
 
	gwr™”_
;

49 
d–‘e
 
	g»ad”_
;

52 
Reİ’FÜAµ’d
() {

53 
d–‘e
 
	gwr™”_
;

54 
	gwr™”_
 = 
Ãw
 
Wr™”
(&
de¡_
, de¡_.
cÚ‹Ás_
.
size
());

57 
Wr™e
(cÚ¡ 
¡d
::
¡ršg
& 
msg
) {

58 
ASSERT_TRUE
(!
»adšg_
) << "Write()‡fter startingo„ead";

59 
	gwr™”_
->
AddRecÜd
(
Sliû
(
msg
));

62 
size_t
 
Wr™‹nBy‹s
(ècÚ¡ {  
	gde¡_
.
	gcÚ‹Ás_
.
size
(); }

64 
	g¡d
::
¡ršg
 
R—d
() {

65 ià(!
»adšg_
) {

66 
»adšg_
 = 
Œue
;

67 
	gsourû_
.
	gcÚ‹Ás_
 = 
Sliû
(
de¡_
.
cÚ‹Ás_
);

69 
	g¡d
::
¡ršg
 
sü©ch
;

70 
Sliû
 
	g»cÜd
;

71 ià(
	g»ad”_
->
R—dRecÜd
(&
»cÜd
, &
sü©ch
)) {

72  
	g»cÜd
.
ToSŒšg
();

78 
Inüem’tBy‹
(
off£t
, 
d–
) {

79 
	gde¡_
.
	gcÚ‹Ás_
[
off£t
] +ğ
d–
;

82 
S‘By‹
(
off£t
, 
Ãw_by‹
) {

83 
	gde¡_
.
	gcÚ‹Ás_
[
off£t
] = 
Ãw_by‹
;

86 
ShrškSize
(
by‹s
) {

87 
	gde¡_
.
	gcÚ‹Ás_
.
»size
(
de¡_
.
cÚ‹Ás_
.
size
(è- 
by‹s
);

90 
FixChecksum
(
h—d”_off£t
, 
Ën
) {

92 
ušt32_t
 
	güc
 = 
üc32c
::
V®ue
(&
de¡_
.
cÚ‹Ás_
[
h—d”_off£t
 + 6], 1 + 
Ën
);

93 
	güc
 = 
üc32c
::
Mask
(
üc
);

94 
EncodeFixed32
(&
de¡_
.
cÚ‹Ás_
[
h—d”_off£t
], 
üc
);

97 
FÜûE¼Ü
(è{ 
	gsourû_
.
	gfÜû_”rÜ_
 = 
Œue
; }

99 
size_t
 
Drİ³dBy‹s
(ècÚ¡ {  
	g»pÜt_
.
	gdrİ³d_by‹s_
; }

101 
	g¡d
::
¡ršg
 
R•ÜtMes§ge
(ècÚ¡ {  
»pÜt_
.
mes§ge_
; }

104 
	g¡d
::
¡ršg
 
M©chE¼Ü
(cÚ¡ 
¡d
::¡ršg& 
msg
) const {

105 ià(
»pÜt_
.
mes§ge_
.
fšd
(
msg
è=ğ
¡d
::
¡ršg
::
Åos
) {

106  
»pÜt_
.
mes§ge_
;

112 
Wr™eIn™ŸlOff£tLog
() {

113 
	gi
 = 0; i < 
	gnum_š™Ÿl_off£t_»cÜds_
; i++) {

114 
	g¡d
::
¡ršg
 
»cÜd
(
š™Ÿl_off£t_»cÜd_sizes_
[
i
],

115 
¡©ic_ÿ¡
<>('a' + 
i
));

116 
Wr™e
(
»cÜd
);

120 
S¹R—dšgAt
(
ušt64_t
 
š™Ÿl_off£t
) {

121 
d–‘e
 
	g»ad”_
;

122 
	g»ad”_
 = 
Ãw
 
R—d”
(&
sourû_
, &
»pÜt_
, 
Œue
 , 
š™Ÿl_off£t
);

125 
CheckOff£tPa¡EndR‘uºsNoRecÜds
(
ušt64_t
 
off£t_·¡_’d
) {

126 
Wr™eIn™ŸlOff£tLog
();

127 
	g»adšg_
 = 
Œue
;

128 
	gsourû_
.
	gcÚ‹Ás_
 = 
Sliû
(
de¡_
.
cÚ‹Ás_
);

129 
R—d”
* 
	goff£t_»ad”
 = 
Ãw
 R—d”(&
sourû_
, &
»pÜt_
, 
Œue
 ,

130 
Wr™‹nBy‹s
(è+ 
off£t_·¡_’d
);

131 
Sliû
 
	g»cÜd
;

132 
	g¡d
::
¡ršg
 
sü©ch
;

133 
ASSERT_TRUE
(!
off£t_»ad”
->
R—dRecÜd
(&
»cÜd
, &
sü©ch
));

134 
d–‘e
 
	goff£t_»ad”
;

137 
CheckIn™ŸlOff£tRecÜd
(
ušt64_t
 
š™Ÿl_off£t
,

138 
ex³ùed_»cÜd_off£t
) {

139 
Wr™eIn™ŸlOff£tLog
();

140 
	g»adšg_
 = 
Œue
;

141 
	gsourû_
.
	gcÚ‹Ás_
 = 
Sliû
(
de¡_
.
cÚ‹Ás_
);

142 
R—d”
* 
	goff£t_»ad”
 =

143 
Ãw
 
R—d”
(&
sourû_
, &
»pÜt_
, 
Œue
 , 
š™Ÿl_off£t
);

146 
ASSERT_LT
(
ex³ùed_»cÜd_off£t
, 
num_š™Ÿl_off£t_»cÜds_
);

147 ; 
	gex³ùed_»cÜd_off£t
 < 
	gnum_š™Ÿl_off£t_»cÜds_
;

148 ++
	gex³ùed_»cÜd_off£t
) {

149 
Sliû
 
	g»cÜd
;

150 
	g¡d
::
¡ršg
 
sü©ch
;

151 
ASSERT_TRUE
(
off£t_»ad”
->
R—dRecÜd
(&
»cÜd
, &
sü©ch
));

152 
ASSERT_EQ
(
š™Ÿl_off£t_»cÜd_sizes_
[
ex³ùed_»cÜd_off£t
],

153 
»cÜd
.
size
());

154 
ASSERT_EQ
(
š™Ÿl_off£t_Ï¡_»cÜd_off£ts_
[
ex³ùed_»cÜd_off£t
],

155 
off£t_»ad”
->
La¡RecÜdOff£t
());

156 
ASSERT_EQ
(()('a' + 
ex³ùed_»cÜd_off£t
), 
»cÜd
.
d©a
()[0]);

158 
d–‘e
 
	goff£t_»ad”
;

161 
	g´iv©e
:

162 şas 
	cSŒšgDe¡
 : 
public
 
Wr™abËFe
 {

163 
public
:

164 
vœtu®
 
Stus
 
Clo£
(è{  Stus::
OK
(); }

165 
vœtu®
 
Stus
 
Flush
(è{  
	gStus
::
OK
(); }

166 
vœtu®
 
Stus
 
Sync
(è{  
	gStus
::
OK
(); }

167 
vœtu®
 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
¦iû
) {

168 
	gcÚ‹Ás_
.
­³nd
(
¦iû
.
d©a
(), sliû.
size
());

169  
	gStus
::
OK
();

172 
	g¡d
::
¡ršg
 
cÚ‹Ás_
;

175 şas 
	cSŒšgSourû
 : 
public
 
Sequ’tŸlFe
 {

176 
public
:

177 
SŒšgSourû
(è: 
fÜû_”rÜ_
(
çl£
), 
»tuºed_·¹Ÿl_
(false) {}

179 
vœtu®
 
Stus
 
R—d
(
size_t
 
n
, 
Sliû
* 
»suÉ
, * 
sü©ch
) {

180 
ASSERT_TRUE
(!
»tuºed_·¹Ÿl_
) << "must‚ot Read()‡fterƒof/error";

182 ià(
	gfÜû_”rÜ_
) {

183 
	gfÜû_”rÜ_
 = 
çl£
;

184 
	g»tuºed_·¹Ÿl_
 = 
Œue
;

185  
	gStus
::
CÜru±iÚ
("readƒrror");

188 ià(
	gcÚ‹Ás_
.
size
(è< 
	gn
) {

189 
	gn
 = 
cÚ‹Ás_
.
size
();

190 
	g»tuºed_·¹Ÿl_
 = 
Œue
;

192 *
	g»suÉ
 = 
Sliû
(
cÚ‹Ás_
.
d©a
(), 
n
);

193 
	gcÚ‹Ás_
.
»move_´efix
(
n
);

194  
	gStus
::
OK
();

197 
vœtu®
 
Stus
 
Sk
(
ušt64_t
 
n
) {

198 ià(
	gn
 > 
	gcÚ‹Ás_
.
size
()) {

199 
	gcÚ‹Ás_
.
ş—r
();

200  
	gStus
::
NÙFound
("in-memory file skipped…astƒnd");

203 
	gcÚ‹Ás_
.
»move_´efix
(
n
);

205  
	gStus
::
OK
();

208 
Sliû
 
	gcÚ‹Ás_
;

209 
boŞ
 
	gfÜû_”rÜ_
;

210 
boŞ
 
	g»tuºed_·¹Ÿl_
;

213 şas 
	cR•ÜtCŞËùÜ
 : 
public
 
R—d”
::
R•Ü‹r
 {

214 
public
:

215 
R•ÜtCŞËùÜ
(è: 
drİ³d_by‹s_
(0) {}

216 
vœtu®
 
CÜru±iÚ
(
size_t
 
by‹s
, cÚ¡ 
Stus
& 
¡©us
) {

217 
	gdrİ³d_by‹s_
 +ğ
by‹s
;

218 
	gmes§ge_
.
­³nd
(
¡©us
.
ToSŒšg
());

221 
size_t
 
	gdrİ³d_by‹s_
;

222 
	g¡d
::
¡ršg
 
mes§ge_
;

226 
size_t
 
	gš™Ÿl_off£t_»cÜd_sizes_
[];

227 
ušt64_t
 
	gš™Ÿl_off£t_Ï¡_»cÜd_off£ts_
[];

228 
	gnum_š™Ÿl_off£t_»cÜds_
;

230 
SŒšgDe¡
 
	gde¡_
;

231 
SŒšgSourû
 
	gsourû_
;

232 
R•ÜtCŞËùÜ
 
	g»pÜt_
;

233 
boŞ
 
	g»adšg_
;

234 
Wr™”
* 
	gwr™”_
;

235 
R—d”
* 
	g»ad”_
;

238 
size_t
 
	gLogTe¡
::
š™Ÿl_off£t_»cÜd_sizes_
[] = {

241 2 * 
log
::
kBlockSize
 - 1000,

244 
log
::
kBlockSize
 - 
kH—d”Size
,

247 
ušt64_t
 
	gLogTe¡
::
š™Ÿl_off£t_Ï¡_»cÜd_off£ts_
[] = {

249 
kH—d”Size
 + 10000,

250 2 * (
kH—d”Size
 + 10000),

251 2 * (
kH—d”Size
 + 10000è+ (2 * 
log
::
kBlockSize
 - 1000) + 3 * kHeaderSize,

252 2 * (
kH—d”Size
 + 10000è+ (2 * 
log
::
kBlockSize
 - 1000) + 3 * kHeaderSize +

253 
kH—d”Size
 + 1,

254 3 * 
log
::
kBlockSize
,

258 
	gLogTe¡
::
num_š™Ÿl_off£t_»cÜds_
 =

259 (
LogTe¡
::
š™Ÿl_off£t_Ï¡_»cÜd_off£ts_
è/ (
ušt64_t
);

261 
TEST
(
LogTe¡
, 
Em±y
è{ 
ASSERT_EQ
("EOF", 
R—d
()); }

263 
TEST
(
LogTe¡
, 
R—dWr™e
) {

264 
Wr™e
("foo");

265 
Wr™e
("bar");

266 
Wr™e
("");

267 
Wr™e
("xxxx");

268 
ASSERT_EQ
("foo", 
R—d
());

269 
ASSERT_EQ
("b¬", 
R—d
());

270 
ASSERT_EQ
("", 
R—d
());

271 
ASSERT_EQ
("xxxx", 
R—d
());

272 
ASSERT_EQ
("EOF", 
R—d
());

273 
ASSERT_EQ
("EOF", 
R—d
());

276 
TEST
(
LogTe¡
, 
MªyBlocks
) {

277 
	gi
 = 0; i < 100000; i++) {

278 
Wr™e
(
Numb”SŒšg
(
i
));

280 
	gi
 = 0; i < 100000; i++) {

281 
ASSERT_EQ
(
Numb”SŒšg
(
i
), 
R—d
());

283 
ASSERT_EQ
("EOF", 
R—d
());

286 
TEST
(
LogTe¡
, 
F¿gm’tiÚ
) {

287 
Wr™e
("small");

288 
Wr™e
(
BigSŒšg
("medium", 50000));

289 
Wr™e
(
BigSŒšg
("large", 100000));

290 
ASSERT_EQ
("sm®l", 
R—d
());

291 
ASSERT_EQ
(
BigSŒšg
("medium", 50000), 
R—d
());

292 
ASSERT_EQ
(
BigSŒšg
("Ïrge", 100000), 
R—d
());

293 
ASSERT_EQ
("EOF", 
R—d
());

296 
TEST
(
LogTe¡
, 
M¬gš®T¿”
) {

298 cÚ¡ 
	gn
 = 
kBlockSize
 - 2 * 
kH—d”Size
;

299 
Wr™e
(
BigSŒšg
("foo", 
n
));

300 
ASSERT_EQ
(
kBlockSize
 - 
kH—d”Size
, 
Wr™‹nBy‹s
());

301 
Wr™e
("");

302 
Wr™e
("bar");

303 
ASSERT_EQ
(
BigSŒšg
("foo", 
n
), 
R—d
());

304 
ASSERT_EQ
("", 
R—d
());

305 
ASSERT_EQ
("b¬", 
R—d
());

306 
ASSERT_EQ
("EOF", 
R—d
());

309 
TEST
(
LogTe¡
, 
M¬gš®T¿”2
) {

311 cÚ¡ 
	gn
 = 
kBlockSize
 - 2 * 
kH—d”Size
;

312 
Wr™e
(
BigSŒšg
("foo", 
n
));

313 
ASSERT_EQ
(
kBlockSize
 - 
kH—d”Size
, 
Wr™‹nBy‹s
());

314 
Wr™e
("bar");

315 
ASSERT_EQ
(
BigSŒšg
("foo", 
n
), 
R—d
());

316 
ASSERT_EQ
("b¬", 
R—d
());

317 
ASSERT_EQ
("EOF", 
R—d
());

318 
ASSERT_EQ
(0, 
Drİ³dBy‹s
());

319 
ASSERT_EQ
("", 
R•ÜtMes§ge
());

322 
TEST
(
LogTe¡
, 
ShÜtT¿”
) {

323 cÚ¡ 
	gn
 = 
kBlockSize
 - 2 * 
kH—d”Size
 + 4;

324 
Wr™e
(
BigSŒšg
("foo", 
n
));

325 
ASSERT_EQ
(
kBlockSize
 - 
kH—d”Size
 + 4, 
Wr™‹nBy‹s
());

326 
Wr™e
("");

327 
Wr™e
("bar");

328 
ASSERT_EQ
(
BigSŒšg
("foo", 
n
), 
R—d
());

329 
ASSERT_EQ
("", 
R—d
());

330 
ASSERT_EQ
("b¬", 
R—d
());

331 
ASSERT_EQ
("EOF", 
R—d
());

334 
TEST
(
LogTe¡
, 
AligÃdEof
) {

335 cÚ¡ 
	gn
 = 
kBlockSize
 - 2 * 
kH—d”Size
 + 4;

336 
Wr™e
(
BigSŒšg
("foo", 
n
));

337 
ASSERT_EQ
(
kBlockSize
 - 
kH—d”Size
 + 4, 
Wr™‹nBy‹s
());

338 
ASSERT_EQ
(
BigSŒšg
("foo", 
n
), 
R—d
());

339 
ASSERT_EQ
("EOF", 
R—d
());

342 
TEST
(
LogTe¡
, 
O³nFÜAµ’d
) {

343 
Wr™e
("hello");

344 
Reİ’FÜAµ’d
();

345 
Wr™e
("world");

346 
ASSERT_EQ
("h–lo", 
R—d
());

347 
ASSERT_EQ
("wÜld", 
R—d
());

348 
ASSERT_EQ
("EOF", 
R—d
());

351 
TEST
(
LogTe¡
, 
RªdomR—d
) {

352 cÚ¡ 
	gN
 = 500;

353 
Rªdom
 
wr™e_ºd
(301);

354 
	gi
 = 0; i < 
	gN
; i++) {

355 
Wr™e
(
RªdomSkewedSŒšg
(
i
, &
wr™e_ºd
));

357 
Rªdom
 
»ad_ºd
(301);

358 
	gi
 = 0; i < 
	gN
; i++) {

359 
ASSERT_EQ
(
RªdomSkewedSŒšg
(
i
, &
»ad_ºd
), 
R—d
());

361 
ASSERT_EQ
("EOF", 
R—d
());

366 
TEST
(
LogTe¡
, 
R—dE¼Ü
) {

367 
Wr™e
("foo");

368 
FÜûE¼Ü
();

369 
ASSERT_EQ
("EOF", 
R—d
());

370 
ASSERT_EQ
(
kBlockSize
, 
Drİ³dBy‹s
());

371 
ASSERT_EQ
("OK", 
M©chE¼Ü
("readƒrror"));

374 
TEST
(
LogTe¡
, 
BadRecÜdTy³
) {

375 
Wr™e
("foo");

377 
Inüem’tBy‹
(6, 100);

378 
FixChecksum
(0, 3);

379 
ASSERT_EQ
("EOF", 
R—d
());

380 
ASSERT_EQ
(3, 
Drİ³dBy‹s
());

381 
ASSERT_EQ
("OK", 
M©chE¼Ü
("unknown„ecordype"));

384 
TEST
(
LogTe¡
, 
Trunÿ‹dT¿šgRecÜdIsIgnÜed
) {

385 
Wr™e
("foo");

386 
ShrškSize
(4);

387 
ASSERT_EQ
("EOF", 
R—d
());

389 
ASSERT_EQ
(0, 
Drİ³dBy‹s
());

390 
ASSERT_EQ
("", 
R•ÜtMes§ge
());

393 
TEST
(
LogTe¡
, 
BadL’gth
) {

394 cÚ¡ 
	gkPaylßdSize
 = 
kBlockSize
 - 
kH—d”Size
;

395 
Wr™e
(
BigSŒšg
("b¬", 
kPaylßdSize
));

396 
Wr™e
("foo");

398 
Inüem’tBy‹
(4, 1);

399 
ASSERT_EQ
("foo", 
R—d
());

400 
ASSERT_EQ
(
kBlockSize
, 
Drİ³dBy‹s
());

401 
ASSERT_EQ
("OK", 
M©chE¼Ü
("bad„ecord†ength"));

404 
TEST
(
LogTe¡
, 
BadL’gthAtEndIsIgnÜed
) {

405 
Wr™e
("foo");

406 
ShrškSize
(1);

407 
ASSERT_EQ
("EOF", 
R—d
());

408 
ASSERT_EQ
(0, 
Drİ³dBy‹s
());

409 
ASSERT_EQ
("", 
R•ÜtMes§ge
());

412 
TEST
(
LogTe¡
, 
ChecksumMism©ch
) {

413 
Wr™e
("foo");

414 
Inüem’tBy‹
(0, 10);

415 
ASSERT_EQ
("EOF", 
R—d
());

416 
ASSERT_EQ
(10, 
Drİ³dBy‹s
());

417 
ASSERT_EQ
("OK", 
M©chE¼Ü
("checksum mismatch"));

420 
TEST
(
LogTe¡
, 
UÃx³ùedMiddËTy³
) {

421 
Wr™e
("foo");

422 
S‘By‹
(6, 
kMiddËTy³
);

423 
FixChecksum
(0, 3);

424 
ASSERT_EQ
("EOF", 
R—d
());

425 
ASSERT_EQ
(3, 
Drİ³dBy‹s
());

426 
ASSERT_EQ
("OK", 
M©chE¼Ü
("missing start"));

429 
TEST
(
LogTe¡
, 
UÃx³ùedLa¡Ty³
) {

430 
Wr™e
("foo");

431 
S‘By‹
(6, 
kLa¡Ty³
);

432 
FixChecksum
(0, 3);

433 
ASSERT_EQ
("EOF", 
R—d
());

434 
ASSERT_EQ
(3, 
Drİ³dBy‹s
());

435 
ASSERT_EQ
("OK", 
M©chE¼Ü
("missing start"));

438 
TEST
(
LogTe¡
, 
UÃx³ùedFuÎTy³
) {

439 
Wr™e
("foo");

440 
Wr™e
("bar");

441 
S‘By‹
(6, 
kFœ¡Ty³
);

442 
FixChecksum
(0, 3);

443 
ASSERT_EQ
("b¬", 
R—d
());

444 
ASSERT_EQ
("EOF", 
R—d
());

445 
ASSERT_EQ
(3, 
Drİ³dBy‹s
());

446 
ASSERT_EQ
("OK", 
M©chE¼Ü
("partial„ecord withoutƒnd"));

449 
TEST
(
LogTe¡
, 
UÃx³ùedFœ¡Ty³
) {

450 
Wr™e
("foo");

451 
Wr™e
(
BigSŒšg
("bar", 100000));

452 
S‘By‹
(6, 
kFœ¡Ty³
);

453 
FixChecksum
(0, 3);

454 
ASSERT_EQ
(
BigSŒšg
("b¬", 100000), 
R—d
());

455 
ASSERT_EQ
("EOF", 
R—d
());

456 
ASSERT_EQ
(3, 
Drİ³dBy‹s
());

457 
ASSERT_EQ
("OK", 
M©chE¼Ü
("partial„ecord withoutƒnd"));

460 
TEST
(
LogTe¡
, 
MissšgLa¡IsIgnÜed
) {

461 
Wr™e
(
BigSŒšg
("b¬", 
kBlockSize
));

463 
ShrškSize
(14);

464 
ASSERT_EQ
("EOF", 
R—d
());

465 
ASSERT_EQ
("", 
R•ÜtMes§ge
());

466 
ASSERT_EQ
(0, 
Drİ³dBy‹s
());

469 
TEST
(
LogTe¡
, 
P¬tŸlLa¡IsIgnÜed
) {

470 
Wr™e
(
BigSŒšg
("b¬", 
kBlockSize
));

472 
ShrškSize
(1);

473 
ASSERT_EQ
("EOF", 
R—d
());

474 
ASSERT_EQ
("", 
R•ÜtMes§ge
());

475 
ASSERT_EQ
(0, 
Drİ³dBy‹s
());

478 
TEST
(
LogTe¡
, 
SkIÁoMuÉiRecÜd
) {

484 
Wr™e
(
BigSŒšg
("foo", 3 * 
kBlockSize
));

485 
Wr™e
("correct");

486 
S¹R—dšgAt
(
kBlockSize
);

488 
ASSERT_EQ
("cÜ»ù", 
R—d
());

489 
ASSERT_EQ
("", 
R•ÜtMes§ge
());

490 
ASSERT_EQ
(0, 
Drİ³dBy‹s
());

491 
ASSERT_EQ
("EOF", 
R—d
());

494 
TEST
(
LogTe¡
, 
E¼ÜJošsRecÜds
) {

501 
Wr™e
(
BigSŒšg
("foo", 
kBlockSize
));

502 
Wr™e
(
BigSŒšg
("b¬", 
kBlockSize
));

503 
Wr™e
("correct");

506 
	goff£t
 = 
kBlockSize
; off£ˆ< 2 * 
	gkBlockSize
; offset++) {

507 
S‘By‹
(
off£t
, 'x');

510 
ASSERT_EQ
("cÜ»ù", 
R—d
());

511 
ASSERT_EQ
("EOF", 
R—d
());

512 cÚ¡ 
size_t
 
	gdrİ³d
 = 
Drİ³dBy‹s
();

513 
ASSERT_LE
(
drİ³d
, 2 * 
kBlockSize
 + 100);

514 
ASSERT_GE
(
drİ³d
, 2 * 
kBlockSize
);

517 
TEST
(
LogTe¡
, 
R—dS¹
è{ 
CheckIn™ŸlOff£tRecÜd
(0, 0); }

519 
TEST
(
LogTe¡
, 
R—dSecÚdOÃOff
è{ 
CheckIn™ŸlOff£tRecÜd
(1, 1); }

521 
TEST
(
LogTe¡
, 
R—dSecÚdT’Thou§nd
è{ 
CheckIn™ŸlOff£tRecÜd
(10000, 1); }

523 
TEST
(
LogTe¡
, 
R—dSecÚdS¹
è{ 
CheckIn™ŸlOff£tRecÜd
(10007, 1); }

525 
TEST
(
LogTe¡
, 
R—dThœdOÃOff
è{ 
CheckIn™ŸlOff£tRecÜd
(10008, 2); }

527 
TEST
(
LogTe¡
, 
R—dThœdS¹
è{ 
CheckIn™ŸlOff£tRecÜd
(20014, 2); }

529 
TEST
(
LogTe¡
, 
R—dFou¹hOÃOff
è{ 
CheckIn™ŸlOff£tRecÜd
(20015, 3); }

531 
TEST
(
LogTe¡
, 
R—dFou¹hFœ¡BlockT¿”
) {

532 
CheckIn™ŸlOff£tRecÜd
(
log
::
kBlockSize
 - 4, 3);

535 
TEST
(
LogTe¡
, 
R—dFou¹hMiddËBlock
) {

536 
CheckIn™ŸlOff£tRecÜd
(
log
::
kBlockSize
 + 1, 3);

539 
TEST
(
LogTe¡
, 
R—dFou¹hLa¡Block
) {

540 
CheckIn™ŸlOff£tRecÜd
(2 * 
log
::
kBlockSize
 + 1, 3);

543 
TEST
(
LogTe¡
, 
R—dFou¹hS¹
) {

544 
CheckIn™ŸlOff£tRecÜd
(

545 2 * (
kH—d”Size
 + 1000è+ (2 * 
log
::
kBlockSize
 - 1000) + 3 * kHeaderSize,

549 
TEST
(
LogTe¡
, 
R—dIn™ŸlOff£tIÁoBlockPaddšg
) {

550 
CheckIn™ŸlOff£tRecÜd
(3 * 
log
::
kBlockSize
 - 3, 5);

553 
TEST
(
LogTe¡
, 
R—dEnd
è{ 
CheckOff£tPa¡EndR‘uºsNoRecÜds
(0); }

555 
TEST
(
LogTe¡
, 
R—dPa¡End
è{ 
CheckOff£tPa¡EndR‘uºsNoRecÜds
(5); }

560 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/log_writer.cc

5 
	~"db/log_wr™”.h
"

7 
	~<¡dšt.h
>

9 
	~"Ëv–db/’v.h
"

10 
	~"ut/codšg.h
"

11 
	~"ut/üc32c.h
"

13 
Çme¥aû
 
	gËv–db
 {

14 
Çme¥aû
 
	glog
 {

16 
In™Ty³Crc
(
ušt32_t
* 
ty³_üc
) {

17 
	gi
 = 0; i <ğ
kMaxRecÜdTy³
; i++) {

18 
	gt
 = 
¡©ic_ÿ¡
<>(
i
);

19 
	gty³_üc
[
i
] = 
üc32c
::
V®ue
(&
t
, 1);

23 
	gWr™”
::
Wr™”
(
Wr™abËFe
* 
de¡
è: 
de¡_
(de¡), 
block_off£t_
(0) {

24 
In™Ty³Crc
(
ty³_üc_
);

27 
	gWr™”
::
Wr™”
(
Wr™abËFe
* 
de¡
, 
ušt64_t
 
de¡_Ëngth
)

28 : 
de¡_
(
de¡
), 
block_off£t_
(
de¡_Ëngth
 % 
kBlockSize
) {

29 
In™Ty³Crc
(
ty³_üc_
);

32 
	gWr™”
::~
Wr™”
() {}

34 
Stus
 
Wr™”
::
AddRecÜd
(cÚ¡ 
Sliû
& 
¦iû
) {

35 cÚ¡ * 
±r
 = 
¦iû
.
d©a
();

36 
size_t
 
	gËá
 = 
¦iû
.
size
();

41 
Stus
 
	gs
;

42 
boŞ
 
	gbegš
 = 
Œue
;

44 cÚ¡ 
	gËáov”
 = 
kBlockSize
 - 
block_off£t_
;

45 
as£¹
(
Ëáov”
 >= 0);

46 ià(
	gËáov”
 < 
	gkH—d”Size
) {

48 ià(
	gËáov”
 > 0) {

50 
¡©ic_as£¹
(
kH—d”Size
 == 7, "");

51 
	gde¡_
->
Aµ’d
(
Sliû
("\x00\x00\x00\x00\x00\x00", 
Ëáov”
));

53 
	gblock_off£t_
 = 0;

57 
as£¹
(
kBlockSize
 - 
block_off£t_
 - 
kH—d”Size
 >= 0);

59 cÚ¡ 
size_t
 
	gava
 = 
kBlockSize
 - 
block_off£t_
 - 
kH—d”Size
;

60 cÚ¡ 
size_t
 
	gäagm’t_Ëngth
 = (
Ëá
 < 
ava
) ?†eft :‡vail;

62 
RecÜdTy³
 
	gty³
;

63 cÚ¡ 
boŞ
 
	g’d
 = (
Ëá
 =ğ
äagm’t_Ëngth
);

64 ià(
	gbegš
 && 
	g’d
) {

65 
	gty³
 = 
kFuÎTy³
;

66 } ià(
	gbegš
) {

67 
	gty³
 = 
kFœ¡Ty³
;

68 } ià(
	g’d
) {

69 
	gty³
 = 
kLa¡Ty³
;

71 
	gty³
 = 
kMiddËTy³
;

74 
	gs
 = 
Em™PhysiÿlRecÜd
(
ty³
, 
±r
, 
äagm’t_Ëngth
);

75 
	g±r
 +ğ
äagm’t_Ëngth
;

76 
	gËá
 -ğ
äagm’t_Ëngth
;

77 
	gbegš
 = 
çl£
;

78 } 
	gs
.
ok
(è&& 
	gËá
 > 0);

79  
	gs
;

82 
Stus
 
	gWr™”
::
Em™PhysiÿlRecÜd
(
RecÜdTy³
 
t
, cÚ¡ * 
±r
,

83 
size_t
 
Ëngth
) {

84 
as£¹
(
Ëngth
 <= 0xffff);

85 
as£¹
(
block_off£t_
 + 
kH—d”Size
 + 
Ëngth
 <ğ
kBlockSize
);

88 
	gbuf
[
kH—d”Size
];

89 
	gbuf
[4] = 
¡©ic_ÿ¡
<>(
Ëngth
 & 0xff);

90 
	gbuf
[5] = 
¡©ic_ÿ¡
<>(
Ëngth
 >> 8);

91 
	gbuf
[6] = 
¡©ic_ÿ¡
<>(
t
);

94 
ušt32_t
 
	güc
 = 
üc32c
::
Ex‹nd
(
ty³_üc_
[
t
], 
±r
, 
Ëngth
);

95 
	güc
 = 
üc32c
::
Mask
(
üc
);

96 
EncodeFixed32
(
buf
, 
üc
);

99 
Stus
 
	gs
 = 
de¡_
->
Aµ’d
(
Sliû
(
buf
, 
kH—d”Size
));

100 ià(
	gs
.
ok
()) {

101 
	gs
 = 
de¡_
->
Aµ’d
(
Sliû
(
±r
, 
Ëngth
));

102 ià(
	gs
.
ok
()) {

103 
	gs
 = 
de¡_
->
Flush
();

106 
	gblock_off£t_
 +ğ
kH—d”Size
 + 
Ëngth
;

107  
	gs
;

	@db/log_writer.h

5 #iâdeà
STORAGE_LEVELDB_DB_LOG_WRITER_H_


6 
	#STORAGE_LEVELDB_DB_LOG_WRITER_H_


	)

8 
	~<¡dšt.h
>

10 
	~"db/log_fÜm©.h
"

11 
	~"Ëv–db/¦iû.h
"

12 
	~"Ëv–db/¡©us.h
"

14 
Çme¥aû
 
	gËv–db
 {

16 
şass
 
	gWr™abËFe
;

18 
Çme¥aû
 
	glog
 {

20 şas 
	cWr™”
 {

21 
	gpublic
:

25 
ex¶ic™
 
Wr™”
(
Wr™abËFe
* 
de¡
);

30 
Wr™”
(
Wr™abËFe
* 
de¡
, 
ušt64_t
 
de¡_Ëngth
);

32 
Wr™”
(cÚ¡ Wr™”&èğ
d–‘e
;

33 
	gWr™”
& 
	gİ”©Ü
=(cÚ¡ 
Wr™”
&èğ
d–‘e
;

35 ~
Wr™”
();

37 
Stus
 
AddRecÜd
(cÚ¡ 
Sliû
& 
¦iû
);

39 
	g´iv©e
:

40 
Stus
 
Em™PhysiÿlRecÜd
(
RecÜdTy³
 
ty³
, cÚ¡ * 
±r
, 
size_t
 
Ëngth
);

42 
Wr™abËFe
* 
	gde¡_
;

43 
	gblock_off£t_
;

48 
ušt32_t
 
	gty³_üc_
[
kMaxRecÜdTy³
 + 1];

	@db/memtable.cc

5 
	~"db/membË.h
"

6 
	~"db/dbfÜm©.h
"

7 
	~"Ëv–db/com·¿tÜ.h
"

8 
	~"Ëv–db/’v.h
"

9 
	~"Ëv–db/™”©Ü.h
"

10 
	~"ut/codšg.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 
Sliû
 
G‘L’gthP»fixedSliû
(cÚ¡ * 
d©a
) {

15 
ušt32_t
 
	gËn
;

16 cÚ¡ * 
	gp
 = 
d©a
;

17 
	gp
 = 
G‘V¬št32PŒ
(
p
,… + 5, &
Ën
);

18  
Sliû
(
p
, 
Ën
);

21 
	gMemTabË
::
MemTabË
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
com·¿tÜ
)

22 : 
com·¿tÜ_
(
com·¿tÜ
), 
»fs_
(0), 
bË_
(com·¿tÜ_, &
¬’a_
) {}

24 
	gMemTabË
::~
MemTabË
(è{ 
as£¹
(
»fs_
 == 0); }

26 
size_t
 
	gMemTabË
::
Aµroxim©eMemÜyU§ge
(è{  
¬’a_
.
MemÜyU§ge
(); }

28 
	gMemTabË
::
KeyCom·¿tÜ
::
İ”©Ü
()(cÚ¡ * 
­Œ
,

29 cÚ¡ * 
	gb±r
) const {

31 
Sliû
 
	ga
 = 
G‘L’gthP»fixedSliû
(
­Œ
);

32 
Sliû
 
	gb
 = 
G‘L’gthP»fixedSliû
(
b±r
);

33  
	gcom·¿tÜ
.
Com·»
(
a
, 
b
);

39 cÚ¡ * 
EncodeKey
(
¡d
::
¡ršg
* 
sü©ch
, cÚ¡ 
Sliû
& 
rg‘
) {

40 
	gsü©ch
->
ş—r
();

41 
PutV¬št32
(
sü©ch
, 
rg‘
.
size
());

42 
	gsü©ch
->
­³nd
(
rg‘
.
d©a
(),¬g‘.
size
());

43  
	gsü©ch
->
d©a
();

46 şas 
	cMemTabËI‹¿tÜ
 : 
public
 
I‹¿tÜ
 {

47 
public
:

48 
ex¶ic™
 
MemTabËI‹¿tÜ
(
MemTabË
::
TabË
* 
bË
è: 
™”_
(table) {}

50 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  
™”_
.Valid(); }

51 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
k
è{ 
	g™”_
.S“k(
EncodeKey
(&
tmp_
, k)); }

52 
vœtu®
 
S“kToFœ¡
(è{ 
	g™”_
.SeekToFirst(); }

53 
vœtu®
 
S“kToLa¡
(è{ 
	g™”_
.SeekToLast(); }

54 
vœtu®
 
Next
(è{ 
	g™”_
.Next(); }

55 
vœtu®
 
P»v
(è{ 
	g™”_
.Prev(); }

56 
vœtu®
 
Sliû
 
key
(ècÚ¡ {  
G‘L’gthP»fixedSliû
(
™”_
.key()); }

57 
vœtu®
 
Sliû
 
v®ue
() const {

58 
Sliû
 
	gkey_¦iû
 = 
G‘L’gthP»fixedSliû
(
™”_
.
key
());

59  
G‘L’gthP»fixedSliû
(
key_¦iû
.
d©a
(è+ key_¦iû.
size
());

62 
vœtu®
 
Stus
 
¡©us
(ècÚ¡ {  
	gStus
::
OK
(); }

64 
	g´iv©e
:

65 
MemTabË
::
TabË
::
I‹¿tÜ
 
™”_
;

66 
	g¡d
::
¡ršg
 
tmp_
;

69 
MemTabËI‹¿tÜ
(const MemTableIterator&);

70 
	gİ”©Ü
=(cÚ¡ 
MemTabËI‹¿tÜ
&);

73 
I‹¿tÜ
* 
	gMemTabË
::
	$NewI‹¿tÜ
(è{  
Ãw
 
	`MemTabËI‹¿tÜ
(&
bË_
); 
	}
}

75 
	gMemTabË
::
	$Add
(
Sequ’ûNumb”
 
s
, 
V®ueTy³
 
ty³
, cÚ¡ 
Sliû
& 
key
,

76 cÚ¡ 
Sliû
& 
v®ue
) {

82 
size_t
 
key_size
 = 
key
.
	`size
();

83 
size_t
 
v®_size
 = 
v®ue
.
	`size
();

84 
size_t
 
š‹º®_key_size
 = 
key_size
 + 8;

85 cÚ¡ 
size_t
 
’coded_Ën
 = 
	`V¬štL’gth
(
š‹º®_key_size
) +

86 
š‹º®_key_size
 + 
	`V¬štL’gth
(
v®_size
) +

87 
v®_size
;

88 * 
buf
 = 
¬’a_
.
	`AÎoÿ‹
(
’coded_Ën
);

89 * 
p
 = 
	`EncodeV¬št32
(
buf
, 
š‹º®_key_size
);

90 
	`memıy
(
p
, 
key
.
	`d©a
(), 
key_size
);

91 
p
 +ğ
key_size
;

92 
	`EncodeFixed64
(
p
, (
s
 << 8è| 
ty³
);

93 
p
 += 8;

94 
p
 = 
	`EncodeV¬št32
Õ, 
v®_size
);

95 
	`memıy
(
p
, 
v®ue
.
	`d©a
(), 
v®_size
);

96 
	`as£¹
(
p
 + 
v®_size
 =ğ
buf
 + 
’coded_Ën
);

97 
bË_
.
	`In£¹
(
buf
);

98 
	}
}

100 
boŞ
 
	gMemTabË
::
	$G‘
(cÚ¡ 
LookupKey
& 
key
, 
¡d
::
¡ršg
* 
v®ue
, 
Stus
* 
s
) {

101 
Sliû
 
memkey
 = 
key
.
	`membË_key
();

102 
TabË
::
I‹¿tÜ
 
	`™”
(&
bË_
);

103 
™”
.
	`S“k
(
memkey
.
	`d©a
());

104 ià(
™”
.
	`V®id
()) {

114 cÚ¡ * 
’Œy
 = 
™”
.
	`key
();

115 
ušt32_t
 
key_Ëngth
;

116 cÚ¡ * 
key_±r
 = 
	`G‘V¬št32PŒ
(
’Œy
,ƒÁry + 5, &
key_Ëngth
);

117 ià(
com·¿tÜ_
.
com·¿tÜ
.
	`u£r_com·¿tÜ
()->
	`Com·»
(

118 
	`Sliû
(
key_±r
, 
key_Ëngth
 - 8), 
key
.
	`u£r_key
()) == 0) {

120 cÚ¡ 
ušt64_t
 
g
 = 
	`DecodeFixed64
(
key_±r
 + 
key_Ëngth
 - 8);

121 
¡©ic_ÿ¡
<
V®ueTy³
>(
g
 & 0xff)) {

122 
kTy³V®ue
: {

123 
Sliû
 
v
 = 
	`G‘L’gthP»fixedSliû
(
key_±r
 + 
key_Ëngth
);

124 
v®ue
->
	`assign
(
v
.
	`d©a
(), v.
	`size
());

125  
Œue
;

127 
kTy³D–‘iÚ
:

128 *
s
 = 
Stus
::
	`NÙFound
(
	`Sliû
());

129  
Œue
;

133  
çl£
;

134 
	}
}

	@db/memtable.h

5 #iâdeà
STORAGE_LEVELDB_DB_MEMTABLE_H_


6 
	#STORAGE_LEVELDB_DB_MEMTABLE_H_


	)

8 
	~<¡ršg
>

10 
	~"db/dbfÜm©.h
"

11 
	~"db/skli¡.h
"

12 
	~"Ëv–db/db.h
"

13 
	~"ut/¬’a.h
"

15 
Çme¥aû
 
	gËv–db
 {

17 
şass
 
	gIÁ”ÇlKeyCom·¿tÜ
;

18 
şass
 
	gMemTabËI‹¿tÜ
;

20 şas 
	cMemTabË
 {

21 
	gpublic
:

24 
ex¶ic™
 
MemTabË
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
com·¿tÜ
);

26 
MemTabË
(cÚ¡ MemTabË&èğ
d–‘e
;

27 
	gMemTabË
& 
	gİ”©Ü
=(cÚ¡ 
MemTabË
&èğ
d–‘e
;

30 
Ref
(è{ ++
	g»fs_
; }

33 
UÄef
() {

34 --
	g»fs_
;

35 
as£¹
(
»fs_
 >= 0);

36 ià(
	g»fs_
 <= 0) {

37 
d–‘e
 
this
;

43 
size_t
 
Aµroxim©eMemÜyU§ge
();

51 
I‹¿tÜ
* 
NewI‹¿tÜ
();

56 
Add
(
Sequ’ûNumb”
 
£q
, 
V®ueTy³
 
ty³
, cÚ¡ 
Sliû
& 
key
,

57 cÚ¡ 
Sliû
& 
v®ue
);

63 
boŞ
 
G‘
(cÚ¡ 
LookupKey
& 
key
, 
¡d
::
¡ršg
* 
v®ue
, 
Stus
* 
s
);

65 
	g´iv©e
:

66 
ä›nd
 
şass
 
MemTabËI‹¿tÜ
;

67 
ä›nd
 
şass
 
	gMemTabËBackw¬dI‹¿tÜ
;

69 
	sKeyCom·¿tÜ
 {

70 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
 
	gcom·¿tÜ
;

71 
ex¶ic™
 
KeyCom·¿tÜ
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
c
è: 
com·¿tÜ
(c) {}

72 
İ”©Ü
()(cÚ¡ * 
a
, cÚ¡ * 
	gb
) const;

75 
	gSkLi¡
<cÚ¡ *, 
	tKeyCom·¿tÜ
> 
	tTabË
;

77 ~
MemTabË
();

79 
KeyCom·¿tÜ
 
	gcom·¿tÜ_
;

80 
	g»fs_
;

81 
A»Ç
 
	g¬’a_
;

82 
TabË
 
	gbË_
;

	@db/recovery_test.cc

5 
	~"db/db_im¶.h
"

6 
	~"db/f’ame.h
"

7 
	~"db/v”siÚ_£t.h
"

8 
	~"db/wr™e_b©ch_š‹º®.h
"

9 
	~"Ëv–db/db.h
"

10 
	~"Ëv–db/’v.h
"

11 
	~"Ëv–db/wr™e_b©ch.h
"

12 
	~"ut/loggšg.h
"

13 
	~"ut/‹¡h¬Ãss.h
"

14 
	~"ut/‹¡ut.h
"

16 
Çme¥aû
 
	gËv–db
 {

18 şas 
	cRecov”yTe¡
 {

19 
	gpublic
:

20 
Recov”yTe¡
(è: 
’v_
(
Env
::
DeçuÉ
()), 
db_
(
nuÎ±r
) {

21 
	gdbÇme_
 = 
‹¡
::
TmpDœ
() + "/recovery_test";

22 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

23 
O³n
();

26 ~
Recov”yTe¡
() {

27 
Clo£
();

28 
De¡royDB
(
dbÇme_
, 
O±iÚs
());

31 
DBIm¶
* 
dbfuÎ
(ècÚ¡ {  
	g»š‹½»t_ÿ¡
<
	gDBIm¶
*>(
	gdb_
); }

32 
Env
* 
’v
(ècÚ¡ {  
	g’v_
; }

34 
boŞ
 
CªAµ’d
() {

35 
Wr™abËFe
* 
	gtmp
;

36 
Stus
 
	gs
 = 
’v_
->
NewAµ’dabËFe
(
Cu¼’tFeName
(
dbÇme_
), &
tmp
);

37 
d–‘e
 
	gtmp
;

38 ià(
	gs
.
IsNÙSuµÜ‹dE¼Ü
()) {

39  
	gçl£
;

41  
	gŒue
;

45 
Clo£
() {

46 
d–‘e
 
	gdb_
;

47 
	gdb_
 = 
nuÎ±r
;

50 
Stus
 
O³nW™hStus
(
O±iÚs
* 
İtiÚs
 = 
nuÎ±r
) {

51 
Clo£
();

52 
O±iÚs
 
	gİts
;

53 ià(
	gİtiÚs
 !ğ
nuÎ±r
) {

54 
İts
 = *
İtiÚs
;

56 
	gİts
.
	g»u£_logs
 = 
Œue
;

57 
	gİts
.
	gü—‹_if_missšg
 = 
Œue
;

59 ià(
	gİts
.
	g’v
 =ğ
nuÎ±r
) {

60 
İts
.
’v
 = 
’v_
;

62  
	gDB
::
O³n
(
İts
, 
dbÇme_
, &
db_
);

65 
O³n
(
O±iÚs
* 
İtiÚs
 = 
nuÎ±r
) {

66 
ASSERT_OK
(
O³nW™hStus
(
İtiÚs
));

67 
ASSERT_EQ
(1, 
NumLogs
());

70 
Stus
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
k
, cÚ¡ std::¡ršg& 
v
) {

71  
db_
->
Put
(
Wr™eO±iÚs
(), 
k
, 
v
);

74 
	g¡d
::
¡ršg
 
G‘
(cÚ¡ 
¡d
::¡ršg& 
k
, cÚ¡ 
SÇpshÙ
* 
¢­shÙ
 = 
nuÎ±r
) {

75 
¡d
::
¡ršg
 
»suÉ
;

76 
Stus
 
	gs
 = 
db_
->
G‘
(
R—dO±iÚs
(), 
k
, &
»suÉ
);

77 ià(
	gs
.
IsNÙFound
()) {

78 
	g»suÉ
 = "NOT_FOUND";

79 } ià(!
	gs
.
ok
()) {

80 
	g»suÉ
 = 
s
.
ToSŒšg
();

82  
	g»suÉ
;

85 
	g¡d
::
¡ršg
 
Mªiã¡FeName
() {

86 
¡d
::
¡ršg
 
cu¼’t
;

87 
ASSERT_OK
(
R—dFeToSŒšg
(
’v_
, 
Cu¼’tFeName
(
dbÇme_
), &
cu¼’t
));

88 
size_t
 
	gËn
 = 
cu¼’t
.
size
();

89 ià(
	gËn
 > 0 && 
	gcu¼’t
[
Ën
 - 1] == '\n') {

90 
cu¼’t
.
»size
(
Ën
 - 1);

92  
	gdbÇme_
 + "/" + 
	gcu¼’t
;

95 
	g¡d
::
¡ršg
 
LogName
(
ušt64_t
 
numb”
è{  
LogFeName
(
dbÇme_
,‚umber); }

97 
size_t
 
D–‘eLogFes
() {

100 
Clo£
();

101 
	g¡d
::
veùÜ
<
ušt64_t
> 
logs
 = 
G‘Fes
(
kLogFe
);

102 
size_t
 
	gi
 = 0; i < 
	glogs
.
size
(); i++) {

103 
ASSERT_OK
(
’v_
->
D–‘eFe
(
LogName
(
logs
[
i
]))) << LogName(logs[i]);

105  
	glogs
.
size
();

108 
D–‘eMªiã¡Fe
(è{ 
ASSERT_OK
(
’v_
->
D–‘eFe
(
Mªiã¡FeName
())); }

110 
ušt64_t
 
Fœ¡LogFe
(è{  
G‘Fes
(
kLogFe
)[0]; }

112 
	g¡d
::
veùÜ
<
ušt64_t
> 
G‘Fes
(
FeTy³
 
t
) {

113 
¡d
::
veùÜ
<¡d::
¡ršg
> 
f’ames
;

114 
ASSERT_OK
(
’v_
->
G‘Chd»n
(
dbÇme_
, &
f’ames
));

115 
	g¡d
::
veùÜ
<
ušt64_t
> 
»suÉ
;

116 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

117 
ušt64_t
 
	gnumb”
;

118 
FeTy³
 
	gty³
;

119 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
è&& 
	gty³
 =ğ
t
) {

120 
»suÉ
.
push_back
(
numb”
);

123  
	g»suÉ
;

126 
NumLogs
(è{  
G‘Fes
(
kLogFe
).
size
(); }

128 
NumTabËs
(è{  
G‘Fes
(
kTabËFe
).
size
(); }

130 
ušt64_t
 
FeSize
(cÚ¡ 
¡d
::
¡ršg
& 
âame
) {

131 
ušt64_t
 
»suÉ
;

132 
ASSERT_OK
(
’v_
->
G‘FeSize
(
âame
, &
»suÉ
)è<< 
	gâame
;

133  
	g»suÉ
;

136 
Com·ùMemTabË
(è{ 
dbfuÎ
()->
TEST_Com·ùMemTabË
(); }

139 
MakeLogFe
(
ušt64_t
 
lognum
, 
Sequ’ûNumb”
 
£q
, 
Sliû
 
key
, Sliû 
v®
) {

140 
	g¡d
::
¡ršg
 
âame
 = 
LogFeName
(
dbÇme_
, 
lognum
);

141 
Wr™abËFe
* 
	gfe
;

142 
ASSERT_OK
(
’v_
->
NewWr™abËFe
(
âame
, &
fe
));

143 
	glog
::
Wr™”
 
wr™”
(
fe
);

144 
Wr™eB©ch
 
	gb©ch
;

145 
	gb©ch
.
Put
(
key
, 
v®
);

146 
	gWr™eB©chIÁ”Çl
::
S‘Sequ’û
(&
b©ch
, 
£q
);

147 
ASSERT_OK
(
wr™”
.
AddRecÜd
(
Wr™eB©chIÁ”Çl
::
CÚ‹Ás
(&
b©ch
)));

148 
ASSERT_OK
(
fe
->
Flush
());

149 
d–‘e
 
	gfe
;

152 
	g´iv©e
:

153 
¡d
::
¡ršg
 
dbÇme_
;

154 
Env
* 
	g’v_
;

155 
DB
* 
	gdb_
;

158 
	$TEST
(
Recov”yTe¡
, 
Mªiã¡Reu£d
) {

159 ià(!
	`CªAµ’d
()) {

160 
	`årštf
(
¡d”r
, "skippingest becauseƒnv does‚ot support‡ppending\n");

163 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

164 
	`Clo£
();

165 
¡d
::
¡ršg
 
Şd_mªiã¡
 = 
	`Mªiã¡FeName
();

166 
	`O³n
();

167 
	`ASSERT_EQ
(
Şd_mªiã¡
, 
	`Mªiã¡FeName
());

168 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

169 
	`O³n
();

170 
	`ASSERT_EQ
(
Şd_mªiã¡
, 
	`Mªiã¡FeName
());

171 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

172 
	}
}

174 
	$TEST
(
Recov”yTe¡
, 
L¬geMªiã¡Com·ùed
) {

175 ià(!
	`CªAµ’d
()) {

176 
	`årštf
(
¡d”r
, "skippingest becauseƒnv does‚ot support‡ppending\n");

179 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

180 
	`Clo£
();

181 
¡d
::
¡ršg
 
Şd_mªiã¡
 = 
	`Mªiã¡FeName
();

185 
ušt64_t
 
Ën
 = 
	`FeSize
(
Şd_mªiã¡
);

186 
Wr™abËFe
* 
fe
;

187 
	`ASSERT_OK
(
	`’v
()->
	`NewAµ’dabËFe
(
Şd_mªiã¡
, &
fe
));

188 
¡d
::
¡ršg
 
	`z”Ûs
(3 * 1048576 - 
¡©ic_ÿ¡
<
size_t
>(
Ën
), 0);

189 
	`ASSERT_OK
(
fe
->
	`Aµ’d
(
z”Ûs
));

190 
	`ASSERT_OK
(
fe
->
	`Flush
());

191 
d–‘e
 
fe
;

194 
	`O³n
();

195 
¡d
::
¡ršg
 
Ãw_mªiã¡
 = 
	`Mªiã¡FeName
();

196 
	`ASSERT_NE
(
Şd_mªiã¡
, 
Ãw_mªiã¡
);

197 
	`ASSERT_GT
(10000, 
	`FeSize
(
Ãw_mªiã¡
));

198 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

200 
	`O³n
();

201 
	`ASSERT_EQ
(
Ãw_mªiã¡
, 
	`Mªiã¡FeName
());

202 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

203 
	}
}

205 
	$TEST
(
Recov”yTe¡
, 
NoLogFes
) {

206 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

207 
	`ASSERT_EQ
(1, 
	`D–‘eLogFes
());

208 
	`O³n
();

209 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("foo"));

210 
	`O³n
();

211 
	`ASSERT_EQ
("NOT_FOUND", 
	`G‘
("foo"));

212 
	}
}

214 
	$TEST
(
Recov”yTe¡
, 
LogFeReu£
) {

215 ià(!
	`CªAµ’d
()) {

216 
	`årštf
(
¡d”r
, "skippingest becauseƒnv does‚ot support‡ppending\n");

219 
i
 = 0; i < 2; i++) {

220 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

221 ià(
i
 == 0) {

223 
	`Com·ùMemTabË
();

225 
	`Clo£
();

226 
	`ASSERT_EQ
(1, 
	`NumLogs
());

227 
ušt64_t
 
numb”
 = 
	`Fœ¡LogFe
();

228 ià(
i
 == 0) {

229 
	`ASSERT_EQ
(0, 
	`FeSize
(
	`LogName
(
numb”
)));

231 
	`ASSERT_LT
(0, 
	`FeSize
(
	`LogName
(
numb”
)));

233 
	`O³n
();

234 
	`ASSERT_EQ
(1, 
	`NumLogs
());

235 
	`ASSERT_EQ
(
numb”
, 
	`Fœ¡LogFe
()) << "did‚ot„euse†og file";

236 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

237 
	`O³n
();

238 
	`ASSERT_EQ
(1, 
	`NumLogs
());

239 
	`ASSERT_EQ
(
numb”
, 
	`Fœ¡LogFe
()) << "did‚ot„euse†og file";

240 
	`ASSERT_EQ
("b¬", 
	`G‘
("foo"));

242 
	}
}

244 
	$TEST
(
Recov”yTe¡
, 
MuÉËMemTabËs
) {

246 cÚ¡ 
kNum
 = 1000;

247 
i
 = 0; i < 
kNum
; i++) {

248 
buf
[100];

249 
	`¢´štf
(
buf
, (buf), "%050d", 
i
);

250 
	`ASSERT_OK
(
	`Put
(
buf
, buf));

252 
	`ASSERT_EQ
(0, 
	`NumTabËs
());

253 
	`Clo£
();

254 
	`ASSERT_EQ
(0, 
	`NumTabËs
());

255 
	`ASSERT_EQ
(1, 
	`NumLogs
());

256 
ušt64_t
 
Şd_log_fe
 = 
	`Fœ¡LogFe
();

259 
O±iÚs
 
İt
;

260 
İt
.
»u£_logs
 = 
Œue
;

261 
İt
.
wr™e_bufãr_size
 = (
kNum
 * 100) / 2;

262 
	`O³n
(&
İt
);

263 
	`ASSERT_LE
(2, 
	`NumTabËs
());

264 
	`ASSERT_EQ
(1, 
	`NumLogs
());

265 
	`ASSERT_NE
(
Şd_log_fe
, 
	`Fœ¡LogFe
()) << "must‚ot„euse†og";

266 
i
 = 0; i < 
kNum
; i++) {

267 
buf
[100];

268 
	`¢´štf
(
buf
, (buf), "%050d", 
i
);

269 
	`ASSERT_EQ
(
buf
, 
	`G‘
(buf));

271 
	}
}

273 
	$TEST
(
Recov”yTe¡
, 
MuÉËLogFes
) {

274 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

275 
	`Clo£
();

276 
	`ASSERT_EQ
(1, 
	`NumLogs
());

279 
ušt64_t
 
Şd_log
 = 
	`Fœ¡LogFe
();

280 
	`MakeLogFe
(
Şd_log
 + 1, 1000, "hello", "world");

281 
	`MakeLogFe
(
Şd_log
 + 2, 1001, "hi", "there");

282 
	`MakeLogFe
(
Şd_log
 + 3, 1002, "foo", "bar2");

285 
	`O³n
();

286 
	`ASSERT_LE
(1, 
	`NumTabËs
());

287 
	`ASSERT_EQ
(1, 
	`NumLogs
());

288 
ušt64_t
 
Ãw_log
 = 
	`Fœ¡LogFe
();

289 
	`ASSERT_LE
(
Şd_log
 + 3, 
Ãw_log
);

290 
	`ASSERT_EQ
("b¬2", 
	`G‘
("foo"));

291 
	`ASSERT_EQ
("wÜld", 
	`G‘
("hello"));

292 
	`ASSERT_EQ
("th”e", 
	`G‘
("hi"));

295 
	`O³n
();

296 
	`ASSERT_LE
(1, 
	`NumTabËs
());

297 
	`ASSERT_EQ
(1, 
	`NumLogs
());

298 ià(
	`CªAµ’d
()) {

299 
	`ASSERT_EQ
(
Ãw_log
, 
	`Fœ¡LogFe
());

301 
	`ASSERT_EQ
("b¬2", 
	`G‘
("foo"));

302 
	`ASSERT_EQ
("wÜld", 
	`G‘
("hello"));

303 
	`ASSERT_EQ
("th”e", 
	`G‘
("hi"));

306 
	`Clo£
();

307 
	`MakeLogFe
(
Şd_log
 + 1, 2000, "hello", "stale write");

308 
	`O³n
();

309 
	`ASSERT_LE
(1, 
	`NumTabËs
());

310 
	`ASSERT_EQ
(1, 
	`NumLogs
());

311 ià(
	`CªAµ’d
()) {

312 
	`ASSERT_EQ
(
Ãw_log
, 
	`Fœ¡LogFe
());

314 
	`ASSERT_EQ
("b¬2", 
	`G‘
("foo"));

315 
	`ASSERT_EQ
("wÜld", 
	`G‘
("hello"));

316 
	`ASSERT_EQ
("th”e", 
	`G‘
("hi"));

317 
	}
}

319 
	$TEST
(
Recov”yTe¡
, 
Mªiã¡Missšg
) {

320 
	`ASSERT_OK
(
	`Put
("foo", "bar"));

321 
	`Clo£
();

322 
	`D–‘eMªiã¡Fe
();

324 
Stus
 
¡©us
 = 
	`O³nW™hStus
();

325 
	`ASSERT_TRUE
(
¡©us
.
	`IsCÜru±iÚ
());

326 
	}
}

330 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/repair.cc

27 
	~"db/bud”.h
"

28 
	~"db/db_im¶.h
"

29 
	~"db/dbfÜm©.h
"

30 
	~"db/f’ame.h
"

31 
	~"db/log_»ad”.h
"

32 
	~"db/log_wr™”.h
"

33 
	~"db/membË.h
"

34 
	~"db/bË_ÿche.h
"

35 
	~"db/v”siÚ_ed™.h
"

36 
	~"db/wr™e_b©ch_š‹º®.h
"

37 
	~"Ëv–db/com·¿tÜ.h
"

38 
	~"Ëv–db/db.h
"

39 
	~"Ëv–db/’v.h
"

43 
Çme¥aû
 
	gËv–db
 {

45 
	gÇme¥aû
 {

47 şas 
	cR•aœ”
 {

48 
	gpublic
:

49 
R•aœ”
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, cÚ¡ 
O±iÚs
& 
İtiÚs
)

50 : 
dbÇme_
(
dbÇme
),

51 
’v_
(
İtiÚs
.
’v
),

52 
icmp_
(
İtiÚs
.
com·¿tÜ
),

53 
Şicy_
(
İtiÚs
.
f‹r_pŞicy
),

54 
İtiÚs_
(
Sª™izeO±iÚs
(
dbÇme
, &
icmp_
, &
Şicy_
, 
İtiÚs
)),

55 
owns_šfo_log_
(
İtiÚs_
.
šfo_log
 !ğ
İtiÚs
.info_log),

56 
owns_ÿche_
(
İtiÚs_
.
block_ÿche
 !ğ
İtiÚs
.block_cache),

57 
Ãxt_fe_numb”_
(1) {

59 
	gbË_ÿche_
 = 
Ãw
 
TabËCache
(
dbÇme_
, 
İtiÚs_
, 10);

62 ~
R•aœ”
() {

63 
d–‘e
 
	gbË_ÿche_
;

64 ià(
	gowns_šfo_log_
) {

65 
d–‘e
 
	gİtiÚs_
.
	gšfo_log
;

67 ià(
	gowns_ÿche_
) {

68 
d–‘e
 
	gİtiÚs_
.
	gblock_ÿche
;

72 
Stus
 
Run
() {

73 
Stus
 
	g¡©us
 = 
FšdFes
();

74 ià(
	g¡©us
.
ok
()) {

75 
CÚv”tLogFesToTabËs
();

76 
ExŒaùM‘aD©a
();

77 
	g¡©us
 = 
Wr™eDesütÜ
();

79 ià(
	g¡©us
.
ok
()) {

80 
	gby‹s
 = 0;

81 
size_t
 
	gi
 = 0; i < 
	gbËs_
.
size
(); i++) {

82 
	gby‹s
 +ğ
bËs_
[
i
].
m‘a
.
fe_size
;

84 
Log
(
İtiÚs_
.
šfo_log
,

89 
dbÇme_
.
c_¡r
(), 
¡©ic_ÿ¡
<>(
bËs_
.
size
()), 
by‹s
);

91  
	g¡©us
;

94 
	g´iv©e
:

95 
	sTabËInfo
 {

96 
FeM‘aD©a
 
m‘a
;

97 
Sequ’ûNumb”
 
	gmax_£qu’û
;

100 
Stus
 
FšdFes
() {

101 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
f’ames
;

102 
Stus
 
	g¡©us
 = 
’v_
->
G‘Chd»n
(
dbÇme_
, &
f’ames
);

103 ià(!
	g¡©us
.
ok
()) {

104  
	g¡©us
;

106 ià(
	gf’ames
.
em±y
()) {

107  
	gStus
::
IOE¼Ü
(
dbÇme_
, "repair found‚o files");

110 
ušt64_t
 
	gnumb”
;

111 
FeTy³
 
	gty³
;

112 
size_t
 
	gi
 = 0; i < 
	gf’ames
.
size
(); i++) {

113 ià(
P¬£FeName
(
f’ames
[
i
], &
numb”
, &
ty³
)) {

114 ià(
	gty³
 =ğ
kDesütÜFe
) {

115 
mªiã¡s_
.
push_back
(
f’ames
[
i
]);

117 ià(
	gnumb”
 + 1 > 
	gÃxt_fe_numb”_
) {

118 
	gÃxt_fe_numb”_
 = 
numb”
 + 1;

120 ià(
	gty³
 =ğ
kLogFe
) {

121 
logs_
.
push_back
(
numb”
);

122 } ià(
	gty³
 =ğ
kTabËFe
) {

123 
bË_numb”s_
.
push_back
(
numb”
);

130  
	g¡©us
;

133 
CÚv”tLogFesToTabËs
() {

134 
size_t
 
	gi
 = 0; i < 
	glogs_
.
size
(); i++) {

135 
	g¡d
::
¡ršg
 
logÇme
 = 
LogFeName
(
dbÇme_
, 
logs_
[
i
]);

136 
Stus
 
	g¡©us
 = 
CÚv”tLogToTabË
(
logs_
[
i
]);

137 ià(!
	g¡©us
.
ok
()) {

138 
Log
(
İtiÚs_
.
šfo_log
, "Log #%llu: ignoring conversionƒrror: %s",

139 ()
logs_
[
i
], 
¡©us
.
ToSŒšg
().
c_¡r
());

141 
ArchiveFe
(
logÇme
);

145 
Stus
 
CÚv”tLogToTabË
(
ušt64_t
 
log
) {

146 
	gLogR•Ü‹r
 : 
public
 
log
::
R—d”
::
R•Ü‹r
 {

147 
Env
* 
’v
;

148 
Logg”
* 
	gšfo_log
;

149 
ušt64_t
 
	glognum
;

150 
vœtu®
 
CÜru±iÚ
(
size_t
 
by‹s
, cÚ¡ 
Stus
& 
s
) {

152 
Log
(
šfo_log
, "Log #%llu: dropping %d bytes; %s",

153 ()
lognum
, 
¡©ic_ÿ¡
<>(
by‹s
),

154 
s
.
ToSŒšg
().
c_¡r
());

159 
	g¡d
::
¡ršg
 
logÇme
 = 
LogFeName
(
dbÇme_
, 
log
);

160 
Sequ’tŸlFe
* 
	glfe
;

161 
Stus
 
	g¡©us
 = 
’v_
->
NewSequ’tŸlFe
(
logÇme
, &
lfe
);

162 ià(!
	g¡©us
.
ok
()) {

163  
	g¡©us
;

167 
LogR•Ü‹r
 
	g»pÜ‹r
;

168 
	g»pÜ‹r
.
	g’v
 = 
’v_
;

169 
	g»pÜ‹r
.
	gšfo_log
 = 
İtiÚs_
.
šfo_log
;

170 
	g»pÜ‹r
.
	glognum
 = 
log
;

175 
	glog
::
R—d”
 
»ad”
(
lfe
, &
»pÜ‹r
, 
çl£
 ,

179 
	g¡d
::
¡ršg
 
sü©ch
;

180 
Sliû
 
	g»cÜd
;

181 
Wr™eB©ch
 
	gb©ch
;

182 
MemTabË
* 
	gmem
 = 
Ãw
 MemTabË(
icmp_
);

183 
	gmem
->
Ref
();

184 
	gcouÁ”
 = 0;

185 
	g»ad”
.
R—dRecÜd
(&
»cÜd
, &
sü©ch
)) {

186 ià(
	g»cÜd
.
size
() < 12) {

187 
	g»pÜ‹r
.
CÜru±iÚ
(
»cÜd
.
size
(),

188 
Stus
::
CÜru±iÚ
("log„ecordoo small"));

191 
	gWr™eB©chIÁ”Çl
::
S‘CÚ‹Ás
(&
b©ch
, 
»cÜd
);

192 
	g¡©us
 = 
Wr™eB©chIÁ”Çl
::
In£¹IÁo
(&
b©ch
, 
mem
);

193 ià(
	g¡©us
.
ok
()) {

194 
	gcouÁ”
 +ğ
Wr™eB©chIÁ”Çl
::
CouÁ
(&
b©ch
);

196 
Log
(
İtiÚs_
.
šfo_log
, "Log #%llu: ignoring %s",

197 ()
log
, 
¡©us
.
ToSŒšg
().
c_¡r
());

198 
	g¡©us
 = 
Stus
::
OK
();

201 
d–‘e
 
	glfe
;

205 
FeM‘aD©a
 
	gm‘a
;

206 
	gm‘a
.
	gnumb”
 = 
Ãxt_fe_numb”_
++;

207 
I‹¿tÜ
* 
	g™”
 = 
mem
->
NewI‹¿tÜ
();

208 
	g¡©us
 = 
BudTabË
(
dbÇme_
, 
’v_
, 
İtiÚs_
, 
bË_ÿche_
, 
™”
, &
m‘a
, 
NULL
 );

209 
d–‘e
 
	g™”
;

210 
	gmem
->
UÄef
();

211 
	gmem
 = 
nuÎ±r
;

212 ià(
	g¡©us
.
ok
()) {

213 ià(
	gm‘a
.
	gfe_size
 > 0) {

214 
	gbË_numb”s_
.
push_back
(
m‘a
.
numb”
);

217 
Log
(
İtiÚs_
.
šfo_log
, "Log #%llu: %d ops savedo Table #%llu %s",

218 ()
log
, 
couÁ”
, ()
m‘a
.
numb”
,

219 
¡©us
.
ToSŒšg
().
c_¡r
());

220  
	g¡©us
;

223 
ExŒaùM‘aD©a
() {

224 
size_t
 
	gi
 = 0; i < 
	gbË_numb”s_
.
size
(); i++) {

225 
SÿnTabË
(
bË_numb”s_
[
i
]);

229 
I‹¿tÜ
* 
NewTabËI‹¿tÜ
(cÚ¡ 
FeM‘aD©a
& 
m‘a
) {

232 
R—dO±iÚs
 
	gr
;

233 
	gr
.
	gv”ify_checksums
 = 
İtiÚs_
.
·¿noid_checks
;

234  
	gbË_ÿche_
->
NewI‹¿tÜ
(
r
, 
m‘a
.
numb”
, m‘a.
fe_size
);

237 
SÿnTabË
(
ušt64_t
 
numb”
) {

238 
TabËInfo
 
	gt
;

239 
	gt
.
	gm‘a
.
	gnumb”
 = 
numb”
;

240 
	g¡d
::
¡ršg
 
âame
 = 
TabËFeName
(
dbÇme_
, 
numb”
);

241 
Stus
 
	g¡©us
 = 
’v_
->
G‘FeSize
(
âame
, &
t
.
m‘a
.
fe_size
);

242 ià(!
	g¡©us
.
ok
()) {

244 
	gâame
 = 
SSTTabËFeName
(
dbÇme_
, 
numb”
);

245 
Stus
 
	gs2
 = 
’v_
->
G‘FeSize
(
âame
, &
t
.
m‘a
.
fe_size
);

246 ià(
	gs2
.
ok
()) {

247 
	g¡©us
 = 
Stus
::
OK
();

250 ià(!
	g¡©us
.
ok
()) {

251 
ArchiveFe
(
TabËFeName
(
dbÇme_
, 
numb”
));

252 
ArchiveFe
(
SSTTabËFeName
(
dbÇme_
, 
numb”
));

253 
Log
(
İtiÚs_
.
šfo_log
, "Table #%llu: dropped: %s",

254 ()
t
.
m‘a
.
numb”
, 
¡©us
.
ToSŒšg
().
c_¡r
());

259 
	gcouÁ”
 = 0;

260 
I‹¿tÜ
* 
	g™”
 = 
NewTabËI‹¿tÜ
(
t
.
m‘a
);

261 
boŞ
 
	gem±y
 = 
Œue
;

262 
P¬£dIÁ”ÇlKey
 
	g·r£d
;

263 
	gt
.
	gmax_£qu’û
 = 0;

264 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

265 
Sliû
 
	gkey
 = 
™”
->
key
();

266 ià(!
P¬£IÁ”ÇlKey
(
key
, &
·r£d
)) {

267 
Log
(
İtiÚs_
.
šfo_log
, "Table #%llu: unparsable key %s",

268 ()
t
.
m‘a
.
numb”
, 
Esÿ³SŒšg
(
key
).
c_¡r
());

272 
	gcouÁ”
++;

273 ià(
	gem±y
) {

274 
	gem±y
 = 
çl£
;

275 
	gt
.
	gm‘a
.
	gsm®Ë¡
.
DecodeFrom
(
key
);

277 
	gt
.
	gm‘a
.
	gÏrge¡
.
DecodeFrom
(
key
);

278 ià(
	g·r£d
.
	g£qu’û
 > 
	gt
.
	gmax_£qu’û
) {

279 
	gt
.
	gmax_£qu’û
 = 
·r£d
.
£qu’û
;

282 ià(!
	g™”
->
¡©us
().
ok
()) {

283 
	g¡©us
 = 
™”
->
¡©us
();

285 
d–‘e
 
	g™”
;

286 
Log
(
İtiÚs_
.
šfo_log
, "Table #%llu: %dƒntries %s",

287 ()
t
.
m‘a
.
numb”
, 
couÁ”
, 
¡©us
.
ToSŒšg
().
c_¡r
());

289 ià(
	g¡©us
.
ok
()) {

290 
	gbËs_
.
push_back
(
t
);

292 
R•aœTabË
(
âame
, 
t
);

296 
R•aœTabË
(cÚ¡ 
¡d
::
¡ršg
& 
¤c
, 
TabËInfo
 
t
) {

301 
	g¡d
::
¡ršg
 
cİy
 = 
TabËFeName
(
dbÇme_
, 
Ãxt_fe_numb”_
++);

302 
Wr™abËFe
* 
	gfe
;

303 
Stus
 
	gs
 = 
’v_
->
NewWr™abËFe
(
cİy
, &
fe
);

304 ià(!
	gs
.
ok
()) {

307 
TabËBud”
* 
	gbud”
 = 
Ãw
 TabËBud”(
İtiÚs_
, 
fe
);

310 
I‹¿tÜ
* 
	g™”
 = 
NewTabËI‹¿tÜ
(
t
.
m‘a
);

311 
	gcouÁ”
 = 0;

312 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

313 
	gbud”
->
Add
(
™”
->
key
(), i‹r->
v®ue
());

314 
	gcouÁ”
++;

316 
d–‘e
 
	g™”
;

318 
ArchiveFe
(
¤c
);

319 ià(
	gcouÁ”
 == 0) {

320 
bud”
->
AbªdÚ
();

322 
	gs
 = 
bud”
->
Fšish
();

323 ià(
	gs
.
ok
()) {

324 
	gt
.
	gm‘a
.
	gfe_size
 = 
bud”
->
FeSize
();

327 
d–‘e
 
	gbud”
;

328 
	gbud”
 = 
nuÎ±r
;

330 ià(
	gs
.
ok
()) {

331 
	gs
 = 
fe
->
Clo£
();

333 
d–‘e
 
	gfe
;

334 
	gfe
 = 
nuÎ±r
;

336 ià(
	gcouÁ”
 > 0 && 
	gs
.
ok
()) {

337 
	g¡d
::
¡ršg
 
Üig
 = 
TabËFeName
(
dbÇme_
, 
t
.
m‘a
.
numb”
);

338 
	gs
 = 
’v_
->
R’ameFe
(
cİy
, 
Üig
);

339 ià(
	gs
.
ok
()) {

340 
Log
(
İtiÚs_
.
šfo_log
, "Table #%llu: %dƒntries„epaired",

341 ()
t
.
m‘a
.
numb”
, 
couÁ”
);

342 
	gbËs_
.
push_back
(
t
);

345 ià(!
	gs
.
ok
()) {

346 
	g’v_
->
D–‘eFe
(
cİy
);

350 
Stus
 
Wr™eDesütÜ
() {

351 
	g¡d
::
¡ršg
 
tmp
 = 
TempFeName
(
dbÇme_
, 1);

352 
Wr™abËFe
* 
	gfe
;

353 
Stus
 
	g¡©us
 = 
’v_
->
NewWr™abËFe
(
tmp
, &
fe
);

354 ià(!
	g¡©us
.
ok
()) {

355  
	g¡©us
;

358 
Sequ’ûNumb”
 
	gmax_£qu’û
 = 0;

359 
size_t
 
	gi
 = 0; i < 
	gbËs_
.
size
(); i++) {

360 ià(
	gmax_£qu’û
 < 
	gbËs_
[
i
].max_sequence) {

361 
	gmax_£qu’û
 = 
bËs_
[
i
].
max_£qu’û
;

365 
	ged™_
.
S‘Com·¿tÜName
(
icmp_
.
u£r_com·¿tÜ
()->
Name
());

366 
	ged™_
.
S‘LogNumb”
(0);

367 
	ged™_
.
S‘NextFe
(
Ãxt_fe_numb”_
);

368 
	ged™_
.
S‘La¡Sequ’û
(
max_£qu’û
);

370 
size_t
 
	gi
 = 0; i < 
	gbËs_
.
size
(); i++) {

372 cÚ¡ 
	gTabËInfo
& 
	gt
 = 
bËs_
[
i
];

373 
	ged™_
.
AddFe
(0, 
t
.
m‘a
.
numb”
,.m‘a.
fe_size
,.m‘a.
sm®Ë¡
,

374 
t
.
m‘a
.
Ïrge¡
,t.m‘a.
fs
);

379 
	glog
::
Wr™”
 
log
(
fe
);

380 
	g¡d
::
¡ršg
 
»cÜd
;

381 
	ged™_
.
EncodeTo
(&
»cÜd
);

382 
	g¡©us
 = 
log
.
AddRecÜd
(
»cÜd
);

384 ià(
	g¡©us
.
ok
()) {

385 
	g¡©us
 = 
fe
->
Clo£
();

387 
d–‘e
 
	gfe
;

388 
	gfe
 = 
nuÎ±r
;

390 ià(!
	g¡©us
.
ok
()) {

391 
	g’v_
->
D–‘eFe
(
tmp
);

394 
size_t
 
	gi
 = 0; i < 
	gmªiã¡s_
.
size
(); i++) {

395 
ArchiveFe
(
dbÇme_
 + "/" + 
mªiã¡s_
[
i
]);

399 
	g¡©us
 = 
’v_
->
R’ameFe
(
tmp
, 
DesütÜFeName
(
dbÇme_
, 1));

400 ià(
	g¡©us
.
ok
()) {

401 
	g¡©us
 = 
S‘Cu¼’tFe
(
’v_
, 
dbÇme_
, 1);

403 
	g’v_
->
D–‘eFe
(
tmp
);

406  
	g¡©us
;

409 
ArchiveFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
) {

414 cÚ¡ * 
¦ash
 = 
¡¼chr
(
âame
.
c_¡r
(), '/');

415 
	g¡d
::
¡ršg
 
Ãw_dœ
;

416 ià(
	g¦ash
 !ğ
nuÎ±r
) {

417 
Ãw_dœ
.
assign
(
âame
.
d©a
(), 
¦ash
 - fname.data());

419 
	gÃw_dœ
.
­³nd
("/lost");

420 
	g’v_
->
C»©eDœ
(
Ãw_dœ
);

421 
	g¡d
::
¡ršg
 
Ãw_fe
 = 
Ãw_dœ
;

422 
	gÃw_fe
.
­³nd
("/");

423 
	gÃw_fe
.
­³nd
((
¦ash
 =ğ
nuÎ±r
è? 
âame
.
c_¡r
() : slash + 1);

424 
Stus
 
	gs
 = 
’v_
->
R’ameFe
(
âame
, 
Ãw_fe
);

425 
Log
(
İtiÚs_
.
šfo_log
, "Archivšg %s: %s\n", 
âame
.
c_¡r
(),

426 
s
.
ToSŒšg
().
c_¡r
());

429 cÚ¡ 
	g¡d
::
¡ršg
 
dbÇme_
;

430 
Env
* cÚ¡ 
	g’v_
;

431 
IÁ”ÇlKeyCom·¿tÜ
 cÚ¡ 
	gicmp_
;

432 
IÁ”ÇlF‹rPŞicy
 cÚ¡ 
	gŞicy_
;

433 cÚ¡ 
O±iÚs
 
	gİtiÚs_
;

434 
boŞ
 
	gowns_šfo_log_
;

435 
boŞ
 
	gowns_ÿche_
;

436 
TabËCache
* 
	gbË_ÿche_
;

437 
V”siÚEd™
 
	ged™_
;

439 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
mªiã¡s_
;

440 
	g¡d
::
veùÜ
<
ušt64_t
> 
bË_numb”s_
;

441 
	g¡d
::
veùÜ
<
ušt64_t
> 
logs_
;

442 
	g¡d
::
veùÜ
<
TabËInfo
> 
bËs_
;

443 
ušt64_t
 
	gÃxt_fe_numb”_
;

447 
Stus
 
	$R•aœDB
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, cÚ¡ 
O±iÚs
& 
İtiÚs
) {

448 
R•aœ”
 
	`»·œ”
(
dbÇme
, 
İtiÚs
);

449  
»·œ”
.
	`Run
();

450 
	}
}

	@db/skiplist.h

5 #iâdeà
STORAGE_LEVELDB_DB_SKIPLIST_H_


6 
	#STORAGE_LEVELDB_DB_SKIPLIST_H_


	)

30 
	~<©omic
>

31 
	~<ÿs£¹
>

32 
	~<c¡dlib
>

34 
	~"ut/¬’a.h
"

35 
	~"ut/¿ndom.h
"

37 
Çme¥aû
 
	gËv–db
 {

39 
şass
 
	gA»Ç
;

41 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

42 şas 
	cSkLi¡
 {

43 
	g´iv©e
:

44 
Node
;

46 
	gpublic
:

50 
ex¶ic™
 
SkLi¡
(
Com·¿tÜ
 
cmp
, 
A»Ç
* 
¬’a
);

52 
SkLi¡
(cÚ¡ SkLi¡&èğ
d–‘e
;

53 
	gSkLi¡
& 
	gİ”©Ü
=(cÚ¡ 
SkLi¡
&èğ
d–‘e
;

57 
In£¹
(cÚ¡ 
Key
& 
key
);

60 
boŞ
 
CÚšs
(cÚ¡ 
Key
& 
key
) const;

63 şas 
	cI‹¿tÜ
 {

64 
	gpublic
:

67 
ex¶ic™
 
I‹¿tÜ
(cÚ¡ 
SkLi¡
* 
li¡
);

70 
boŞ
 
V®id
() const;

74 cÚ¡ 
	gKey
& 
key
() const;

78 
Next
();

82 
P»v
();

85 
S“k
(cÚ¡ 
Key
& 
rg‘
);

89 
S“kToFœ¡
();

93 
S“kToLa¡
();

95 
	g´iv©e
:

96 cÚ¡ 
SkLi¡
* 
li¡_
;

97 
Node
* 
	gnode_
;

101 
	g´iv©e
:

102 ’um { 
kMaxHeight
 = 12 };

104 
šlše
 
G‘MaxHeight
() const {

105  
	gmax_height_
.
lßd
(
¡d
::
memÜy_Üd”_»Ïxed
);

108 
Node
* 
NewNode
(cÚ¡ 
Key
& 
key
, 
height
);

109 
RªdomHeight
();

110 
boŞ
 
Equ®
(cÚ¡ 
Key
& 
a
, cÚ¡ Key& 
b
ècÚ¡ {  (
com·»_
(a, b) == 0); }

113 
boŞ
 
KeyIsAá”Node
(cÚ¡ 
Key
& 
key
, 
Node
* 
n
) const;

120 
Node
* 
FšdG»©”OrEqu®
(cÚ¡ 
Key
& 
key
, Node** 
´ev
) const;

124 
Node
* 
FšdLessThª
(cÚ¡ 
Key
& 
key
) const;

128 
Node
* 
FšdLa¡
() const;

131 
Com·¿tÜ
 cÚ¡ 
	gcom·»_
;

132 
A»Ç
* cÚ¡ 
	g¬’a_
;

134 
Node
* cÚ¡ 
	gh—d_
;

138 
	g¡d
::
©omic
<> 
max_height_
;

141 
Rªdom
 
	gºd_
;

145 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

146 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Node
 {

147 
ex¶ic™
 
Node
(cÚ¡ 
Key
& 
k
è: 
key
(k) {}

149 
Key
 cÚ¡ 
key
;

153 
Node
* 
Next
(
n
) {

154 
as£¹
(
n
 >= 0);

157  
	gÃxt_
[
n
].
lßd
(
¡d
::
memÜy_Üd”_acquœe
);

159 
S‘Next
(
n
, 
Node
* 
x
) {

160 
as£¹
(
n
 >= 0);

163 
	gÃxt_
[
n
].
¡Üe
(
x
, 
¡d
::
memÜy_Üd”_»Ëa£
);

167 
Node
* 
NoB¬r›r_Next
(
n
) {

168 
as£¹
(
n
 >= 0);

169  
	gÃxt_
[
n
].
lßd
(
¡d
::
memÜy_Üd”_»Ïxed
);

171 
NoB¬r›r_S‘Next
(
n
, 
Node
* 
x
) {

172 
as£¹
(
n
 >= 0);

173 
	gÃxt_
[
n
].
¡Üe
(
x
, 
¡d
::
memÜy_Üd”_»Ïxed
);

176 
	g´iv©e
:

178 
¡d
::
©omic
<
Node
*> 
Ãxt_
[1];

181 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

182 
ty³Çme
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Node
* 
SkLi¡
<
Key
, Com·¿tÜ>::
	$NewNode
(

183 cÚ¡ 
Key
& 
key
, 
height
) {

184 * cÚ¡ 
node_memÜy
 = 
¬’a_
->
	`AÎoÿ‹AligÃd
(

185 (
Node
è+ (
¡d
::
©omic
<Node*>è* (
height
 - 1));

186  
	`Ãw
 (
node_memÜy
è
	`Node
(
key
);

187 
	}
}

189 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

190 
šlše
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$I‹¿tÜ
(cÚ¡ 
SkLi¡
* 
li¡
) {

191 
li¡_
 = 
li¡
;

192 
node_
 = 
nuÎ±r
;

193 
	}
}

195 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

196 
šlše
 
boŞ
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$V®id
() const {

197  
node_
 !ğ
nuÎ±r
;

198 
	}
}

200 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

201 
šlše
 cÚ¡ 
	gKey
& 
	gSkLi¡
<Key, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$key
() const {

202 
	`as£¹
(
	`V®id
());

203  
node_
->
key
;

204 
	}
}

206 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

207 
šlše
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$Next
() {

208 
	`as£¹
(
	`V®id
());

209 
node_
 =‚ode_->
	`Next
(0);

210 
	}
}

212 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

213 
šlše
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$P»v
() {

216 
	`as£¹
(
	`V®id
());

217 
node_
 = 
li¡_
->
	`FšdLessThª
Òode_->
key
);

218 ià(
node_
 =ğ
li¡_
->
h—d_
) {

219 
node_
 = 
nuÎ±r
;

221 
	}
}

223 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

224 
šlše
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$S“k
(cÚ¡ 
Key
& 
rg‘
) {

225 
node_
 = 
li¡_
->
	`FšdG»©”OrEqu®
(
rg‘
, 
nuÎ±r
);

226 
	}
}

228 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

229 
šlše
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$S“kToFœ¡
() {

230 
node_
 = 
li¡_
->
h—d_
->
	`Next
(0);

231 
	}
}

233 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

234 
šlše
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
::
	$S“kToLa¡
() {

235 
node_
 = 
li¡_
->
	`FšdLa¡
();

236 ià(
node_
 =ğ
li¡_
->
h—d_
) {

237 
node_
 = 
nuÎ±r
;

239 
	}
}

241 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

242 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
	$RªdomHeight
() {

244 cÚ¡ 
kB¿nchšg
 = 4;

245 
height
 = 1;

246 
height
 < 
kMaxHeight
 && ((
ºd_
.
	`Next
(è% 
kB¿nchšg
) == 0)) {

247 
height
++;

249 
	`as£¹
(
height
 > 0);

250 
	`as£¹
(
height
 <ğ
kMaxHeight
);

251  
height
;

252 
	}
}

254 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

255 
boŞ
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
	$KeyIsAá”Node
(cÚ¡ 
Key
& 
key
, 
Node
* 
n
) const {

257  (
n
 !ğ
nuÎ±r
è&& (
	`com·»_
Ò->
key
, key) < 0);

258 
	}
}

260 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

261 
ty³Çme
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Node
*

262 
SkLi¡
<
Key
, 
	gCom·¿tÜ
>::
	$FšdG»©”OrEqu®
(cÚ¡ 
Key
& 
key
,

263 
Node
** 
´ev
) const {

264 
Node
* 
x
 = 
h—d_
;

265 
Ëv–
 = 
	`G‘MaxHeight
() - 1;

266 
Œue
) {

267 
Node
* 
Ãxt
 = 
x
->
	`Next
(
Ëv–
);

268 ià(
	`KeyIsAá”Node
(
key
, 
Ãxt
)) {

270 
x
 = 
Ãxt
;

272 ià(
´ev
 !ğ
nuÎ±r
è´ev[
Ëv–
] = 
x
;

273 ià(
Ëv–
 == 0) {

274  
Ãxt
;

277 
Ëv–
--;

281 
	}
}

283 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

284 
ty³Çme
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Node
*

285 
SkLi¡
<
Key
, 
	gCom·¿tÜ
>::
	$FšdLessThª
(cÚ¡ 
Key
& 
key
) const {

286 
Node
* 
x
 = 
h—d_
;

287 
Ëv–
 = 
	`G‘MaxHeight
() - 1;

288 
Œue
) {

289 
	`as£¹
(
x
 =ğ
h—d_
 || 
	`com·»_
(x->
key
, key) < 0);

290 
Node
* 
Ãxt
 = 
x
->
	`Next
(
Ëv–
);

291 ià(
Ãxt
 =ğ
nuÎ±r
 || 
	`com·»_
Òext->
key
, key) >= 0) {

292 ià(
Ëv–
 == 0) {

293  
x
;

296 
Ëv–
--;

299 
x
 = 
Ãxt
;

302 
	}
}

304 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

305 
ty³Çme
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Node
* 
SkLi¡
<
Key
, Com·¿tÜ>::
	$FšdLa¡
()

307 
Node
* 
x
 = 
h—d_
;

308 
Ëv–
 = 
	`G‘MaxHeight
() - 1;

309 
Œue
) {

310 
Node
* 
Ãxt
 = 
x
->
	`Next
(
Ëv–
);

311 ià(
Ãxt
 =ğ
nuÎ±r
) {

312 ià(
Ëv–
 == 0) {

313  
x
;

316 
Ëv–
--;

319 
x
 = 
Ãxt
;

322 
	}
}

324 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

325 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
	$SkLi¡
(
Com·¿tÜ
 
cmp
, 
A»Ç
* 
¬’a
)

326 : 
	`com·»_
(
cmp
),

327 
	`¬’a_
(
¬’a
),

328 
	`h—d_
(
	`NewNode
(0 , 
kMaxHeight
)),

329 
	`max_height_
(1),

330 
	$ºd_
(0xdeadbeef) {

331 
i
 = 0; i < 
kMaxHeight
; i++) {

332 
h—d_
->
	`S‘Next
(
i
, 
nuÎ±r
);

334 
	}
}

336 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

337 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
	$In£¹
(cÚ¡ 
Key
& 
key
) {

340 
Node
* 
´ev
[
kMaxHeight
];

341 
Node
* 
x
 = 
	`FšdG»©”OrEqu®
(
key
, 
´ev
);

344 
	`as£¹
(
x
 =ğ
nuÎ±r
 || !
	`Equ®
(
key
, x->key));

346 
height
 = 
	`RªdomHeight
();

347 ià(
height
 > 
	`G‘MaxHeight
()) {

348 
i
 = 
	`G‘MaxHeight
(); i < 
height
; i++) {

349 
´ev
[
i
] = 
h—d_
;

358 
max_height_
.
	`¡Üe
(
height
, 
¡d
::
memÜy_Üd”_»Ïxed
);

361 
x
 = 
	`NewNode
(
key
, 
height
);

362 
i
 = 0; i < 
height
; i++) {

365 
x
->
	`NoB¬r›r_S‘Next
(
i
, 
´ev
[i]->
	`NoB¬r›r_Next
(i));

366 
´ev
[
i
]->
	`S‘Next
(i, 
x
);

368 
	}
}

370 
	g‹m¶©e
 <
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

371 
boŞ
 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
	$CÚšs
(cÚ¡ 
Key
& 
key
) const {

372 
Node
* 
x
 = 
	`FšdG»©”OrEqu®
(
key
, 
nuÎ±r
);

373 ià(
x
 !ğ
nuÎ±r
 && 
	`Equ®
(
key
, x->key)) {

374  
Œue
;

376  
çl£
;

378 
	}
}

	@db/skiplist_test.cc

5 
	~"db/skli¡.h
"

7 
	~<©omic
>

8 
	~<£t
>

10 
	~"Ëv–db/’v.h
"

11 
	~"pÜt/pÜt.h
"

12 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

13 
	~"ut/¬’a.h
"

14 
	~"ut/hash.h
"

15 
	~"ut/¿ndom.h
"

16 
	~"ut/‹¡h¬Ãss.h
"

18 
Çme¥aû
 
	gËv–db
 {

20 
ušt64_t
 
	tKey
;

22 
	sCom·¿tÜ
 {

23 
İ”©Ü
()(cÚ¡ 
	gKey
& 
	ga
, cÚ¡ Key& 
	gb
) const {

24 ià(
	ga
 < 
	gb
) {

26 } ià(
	ga
 > 
	gb
) {

34 şas 
	cSkTe¡
 {};

36 
	$TEST
(
SkTe¡
, 
Em±y
) {

37 
A»Ç
 
¬’a
;

38 
Com·¿tÜ
 
cmp
;

39 
SkLi¡
<
Key
, 
Com·¿tÜ
> 
	`li¡
(
cmp
, &
¬’a
);

40 
	`ASSERT_TRUE
(!
li¡
.
	`CÚšs
(10));

42 
SkLi¡
<
Key
, 
Com·¿tÜ
>::
I‹¿tÜ
 
	`™”
(&
li¡
);

43 
	`ASSERT_TRUE
(!
™”
.
	`V®id
());

44 
™”
.
	`S“kToFœ¡
();

45 
	`ASSERT_TRUE
(!
™”
.
	`V®id
());

46 
™”
.
	`S“k
(100);

47 
	`ASSERT_TRUE
(!
™”
.
	`V®id
());

48 
™”
.
	`S“kToLa¡
();

49 
	`ASSERT_TRUE
(!
™”
.
	`V®id
());

50 
	}
}

52 
	$TEST
(
SkTe¡
, 
In£¹AndLookup
) {

53 cÚ¡ 
N
 = 2000;

54 cÚ¡ 
R
 = 5000;

55 
Rªdom
 
	`ºd
(1000);

56 
¡d
::
£t
<
Key
> 
keys
;

57 
A»Ç
 
¬’a
;

58 
Com·¿tÜ
 
cmp
;

59 
SkLi¡
<
Key
, 
Com·¿tÜ
> 
	`li¡
(
cmp
, &
¬’a
);

60 
i
 = 0; i < 
N
; i++) {

61 
Key
 
key
 = 
ºd
.
	`Next
(è% 
R
;

62 ià(
keys
.
	`š£¹
(
key
).
£cÚd
) {

63 
li¡
.
	`In£¹
(
key
);

67 
i
 = 0; i < 
R
; i++) {

68 ià(
li¡
.
	`CÚšs
(
i
)) {

69 
	`ASSERT_EQ
(
keys
.
	`couÁ
(
i
), 1);

71 
	`ASSERT_EQ
(
keys
.
	`couÁ
(
i
), 0);

77 
SkLi¡
<
Key
, 
Com·¿tÜ
>::
I‹¿tÜ
 
	`™”
(&
li¡
);

78 
	`ASSERT_TRUE
(!
™”
.
	`V®id
());

80 
™”
.
	`S“k
(0);

81 
	`ASSERT_TRUE
(
™”
.
	`V®id
());

82 
	`ASSERT_EQ
(*(
keys
.
	`begš
()), 
™”
.
	`key
());

84 
™”
.
	`S“kToFœ¡
();

85 
	`ASSERT_TRUE
(
™”
.
	`V®id
());

86 
	`ASSERT_EQ
(*(
keys
.
	`begš
()), 
™”
.
	`key
());

88 
™”
.
	`S“kToLa¡
();

89 
	`ASSERT_TRUE
(
™”
.
	`V®id
());

90 
	`ASSERT_EQ
(*(
keys
.
	`rbegš
()), 
™”
.
	`key
());

94 
i
 = 0; i < 
R
; i++) {

95 
SkLi¡
<
Key
, 
Com·¿tÜ
>::
I‹¿tÜ
 
	`™”
(&
li¡
);

96 
™”
.
	`S“k
(
i
);

99 
¡d
::
£t
<
Key
>::
™”©Ü
 
mod–_™”
 = 
keys
.
	`low”_bound
(
i
);

100 
j
 = 0; j < 3; j++) {

101 ià(
mod–_™”
 =ğ
keys
.
	`’d
()) {

102 
	`ASSERT_TRUE
(!
™”
.
	`V®id
());

105 
	`ASSERT_TRUE
(
™”
.
	`V®id
());

106 
	`ASSERT_EQ
(*
mod–_™”
, 
™”
.
	`key
());

107 ++
mod–_™”
;

108 
™”
.
	`Next
();

115 
SkLi¡
<
Key
, 
Com·¿tÜ
>::
I‹¿tÜ
 
	`™”
(&
li¡
);

116 
™”
.
	`S“kToLa¡
();

119 
¡d
::
£t
<
Key
>::
»v”£_™”©Ü
 
mod–_™”
 = 
keys
.
	`rbegš
();

120 
mod–_™”
 !ğ
keys
.
	`»nd
(); ++model_iter) {

121 
	`ASSERT_TRUE
(
™”
.
	`V®id
());

122 
	`ASSERT_EQ
(*
mod–_™”
, 
™”
.
	`key
());

123 
™”
.
	`P»v
();

125 
	`ASSERT_TRUE
(!
™”
.
	`V®id
());

127 
	}
}

153 şas 
	cCÚcu¼’tTe¡
 {

154 
	g´iv©e
:

155 cÚ¡ 
ušt32_t
 
K
 = 4;

157 
ušt64_t
 
key
(
Key
 keyè{  (
	gkey
 >> 40); }

158 
ušt64_t
 
g’
(
Key
 
key
è{  (
	gkey
 >> 8) & 0xffffffffu; }

159 
ušt64_t
 
hash
(
Key
 
key
è{  
	gkey
 & 0xff; }

161 
ušt64_t
 
HashNumb”s
(ušt64_ˆ
k
, ušt64_ˆ
g
) {

162 
ušt64_t
 
	gd©a
[2] = {
k
, 
g
};

163  
Hash
(
»š‹½»t_ÿ¡
<*>(
d©a
), (data), 0);

166 
Key
 
MakeKey
(
ušt64_t
 
k
, ušt64_ˆ
g
) {

167 
¡©ic_as£¹
((
Key
è=ğ(
ušt64_t
), "");

168 
as£¹
(
k
 <ğ
K
);

169 
as£¹
(
g
 <= 0xffffffffu);

170  ((
	gk
 << 40è| (
	gg
 << 8è| (
HashNumb”s
(
k
, 
g
) & 0xff));

173 
boŞ
 
IsV®idKey
(
Key
 
k
) {

174  
hash
(
k
è=ğ(
HashNumb”s
(
key
(k), 
g’
(k)) & 0xff);

177 
Key
 
RªdomT¬g‘
(
Rªdom
* 
ºd
) {

178 
	gºd
->
Next
() % 10) {

181  
MakeKey
(0, 0);

184  
MakeKey
(
K
, 0);

187  
MakeKey
(
ºd
->
Next
(è% 
K
, 0);

192 
	sS‹
 {

193 
	g¡d
::
©omic
<> 
g’”©iÚ
[
K
];

194 
S‘
(
k
, 
v
) {

195 
	gg’”©iÚ
[
k
].
¡Üe
(
v
, 
¡d
::
memÜy_Üd”_»Ëa£
);

197 
G‘
(
k
è{  
	gg’”©iÚ
[k].
lßd
(
¡d
::
memÜy_Üd”_acquœe
); }

199 
S‹
() {

200 
	gk
 = 0; k < 
	gK
; k++) {

201 
S‘
(
k
, 0);

207 
S‹
 
	gcu¼’t_
;

209 
A»Ç
 
	g¬’a_
;

213 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
> 
	gli¡_
;

215 
	gpublic
:

216 
CÚcu¼’tTe¡
(è: 
li¡_
(
Com·¿tÜ
(), &
¬’a_
) {}

219 
Wr™eS‹p
(
Rªdom
* 
ºd
) {

220 cÚ¡ 
ušt32_t
 
	gk
 = 
ºd
->
Next
(è% 
K
;

221 cÚ¡ 
šŒ_t
 
	gg
 = 
cu¼’t_
.
G‘
(
k
) + 1;

222 cÚ¡ 
Key
 
	gkey
 = 
MakeKey
(
k
, 
g
);

223 
	gli¡_
.
In£¹
(
key
);

224 
	gcu¼’t_
.
S‘
(
k
, 
g
);

227 
R—dS‹p
(
Rªdom
* 
ºd
) {

229 
S‹
 
	gš™Ÿl_¡©e
;

230 
	gk
 = 0; k < 
	gK
; k++) {

231 
	gš™Ÿl_¡©e
.
S‘
(
k
, 
cu¼’t_
.
G‘
(k));

234 
Key
 
	gpos
 = 
RªdomT¬g‘
(
ºd
);

235 
	gSkLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
I‹¿tÜ
 
™”
(&
li¡_
);

236 
	g™”
.
S“k
(
pos
);

237 
	gŒue
) {

238 
Key
 
	gcu¼’t
;

239 ià(!
	g™”
.
V®id
()) {

240 
	gcu¼’t
 = 
MakeKey
(
K
, 0);

242 
	gcu¼’t
 = 
™”
.
key
();

243 
ASSERT_TRUE
(
IsV®idKey
(
cu¼’t
)è<< 
	gcu¼’t
;

245 
ASSERT_LE
(
pos
, 
cu¼’t
) << "should‚ot go backwards";

249 
	gpos
 < 
	gcu¼’t
) {

250 
ASSERT_LT
(
key
(
pos
), 
K
è<< 
	gpos
;

254 
ASSERT_TRUE
((
g’
(
pos
) == 0) ||

255 (
g’
(
pos
è> 
¡©ic_ÿ¡
<
Key
>(
š™Ÿl_¡©e
.
G‘
(
key
(pos)))))

256 << "key: " << 
key
(
pos
è<< "; g’: " << 
g’
(pos)

257 << "; in™g’: " << 
š™Ÿl_¡©e
.
G‘
(
key
(
pos
));

260 ià(
key
(
pos
è< key(
cu¼’t
)) {

261 
	gpos
 = 
MakeKey
(
key
(
pos
) + 1, 0);

263 
	gpos
 = 
MakeKey
(
key
(
pos
), 
g’
(pos) + 1);

267 ià(!
	g™”
.
V®id
()) {

271 ià(
	gºd
->
Next
() % 2) {

272 
	g™”
.
Next
();

273 
	gpos
 = 
MakeKey
(
key
(
pos
), 
g’
(pos) + 1);

275 
Key
 
	gÃw_rg‘
 = 
RªdomT¬g‘
(
ºd
);

276 ià(
	gÃw_rg‘
 > 
	gpos
) {

277 
	gpos
 = 
Ãw_rg‘
;

278 
	g™”
.
S“k
(
Ãw_rg‘
);

284 cÚ¡ 
ušt32_t
 
	gCÚcu¼’tTe¡
::
K
;

288 
	$TEST
(
SkTe¡
, 
CÚcu¼’tW™houtTh»ads
) {

289 
CÚcu¼’tTe¡
 
‹¡
;

290 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
());

291 
i
 = 0; i < 10000; i++) {

292 
‹¡
.
	`R—dS‹p
(&
ºd
);

293 
‹¡
.
	`Wr™eS‹p
(&
ºd
);

295 
	}
}

297 şas 
	cTe¡S‹
 {

298 
	gpublic
:

299 
CÚcu¼’tTe¡
 
t_
;

300 
	g£ed_
;

301 
	g¡d
::
©omic
<
boŞ
> 
qu™_æag_
;

303 
	eR—d”S‹
 { 
	gSTARTING
, 
	gRUNNING
, 
	gDONE
 };

305 
ex¶ic™
 
Te¡S‹
(
s
)

306 : 
£ed_
(
s
), 
qu™_æag_
(
çl£
), 
¡©e_
(
STARTING
), 
¡©e_cv_
(&
mu_
) {}

308 
Wa™
(
R—d”S‹
 
s
è
LOCKS_EXCLUDED
(
mu_
) {

309 
	gmu_
.
Lock
();

310 
	g¡©e_
 !ğ
s
) {

311 
¡©e_cv_
.
Wa™
();

313 
	gmu_
.
UÆock
();

316 
Chªge
(
R—d”S‹
 
s
è
LOCKS_EXCLUDED
(
mu_
) {

317 
	gmu_
.
Lock
();

318 
	g¡©e_
 = 
s
;

319 
	g¡©e_cv_
.
SigÇl
();

320 
	gmu_
.
UÆock
();

323 
	g´iv©e
:

324 
pÜt
::
Mu‹x
 
mu_
;

325 
R—d”S‹
 
¡©e_
 
GUARDED_BY
(
mu_
);

326 
	gpÜt
::
CÚdV¬
 
¡©e_cv_
 
GUARDED_BY
(
mu_
);

329 
	$CÚcu¼’tR—d”
(* 
¬g
) {

330 
Te¡S‹
* 
¡©e
 = 
»š‹½»t_ÿ¡
<Te¡S‹*>(
¬g
);

331 
Rªdom
 
	`ºd
(
¡©e
->
£ed_
);

332 
št64_t
 
»ads
 = 0;

333 
¡©e
->
	`Chªge
(
Te¡S‹
::
RUNNING
);

334 !
¡©e
->
qu™_æag_
.
	`lßd
(
¡d
::
memÜy_Üd”_acquœe
)) {

335 
¡©e
->
t_
.
	`R—dS‹p
(&
ºd
);

336 ++
»ads
;

338 
¡©e
->
	`Chªge
(
Te¡S‹
::
DONE
);

339 
	}
}

341 
	$RunCÚcu¼’t
(
run
) {

342 cÚ¡ 
£ed
 = 
‹¡
::
	`RªdomS“d
(è+ (
run
 * 100);

343 
Rªdom
 
	`ºd
(
£ed
);

344 cÚ¡ 
N
 = 1000;

345 cÚ¡ 
kSize
 = 1000;

346 
i
 = 0; i < 
N
; i++) {

347 ià((
i
 % 100) == 0) {

348 
	`årštf
(
¡d”r
, "RuÀ%d oà%d\n", 
i
, 
N
);

350 
Te¡S‹
 
	`¡©e
(
£ed
 + 1);

351 
Env
::
	`DeçuÉ
()->
	`ScheduË
(
CÚcu¼’tR—d”
, &
¡©e
);

352 
¡©e
.
	`Wa™
(
Te¡S‹
::
RUNNING
);

353 
i
 = 0; i < 
kSize
; i++) {

354 
¡©e
.
t_
.
	`Wr™eS‹p
(&
ºd
);

356 
¡©e
.
qu™_æag_
.
	`¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ëa£
);

357 
¡©e
.
	`Wa™
(
Te¡S‹
::
DONE
);

359 
	}
}

361 
	$TEST
(
SkTe¡
, 
CÚcu¼’t1
è{ 
	`RunCÚcu¼’t
(1); 
	}
}

362 
	$TEST
(
SkTe¡
, 
CÚcu¼’t2
è{ 
	`RunCÚcu¼’t
(2); 
	}
}

363 
	$TEST
(
SkTe¡
, 
CÚcu¼’t3
è{ 
	`RunCÚcu¼’t
(3); 
	}
}

364 
	$TEST
(
SkTe¡
, 
CÚcu¼’t4
è{ 
	`RunCÚcu¼’t
(4); 
	}
}

365 
	$TEST
(
SkTe¡
, 
CÚcu¼’t5
è{ 
	`RunCÚcu¼’t
(5); 
	}
}

369 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/snapshot.h

5 #iâdeà
STORAGE_LEVELDB_DB_SNAPSHOT_H_


6 
	#STORAGE_LEVELDB_DB_SNAPSHOT_H_


	)

8 
	~"db/dbfÜm©.h
"

9 
	~"Ëv–db/db.h
"

11 
Çme¥aû
 
	gËv–db
 {

13 
şass
 
	gSÇpshÙLi¡
;

17 şas 
	cSÇpshÙIm¶
 : 
public
 
SÇpshÙ
 {

18 
public
:

19 
SÇpshÙIm¶
(
Sequ’ûNumb”
 
£qu’û_numb”
)

20 : 
£qu’û_numb”_
(
£qu’û_numb”
) {}

22 
Sequ’ûNumb”
 
£qu’û_numb”
(ècÚ¡ {  
£qu’û_numb”_
; }

24 
	g´iv©e
:

25 
ä›nd
 
şass
 
SÇpshÙLi¡
;

29 
SÇpshÙIm¶
* 
	g´ev_
;

30 
SÇpshÙIm¶
* 
	gÃxt_
;

32 cÚ¡ 
Sequ’ûNumb”
 
	g£qu’û_numb”_
;

34 #ià!
defšed
(
NDEBUG
)

35 
SÇpshÙLi¡
* 
	gli¡_
 = 
nuÎ±r
;

39 şas 
	cSÇpshÙLi¡
 {

40 
	gpublic
:

41 
SÇpshÙLi¡
(è: 
h—d_
(0) {

42 
h—d_
.
´ev_
 = &head_;

43 
	gh—d_
.
	gÃxt_
 = &
h—d_
;

46 
boŞ
 
em±y
(ècÚ¡ {  
	gh—d_
.
	gÃxt_
 =ğ&
h—d_
; }

47 
SÇpshÙIm¶
* 
Şde¡
() const {

48 
as£¹
(!
em±y
());

49  
	gh—d_
.
	gÃxt_
;

51 
SÇpshÙIm¶
* 
Ãwe¡
() const {

52 
as£¹
(!
em±y
());

53  
	gh—d_
.
	g´ev_
;

57 
SÇpshÙIm¶
* 
New
(
Sequ’ûNumb”
 
£qu’û_numb”
) {

58 
as£¹
(
em±y
(è|| 
Ãwe¡
()->
£qu’û_numb”_
 <ğ
£qu’û_numb”
);

60 
SÇpshÙIm¶
* 
	g¢­shÙ
 = 
Ãw
 SÇpshÙIm¶(
£qu’û_numb”
);

62 #ià!
defšed
(
NDEBUG
)

63 
	g¢­shÙ
->
	gli¡_
 = 
this
;

65 
	g¢­shÙ
->
	gÃxt_
 = &
h—d_
;

66 
	g¢­shÙ
->
	g´ev_
 = 
h—d_
.
´ev_
;

67 
	g¢­shÙ
->
	g´ev_
->
	gÃxt_
 = 
¢­shÙ
;

68 
	g¢­shÙ
->
	gÃxt_
->
	g´ev_
 = 
¢­shÙ
;

69  
	g¢­shÙ
;

79 
D–‘e
(cÚ¡ 
SÇpshÙIm¶
* 
¢­shÙ
) {

80 #ià!
defšed
(
NDEBUG
)

81 
as£¹
(
¢­shÙ
->
li¡_
 =ğ
this
);

83 
	g¢­shÙ
->
	g´ev_
->
	gÃxt_
 = 
¢­shÙ
->
Ãxt_
;

84 
	g¢­shÙ
->
	gÃxt_
->
	g´ev_
 = 
¢­shÙ
->
´ev_
;

85 
d–‘e
 
	g¢­shÙ
;

88 
	g´iv©e
:

90 
SÇpshÙIm¶
 
h—d_
;

	@db/table_cache.cc

5 
	~"db/bË_ÿche.h
"

7 
	~"db/f’ame.h
"

8 
	~"Ëv–db/’v.h
"

9 
	~"Ëv–db/bË.h
"

10 
	~"ut/codšg.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 
	sTabËAndFe
 {

15 
RªdomAcûssFe
* 
	gfe
;

16 
TabË
* 
	gbË
;

19 
D–‘eEÁry
(cÚ¡ 
Sliû
& 
key
, * 
v®ue
) {

20 
TabËAndFe
* 
	gtf
 = 
»š‹½»t_ÿ¡
<TabËAndFe*>(
v®ue
);

21 
d–‘e
 
	gtf
->
	gbË
;

22 
d–‘e
 
	gtf
->
	gfe
;

23 
d–‘e
 
	gtf
;

26 
UÄefEÁry
(* 
¬g1
, * 
¬g2
) {

27 
Cache
* 
	gÿche
 = 
»š‹½»t_ÿ¡
<Cache*>(
¬g1
);

28 
	gCache
::
HªdË
* 
h
 = 
»š‹½»t_ÿ¡
<
Cache
::HªdË*>(
¬g2
);

29 
	gÿche
->
R–—£
(
h
);

32 
	gTabËCache
::
TabËCache
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, cÚ¡ 
O±iÚs
& 
İtiÚs
,

33 
’Œ›s
)

34 : 
’v_
(
İtiÚs
.
’v
),

35 
dbÇme_
(
dbÇme
),

36 
İtiÚs_
(
İtiÚs
),

37 
ÿche_
(
NewLRUCache
(
’Œ›s
)) {}

39 
	gTabËCache
::~
TabËCache
(è{ 
d–‘e
 
ÿche_
; }

41 
Stus
 
	gTabËCache
::
FšdTabË
(
ušt64_t
 
fe_numb”
, ušt64_ˆ
fe_size
,

42 
Cache
::
HªdË
** 
hªdË
) {

43 
Stus
 
s
;

44 
	gbuf
[(
fe_numb”
)];

45 
EncodeFixed64
(
buf
, 
fe_numb”
);

46 
Sliû
 
key
(
buf
, (buf));

47 *
	ghªdË
 = 
ÿche_
->
Lookup
(
key
);

48 ià(*
	ghªdË
 =ğ
nuÎ±r
) {

49 
¡d
::
¡ršg
 
âame
 = 
TabËFeName
(
dbÇme_
, 
fe_numb”
);

50 
RªdomAcûssFe
* 
	gfe
 = 
nuÎ±r
;

51 
TabË
* 
	gbË
 = 
nuÎ±r
;

52 
	gs
 = 
’v_
->
NewRªdomAcûssFe
(
âame
, &
fe
);

53 ià(!
	gs
.
ok
()) {

54 
	g¡d
::
¡ršg
 
Şd_âame
 = 
SSTTabËFeName
(
dbÇme_
, 
fe_numb”
);

55 ià(
	g’v_
->
NewRªdomAcûssFe
(
Şd_âame
, &
fe
).
ok
()) {

56 
	gs
 = 
Stus
::
OK
();

59 ià(
	gs
.
ok
()) {

60 
	gs
 = 
TabË
::
O³n
(
İtiÚs_
, 
fe
, 
fe_size
, &
bË
);

63 ià(!
	gs
.
ok
()) {

64 
as£¹
(
bË
 =ğ
nuÎ±r
);

65 
d–‘e
 
	gfe
;

69 
TabËAndFe
* 
	gtf
 = 
Ãw
 TableAndFile;

70 
	gtf
->
	gfe
 = 
fe
;

71 
	gtf
->
	gbË
 = 
bË
;

72 *
	ghªdË
 = 
ÿche_
->
In£¹
(
key
, 
tf
, 1, &
D–‘eEÁry
);

75  
	gs
;

78 
I‹¿tÜ
* 
	gTabËCache
::
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

79 
ušt64_t
 
fe_numb”
, ušt64_ˆ
fe_size
,

80 
TabË
** 
bË±r
) {

81 ià(
	gbË±r
 !ğ
nuÎ±r
) {

82 *
bË±r
 = 
nuÎ±r
;

85 
	gCache
::
HªdË
* 
hªdË
 = 
nuÎ±r
;

86 
Stus
 
	gs
 = 
FšdTabË
(
fe_numb”
, 
fe_size
, &
hªdË
);

87 ià(!
	gs
.
ok
()) {

88  
NewE¼ÜI‹¿tÜ
(
s
);

91 
TabË
* 
	gbË
 = 
»š‹½»t_ÿ¡
<
TabËAndFe
*>(
ÿche_
->
V®ue
(
hªdË
))->
bË
;

92 
I‹¿tÜ
* 
	g»suÉ
 = 
bË
->
NewI‹¿tÜ
(
İtiÚs
);

93 
	g»suÉ
->
Regi¡”CËªup
(&
UÄefEÁry
, 
ÿche_
, 
hªdË
);

94 ià(
	gbË±r
 !ğ
nuÎ±r
) {

95 *
bË±r
 = 
bË
;

97  
	g»suÉ
;

100 
Stus
 
	gTabËCache
::
G‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, 
ušt64_t
 
fe_numb”
,

101 
ušt64_t
 
fe_size
, cÚ¡ 
Sliû
& 
k
, * 
¬g
,

102 (*
hªdË_»suÉ
)(*, cÚ¡ 
Sliû
&,

103 cÚ¡ 
Sliû
&)) {

104 
	gCache
::
HªdË
* 
hªdË
 = 
nuÎ±r
;

105 
Stus
 
	gs
 = 
FšdTabË
(
fe_numb”
, 
fe_size
, &
hªdË
);

106 ià(
	gs
.
ok
()) {

107 
TabË
* 
	gt
 = 
»š‹½»t_ÿ¡
<
TabËAndFe
*>(
ÿche_
->
V®ue
(
hªdË
))->
bË
;

108 
	gs
 = 
t
->
IÁ”ÇlG‘
(
İtiÚs
, 
k
, 
¬g
, 
hªdË_»suÉ
);

109 
	gÿche_
->
R–—£
(
hªdË
);

111  
	gs
;

114 
	gTabËCache
::
Eviù
(
ušt64_t
 
fe_numb”
) {

115 
buf
[(
fe_numb”
)];

116 
EncodeFixed64
(
buf
, 
fe_numb”
);

117 
	gÿche_
->
E¿£
(
Sliû
(
buf
, (buf)));

	@db/table_cache.h

7 #iâdeà
STORAGE_LEVELDB_DB_TABLE_CACHE_H_


8 
	#STORAGE_LEVELDB_DB_TABLE_CACHE_H_


	)

10 
	~<¡dšt.h
>

12 
	~<¡ršg
>

14 
	~"db/dbfÜm©.h
"

15 
	~"Ëv–db/ÿche.h
"

16 
	~"Ëv–db/bË.h
"

17 
	~"pÜt/pÜt.h
"

19 
Çme¥aû
 
	gËv–db
 {

21 
şass
 
	gEnv
;

23 şas 
	cTabËCache
 {

24 
	gpublic
:

25 
TabËCache
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, cÚ¡ 
O±iÚs
& 
İtiÚs
, 
’Œ›s
);

26 ~
TabËCache
();

35 
I‹¿tÜ
* 
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, 
ušt64_t
 
fe_numb”
,

36 
ušt64_t
 
fe_size
, 
TabË
** 
bË±r
 = 
nuÎ±r
);

40 
Stus
 
G‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, 
ušt64_t
 
fe_numb”
,

41 
ušt64_t
 
fe_size
, cÚ¡ 
Sliû
& 
k
, * 
¬g
,

42 (*
hªdË_»suÉ
)(*, cÚ¡ 
Sliû
&, const Slice&));

45 
Eviù
(
ušt64_t
 
fe_numb”
);

47 
	g´iv©e
:

48 
Stus
 
FšdTabË
(
ušt64_t
 
fe_numb”
, ušt64_ˆ
fe_size
, 
Cache
::
HªdË
**);

50 
Env
* cÚ¡ 
	g’v_
;

51 cÚ¡ 
	g¡d
::
¡ršg
 
dbÇme_
;

52 cÚ¡ 
	gO±iÚs
& 
	gİtiÚs_
;

53 
Cache
* 
	gÿche_
;

	@db/version_edit.cc

5 
	~"db/v”siÚ_ed™.h
"

7 
	~"db/v”siÚ_£t.h
"

8 
	~"ut/codšg.h
"

10 
Çme¥aû
 
	gËv–db
 {

14 
	eTag
 {

15 
	gkCom·¿tÜ
 = 1,

16 
	gkLogNumb”
 = 2,

17 
	gkNextFeNumb”
 = 3,

18 
	gkLa¡Sequ’û
 = 4,

19 
	gkCom·ùPoš‹r
 = 5,

20 
	gkD–‘edFe
 = 6,

21 
	gkNewFe
 = 7,

23 
	gkP»vLogNumb”
 = 9

26 
	gV”siÚEd™
::
CË¬
() {

27 
com·¿tÜ_
.
ş—r
();

28 
	glog_numb”_
 = 0;

29 
	g´ev_log_numb”_
 = 0;

30 
	gÏ¡_£qu’û_
 = 0;

31 
	gÃxt_fe_numb”_
 = 0;

32 
	ghas_com·¿tÜ_
 = 
çl£
;

33 
	ghas_log_numb”_
 = 
çl£
;

34 
	ghas_´ev_log_numb”_
 = 
çl£
;

35 
	ghas_Ãxt_fe_numb”_
 = 
çl£
;

36 
	ghas_Ï¡_£qu’û_
 = 
çl£
;

37 
	gd–‘ed_fes_
.
ş—r
();

38 
	gÃw_fes_
.
ş—r
();

41 
	gV”siÚEd™
::
EncodeTo
(
¡d
::
¡ršg
* 
d¡
) const {

42 ià(
has_com·¿tÜ_
) {

43 
PutV¬št32
(
d¡
, 
kCom·¿tÜ
);

44 
PutL’gthP»fixedSliû
(
d¡
, 
com·¿tÜ_
);

46 ià(
	ghas_log_numb”_
) {

47 
PutV¬št32
(
d¡
, 
kLogNumb”
);

48 
PutV¬št64
(
d¡
, 
log_numb”_
);

50 ià(
	ghas_´ev_log_numb”_
) {

51 
PutV¬št32
(
d¡
, 
kP»vLogNumb”
);

52 
PutV¬št64
(
d¡
, 
´ev_log_numb”_
);

54 ià(
	ghas_Ãxt_fe_numb”_
) {

55 
PutV¬št32
(
d¡
, 
kNextFeNumb”
);

56 
PutV¬št64
(
d¡
, 
Ãxt_fe_numb”_
);

58 ià(
	ghas_Ï¡_£qu’û_
) {

59 
PutV¬št32
(
d¡
, 
kLa¡Sequ’û
);

60 
PutV¬št64
(
d¡
, 
Ï¡_£qu’û_
);

63 
size_t
 
	gi
 = 0; i < 
	gcom·ù_poš‹rs_
.
size
(); i++) {

64 
PutV¬št32
(
d¡
, 
kCom·ùPoš‹r
);

65 
PutV¬št32
(
d¡
, 
com·ù_poš‹rs_
[
i
].
fœ¡
);

66 
PutL’gthP»fixedSliû
(
d¡
, 
com·ù_poš‹rs_
[
i
].
£cÚd
.
Encode
());

69 
	gD–‘edFeS‘
::
cÚ¡_™”©Ü
 
™”
 = 
d–‘ed_fes_
.
begš
();

70 
	g™”
 !ğ
d–‘ed_fes_
.
’d
(); ++iter) {

71 
PutV¬št32
(
d¡
, 
kD–‘edFe
);

72 
PutV¬št32
(
d¡
, 
™”
->
fœ¡
);

73 
PutV¬št64
(
d¡
, 
™”
->
£cÚd
);

76 
size_t
 
	gi
 = 0; i < 
	gÃw_fes_
.
size
(); i++) {

77 cÚ¡ 
	gFeM‘aD©a
& 
	gf
 = 
Ãw_fes_
[
i
].
£cÚd
;

78 
PutV¬št32
(
d¡
, 
kNewFe
);

79 
PutV¬št32
(
d¡
, 
Ãw_fes_
[
i
].
fœ¡
);

80 
PutV¬št64
(
d¡
, 
f
.
numb”
);

81 
PutV¬št64
(
d¡
, 
f
.
fe_size
);

82 
PutL’gthP»fixedSliû
(
d¡
, 
f
.
sm®Ë¡
.
Encode
());

83 
PutL’gthP»fixedSliû
(
d¡
, 
f
.
Ïrge¡
.
Encode
());

87 
boŞ
 
G‘IÁ”ÇlKey
(
Sliû
* 
šput
, 
IÁ”ÇlKey
* 
d¡
) {

88 
Sliû
 
	g¡r
;

89 ià(
G‘L’gthP»fixedSliû
(
šput
, &
¡r
)) {

90 
	gd¡
->
DecodeFrom
(
¡r
);

91  
	gŒue
;

93  
	gçl£
;

97 
boŞ
 
G‘Lev–
(
Sliû
* 
šput
, * 
Ëv–
) {

98 
ušt32_t
 
	gv
;

99 ià(
G‘V¬št32
(
šput
, &
v
è&& 
	gv
 < 
	gcÚfig
::
kNumLev–s
) {

100 *
Ëv–
 = 
v
;

101  
	gŒue
;

103  
	gçl£
;

107 
Stus
 
	gV”siÚEd™
::
DecodeFrom
(cÚ¡ 
Sliû
& 
¤c
) {

108 
CË¬
();

109 
Sliû
 
	gšput
 = 
¤c
;

110 cÚ¡ * 
	gmsg
 = 
nuÎ±r
;

111 
ušt32_t
 
	gg
;

114 
	gËv–
;

115 
ušt64_t
 
	gnumb”
;

116 
FeM‘aD©a
 
	gf
;

117 
Sliû
 
	g¡r
;

118 
IÁ”ÇlKey
 
	gkey
;

120 
	gmsg
 =ğ
nuÎ±r
 && 
G‘V¬št32
(&
šput
, &
g
)) {

121 
	gg
) {

122 
	gkCom·¿tÜ
:

123 ià(
G‘L’gthP»fixedSliû
(&
šput
, &
¡r
)) {

124 
	gcom·¿tÜ_
 = 
¡r
.
ToSŒšg
();

125 
	ghas_com·¿tÜ_
 = 
Œue
;

127 
	gmsg
 = "comparator‚ame";

131 
	gkLogNumb”
:

132 ià(
G‘V¬št64
(&
šput
, &
log_numb”_
)) {

133 
	ghas_log_numb”_
 = 
Œue
;

135 
	gmsg
 = "log‚umber";

139 
	gkP»vLogNumb”
:

140 ià(
G‘V¬št64
(&
šput
, &
´ev_log_numb”_
)) {

141 
	ghas_´ev_log_numb”_
 = 
Œue
;

143 
	gmsg
 = "previous†og‚umber";

147 
	gkNextFeNumb”
:

148 ià(
G‘V¬št64
(&
šput
, &
Ãxt_fe_numb”_
)) {

149 
	ghas_Ãxt_fe_numb”_
 = 
Œue
;

151 
	gmsg
 = "next file‚umber";

155 
	gkLa¡Sequ’û
:

156 ià(
G‘V¬št64
(&
šput
, &
Ï¡_£qu’û_
)) {

157 
	ghas_Ï¡_£qu’û_
 = 
Œue
;

159 
	gmsg
 = "last sequence‚umber";

163 
	gkCom·ùPoš‹r
:

164 ià(
G‘Lev–
(&
šput
, &
Ëv–
è&& 
G‘IÁ”ÇlKey
(&šput, &
key
)) {

165 
	gcom·ù_poš‹rs_
.
push_back
(
¡d
::
make_·œ
(
Ëv–
, 
key
));

167 
	gmsg
 = "compaction…ointer";

171 
	gkD–‘edFe
:

172 ià(
G‘Lev–
(&
šput
, &
Ëv–
è&& 
G‘V¬št64
(&šput, &
numb”
)) {

173 
	gd–‘ed_fes_
.
š£¹
(
¡d
::
make_·œ
(
Ëv–
, 
numb”
));

175 
	gmsg
 = "deleted file";

179 
	gkNewFe
:

180 ià(
G‘Lev–
(&
šput
, &
Ëv–
è&& 
G‘V¬št64
(&šput, &
f
.
numb”
) &&

181 
G‘V¬št64
(&
šput
, &
f
.
fe_size
) &&

182 
G‘IÁ”ÇlKey
(&
šput
, &
f
.
sm®Ë¡
) &&

183 
G‘IÁ”ÇlKey
(&
šput
, &
f
.
Ïrge¡
)) {

184 
	gÃw_fes_
.
push_back
(
¡d
::
make_·œ
(
Ëv–
, 
f
));

186 
	gmsg
 = "new-fileƒntry";

191 
msg
 = "unknownag";

196 ià(
	gmsg
 =ğ
nuÎ±r
 && !
šput
.
em±y
()) {

197 
msg
 = "invalidag";

200 
Stus
 
	g»suÉ
;

201 ià(
	gmsg
 !ğ
nuÎ±r
) {

202 
»suÉ
 = 
Stus
::
CÜru±iÚ
("V”siÚEd™", 
msg
);

204  
	g»suÉ
;

207 
	g¡d
::
¡ršg
 
V”siÚEd™
::
DebugSŒšg
() const {

208 
¡d
::
¡ršg
 
r
;

209 
	gr
.
­³nd
("VersionEdit {");

210 ià(
	ghas_com·¿tÜ_
) {

211 
	gr
.
­³nd
("\n Comparator: ");

212 
	gr
.
­³nd
(
com·¿tÜ_
);

214 ià(
	ghas_log_numb”_
) {

215 
	gr
.
­³nd
("\n LogNumber: ");

216 
Aµ’dNumb”To
(&
r
, 
log_numb”_
);

218 ià(
	ghas_´ev_log_numb”_
) {

219 
	gr
.
­³nd
("\n PrevLogNumber: ");

220 
Aµ’dNumb”To
(&
r
, 
´ev_log_numb”_
);

222 ià(
	ghas_Ãxt_fe_numb”_
) {

223 
	gr
.
­³nd
("\n NextFile: ");

224 
Aµ’dNumb”To
(&
r
, 
Ãxt_fe_numb”_
);

226 ià(
	ghas_Ï¡_£qu’û_
) {

227 
	gr
.
­³nd
("\n LastSeq: ");

228 
Aµ’dNumb”To
(&
r
, 
Ï¡_£qu’û_
);

230 
size_t
 
	gi
 = 0; i < 
	gcom·ù_poš‹rs_
.
size
(); i++) {

231 
	gr
.
­³nd
("\n CompactPointer: ");

232 
Aµ’dNumb”To
(&
r
, 
com·ù_poš‹rs_
[
i
].
fœ¡
);

233 
	gr
.
­³nd
(" ");

234 
	gr
.
­³nd
(
com·ù_poš‹rs_
[
i
].
£cÚd
.
DebugSŒšg
());

236 
	gD–‘edFeS‘
::
cÚ¡_™”©Ü
 
™”
 = 
d–‘ed_fes_
.
begš
();

237 
	g™”
 !ğ
d–‘ed_fes_
.
’d
(); ++iter) {

238 
	gr
.
­³nd
("\n DeleteFile: ");

239 
Aµ’dNumb”To
(&
r
, 
™”
->
fœ¡
);

240 
	gr
.
­³nd
(" ");

241 
Aµ’dNumb”To
(&
r
, 
™”
->
£cÚd
);

243 
size_t
 
	gi
 = 0; i < 
	gÃw_fes_
.
size
(); i++) {

244 cÚ¡ 
	gFeM‘aD©a
& 
	gf
 = 
Ãw_fes_
[
i
].
£cÚd
;

245 
	gr
.
­³nd
("\n AddFile: ");

246 
Aµ’dNumb”To
(&
r
, 
Ãw_fes_
[
i
].
fœ¡
);

247 
	gr
.
­³nd
(" ");

248 
Aµ’dNumb”To
(&
r
, 
f
.
numb”
);

249 
	gr
.
­³nd
(" ");

250 
Aµ’dNumb”To
(&
r
, 
f
.
fe_size
);

251 
	gr
.
­³nd
(" ");

252 
	gr
.
­³nd
(
f
.
sm®Ë¡
.
DebugSŒšg
());

253 
	gr
.
­³nd
(" .. ");

254 
	gr
.
­³nd
(
f
.
Ïrge¡
.
DebugSŒšg
());

256 
	gr
.
­³nd
("\n}\n");

257  
	gr
;

	@db/version_edit.h

5 #iâdeà
STORAGE_LEVELDB_DB_VERSION_EDIT_H_


6 
	#STORAGE_LEVELDB_DB_VERSION_EDIT_H_


	)

8 
	~<£t
>

9 
	~<ut™y
>

10 
	~<veùÜ
>

12 
	~"db/dbfÜm©.h
"

14 
Çme¥aû
 
	gËv–db
 {

16 
şass
 
	gV”siÚS‘
;

18 
	sFeM‘aD©a
 {

19 
FeM‘aD©a
(è: 
»fs
(0), 
®lowed_£eks
(1 << 30), 
fe_size
(0) {}

21 
	g»fs
;

22 
	g®lowed_£eks
;

23 
ušt64_t
 
	gnumb”
;

24 
ušt64_t
 
	gfe_size
;

25 
IÁ”ÇlKey
 
	gsm®Ë¡
;

26 
IÁ”ÇlKey
 
	gÏrge¡
;

28 
	gfs
;

31 şas 
	cV”siÚEd™
 {

32 
	gpublic
:

33 
V”siÚEd™
(è{ 
CË¬
(); }

34 ~
V”siÚEd™
() {}

36 
CË¬
();

38 
S‘Com·¿tÜName
(cÚ¡ 
Sliû
& 
Çme
) {

39 
	ghas_com·¿tÜ_
 = 
Œue
;

40 
	gcom·¿tÜ_
 = 
Çme
.
ToSŒšg
();

42 
S‘LogNumb”
(
ušt64_t
 
num
) {

43 
	ghas_log_numb”_
 = 
Œue
;

44 
	glog_numb”_
 = 
num
;

46 
S‘P»vLogNumb”
(
ušt64_t
 
num
) {

47 
	ghas_´ev_log_numb”_
 = 
Œue
;

48 
	g´ev_log_numb”_
 = 
num
;

50 
S‘NextFe
(
ušt64_t
 
num
) {

51 
	ghas_Ãxt_fe_numb”_
 = 
Œue
;

52 
	gÃxt_fe_numb”_
 = 
num
;

54 
S‘La¡Sequ’û
(
Sequ’ûNumb”
 
£q
) {

55 
	ghas_Ï¡_£qu’û_
 = 
Œue
;

56 
	gÏ¡_£qu’û_
 = 
£q
;

58 
S‘Com·ùPoš‹r
(
Ëv–
, cÚ¡ 
IÁ”ÇlKey
& 
key
) {

59 
	gcom·ù_poš‹rs_
.
push_back
(
¡d
::
make_·œ
(
Ëv–
, 
key
));

65 
AddFe
(
Ëv–
, 
ušt64_t
 
fe
, ušt64_ˆ
fe_size
,

66 cÚ¡ 
IÁ”ÇlKey
& 
sm®Ë¡
, cÚ¡ IÁ”ÇlKey& 
Ïrge¡
, 
fs
) {

67 
FeM‘aD©a
 
	gf
;

68 
	gf
.
	gnumb”
 = 
fe
;

69 
	gf
.
	gfe_size
 = 
fe_size
;

70 
	gf
.
	gsm®Ë¡
 = 
sm®Ë¡
;

71 
	gf
.
	gÏrge¡
 = 
Ïrge¡
;

72 
	gf
.
	gfs
 = 
fs
;

73 
	gÃw_fes_
.
push_back
(
¡d
::
make_·œ
(
Ëv–
, 
f
));

77 
D–‘eFe
(
Ëv–
, 
ušt64_t
 
fe
) {

78 
	gd–‘ed_fes_
.
š£¹
(
¡d
::
make_·œ
(
Ëv–
, 
fe
));

81 
EncodeTo
(
¡d
::
¡ršg
* 
d¡
) const;

82 
Stus
 
DecodeFrom
(cÚ¡ 
Sliû
& 
¤c
);

84 
	g¡d
::
¡ršg
 
DebugSŒšg
() const;

86 
	g´iv©e
:

87 
ä›nd
 
şass
 
V”siÚS‘
;

89 
	g¡d
::
	t£t
<
	t¡d
::
	t·œ
<, 
	tušt64_t
> > 
	tD–‘edFeS‘
;

91 
	g¡d
::
¡ršg
 
com·¿tÜ_
;

92 
ušt64_t
 
	glog_numb”_
;

93 
ušt64_t
 
	g´ev_log_numb”_
;

94 
ušt64_t
 
	gÃxt_fe_numb”_
;

95 
Sequ’ûNumb”
 
	gÏ¡_£qu’û_
;

96 
boŞ
 
	ghas_com·¿tÜ_
;

97 
boŞ
 
	ghas_log_numb”_
;

98 
boŞ
 
	ghas_´ev_log_numb”_
;

99 
boŞ
 
	ghas_Ãxt_fe_numb”_
;

100 
boŞ
 
	ghas_Ï¡_£qu’û_
;

102 
	g¡d
::
veùÜ
<
¡d
::
·œ
<, 
	gIÁ”ÇlKey
> > 
	gcom·ù_poš‹rs_
;

103 
D–‘edFeS‘
 
	gd–‘ed_fes_
;

104 
	g¡d
::
veùÜ
<
¡d
::
·œ
<, 
	gFeM‘aD©a
> > 
	gÃw_fes_
;

	@db/version_edit_test.cc

5 
	~"db/v”siÚ_ed™.h
"

6 
	~"ut/‹¡h¬Ãss.h
"

8 
Çme¥aû
 
	gËv–db
 {

10 
Te¡EncodeDecode
(cÚ¡ 
V”siÚEd™
& 
ed™
) {

11 
	g¡d
::
¡ršg
 
’coded
, 
	g’coded2
;

12 
	ged™
.
EncodeTo
(&
’coded
);

13 
V”siÚEd™
 
	g·r£d
;

14 
Stus
 
	gs
 = 
·r£d
.
DecodeFrom
(
’coded
);

15 
ASSERT_TRUE
(
s
.
ok
()è<< 
	gs
.
ToSŒšg
();

16 
	g·r£d
.
EncodeTo
(&
’coded2
);

17 
ASSERT_EQ
(
’coded
, 
’coded2
);

20 şas 
	cV”siÚEd™Te¡
 {};

22 
	$TEST
(
V”siÚEd™Te¡
, 
EncodeDecode
) {

23 cÚ¡ 
ušt64_t
 
kBig
 = 1ull << 50;

25 
V”siÚEd™
 
ed™
;

26 
i
 = 0; i < 4; i++) {

27 
	`Te¡EncodeDecode
(
ed™
);

28 
ed™
.
	`AddFe
(3, 
kBig
 + 300 + 
i
, kBig + 400 + i,

29 
	`IÁ”ÇlKey
("foo", 
kBig
 + 500 + 
i
, 
kTy³V®ue
),

30 
	`IÁ”ÇlKey
("zoo", 
kBig
 + 600 + 
i
, 
kTy³D–‘iÚ
),0);

31 
ed™
.
	`D–‘eFe
(4, 
kBig
 + 700 + 
i
);

32 
ed™
.
	`S‘Com·ùPoš‹r
(
i
, 
	`IÁ”ÇlKey
("x", 
kBig
 + 900 + i, 
kTy³V®ue
));

35 
ed™
.
	`S‘Com·¿tÜName
("foo");

36 
ed™
.
	`S‘LogNumb”
(
kBig
 + 100);

37 
ed™
.
	`S‘NextFe
(
kBig
 + 200);

38 
ed™
.
	`S‘La¡Sequ’û
(
kBig
 + 1000);

39 
	`Te¡EncodeDecode
(
ed™
);

40 
	}
}

44 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/version_set.cc

5 
	~"db/v”siÚ_£t.h
"

7 
	~<¡dio.h
>

9 
	~<®gÜ™hm
>

11 
	~"db/f’ame.h
"

12 
	~"db/log_»ad”.h
"

13 
	~"db/log_wr™”.h
"

14 
	~"db/membË.h
"

15 
	~"db/bË_ÿche.h
"

16 
	~"Ëv–db/’v.h
"

17 
	~"Ëv–db/bË_bud”.h
"

18 
	~"bË/m”g”.h
"

19 
	~"bË/two_Ëv–_™”©Ü.h
"

20 
	~"ut/codšg.h
"

21 
	~"ut/loggšg.h
"

23 
Çme¥aû
 
	gËv–db
 {

25 
size_t
 
T¬g‘FeSize
(cÚ¡ 
O±iÚs
* 
İtiÚs
) {

26  
	gİtiÚs
->
	gmax_fe_size
;

31 
št64_t
 
MaxG¿ndP¬’tOv”ÏpBy‹s
(cÚ¡ 
O±iÚs
* 
İtiÚs
) {

32  10 * 
T¬g‘FeSize
(
İtiÚs
);

38 
št64_t
 
Ex·ndedCom·ùiÚBy‹SizeLim™
(cÚ¡ 
O±iÚs
* 
İtiÚs
) {

39  25 * 
T¬g‘FeSize
(
İtiÚs
);

42 
MaxBy‹sFÜLev–
(cÚ¡ 
O±iÚs
* 
İtiÚs
, 
Ëv–
) {

47 
	g»suÉ
 = 10. * 1048576.0;

48 
	gËv–
 > 1) {

49 
	g»suÉ
 *= 10;

50 
	gËv–
--;

52  
	g»suÉ
;

55 
ušt64_t
 
MaxFeSizeFÜLev–
(cÚ¡ 
O±iÚs
* 
İtiÚs
, 
Ëv–
) {

57  
T¬g‘FeSize
(
İtiÚs
);

60 
št64_t
 
TÙ®FeSize
(cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
) {

61 
št64_t
 
sum
 = 0;

62 
size_t
 
	gi
 = 0; i < 
	gfes
.
size
(); i++) {

63 
	gsum
 +ğ
fes
[
i
]->
fe_size
;

65  
	gsum
;

68 
	gV”siÚ
::~
V”siÚ
() {

69 
as£¹
(
»fs_
 == 0);

72 
	g´ev_
->
	gÃxt_
 = 
Ãxt_
;

73 
	gÃxt_
->
	g´ev_
 = 
´ev_
;

76 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

77 
size_t
 
	gi
 = 0; i < 
	gfes_
[
Ëv–
].
size
(); i++) {

78 
FeM‘aD©a
* 
	gf
 = 
fes_
[
Ëv–
][
i
];

79 
as£¹
(
f
->
»fs
 > 0);

80 
	gf
->
	g»fs
--;

81 ià(
	gf
->
	g»fs
 <= 0) {

82 
d–‘e
 
f
;

88 
FšdFe
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

89 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
, cÚ¡ 
Sliû
& 
key
) {

90 
ušt32_t
 
	gËá
 = 0;

91 
ušt32_t
 
	gright
 = 
fes
.
size
();

92 
	gËá
 < 
	gright
) {

93 
ušt32_t
 
	gmid
 = (
Ëá
 + 
right
) / 2;

94 cÚ¡ 
FeM‘aD©a
* 
	gf
 = 
fes
[
mid
];

95 ià(
	gicmp
.
	gIÁ”ÇlKeyCom·¿tÜ
::
Com·»
(
f
->
Ïrge¡
.
Encode
(), 
key
) < 0) {

98 
	gËá
 = 
mid
 + 1;

102 
	gright
 = 
mid
;

105  
	gright
;

108 
boŞ
 
Aá”Fe
(cÚ¡ 
Com·¿tÜ
* 
ucmp
, cÚ¡ 
Sliû
* 
u£r_key
,

109 cÚ¡ 
FeM‘aD©a
* 
f
) {

111  (
	gu£r_key
 !ğ
nuÎ±r
 &&

112 
ucmp
->
Com·»
(*
u£r_key
, 
f
->
Ïrge¡
.user_key()) > 0);

115 
boŞ
 
BefÜeFe
(cÚ¡ 
Com·¿tÜ
* 
ucmp
, cÚ¡ 
Sliû
* 
u£r_key
,

116 cÚ¡ 
FeM‘aD©a
* 
f
) {

118  (
	gu£r_key
 !ğ
nuÎ±r
 &&

119 
ucmp
->
Com·»
(*
u£r_key
, 
f
->
sm®Ë¡
.user_key()) < 0);

122 
boŞ
 
SomeFeOv”ÏpsRªge
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

123 
boŞ
 
disjošt_sÜ‹d_fes
,

124 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
,

125 cÚ¡ 
Sliû
* 
sm®Ë¡_u£r_key
,

126 cÚ¡ 
Sliû
* 
Ïrge¡_u£r_key
) {

127 cÚ¡ 
Com·¿tÜ
* 
	gucmp
 = 
icmp
.
u£r_com·¿tÜ
();

128 ià(!
	gdisjošt_sÜ‹d_fes
) {

130 
size_t
 
	gi
 = 0; i < 
	gfes
.
size
(); i++) {

131 cÚ¡ 
FeM‘aD©a
* 
	gf
 = 
fes
[
i
];

132 ià(
Aá”Fe
(
ucmp
, 
sm®Ë¡_u£r_key
, 
f
) ||

133 
BefÜeFe
(
ucmp
, 
Ïrge¡_u£r_key
, 
f
)) {

136  
	gŒue
;

139  
	gçl£
;

143 
ušt32_t
 
	gšdex
 = 0;

144 ià(
	gsm®Ë¡_u£r_key
 !ğ
nuÎ±r
) {

146 
IÁ”ÇlKey
 
sm®l_key
(*
sm®Ë¡_u£r_key
, 
kMaxSequ’ûNumb”
,

147 
kV®ueTy³FÜS“k
);

148 
	gšdex
 = 
FšdFe
(
icmp
, 
fes
, 
sm®l_key
.
Encode
());

151 ià(
	gšdex
 >ğ
fes
.
size
()) {

153  
çl£
;

156  !
BefÜeFe
(
ucmp
, 
Ïrge¡_u£r_key
, 
fes
[
šdex
]);

164 şas 
	cV”siÚ
::
Lev–FeNumI‹¿tÜ
 : 
public
 
I‹¿tÜ
 {

165 
public
:

166 
Lev–FeNumI‹¿tÜ
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

167 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>* 
æi¡
)

168 : 
icmp_
(
icmp
), 
æi¡_
(
æi¡
), 
šdex_
(æi¡->
size
()) {

170 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  
	gšdex_
 < 
	gæi¡_
->
size
(); }

171 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
rg‘
) {

172 
	gšdex_
 = 
FšdFe
(
icmp_
, *
æi¡_
, 
rg‘
);

174 
vœtu®
 
S“kToFœ¡
(è{ 
	gšdex_
 = 0; }

175 
vœtu®
 
S“kToLa¡
() {

176 
	gšdex_
 = 
æi¡_
->
em±y
(è? 0 : fli¡_->
size
() - 1;

178 
vœtu®
 
Next
() {

179 
as£¹
(
V®id
());

180 
	gšdex_
++;

182 
vœtu®
 
P»v
() {

183 
as£¹
(
V®id
());

184 ià(
	gšdex_
 == 0) {

185 
šdex_
 = 
æi¡_
->
size
();

187 
	gšdex_
--;

190 
Sliû
 
key
() const {

191 
as£¹
(
V®id
());

192  (*
	gæi¡_
)[
šdex_
]->
	gÏrge¡
.
Encode
();

194 
Sliû
 
v®ue
() const {

195 
as£¹
(
V®id
());

196 
EncodeFixed64
(
v®ue_buf_
, (*
æi¡_
)[
šdex_
]->
numb”
);

197 
EncodeFixed64
(
v®ue_buf_
 + 8, (*
æi¡_
)[
šdex_
]->
fe_size
);

198  
Sliû
(
v®ue_buf_
, (value_buf_));

200 
vœtu®
 
Stus
 
¡©us
(ècÚ¡ {  
	gStus
::
OK
(); }

202 
	g´iv©e
:

203 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
 
icmp_
;

204 cÚ¡ 
	g¡d
::
veùÜ
<
FeM‘aD©a
*>* cÚ¡ 
æi¡_
;

205 
ušt32_t
 
	gšdex_
;

208 
mubË
 
	gv®ue_buf_
[16];

211 
I‹¿tÜ
* 
	$G‘FeI‹¿tÜ
(* 
¬g
, cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

212 cÚ¡ 
Sliû
& 
fe_v®ue
) {

213 
TabËCache
* 
ÿche
 = 
»š‹½»t_ÿ¡
<TabËCache*>(
¬g
);

214 ià(
fe_v®ue
.
	`size
() != 16) {

215  
	`NewE¼ÜI‹¿tÜ
(

216 
Stus
::
	`CÜru±iÚ
("FileReader invoked with unexpected value"));

218  
ÿche
->
	`NewI‹¿tÜ
(
İtiÚs
, 
	`DecodeFixed64
(
fe_v®ue
.
	`d©a
()),

219 
	`DecodeFixed64
(
fe_v®ue
.
	`d©a
() + 8));

221 
	}
}

223 
I‹¿tÜ
* 
	gV”siÚ
::
	$NewCÚÿ‹ÇtšgI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

224 
Ëv–
) const {

225  
	`NewTwoLev–I‹¿tÜ
(

226 
Ãw
 
	`Lev–FeNumI‹¿tÜ
(
v£t_
->
icmp_
, &
fes_
[
Ëv–
]), &
G‘FeI‹¿tÜ
,

227 
v£t_
->
bË_ÿche_
, 
İtiÚs
);

228 
	}
}

230 
	gV”siÚ
::
AddI‹¿tÜs
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

231 
¡d
::
veùÜ
<
I‹¿tÜ
*>* 
™”s
) {

233 
size_t
 
i
 = 0; 
	gi
 < 
	gfes_
[0].
size
(); i++) {

234 
	g™”s
->
push_back
(
v£t_
->
bË_ÿche_
->
NewI‹¿tÜ
(

235 
İtiÚs
, 
fes_
[0][
i
]->
numb”
, fes_[0][i]->
fe_size
));

241 
	gËv–
 = 1;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

242 ià(!
	gfes_
[
Ëv–
].
em±y
()) {

243 
	g™”s
->
push_back
(
NewCÚÿ‹ÇtšgI‹¿tÜ
(
İtiÚs
, 
Ëv–
));

249 
	gÇme¥aû
 {

250 
	eSav”S‹
 {

251 
	gkNÙFound
,

252 
	gkFound
,

253 
	gkD–‘ed
,

254 
	gkCÜru±
,

256 
	sSav”
 {

257 
Sav”S‹
 
	g¡©e
;

258 cÚ¡ 
Com·¿tÜ
* 
	gucmp
;

259 
Sliû
 
	gu£r_key
;

260 
	g¡d
::
¡ršg
* 
v®ue
;

263 
	$SaveV®ue
(* 
¬g
, cÚ¡ 
Sliû
& 
ikey
, cÚ¡ Sliû& 
v
) {

264 
Sav”
* 
s
 = 
»š‹½»t_ÿ¡
<Sav”*>(
¬g
);

265 
P¬£dIÁ”ÇlKey
 
·r£d_key
;

266 ià(!
	`P¬£IÁ”ÇlKey
(
ikey
, &
·r£d_key
)) {

267 
s
->
¡©e
 = 
kCÜru±
;

269 ià(
s
->
ucmp
->
	`Com·»
(
·r£d_key
.
u£r_key
, s->user_key) == 0) {

270 
s
->
¡©e
 = (
·r£d_key
.
ty³
 =ğ
kTy³V®ue
è? 
kFound
 : 
kD–‘ed
;

271 ià(
s
->
¡©e
 =ğ
kFound
) {

272 
s
->
v®ue
->
	`assign
(
v
.
	`d©a
(), v.
	`size
());

276 
	}
}

278 
boŞ
 
	$Newe¡Fœ¡
(
FeM‘aD©a
* 
a
, FeM‘aD©a* 
b
) {

279  
a
->
numb”
 > 
b
->number;

280 
	}
}

282 
	gV”siÚ
::
	$FÜEachOv”Ïµšg
(
Sliû
 
u£r_key
, Sliû 
š‹º®_key
, * 
¬g
,

283 
	$boŞ
 (*
func
)(*, , 
FeM‘aD©a
*)) {

285 cÚ¡ 
Com·¿tÜ
* 
ucmp
 = 
v£t_
->
icmp_
.
	`u£r_com·¿tÜ
();

288 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
tmp
;

289 
tmp
.
	`»£rve
(
fes_
[0].
	`size
());

290 
ušt32_t
 
i
 = 0; i < 
fes_
[0].
	`size
(); i++) {

291 
FeM‘aD©a
* 
f
 = 
fes_
[0][
i
];

292 ià(
ucmp
->
	`Com·»
(
u£r_key
, 
f
->
sm®Ë¡
.
	`u£r_key
()) >= 0 &&

293 
ucmp
->
	`Com·»
(
u£r_key
, 
f
->
Ïrge¡
.
	`u£r_key
()) <= 0) {

294 
tmp
.
	`push_back
(
f
);

297 ià(!
tmp
.
	`em±y
()) {

298 
¡d
::
	`sÜt
(
tmp
.
	`begš
(),mp.
	`’d
(), 
Newe¡Fœ¡
);

299 
ušt32_t
 
i
 = 0; i < 
tmp
.
	`size
(); i++) {

300 ià(!(*
func
)(
¬g
, 0, 
tmp
[
i
])) {

307 
Ëv–
 = 1;†ev– < 
cÚfig
::
kNumLev–s
;†evel++) {

308 
size_t
 
num_fes
 = 
fes_
[
Ëv–
].
	`size
();

309 ià(
num_fes
 == 0) ;

312 
ušt32_t
 
šdex
 = 
	`FšdFe
(
v£t_
->
icmp_
, 
fes_
[
Ëv–
], 
š‹º®_key
);

313 ià(
šdex
 < 
num_fes
) {

314 
FeM‘aD©a
* 
f
 = 
fes_
[
Ëv–
][
šdex
];

315 ià(
ucmp
->
	`Com·»
(
u£r_key
, 
f
->
sm®Ë¡
.
	`u£r_key
()) < 0) {

318 ià(!(*
func
)(
¬g
, 
Ëv–
, 
f
)) {

324 
	}
}

326 
Stus
 
	gV”siÚ
::
	$G‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, cÚ¡ 
LookupKey
& 
k
,

327 
¡d
::
¡ršg
* 
v®ue
, 
G‘Sts
* 
¡©s
) {

328 
Sliû
 
ikey
 = 
k
.
	`š‹º®_key
();

329 
Sliû
 
u£r_key
 = 
k
.
	`u£r_key
();

330 cÚ¡ 
Com·¿tÜ
* 
ucmp
 = 
v£t_
->
icmp_
.
	`u£r_com·¿tÜ
();

331 
Stus
 
s
;

333 
¡©s
->
£ek_fe
 = 
nuÎ±r
;

334 
¡©s
->
£ek_fe_Ëv–
 = -1;

335 
FeM‘aD©a
* 
Ï¡_fe_»ad
 = 
nuÎ±r
;

336 
Ï¡_fe_»ad_Ëv–
 = -1;

341 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
tmp
;

342 
FeM‘aD©a
* 
tmp2
;

343 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
;†evel++) {

344 
size_t
 
num_fes
 = 
fes_
[
Ëv–
].
	`size
();

345 ià(
num_fes
 == 0) ;

348 
FeM‘aD©a
* cÚ¡* 
fes
 = &
fes_
[
Ëv–
][0];

349 ià(
Ëv–
 == 0) {

352 
tmp
.
	`»£rve
(
num_fes
);

353 
ušt32_t
 
i
 = 0; i < 
num_fes
; i++) {

354 
FeM‘aD©a
* 
f
 = 
fes
[
i
];

355 ià(
ucmp
->
	`Com·»
(
u£r_key
, 
f
->
sm®Ë¡
.
	`u£r_key
()) >= 0 &&

356 
ucmp
->
	`Com·»
(
u£r_key
, 
f
->
Ïrge¡
.
	`u£r_key
()) <= 0) {

357 
tmp
.
	`push_back
(
f
);

360 ià(
tmp
.
	`em±y
()) ;

362 
¡d
::
	`sÜt
(
tmp
.
	`begš
(),mp.
	`’d
(), 
Newe¡Fœ¡
);

363 
fes
 = &
tmp
[0];

364 
num_fes
 = 
tmp
.
	`size
();

367 
ušt32_t
 
šdex
 = 
	`FšdFe
(
v£t_
->
icmp_
, 
fes_
[
Ëv–
], 
ikey
);

368 ià(
šdex
 >ğ
num_fes
) {

369 
fes
 = 
nuÎ±r
;

370 
num_fes
 = 0;

372 
tmp2
 = 
fes
[
šdex
];

373 ià(
ucmp
->
	`Com·»
(
u£r_key
, 
tmp2
->
sm®Ë¡
.
	`u£r_key
()) < 0) {

375 
fes
 = 
nuÎ±r
;

376 
num_fes
 = 0;

378 
fes
 = &
tmp2
;

379 
num_fes
 = 1;

384 
ušt32_t
 
i
 = 0; i < 
num_fes
; ++i) {

385 ià(
Ï¡_fe_»ad
 !ğ
nuÎ±r
 && 
¡©s
->
£ek_fe
 ==‚ullptr) {

387 
¡©s
->
£ek_fe
 = 
Ï¡_fe_»ad
;

388 
¡©s
->
£ek_fe_Ëv–
 = 
Ï¡_fe_»ad_Ëv–
;

391 
FeM‘aD©a
* 
f
 = 
fes
[
i
];

392 
Ï¡_fe_»ad
 = 
f
;

393 
Ï¡_fe_»ad_Ëv–
 = 
Ëv–
;

395 
Sav”
 
§v”
;

396 
§v”
.
¡©e
 = 
kNÙFound
;

397 
§v”
.
ucmp
 = ucmp;

398 
§v”
.
u£r_key
 = user_key;

399 
§v”
.
v®ue
 = value;

400 
s
 = 
v£t_
->
bË_ÿche_
->
	`G‘
(
İtiÚs
, 
f
->
numb”
, f->
fe_size
, 
ikey
,

401 &
§v”
, 
SaveV®ue
);

402 ià(!
s
.
	`ok
()) {

403  
s
;

405 
§v”
.
¡©e
) {

406 
kNÙFound
:

408 
kFound
:

409  
s
;

410 
kD–‘ed
:

411 
s
 = 
Stus
::
	`NÙFound
(
	`Sliû
());

412  
s
;

413 
kCÜru±
:

414 
s
 = 
Stus
::
	`CÜru±iÚ
("cÜru±ed key fÜ ", 
u£r_key
);

415  
s
;

420  
Stus
::
	`NÙFound
(
	`Sliû
());

421 
	}
}

423 
boŞ
 
	gV”siÚ
::
	$Upd©eSts
(cÚ¡ 
G‘Sts
& 
¡©s
) {

424 
FeM‘aD©a
* 
f
 = 
¡©s
.
£ek_fe
;

425 ià(
f
 !ğ
nuÎ±r
) {

426 
f
->
®lowed_£eks
--;

427 ià(
f
->
®lowed_£eks
 <ğ0 && 
fe_to_com·ù_
 =ğ
nuÎ±r
) {

428 
fe_to_com·ù_
 = 
f
;

429 
fe_to_com·ù_Ëv–_
 = 
¡©s
.
£ek_fe_Ëv–
;

430  
Œue
;

433  
çl£
;

434 
	}
}

436 
boŞ
 
	gV”siÚ
::
	$RecÜdR—dSam¶e
(
Sliû
 
š‹º®_key
) {

437 
P¬£dIÁ”ÇlKey
 
ikey
;

438 ià(!
	`P¬£IÁ”ÇlKey
(
š‹º®_key
, &
ikey
)) {

439  
çl£
;

442 
	sS‹
 {

443 
G‘Sts
 
¡©s
;

444 
m©ches
;

446 
boŞ
 
	`M©ch
(* 
¬g
, 
Ëv–
, 
FeM‘aD©a
* 
f
) {

447 
S‹
* 
¡©e
 = 
»š‹½»t_ÿ¡
<S‹*>(
¬g
);

448 
¡©e
->
m©ches
++;

449 ià(
¡©e
->
m©ches
 == 1) {

451 
¡©e
->
¡©s
.
£ek_fe
 = 
f
;

452 
¡©e
->
¡©s
.
£ek_fe_Ëv–
 = 
Ëv–
;

455  
¡©e
->
m©ches
 < 2;

459 
S‹
 
¡©e
;

460 
¡©e
.
m©ches
 = 0;

461 
	`FÜEachOv”Ïµšg
(
ikey
.
u£r_key
, 
š‹º®_key
, &
¡©e
, &
S‹
::
M©ch
);

467 ià(
¡©e
.
m©ches
 >= 2) {

469  
	`Upd©eSts
(
¡©e
.
¡©s
);

471  
çl£
;

472 
	}
}

474 
	gV”siÚ
::
	$Ref
(è{ ++
»fs_
; 
	}
}

476 
	gV”siÚ
::
	$UÄef
() {

477 
	`as£¹
(
this
 !ğ&
v£t_
->
dummy_v”siÚs_
);

478 
	`as£¹
(
»fs_
 >= 1);

479 --
»fs_
;

480 ià(
»fs_
 == 0) {

481 
d–‘e
 
this
;

483 
	}
}

485 
boŞ
 
	gV”siÚ
::
	$Ov”ÏpInLev–
(
Ëv–
, cÚ¡ 
Sliû
* 
sm®Ë¡_u£r_key
,

486 cÚ¡ 
Sliû
* 
Ïrge¡_u£r_key
) {

487  
	`SomeFeOv”ÏpsRªge
(
v£t_
->
icmp_
, (
Ëv–
 > 0), 
fes_
[level],

488 
sm®Ë¡_u£r_key
, 
Ïrge¡_u£r_key
);

489 
	}
}

491 
	gV”siÚ
::
	$PickLev–FÜMemTabËOuut
(cÚ¡ 
Sliû
& 
sm®Ë¡_u£r_key
,

492 cÚ¡ 
Sliû
& 
Ïrge¡_u£r_key
) {

493 
Ëv–
 = 0;

494 ià(!
	`Ov”ÏpInLev–
(0, &
sm®Ë¡_u£r_key
, &
Ïrge¡_u£r_key
)) {

497 
IÁ”ÇlKey
 
	`¡¬t
(
sm®Ë¡_u£r_key
, 
kMaxSequ’ûNumb”
, 
kV®ueTy³FÜS“k
);

498 
IÁ”ÇlKey
 
	`lim™
(
Ïrge¡_u£r_key
, 0, 
¡©ic_ÿ¡
<
V®ueTy³
>(0));

499 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
ov”Ïps
;

500 
Ëv–
 < 
cÚfig
::
kMaxMemCom·ùLev–
) {

501 ià(
	`Ov”ÏpInLev–
(
Ëv–
 + 1, &
sm®Ë¡_u£r_key
, &
Ïrge¡_u£r_key
)) {

504 ià(
Ëv–
 + 2 < 
cÚfig
::
kNumLev–s
) {

506 
	`G‘Ov”ÏµšgIÅuts
(
Ëv–
 + 2, &
¡¬t
, &
lim™
, &
ov”Ïps
);

507 cÚ¡ 
št64_t
 
sum
 = 
	`TÙ®FeSize
(
ov”Ïps
);

508 ià(
sum
 > 
	`MaxG¿ndP¬’tOv”ÏpBy‹s
(
v£t_
->
İtiÚs_
)) {

512 
Ëv–
++;

515  
Ëv–
;

516 
	}
}

519 
	gV”siÚ
::
G‘Ov”ÏµšgIÅuts
(
Ëv–
, cÚ¡ 
IÁ”ÇlKey
* 
begš
,

520 cÚ¡ 
IÁ”ÇlKey
* 
’d
,

521 
¡d
::
veùÜ
<
FeM‘aD©a
*>* 
šputs
) {

522 
as£¹
(
Ëv–
 >= 0);

523 
as£¹
(
Ëv–
 < 
cÚfig
::
kNumLev–s
);

524 
	gšputs
->
ş—r
();

525 
Sliû
 
	gu£r_begš
, 
	gu£r_’d
;

526 ià(
	gbegš
 !ğ
nuÎ±r
) {

527 
u£r_begš
 = 
begš
->
u£r_key
();

529 ià(
	g’d
 !ğ
nuÎ±r
) {

530 
u£r_’d
 = 
’d
->
u£r_key
();

532 cÚ¡ 
Com·¿tÜ
* 
	gu£r_cmp
 = 
v£t_
->
icmp_
.
u£r_com·¿tÜ
();

533 
size_t
 
	gi
 = 0; i < 
	gfes_
[
Ëv–
].
size
();) {

534 
FeM‘aD©a
* 
	gf
 = 
fes_
[
Ëv–
][
i
++];

535 cÚ¡ 
Sliû
 
	gfe_¡¬t
 = 
f
->
sm®Ë¡
.
u£r_key
();

536 cÚ¡ 
Sliû
 
	gfe_lim™
 = 
f
->
Ïrge¡
.
u£r_key
();

537 ià(
	gbegš
 !ğ
nuÎ±r
 && 
u£r_cmp
->
Com·»
(
fe_lim™
, 
u£r_begš
) < 0) {

539 } ià(
	g’d
 !ğ
nuÎ±r
 && 
u£r_cmp
->
Com·»
(
fe_¡¬t
, 
u£r_’d
) > 0) {

542 
	gšputs
->
push_back
(
f
);

543 ià(
	gËv–
 == 0) {

546 ià(
begš
 !ğ
nuÎ±r
 && 
u£r_cmp
->
Com·»
(
fe_¡¬t
, 
u£r_begš
) < 0) {

547 
	gu£r_begš
 = 
fe_¡¬t
;

548 
	gšputs
->
ş—r
();

549 
	gi
 = 0;

550 } ià(
	g’d
 !ğ
nuÎ±r
 &&

551 
u£r_cmp
->
Com·»
(
fe_lim™
, 
u£r_’d
) > 0) {

552 
	gu£r_’d
 = 
fe_lim™
;

553 
	gšputs
->
ş—r
();

554 
	gi
 = 0;

561 
	g¡d
::
¡ršg
 
V”siÚ
::
	$DebugSŒšg
() const {

562 
¡d
::
¡ršg
 
r
;

563 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
;†evel++) {

568 
r
.
	`­³nd
("---†evel ");

569 
	`Aµ’dNumb”To
(&
r
, 
Ëv–
);

570 
r
.
	`­³nd
(" ---\n");

571 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
 = 
fes_
[
Ëv–
];

572 
size_t
 
i
 = 0; i < 
fes
.
	`size
(); i++) {

573 
r
.
	`push_back
(' ');

574 
	`Aµ’dNumb”To
(&
r
, 
fes
[
i
]->
numb”
);

575 
r
.
	`push_back
(':');

576 
	`Aµ’dNumb”To
(&
r
, 
fes
[
i
]->
fe_size
);

577 
r
.
	`­³nd
("[");

578 
r
.
	`­³nd
(
fes
[
i
]->
sm®Ë¡
.
	`DebugSŒšg
());

579 
r
.
	`­³nd
(" .. ");

580 
r
.
	`­³nd
(
fes
[
i
]->
Ïrge¡
.
	`DebugSŒšg
());

581 
r
.
	`­³nd
("]\n");

584  
r
;

585 
	}
}

590 şas 
	cV”siÚS‘
::
Bud”
 {

591 
´iv©e
:

593 
	sBySm®Ë¡Key
 {

594 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
* 
š‹º®_com·¿tÜ
;

596 
boŞ
 
İ”©Ü
()(
FeM‘aD©a
* 
	gf1
, FeM‘aD©a* 
	gf2
) const {

597 
	gr
 = 
š‹º®_com·¿tÜ
->
Com·»
(
f1
->
sm®Ë¡
, 
f2
->smallest);

598 ià(
	gr
 != 0) {

599  (
r
 < 0);

602  (
	gf1
->
	gnumb”
 < 
	gf2
->number);

607 
	g¡d
::
	t£t
<
	tFeM‘aD©a
*, 
	tBySm®Ë¡Key
> 
	tFeS‘
;

608 
	sLev–S‹
 {

609 
	g¡d
::
£t
<
ušt64_t
> 
d–‘ed_fes
;

610 
FeS‘
* 
	gadded_fes
;

613 
V”siÚS‘
* 
	gv£t_
;

614 
V”siÚ
* 
	gba£_
;

615 
Lev–S‹
 
	gËv–s_
[
cÚfig
::
kNumLev–s
];

617 
	gpublic
:

619 
Bud”
(
V”siÚS‘
* 
v£t
, 
V”siÚ
* 
ba£
è: 
v£t_
(v£t), 
ba£_
(base) {

620 
	gba£_
->
Ref
();

621 
BySm®Ë¡Key
 
	gcmp
;

622 
	gcmp
.
	gš‹º®_com·¿tÜ
 = &
v£t_
->
icmp_
;

623 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

624 
	gËv–s_
[
Ëv–
].
	gadded_fes
 = 
Ãw
 
FeS‘
(
cmp
);

628 ~
Bud”
() {

629 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

630 cÚ¡ 
FeS‘
* 
	gadded
 = 
Ëv–s_
[
Ëv–
].
added_fes
;

631 
	g¡d
::
veùÜ
<
FeM‘aD©a
*> 
to_uÄef
;

632 
	gto_uÄef
.
»£rve
(
added
->
size
());

633 
	gFeS‘
::
cÚ¡_™”©Ü
 
™
 = 
added
->
begš
(); 
	g™
 !ğadded->
’d
();

634 ++
	g™
) {

635 
	gto_uÄef
.
push_back
(*
™
);

637 
d–‘e
 
	gadded
;

638 
ušt32_t
 
	gi
 = 0; i < 
	gto_uÄef
.
size
(); i++) {

639 
FeM‘aD©a
* 
	gf
 = 
to_uÄef
[
i
];

640 
	gf
->
	g»fs
--;

641 ià(
	gf
->
	g»fs
 <= 0) {

642 
d–‘e
 
f
;

646 
	gba£_
->
UÄef
();

650 
Aµly
(
V”siÚEd™
* 
ed™
) {

652 
size_t
 
	gi
 = 0; i < 
	ged™
->
	gcom·ù_poš‹rs_
.
size
(); i++) {

653 cÚ¡ 
	gËv–
 = 
ed™
->
com·ù_poš‹rs_
[
i
].
fœ¡
;

654 
	gv£t_
->
	gcom·ù_poš‹r_
[
Ëv–
] =

655 
ed™
->
com·ù_poš‹rs_
[
i
].
£cÚd
.
Encode
().
ToSŒšg
();

659 cÚ¡ 
	gV”siÚEd™
::
D–‘edFeS‘
& 
d–
 = 
ed™
->
d–‘ed_fes_
;

660 
	gV”siÚEd™
::
D–‘edFeS‘
::
cÚ¡_™”©Ü
 
™”
 = 
d–
.
begš
();

661 
	g™”
 !ğ
d–
.
’d
(); ++iter) {

662 cÚ¡ 
	gËv–
 = 
™”
->
fœ¡
;

663 cÚ¡ 
ušt64_t
 
	gnumb”
 = 
™”
->
£cÚd
;

664 
	gËv–s_
[
Ëv–
].
	gd–‘ed_fes
.
š£¹
(
numb”
);

668 
size_t
 
	gi
 = 0; i < 
	ged™
->
	gÃw_fes_
.
size
(); i++) {

669 cÚ¡ 
	gËv–
 = 
ed™
->
Ãw_fes_
[
i
].
fœ¡
;

670 
FeM‘aD©a
* 
	gf
 = 
Ãw
 FeM‘aD©a(
ed™
->
Ãw_fes_
[
i
].
£cÚd
);

671 
	gf
->
	g»fs
 = 1;

686 
	gf
->
	g®lowed_£eks
 = 
¡©ic_ÿ¡
<>((
f
->
fe_size
 / 16384U));

687 ià(
	gf
->
	g®lowed_£eks
 < 100) f->allowed_seeks = 100;

689 
	gËv–s_
[
Ëv–
].
	gd–‘ed_fes
.
”a£
(
f
->
numb”
);

690 
	gËv–s_
[
Ëv–
].
	gadded_fes
->
š£¹
(
f
);

695 
SaveTo
(
V”siÚ
* 
v
) {

696 
BySm®Ë¡Key
 
	gcmp
;

697 
	gcmp
.
	gš‹º®_com·¿tÜ
 = &
v£t_
->
icmp_
;

698 
	gËv–
 = 0;†ev– < 
	gcÚfig
::
kNumLev–s
;†evel++) {

701 cÚ¡ 
	g¡d
::
veùÜ
<
FeM‘aD©a
*>& 
ba£_fes
 = 
ba£_
->
fes_
[
Ëv–
];

702 
	g¡d
::
veùÜ
<
FeM‘aD©a
*>::
cÚ¡_™”©Ü
 
ba£_™”
 = 
ba£_fes
.
begš
();

703 
	g¡d
::
veùÜ
<
FeM‘aD©a
*>::
cÚ¡_™”©Ü
 
ba£_’d
 = 
ba£_fes
.
’d
();

704 cÚ¡ 
FeS‘
* 
	gadded
 = 
Ëv–s_
[
Ëv–
].
added_fes
;

705 
	gv
->
	gfes_
[
Ëv–
].
»£rve
(
ba£_fes
.
size
(è+ 
added
->size());

706 
	gFeS‘
::
cÚ¡_™”©Ü
 
added_™”
 = 
added
->
begš
();

707 
	gadded_™”
 !ğ
added
->
’d
(); ++added_iter) {

709 
	g¡d
::
veùÜ
<
FeM‘aD©a
*>::
cÚ¡_™”©Ü
 
bpos
 =

710 
¡d
::
uµ”_bound
(
ba£_™”
, 
ba£_’d
, *
added_™”
, 
cmp
);

711 
	gba£_™”
 !ğ
bpos
; ++base_iter) {

712 
MaybeAddFe
(
v
, 
Ëv–
, *
ba£_™”
);

715 
MaybeAddFe
(
v
, 
Ëv–
, *
added_™”
);

719 ; 
	gba£_™”
 !ğ
ba£_’d
; ++base_iter) {

720 
MaybeAddFe
(
v
, 
Ëv–
, *
ba£_™”
);

723 #iâdeà
NDEBUG


725 ià(
	gËv–
 > 0) {

726 
ušt32_t
 
	gi
 = 1; i < 
	gv
->
	gfes_
[
Ëv–
].
size
(); i++) {

727 cÚ¡ 
	gIÁ”ÇlKey
& 
	g´ev_’d
 = 
v
->
fes_
[
Ëv–
][
i
 - 1]->
Ïrge¡
;

728 cÚ¡ 
	gIÁ”ÇlKey
& 
	gthis_begš
 = 
v
->
fes_
[
Ëv–
][
i
]->
sm®Ë¡
;

729 ià(
	gv£t_
->
	gicmp_
.
Com·»
(
´ev_’d
, 
this_begš
) >= 0) {

730 
årštf
(
¡d”r
, "overlapping„anges in same†evel %s vs. %s\n",

731 
´ev_’d
.
DebugSŒšg
().
c_¡r
(),

732 
this_begš
.
DebugSŒšg
().
c_¡r
());

733 
abÜt
();

741 
MaybeAddFe
(
V”siÚ
* 
v
, 
Ëv–
, 
FeM‘aD©a
* 
f
) {

742 ià(
	gËv–s_
[
Ëv–
].
	gd–‘ed_fes
.
couÁ
(
f
->
numb”
) > 0) {

745 
	g¡d
::
veùÜ
<
FeM‘aD©a
*>* 
fes
 = &
v
->
fes_
[
Ëv–
];

746 ià(
	gËv–
 > 0 && !
	gfes
->
em±y
()) {

748 
as£¹
(
v£t_
->
icmp_
.
Com·»
((*
fes
)[fes->
size
(è- 1]->
Ïrge¡
,

749 
f
->
sm®Ë¡
) < 0);

751 
	gf
->
	g»fs
++;

752 
	gfes
->
push_back
(
f
);

757 
	gV”siÚS‘
::
	$V”siÚS‘
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, cÚ¡ 
O±iÚs
* 
İtiÚs
,

758 
TabËCache
* 
bË_ÿche
,

759 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
* 
cmp
)

760 : 
	`’v_
(
İtiÚs
->
’v
),

761 
	`dbÇme_
(
dbÇme
),

762 
	`İtiÚs_
(
İtiÚs
),

763 
	`bË_ÿche_
(
bË_ÿche
),

764 
	`icmp_
(*
cmp
),

765 
	`Ãxt_fe_numb”_
(2),

766 
	`mªiã¡_fe_numb”_
(0),

767 
	`Ï¡_£qu’û_
(0),

768 
	`log_numb”_
(0),

769 
	`´ev_log_numb”_
(0),

770 
	`desütÜ_fe_
(
nuÎ±r
),

771 
	`desütÜ_log_
(
nuÎ±r
),

772 
	`dummy_v”siÚs_
(
this
),

773 
	$cu¼’t_
(
nuÎ±r
) {

774 
	`Aµ’dV”siÚ
(
Ãw
 
	`V”siÚ
(
this
));

775 
	}
}

777 
	gV”siÚS‘
::~
	$V”siÚS‘
() {

778 
cu¼’t_
->
	`UÄef
();

779 
	`as£¹
(
dummy_v”siÚs_
.
Ãxt_
 == &dummy_versions_);

780 
d–‘e
 
desütÜ_log_
;

781 
d–‘e
 
desütÜ_fe_
;

782 
	}
}

784 
	gV”siÚS‘
::
	$Aµ’dV”siÚ
(
V”siÚ
* 
v
) {

786 
	`as£¹
(
v
->
»fs_
 == 0);

787 
	`as£¹
(
v
 !ğ
cu¼’t_
);

788 ià(
cu¼’t_
 !ğ
nuÎ±r
) {

789 
cu¼’t_
->
	`UÄef
();

791 
cu¼’t_
 = 
v
;

792 
v
->
	`Ref
();

795 
v
->
´ev_
 = 
dummy_v”siÚs_
.prev_;

796 
v
->
Ãxt_
 = &
dummy_v”siÚs_
;

797 
v
->
´ev_
->
Ãxt_
 = v;

798 
v
->
Ãxt_
->
´ev_
 = v;

799 
	}
}

801 
Stus
 
	gV”siÚS‘
::
	$LogAndAµly
(
V”siÚEd™
* 
ed™
, 
pÜt
::
Mu‹x
* 
mu
) {

802 ià(
ed™
->
has_log_numb”_
) {

803 
	`as£¹
(
ed™
->
log_numb”_
 >=†og_number_);

804 
	`as£¹
(
ed™
->
log_numb”_
 < 
Ãxt_fe_numb”_
);

806 
ed™
->
	`S‘LogNumb”
(
log_numb”_
);

809 ià(!
ed™
->
has_´ev_log_numb”_
) {

810 
ed™
->
	`S‘P»vLogNumb”
(
´ev_log_numb”_
);

813 
ed™
->
	`S‘NextFe
(
Ãxt_fe_numb”_
);

814 
ed™
->
	`S‘La¡Sequ’û
(
Ï¡_£qu’û_
);

816 
V”siÚ
* 
v
 = 
Ãw
 
	`V”siÚ
(
this
);

818 
Bud”
 
	`bud”
(
this
, 
cu¼’t_
);

819 
bud”
.
	`Aµly
(
ed™
);

820 
bud”
.
	`SaveTo
(
v
);

822 
	`Fš®ize
(
v
);

826 
¡d
::
¡ršg
 
Ãw_mªiã¡_fe
;

827 
Stus
 
s
;

828 ià(
desütÜ_log_
 =ğ
nuÎ±r
) {

831 
	`as£¹
(
desütÜ_fe_
 =ğ
nuÎ±r
);

832 
Ãw_mªiã¡_fe
 = 
	`DesütÜFeName
(
dbÇme_
, 
mªiã¡_fe_numb”_
);

833 
ed™
->
	`S‘NextFe
(
Ãxt_fe_numb”_
);

834 
s
 = 
’v_
->
	`NewWr™abËFe
(
Ãw_mªiã¡_fe
, &
desütÜ_fe_
);

835 ià(
s
.
	`ok
()) {

836 
desütÜ_log_
 = 
Ãw
 
log
::
	`Wr™”
(
desütÜ_fe_
);

837 
s
 = 
	`Wr™eSÇpshÙ
(
desütÜ_log_
);

843 
mu
->
	`UÆock
();

846 ià(
s
.
	`ok
()) {

847 
¡d
::
¡ršg
 
»cÜd
;

848 
ed™
->
	`EncodeTo
(&
»cÜd
);

849 
s
 = 
desütÜ_log_
->
	`AddRecÜd
(
»cÜd
);

850 ià(
s
.
	`ok
()) {

851 
s
 = 
desütÜ_fe_
->
	`Sync
();

853 ià(!
s
.
	`ok
()) {

854 
	`Log
(
İtiÚs_
->
šfo_log
, "MANIFEST wr™e: %s\n", 
s
.
	`ToSŒšg
().
	`c_¡r
());

860 ià(
s
.
	`ok
(è&& !
Ãw_mªiã¡_fe
.
	`em±y
()) {

861 
s
 = 
	`S‘Cu¼’tFe
(
’v_
, 
dbÇme_
, 
mªiã¡_fe_numb”_
);

864 
mu
->
	`Lock
();

868 ià(
s
.
	`ok
()) {

869 
	`Aµ’dV”siÚ
(
v
);

870 
log_numb”_
 = 
ed™
->log_number_;

871 
´ev_log_numb”_
 = 
ed™
->prev_log_number_;

873 
d–‘e
 
v
;

874 ià(!
Ãw_mªiã¡_fe
.
	`em±y
()) {

875 
d–‘e
 
desütÜ_log_
;

876 
d–‘e
 
desütÜ_fe_
;

877 
desütÜ_log_
 = 
nuÎ±r
;

878 
desütÜ_fe_
 = 
nuÎ±r
;

879 
’v_
->
	`D–‘eFe
(
Ãw_mªiã¡_fe
);

883  
s
;

884 
	}
}

886 
Stus
 
	gV”siÚS‘
::
	$Recov”
(
boŞ
* 
§ve_mªiã¡
) {

887 
LogR•Ü‹r
 : 
public
 
log
::
R—d”
::
R•Ü‹r
 {

888 
Stus
* 
¡©us
;

889 
vœtu®
 
	`CÜru±iÚ
(
size_t
 
by‹s
, cÚ¡ 
Stus
& 
s
) {

890 ià(
this
->
¡©us
->
	`ok
()è*this->¡©u ğ
s
;

895 
¡d
::
¡ršg
 
cu¼’t
;

896 
Stus
 
s
 = 
	`R—dFeToSŒšg
(
’v_
, 
	`Cu¼’tFeName
(
dbÇme_
), &
cu¼’t
);

897 ià(!
s
.
	`ok
()) {

898  
s
;

900 ià(
cu¼’t
.
	`em±y
(è|| cu¼’t[cu¼’t.
	`size
() - 1] != '\n') {

901  
Stus
::
	`CÜru±iÚ
("CURRENT file does‚otƒnd with‚ewline");

903 
cu¼’t
.
	`»size
(cu¼’t.
	`size
() - 1);

905 
¡d
::
¡ršg
 
dsúame
 = 
dbÇme_
 + "/" + 
cu¼’t
;

906 
Sequ’tŸlFe
* 
fe
;

907 
s
 = 
’v_
->
	`NewSequ’tŸlFe
(
dsúame
, &
fe
);

908 ià(!
s
.
	`ok
()) {

909 ià(
s
.
	`IsNÙFound
()) {

910  
Stus
::
	`CÜru±iÚ
("CURRENT…ointso‡‚on-existent file",

911 
s
.
	`ToSŒšg
());

913  
s
;

916 
boŞ
 
have_log_numb”
 = 
çl£
;

917 
boŞ
 
have_´ev_log_numb”
 = 
çl£
;

918 
boŞ
 
have_Ãxt_fe
 = 
çl£
;

919 
boŞ
 
have_Ï¡_£qu’û
 = 
çl£
;

920 
ušt64_t
 
Ãxt_fe
 = 0;

921 
ušt64_t
 
Ï¡_£qu’û
 = 0;

922 
ušt64_t
 
log_numb”
 = 0;

923 
ušt64_t
 
´ev_log_numb”
 = 0;

924 
Bud”
 
	`bud”
(
this
, 
cu¼’t_
);

927 
LogR•Ü‹r
 
»pÜ‹r
;

928 
»pÜ‹r
.
¡©us
 = &
s
;

929 
log
::
R—d”
 
	`»ad”
(
fe
, &
»pÜ‹r
, 
Œue
 ,

931 
Sliû
 
»cÜd
;

932 
¡d
::
¡ršg
 
sü©ch
;

933 
»ad”
.
	`R—dRecÜd
(&
»cÜd
, &
sü©ch
è&& 
s
.
	`ok
()) {

934 
V”siÚEd™
 
ed™
;

935 
s
 = 
ed™
.
	`DecodeFrom
(
»cÜd
);

936 ià(
s
.
	`ok
()) {

937 ià(
ed™
.
has_com·¿tÜ_
 &&

938 
ed™
.
com·¿tÜ_
 !ğ
icmp_
.
	`u£r_com·¿tÜ
()->
	`Name
()) {

939 
s
 = 
Stus
::
	`Inv®idArgum’t
(

940 
ed™
.
com·¿tÜ_
 + " does‚ot matchƒxisting comparator ",

941 
icmp_
.
	`u£r_com·¿tÜ
()->
	`Name
());

945 ià(
s
.
	`ok
()) {

946 
bud”
.
	`Aµly
(&
ed™
);

949 ià(
ed™
.
has_log_numb”_
) {

950 
log_numb”
 = 
ed™
.
log_numb”_
;

951 
have_log_numb”
 = 
Œue
;

954 ià(
ed™
.
has_´ev_log_numb”_
) {

955 
´ev_log_numb”
 = 
ed™
.
´ev_log_numb”_
;

956 
have_´ev_log_numb”
 = 
Œue
;

959 ià(
ed™
.
has_Ãxt_fe_numb”_
) {

960 
Ãxt_fe
 = 
ed™
.
Ãxt_fe_numb”_
;

961 
have_Ãxt_fe
 = 
Œue
;

964 ià(
ed™
.
has_Ï¡_£qu’û_
) {

965 
Ï¡_£qu’û
 = 
ed™
.
Ï¡_£qu’û_
;

966 
have_Ï¡_£qu’û
 = 
Œue
;

970 
d–‘e
 
fe
;

971 
fe
 = 
nuÎ±r
;

973 ià(
s
.
	`ok
()) {

974 ià(!
have_Ãxt_fe
) {

975 
s
 = 
Stus
::
	`CÜru±iÚ
("no meta-nextfileƒntry in descriptor");

976 } ià(!
have_log_numb”
) {

977 
s
 = 
Stus
::
	`CÜru±iÚ
("no meta-lognumberƒntry in descriptor");

978 } ià(!
have_Ï¡_£qu’û
) {

979 
s
 = 
Stus
::
	`CÜru±iÚ
("no†ast-sequence-numberƒntry in descriptor");

982 ià(!
have_´ev_log_numb”
) {

983 
´ev_log_numb”
 = 0;

986 
	`M¬kFeNumb”U£d
(
´ev_log_numb”
);

987 
	`M¬kFeNumb”U£d
(
log_numb”
);

990 ià(
s
.
	`ok
()) {

991 
V”siÚ
* 
v
 = 
Ãw
 
	`V”siÚ
(
this
);

992 
bud”
.
	`SaveTo
(
v
);

994 
	`Fš®ize
(
v
);

995 
	`Aµ’dV”siÚ
(
v
);

996 
mªiã¡_fe_numb”_
 = 
Ãxt_fe
;

997 
Ãxt_fe_numb”_
 = 
Ãxt_fe
 + 1;

998 
Ï¡_£qu’û_
 = 
Ï¡_£qu’û
;

999 
log_numb”_
 = 
log_numb”
;

1000 
´ev_log_numb”_
 = 
´ev_log_numb”
;

1003 ià(
	`Reu£Mªiã¡
(
dsúame
, 
cu¼’t
)) {

1006 *
§ve_mªiã¡
 = 
Œue
;

1010  
s
;

1011 
	}
}

1013 
boŞ
 
	gV”siÚS‘
::
	$Reu£Mªiã¡
(cÚ¡ 
¡d
::
¡ršg
& 
dsúame
,

1014 cÚ¡ 
¡d
::
¡ršg
& 
dscba£
) {

1015 ià(!
İtiÚs_
->
»u£_logs
) {

1016  
çl£
;

1018 
FeTy³
 
mªiã¡_ty³
;

1019 
ušt64_t
 
mªiã¡_numb”
;

1020 
ušt64_t
 
mªiã¡_size
;

1021 ià(!
	`P¬£FeName
(
dscba£
, &
mªiã¡_numb”
, &
mªiã¡_ty³
) ||

1022 
mªiã¡_ty³
 !ğ
kDesütÜFe
 ||

1023 !
’v_
->
	`G‘FeSize
(
dsúame
, &
mªiã¡_size
).
	`ok
() ||

1025 
mªiã¡_size
 >ğ
	`T¬g‘FeSize
(
İtiÚs_
)) {

1026  
çl£
;

1029 
	`as£¹
(
desütÜ_fe_
 =ğ
nuÎ±r
);

1030 
	`as£¹
(
desütÜ_log_
 =ğ
nuÎ±r
);

1031 
Stus
 
r
 = 
’v_
->
	`NewAµ’dabËFe
(
dsúame
, &
desütÜ_fe_
);

1032 ià(!
r
.
	`ok
()) {

1033 
	`Log
(
İtiÚs_
->
šfo_log
, "Reu£ MANIFEST: %s\n", 
r
.
	`ToSŒšg
().
	`c_¡r
());

1034 
	`as£¹
(
desütÜ_fe_
 =ğ
nuÎ±r
);

1035  
çl£
;

1038 
	`Log
(
İtiÚs_
->
šfo_log
, "Reusšg MANIFEST %s\n", 
dsúame
.
	`c_¡r
());

1039 
desütÜ_log_
 = 
Ãw
 
log
::
	`Wr™”
(
desütÜ_fe_
, 
mªiã¡_size
);

1040 
mªiã¡_fe_numb”_
 = 
mªiã¡_numb”
;

1041  
Œue
;

1042 
	}
}

1044 
	gV”siÚS‘
::
	$M¬kFeNumb”U£d
(
ušt64_t
 
numb”
) {

1045 ià(
Ãxt_fe_numb”_
 <ğ
numb”
) {

1046 
Ãxt_fe_numb”_
 = 
numb”
 + 1;

1048 
	}
}

1050 
	gV”siÚS‘
::
	$Fš®ize
(
V”siÚ
* 
v
) {

1052 
be¡_Ëv–
 = -1;

1053 
be¡_scÜe
 = -1;

1055 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
 - 1;†evel++) {

1056 
scÜe
;

1057 ià(
Ëv–
 == 0) {

1069 
scÜe
 = 
v
->
fes_
[
Ëv–
].
	`size
() /

1070 
¡©ic_ÿ¡
<>(
cÚfig
::
kL0_Com·ùiÚTrigg”
);

1073 cÚ¡ 
ušt64_t
 
Ëv–_by‹s
 = 
	`TÙ®FeSize
(
v
->
fes_
[
Ëv–
]);

1074 
scÜe
 =

1075 
¡©ic_ÿ¡
<>(
Ëv–_by‹s
è/ 
	`MaxBy‹sFÜLev–
(
İtiÚs_
, 
Ëv–
);

1078 ià(
scÜe
 > 
be¡_scÜe
) {

1079 
be¡_Ëv–
 = 
Ëv–
;

1080 
be¡_scÜe
 = 
scÜe
;

1084 
v
->
com·ùiÚ_Ëv–_
 = 
be¡_Ëv–
;

1085 
v
->
com·ùiÚ_scÜe_
 = 
be¡_scÜe
;

1086 
	}
}

1088 
Stus
 
	gV”siÚS‘
::
	$Wr™eSÇpshÙ
(
log
::
Wr™”
*†og) {

1092 
V”siÚEd™
 
ed™
;

1093 
ed™
.
	`S‘Com·¿tÜName
(
icmp_
.
	`u£r_com·¿tÜ
()->
	`Name
());

1096 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
;†evel++) {

1097 ià(!
com·ù_poš‹r_
[
Ëv–
].
	`em±y
()) {

1098 
IÁ”ÇlKey
 
key
;

1099 
key
.
	`DecodeFrom
(
com·ù_poš‹r_
[
Ëv–
]);

1100 
ed™
.
	`S‘Com·ùPoš‹r
(
Ëv–
, 
key
);

1105 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
;†evel++) {

1106 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
 = 
cu¼’t_
->
fes_
[
Ëv–
];

1107 
size_t
 
i
 = 0; i < 
fes
.
	`size
(); i++) {

1108 cÚ¡ 
FeM‘aD©a
* 
f
 = 
fes
[
i
];

1109 
ed™
.
	`AddFe
(
Ëv–
, 
f
->
numb”
, f->
fe_size
, f->
sm®Ë¡
, f->
Ïrge¡
,f->
fs
);

1113 
¡d
::
¡ršg
 
»cÜd
;

1114 
ed™
.
	`EncodeTo
(&
»cÜd
);

1115  
log
->
	`AddRecÜd
(
»cÜd
);

1116 
	}
}

1118 
	gV”siÚS‘
::
	$NumLev–Fes
(
Ëv–
) const {

1119 
	`as£¹
(
Ëv–
 >= 0);

1120 
	`as£¹
(
Ëv–
 < 
cÚfig
::
kNumLev–s
);

1121  
cu¼’t_
->
fes_
[
Ëv–
].
	`size
();

1122 
	}
}

1124 cÚ¡ * 
	gV”siÚS‘
::
	$Lev–Summ¬y
(
Lev–Summ¬yStÜage
* 
sü©ch
) const {

1126 
	`¡©ic_as£¹
(
cÚfig
::
kNumLev–s
 == 7, "");

1127 
	`¢´štf
(
sü©ch
->
bufãr
, (scratch->buffer),

1128 "fes[ %d %d %d %d %d %d %d ]", (
cu¼’t_
->
fes_
[0].
	`size
()),

1129 (
cu¼’t_
->
fes_
[1].
	`size
()), (current_->files_[2].size()),

1130 (
cu¼’t_
->
fes_
[3].
	`size
()), (current_->files_[4].size()),

1131 (
cu¼’t_
->
fes_
[5].
	`size
()), (current_->files_[6].size()));

1132  
sü©ch
->
bufãr
;

1133 
	}
}

1135 
ušt64_t
 
	gV”siÚS‘
::
	$Aµroxim©eOff£tOf
(
V”siÚ
* 
v
, cÚ¡ 
IÁ”ÇlKey
& 
ikey
) {

1136 
ušt64_t
 
»suÉ
 = 0;

1137 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
;†evel++) {

1138 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
 = 
v
->
fes_
[
Ëv–
];

1139 
size_t
 
i
 = 0; i < 
fes
.
	`size
(); i++) {

1140 ià(
icmp_
.
	`Com·»
(
fes
[
i
]->
Ïrge¡
, 
ikey
) <= 0) {

1142 
»suÉ
 +ğ
fes
[
i
]->
fe_size
;

1143 } ià(
icmp_
.
	`Com·»
(
fes
[
i
]->
sm®Ë¡
, 
ikey
) > 0) {

1145 ià(
Ëv–
 > 0) {

1154 
TabË
* 
bË±r
;

1155 
I‹¿tÜ
* 
™”
 = 
bË_ÿche_
->
	`NewI‹¿tÜ
(

1156 
	`R—dO±iÚs
(), 
fes
[
i
]->
numb”
, fes[i]->
fe_size
, &
bË±r
);

1157 ià(
bË±r
 !ğ
nuÎ±r
) {

1158 
»suÉ
 +ğ
bË±r
->
	`Aµroxim©eOff£tOf
(
ikey
.
	`Encode
());

1160 
d–‘e
 
™”
;

1164  
»suÉ
;

1165 
	}
}

1167 
	gV”siÚS‘
::
AddLiveFes
(
¡d
::
£t
<
ušt64_t
>* 
live
) {

1168 
V”siÚ
* 
v
 = 
dummy_v”siÚs_
.
Ãxt_
; 
	gv
 != &dummy_versions_;

1169 
	gv
 = 
v
->
Ãxt_
) {

1170 
Ëv–
 = 0; 
	gËv–
 < 
	gcÚfig
::
kNumLev–s
;†evel++) {

1171 cÚ¡ 
	g¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
 = 
v
->
fes_
[
Ëv–
];

1172 
size_t
 
	gi
 = 0; i < 
	gfes
.
size
(); i++) {

1173 
	glive
->
š£¹
(
fes
[
i
]->
numb”
);

1179 
št64_t
 
	gV”siÚS‘
::
	$NumLev–By‹s
(
Ëv–
) const {

1180 
	`as£¹
(
Ëv–
 >= 0);

1181 
	`as£¹
(
Ëv–
 < 
cÚfig
::
kNumLev–s
);

1182  
	`TÙ®FeSize
(
cu¼’t_
->
fes_
[
Ëv–
]);

1183 
	}
}

1185 
št64_t
 
	gV”siÚS‘
::
	$MaxNextLev–Ov”ÏµšgBy‹s
() {

1186 
št64_t
 
»suÉ
 = 0;

1187 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
ov”Ïps
;

1188 
Ëv–
 = 1;†ev– < 
cÚfig
::
kNumLev–s
 - 1;†evel++) {

1189 
size_t
 
i
 = 0; i < 
cu¼’t_
->
fes_
[
Ëv–
].
	`size
(); i++) {

1190 cÚ¡ 
FeM‘aD©a
* 
f
 = 
cu¼’t_
->
fes_
[
Ëv–
][
i
];

1191 
cu¼’t_
->
	`G‘Ov”ÏµšgIÅuts
(
Ëv–
 + 1, &
f
->
sm®Ë¡
, &f->
Ïrge¡
,

1192 &
ov”Ïps
);

1193 cÚ¡ 
št64_t
 
sum
 = 
	`TÙ®FeSize
(
ov”Ïps
);

1194 ià(
sum
 > 
»suÉ
) {

1195 
»suÉ
 = 
sum
;

1199  
»suÉ
;

1200 
	}
}

1205 
	gV”siÚS‘
::
G‘Rªge
(cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
šputs
,

1206 
IÁ”ÇlKey
* 
sm®Ë¡
, IÁ”ÇlKey* 
Ïrge¡
) {

1207 
as£¹
(!
šputs
.
em±y
());

1208 
	gsm®Ë¡
->
CË¬
();

1209 
	gÏrge¡
->
CË¬
();

1210 
size_t
 
	gi
 = 0; i < 
	gšputs
.
size
(); i++) {

1211 
FeM‘aD©a
* 
	gf
 = 
šputs
[
i
];

1212 ià(
	gi
 == 0) {

1213 *
sm®Ë¡
 = 
f
->smallest;

1214 *
	gÏrge¡
 = 
f
->
Ïrge¡
;

1216 ià(
	gicmp_
.
Com·»
(
f
->
sm®Ë¡
, *smallest) < 0) {

1217 *
	gsm®Ë¡
 = 
f
->
sm®Ë¡
;

1219 ià(
	gicmp_
.
Com·»
(
f
->
Ïrge¡
, *largest) > 0) {

1220 *
	gÏrge¡
 = 
f
->
Ïrge¡
;

1229 
	gV”siÚS‘
::
G‘Rªge2
(cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
šputs1
,

1230 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
šputs2
,

1231 
IÁ”ÇlKey
* 
sm®Ë¡
, IÁ”ÇlKey* 
Ïrge¡
) {

1232 
	g¡d
::
veùÜ
<
FeM‘aD©a
*> 
®l
 = 
šputs1
;

1233 
	g®l
.
š£¹
(
®l
.
’d
(), 
šputs2
.
begš
(), inputs2.end());

1234 
G‘Rªge
(
®l
, 
sm®Ë¡
, 
Ïrge¡
);

1237 
I‹¿tÜ
* 
	gV”siÚS‘
::
	$MakeIÅutI‹¿tÜ
(
Com·ùiÚ
* 
c
) {

1238 
R—dO±iÚs
 
İtiÚs
;

1239 
İtiÚs
.
v”ify_checksums
 = 
İtiÚs_
->
·¿noid_checks
;

1240 
İtiÚs
.
fl_ÿche
 = 
çl£
;

1245 cÚ¡ 
¥aû
 = (
c
->
	`Ëv–
(è=ğ0 ? c->
šputs_
[0].
	`size
() + 1 : 2);

1246 
I‹¿tÜ
** 
li¡
 = 
Ãw
 I‹¿tÜ*[
¥aû
];

1247 
num
 = 0;

1248 
which
 = 0; which < 2; which++) {

1249 ià(!
c
->
šputs_
[
which
].
	`em±y
()) {

1250 ià(
c
->
	`Ëv–
(è+ 
which
 == 0) {

1251 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
 = 
c
->
šputs_
[
which
];

1252 
size_t
 
i
 = 0; i < 
fes
.
	`size
(); i++) {

1253 
li¡
[
num
++] = 
bË_ÿche_
->
	`NewI‹¿tÜ
(
İtiÚs
, 
fes
[
i
]->
numb”
,

1254 
fes
[
i
]->
fe_size
);

1258 
li¡
[
num
++] = 
	`NewTwoLev–I‹¿tÜ
(

1259 
Ãw
 
V”siÚ
::
	`Lev–FeNumI‹¿tÜ
(
icmp_
, &
c
->
šputs_
[
which
]),

1260 &
G‘FeI‹¿tÜ
, 
bË_ÿche_
, 
İtiÚs
);

1264 
	`as£¹
(
num
 <ğ
¥aû
);

1265 
I‹¿tÜ
* 
»suÉ
 = 
	`NewM”gšgI‹¿tÜ
(&
icmp_
, 
li¡
, 
num
);

1266 
d–‘e
[] 
li¡
;

1267  
»suÉ
;

1268 
	}
}

1270 
Com·ùiÚ
* 
	gV”siÚS‘
::
	$PickCom·ùiÚ
() {

1271 
Com·ùiÚ
* 
c
;

1272 
Ëv–
;

1276 cÚ¡ 
boŞ
 
size_com·ùiÚ
 = (
cu¼’t_
->
com·ùiÚ_scÜe_
 >= 1);

1277 cÚ¡ 
boŞ
 
£ek_com·ùiÚ
 = (
cu¼’t_
->
fe_to_com·ù_
 !ğ
nuÎ±r
);

1278 ià(
size_com·ùiÚ
) {

1279 
Ëv–
 = 
cu¼’t_
->
com·ùiÚ_Ëv–_
;

1280 
	`as£¹
(
Ëv–
 >= 0);

1281 
	`as£¹
(
Ëv–
 + 1 < 
cÚfig
::
kNumLev–s
);

1282 
c
 = 
Ãw
 
	`Com·ùiÚ
(
İtiÚs_
, 
Ëv–
);

1285 
size_t
 
i
 = 0; i < 
cu¼’t_
->
fes_
[
Ëv–
].
	`size
(); i++) {

1286 
FeM‘aD©a
* 
f
 = 
cu¼’t_
->
fes_
[
Ëv–
][
i
];

1287 ià(
com·ù_poš‹r_
[
Ëv–
].
	`em±y
() ||

1288 
icmp_
.
	`Com·»
(
f
->
Ïrge¡
.
	`Encode
(), 
com·ù_poš‹r_
[
Ëv–
]) > 0) {

1289 
c
->
šputs_
[0].
	`push_back
(
f
);

1293 ià(
c
->
šputs_
[0].
	`em±y
()) {

1295 
c
->
šputs_
[0].
	`push_back
(
cu¼’t_
->
fes_
[
Ëv–
][0]);

1297 } ià(
£ek_com·ùiÚ
) {

1298 
Ëv–
 = 
cu¼’t_
->
fe_to_com·ù_Ëv–_
;

1299 
c
 = 
Ãw
 
	`Com·ùiÚ
(
İtiÚs_
, 
Ëv–
);

1300 
c
->
šputs_
[0].
	`push_back
(
cu¼’t_
->
fe_to_com·ù_
);

1302  
nuÎ±r
;

1305 
c
->
šput_v”siÚ_
 = 
cu¼’t_
;

1306 
c
->
šput_v”siÚ_
->
	`Ref
();

1309 ià(
Ëv–
 == 0) {

1310 
IÁ”ÇlKey
 
sm®Ë¡
, 
Ïrge¡
;

1311 
	`G‘Rªge
(
c
->
šputs_
[0], &
sm®Ë¡
, &
Ïrge¡
);

1315 
cu¼’t_
->
	`G‘Ov”ÏµšgIÅuts
(0, &
sm®Ë¡
, &
Ïrge¡
, &
c
->
šputs_
[0]);

1316 
	`as£¹
(!
c
->
šputs_
[0].
	`em±y
());

1319 
	`S‘upOth”IÅuts
(
c
);

1321  
c
;

1322 
	}
}

1326 
boŞ
 
FšdL¬ge¡Key
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

1327 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
,

1328 
IÁ”ÇlKey
* 
Ïrge¡_key
) {

1329 ià(
	gfes
.
em±y
()) {

1330  
	gçl£
;

1332 *
	gÏrge¡_key
 = 
fes
[0]->
Ïrge¡
;

1333 
size_t
 
	gi
 = 1; i < 
	gfes
.
size
(); ++i) {

1334 
FeM‘aD©a
* 
	gf
 = 
fes
[
i
];

1335 ià(
	gicmp
.
Com·»
(
f
->
Ïrge¡
, *
Ïrge¡_key
) > 0) {

1336 *
	gÏrge¡_key
 = 
f
->
Ïrge¡
;

1339  
	gŒue
;

1344 
FeM‘aD©a
* 
FšdSm®Ë¡Bound¬yFe
(

1345 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

1346 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
Ëv–_fes
,

1347 cÚ¡ 
IÁ”ÇlKey
& 
Ïrge¡_key
) {

1348 cÚ¡ 
Com·¿tÜ
* 
	gu£r_cmp
 = 
icmp
.
u£r_com·¿tÜ
();

1349 
FeM‘aD©a
* 
	gsm®Ë¡_bound¬y_fe
 = 
nuÎ±r
;

1350 
size_t
 
	gi
 = 0; i < 
	gËv–_fes
.
size
(); ++i) {

1351 
FeM‘aD©a
* 
	gf
 = 
Ëv–_fes
[
i
];

1352 ià(
	gicmp
.
Com·»
(
f
->
sm®Ë¡
, 
Ïrge¡_key
) > 0 &&

1353 
	gu£r_cmp
->
Com·»
(
f
->
sm®Ë¡
.
u£r_key
(), 
Ïrge¡_key
.user_key()) ==

1355 ià(
sm®Ë¡_bound¬y_fe
 =ğ
nuÎ±r
 ||

1356 
icmp
.
Com·»
(
f
->
sm®Ë¡
, 
sm®Ë¡_bound¬y_fe
->smallest) < 0) {

1357 
	gsm®Ë¡_bound¬y_fe
 = 
f
;

1361  
	gsm®Ë¡_bound¬y_fe
;

1378 
AddBound¬yIÅuts
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

1379 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
Ëv–_fes
,

1380 
¡d
::
veùÜ
<
FeM‘aD©a
*>* 
com·ùiÚ_fes
) {

1381 
IÁ”ÇlKey
 
Ïrge¡_key
;

1384 ià(!
FšdL¬ge¡Key
(
icmp
, *
com·ùiÚ_fes
, &
Ïrge¡_key
)) {

1388 
boŞ
 
	gcÚtšue_£¬chšg
 = 
Œue
;

1389 
	gcÚtšue_£¬chšg
) {

1390 
FeM‘aD©a
* 
	gsm®Ë¡_bound¬y_fe
 =

1391 
FšdSm®Ë¡Bound¬yFe
(
icmp
, 
Ëv–_fes
, 
Ïrge¡_key
);

1394 ià(
	gsm®Ë¡_bound¬y_fe
 !ğ
NULL
) {

1395 
com·ùiÚ_fes
->
push_back
(
sm®Ë¡_bound¬y_fe
);

1396 
	gÏrge¡_key
 = 
sm®Ë¡_bound¬y_fe
->
Ïrge¡
;

1398 
	gcÚtšue_£¬chšg
 = 
çl£
;

1403 
	gV”siÚS‘
::
	$S‘upOth”IÅuts
(
Com·ùiÚ
* 
c
) {

1404 cÚ¡ 
Ëv–
 = 
c
->
	`Ëv–
();

1405 
IÁ”ÇlKey
 
sm®Ë¡
, 
Ïrge¡
;

1407 
	`AddBound¬yIÅuts
(
icmp_
, 
cu¼’t_
->
fes_
[
Ëv–
], &
c
->
šputs_
[0]);

1408 
	`G‘Rªge
(
c
->
šputs_
[0], &
sm®Ë¡
, &
Ïrge¡
);

1410 
cu¼’t_
->
	`G‘Ov”ÏµšgIÅuts
(
Ëv–
 + 1, &
sm®Ë¡
, &
Ïrge¡
,

1411 &
c
->
šputs_
[1]);

1414 
IÁ”ÇlKey
 
®l_¡¬t
, 
®l_lim™
;

1415 
	`G‘Rªge2
(
c
->
šputs_
[0], c->šputs_[1], &
®l_¡¬t
, &
®l_lim™
);

1419 ià(!
c
->
šputs_
[1].
	`em±y
()) {

1420 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
ex·nded0
;

1421 
cu¼’t_
->
	`G‘Ov”ÏµšgIÅuts
(
Ëv–
, &
®l_¡¬t
, &
®l_lim™
, &
ex·nded0
);

1422 
	`AddBound¬yIÅuts
(
icmp_
, 
cu¼’t_
->
fes_
[
Ëv–
], &
ex·nded0
);

1423 cÚ¡ 
št64_t
 
šputs0_size
 = 
	`TÙ®FeSize
(
c
->
šputs_
[0]);

1424 cÚ¡ 
št64_t
 
šputs1_size
 = 
	`TÙ®FeSize
(
c
->
šputs_
[1]);

1425 cÚ¡ 
št64_t
 
ex·nded0_size
 = 
	`TÙ®FeSize
(
ex·nded0
);

1426 ià(
ex·nded0
.
	`size
(è> 
c
->
šputs_
[0].size() &&

1427 
šputs1_size
 + 
ex·nded0_size
 <

1428 
	`Ex·ndedCom·ùiÚBy‹SizeLim™
(
İtiÚs_
)) {

1429 
IÁ”ÇlKey
 
Ãw_¡¬t
, 
Ãw_lim™
;

1430 
	`G‘Rªge
(
ex·nded0
, &
Ãw_¡¬t
, &
Ãw_lim™
);

1431 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
ex·nded1
;

1432 
cu¼’t_
->
	`G‘Ov”ÏµšgIÅuts
(
Ëv–
 + 1, &
Ãw_¡¬t
, &
Ãw_lim™
,

1433 &
ex·nded1
);

1434 ià(
ex·nded1
.
	`size
(è=ğ
c
->
šputs_
[1].size()) {

1435 
	`Log
(
İtiÚs_
->
šfo_log
,

1437 
Ëv–
, (
c
->
šputs_
[0].
	`size
()), (c->inputs_[1].size()),

1438 (
šputs0_size
), (
šputs1_size
), (
ex·nded0
.
	`size
()),

1439 (
ex·nded1
.
	`size
()), (
ex·nded0_size
), (
šputs1_size
));

1440 
sm®Ë¡
 = 
Ãw_¡¬t
;

1441 
Ïrge¡
 = 
Ãw_lim™
;

1442 
c
->
šputs_
[0] = 
ex·nded0
;

1443 
c
->
šputs_
[1] = 
ex·nded1
;

1444 
	`G‘Rªge2
(
c
->
šputs_
[0], c->šputs_[1], &
®l_¡¬t
, &
®l_lim™
);

1451 ià(
Ëv–
 + 2 < 
cÚfig
::
kNumLev–s
) {

1452 
cu¼’t_
->
	`G‘Ov”ÏµšgIÅuts
(
Ëv–
 + 2, &
®l_¡¬t
, &
®l_lim™
,

1453 &
c
->
g¿nd·»Ás_
);

1460 
com·ù_poš‹r_
[
Ëv–
] = 
Ïrge¡
.
	`Encode
().
	`ToSŒšg
();

1461 
c
->
ed™_
.
	`S‘Com·ùPoš‹r
(
Ëv–
, 
Ïrge¡
);

1462 
	}
}

1464 
Com·ùiÚ
* 
	gV”siÚS‘
::
	$Com·ùRªge
(
Ëv–
, cÚ¡ 
IÁ”ÇlKey
* 
begš
,

1465 cÚ¡ 
IÁ”ÇlKey
* 
’d
) {

1466 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
šputs
;

1467 
cu¼’t_
->
	`G‘Ov”ÏµšgIÅuts
(
Ëv–
, 
begš
, 
’d
, &
šputs
);

1468 ià(
šputs
.
	`em±y
()) {

1469  
nuÎ±r
;

1476 ià(
Ëv–
 > 0) {

1477 cÚ¡ 
ušt64_t
 
lim™
 = 
	`MaxFeSizeFÜLev–
(
İtiÚs_
, 
Ëv–
);

1478 
ušt64_t
 
tÙ®
 = 0;

1479 
size_t
 
i
 = 0; i < 
šputs
.
	`size
(); i++) {

1480 
ušt64_t
 
s
 = 
šputs
[
i
]->
fe_size
;

1481 
tÙ®
 +ğ
s
;

1482 ià(
tÙ®
 >ğ
lim™
) {

1483 
šputs
.
	`»size
(
i
 + 1);

1489 
Com·ùiÚ
* 
c
 = 
Ãw
 
	`Com·ùiÚ
(
İtiÚs_
, 
Ëv–
);

1490 
c
->
šput_v”siÚ_
 = 
cu¼’t_
;

1491 
c
->
šput_v”siÚ_
->
	`Ref
();

1492 
c
->
šputs_
[0] = 
šputs
;

1493 
	`S‘upOth”IÅuts
(
c
);

1494  
c
;

1495 
	}
}

1497 
	gCom·ùiÚ
::
	$Com·ùiÚ
(cÚ¡ 
O±iÚs
* 
İtiÚs
, 
Ëv–
)

1498 : 
	`Ëv–_
(
Ëv–
),

1499 
	`max_ouut_fe_size_
(
	`MaxFeSizeFÜLev–
(
İtiÚs
, 
Ëv–
)),

1500 
	`šput_v”siÚ_
(
nuÎ±r
),

1501 
	`g¿nd·»Á_šdex_
(0),

1502 
	`£’_key_
(
çl£
),

1503 
	$ov”Ïµed_by‹s_
(0) {

1504 
i
 = 0; i < 
cÚfig
::
kNumLev–s
; i++) {

1505 
Ëv–_±rs_
[
i
] = 0;

1507 
	}
}

1509 
	gCom·ùiÚ
::~
	$Com·ùiÚ
() {

1510 ià(
šput_v”siÚ_
 !ğ
nuÎ±r
) {

1511 
šput_v”siÚ_
->
	`UÄef
();

1513 
	}
}

1515 
boŞ
 
	gCom·ùiÚ
::
	$IsTrivŸlMove
() const {

1516 cÚ¡ 
V”siÚS‘
* 
v£t
 = 
šput_v”siÚ_
->
v£t_
;

1520  (
	`num_šput_fes
(0) == 1 &&‚um_input_files(1) == 0 &&

1521 
	`TÙ®FeSize
(
g¿nd·»Ás_
) <=

1522 
	`MaxG¿ndP¬’tOv”ÏpBy‹s
(
v£t
->
İtiÚs_
));

1523 
	}
}

1525 
	gCom·ùiÚ
::
	$AddIÅutD–‘iÚs
(
V”siÚEd™
* 
ed™
) {

1526 
which
 = 0; which < 2; which++) {

1527 
size_t
 
i
 = 0; i < 
šputs_
[
which
].
	`size
(); i++) {

1528 
ed™
->
	`D–‘eFe
(
Ëv–_
 + 
which
, 
šputs_
[which][
i
]->
numb”
);

1531 
	}
}

1533 
boŞ
 
	gCom·ùiÚ
::
	$IsBa£Lev–FÜKey
(cÚ¡ 
Sliû
& 
u£r_key
) {

1535 cÚ¡ 
Com·¿tÜ
* 
u£r_cmp
 = 
šput_v”siÚ_
->
v£t_
->
icmp_
.
	`u£r_com·¿tÜ
();

1536 
lvl
 = 
Ëv–_
 + 2;†vÈ< 
cÚfig
::
kNumLev–s
;†vl++) {

1537 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
 = 
šput_v”siÚ_
->
fes_
[
lvl
];

1538 ; 
Ëv–_±rs_
[
lvl
] < 
fes
.
	`size
();) {

1539 
FeM‘aD©a
* 
f
 = 
fes
[
Ëv–_±rs_
[
lvl
]];

1540 ià(
u£r_cmp
->
	`Com·»
(
u£r_key
, 
f
->
Ïrge¡
.
	`u£r_key
()) <= 0) {

1542 ià(
u£r_cmp
->
	`Com·»
(
u£r_key
, 
f
->
sm®Ë¡
.
	`u£r_key
()) >= 0) {

1544  
çl£
;

1548 
Ëv–_±rs_
[
lvl
]++;

1551  
Œue
;

1552 
	}
}

1554 
boŞ
 
	gCom·ùiÚ
::
	$ShouldStİBefÜe
(cÚ¡ 
Sliû
& 
š‹º®_key
) {

1555 cÚ¡ 
V”siÚS‘
* 
v£t
 = 
šput_v”siÚ_
->
v£t_
;

1557 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
* 
icmp
 = &
v£t
->
icmp_
;

1558 
g¿nd·»Á_šdex_
 < 
g¿nd·»Ás_
.
	`size
() &&

1559 
icmp
->
	`Com·»
(
š‹º®_key
,

1560 
g¿nd·»Ás_
[
g¿nd·»Á_šdex_
]->
Ïrge¡
.
	`Encode
()) >

1562 ià(
£’_key_
) {

1563 
ov”Ïµed_by‹s_
 +ğ
g¿nd·»Ás_
[
g¿nd·»Á_šdex_
]->
fe_size
;

1565 
g¿nd·»Á_šdex_
++;

1567 
£’_key_
 = 
Œue
;

1569 ià(
ov”Ïµed_by‹s_
 > 
	`MaxG¿ndP¬’tOv”ÏpBy‹s
(
v£t
->
İtiÚs_
)) {

1571 
ov”Ïµed_by‹s_
 = 0;

1572  
Œue
;

1574  
çl£
;

1576 
	}
}

1578 
	gCom·ùiÚ
::
	$R–—£IÅuts
() {

1579 ià(
šput_v”siÚ_
 !ğ
nuÎ±r
) {

1580 
šput_v”siÚ_
->
	`UÄef
();

1581 
šput_v”siÚ_
 = 
nuÎ±r
;

1583 
	}
}

	@db/version_set.h

15 #iâdeà
STORAGE_LEVELDB_DB_VERSION_SET_H_


16 
	#STORAGE_LEVELDB_DB_VERSION_SET_H_


	)

18 
	~<m­
>

19 
	~<£t
>

20 
	~<veùÜ
>

22 
	~"db/dbfÜm©.h
"

23 
	~"db/v”siÚ_ed™.h
"

24 
	~"pÜt/pÜt.h
"

25 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

27 
Çme¥aû
 
	gËv–db
 {

29 
Çme¥aû
 
	glog
 {

30 
şass
 
	gWr™”
;

33 
şass
 
	gCom·ùiÚ
;

34 
şass
 
	gI‹¿tÜ
;

35 
şass
 
	gMemTabË
;

36 
şass
 
	gTabËBud”
;

37 
şass
 
	gTabËCache
;

38 
şass
 
	gV”siÚ
;

39 
şass
 
	gV”siÚS‘
;

40 
şass
 
	gWr™abËFe
;

45 
FšdFe
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

46 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
, cÚ¡ 
Sliû
& 
key
);

54 
boŞ
 
SomeFeOv”ÏpsRªge
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

55 
boŞ
 
disjošt_sÜ‹d_fes
,

56 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
fes
,

57 cÚ¡ 
Sliû
* 
sm®Ë¡_u£r_key
,

58 cÚ¡ 
Sliû
* 
Ïrge¡_u£r_key
);

60 şas 
	cV”siÚ
 {

61 
	gpublic
:

65 
	sG‘Sts
 {

66 
FeM‘aD©a
* 
£ek_fe
;

67 
	g£ek_fe_Ëv–
;

73 
AddI‹¿tÜs
(cÚ¡ 
R—dO±iÚs
&, 
¡d
::
veùÜ
<
I‹¿tÜ
*>* 
™”s
);

75 
Stus
 
G‘
(cÚ¡ 
R—dO±iÚs
&, cÚ¡ 
LookupKey
& 
key
, 
¡d
::
¡ršg
* 
v®
,

76 
G‘Sts
* 
¡©s
);

81 
boŞ
 
Upd©eSts
(cÚ¡ 
G‘Sts
& 
¡©s
);

87 
boŞ
 
RecÜdR—dSam¶e
(
Sliû
 
key
);

91 
Ref
();

92 
UÄef
();

94 
G‘Ov”ÏµšgIÅuts
(

95 
Ëv–
,

96 cÚ¡ 
IÁ”ÇlKey
* 
begš
,

97 cÚ¡ 
IÁ”ÇlKey
* 
’d
,

98 
¡d
::
veùÜ
<
FeM‘aD©a
*>* 
šputs
);

104 
boŞ
 
Ov”ÏpInLev–
(
Ëv–
, cÚ¡ 
Sliû
* 
sm®Ë¡_u£r_key
,

105 cÚ¡ 
Sliû
* 
Ïrge¡_u£r_key
);

109 
PickLev–FÜMemTabËOuut
(cÚ¡ 
Sliû
& 
sm®Ë¡_u£r_key
,

110 cÚ¡ 
Sliû
& 
Ïrge¡_u£r_key
);

112 
NumFes
(
Ëv–
ècÚ¡ {  
	gfes_
[Ëv–].
size
(); }

115 
	g¡d
::
¡ršg
 
DebugSŒšg
() const;

117 
	g´iv©e
:

118 
ä›nd
 
şass
 
Com·ùiÚ
;

119 
ä›nd
 
şass
 
	gV”siÚS‘
;

121 
şass
 
	gLev–FeNumI‹¿tÜ
;

123 
ex¶ic™
 
V”siÚ
(
V”siÚS‘
* 
v£t
)

124 : 
v£t_
(
v£t
),

125 
Ãxt_
(
this
),

126 
´ev_
(
this
),

127 
»fs_
(0),

128 
fe_to_com·ù_
(
nuÎ±r
),

129 
fe_to_com·ù_Ëv–_
(-1),

130 
com·ùiÚ_scÜe_
(-1),

131 
com·ùiÚ_Ëv–_
(-1) {}

133 
V”siÚ
(cÚ¡ V”siÚ&èğ
d–‘e
;

134 
	gV”siÚ
& 
	gİ”©Ü
=(cÚ¡ 
V”siÚ
&èğ
d–‘e
;

136 ~
V”siÚ
();

138 
I‹¿tÜ
* 
NewCÚÿ‹ÇtšgI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
&, 
Ëv–
) const;

145 
FÜEachOv”Ïµšg
(
Sliû
 
u£r_key
, Sliû 
š‹º®_key
, * 
¬g
,

146 
boŞ
 (*
func
)(*, , 
FeM‘aD©a
*));

148 
V”siÚS‘
* 
	gv£t_
;

149 
V”siÚ
* 
	gÃxt_
;

150 
V”siÚ
* 
	g´ev_
;

151 
	g»fs_
;

154 
	g¡d
::
veùÜ
<
FeM‘aD©a
*> 
fes_
[
cÚfig
::
kNumLev–s
];

157 
FeM‘aD©a
* 
	gfe_to_com·ù_
;

158 
	gfe_to_com·ù_Ëv–_
;

163 
	gcom·ùiÚ_scÜe_
;

164 
	gcom·ùiÚ_Ëv–_
;

167 şas 
	cV”siÚS‘
 {

168 
	gpublic
:

169 
V”siÚS‘
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
, cÚ¡ 
O±iÚs
* 
İtiÚs
,

170 
TabËCache
* 
bË_ÿche
, cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
*);

171 
V”siÚS‘
(cÚ¡ V”siÚS‘&èğ
d–‘e
;

172 
	gV”siÚS‘
& 
	gİ”©Ü
=(cÚ¡ 
V”siÚS‘
&èğ
d–‘e
;

174 ~
V”siÚS‘
();

181 
Stus
 
LogAndAµly
(
V”siÚEd™
* 
ed™
, 
pÜt
::
Mu‹x
* 
mu
)

182 
EXCLUSIVE_LOCKS_REQUIRED
(
mu
);

185 
Stus
 
Recov”
(
boŞ
* 
§ve_mªiã¡
);

188 
V”siÚ
* 
cu¼’t
(ècÚ¡ {  
	gcu¼’t_
; }

191 
ušt64_t
 
Mªiã¡FeNumb”
(ècÚ¡ {  
	gmªiã¡_fe_numb”_
; }

194 
ušt64_t
 
NewFeNumb”
(è{  
	gÃxt_fe_numb”_
++; }

199 
Reu£FeNumb”
(
ušt64_t
 
fe_numb”
) {

200 ià(
	gÃxt_fe_numb”_
 =ğ
fe_numb”
 + 1) {

201 
Ãxt_fe_numb”_
 = 
fe_numb”
;

206 
NumLev–Fes
(
Ëv–
) const;

209 
št64_t
 
NumLev–By‹s
(
Ëv–
) const;

212 
ušt64_t
 
La¡Sequ’û
(ècÚ¡ {  
	gÏ¡_£qu’û_
; }

215 
S‘La¡Sequ’û
(
ušt64_t
 
s
) {

216 
as£¹
(
s
 >ğ
Ï¡_£qu’û_
);

217 
	gÏ¡_£qu’û_
 = 
s
;

221 
M¬kFeNumb”U£d
(
ušt64_t
 
numb”
);

224 
ušt64_t
 
LogNumb”
(ècÚ¡ {  
	glog_numb”_
; }

228 
ušt64_t
 
P»vLogNumb”
(ècÚ¡ {  
	g´ev_log_numb”_
; }

234 
Com·ùiÚ
* 
PickCom·ùiÚ
();

240 
Com·ùiÚ
* 
Com·ùRªge
(
Ëv–
, cÚ¡ 
IÁ”ÇlKey
* 
begš
,

241 cÚ¡ 
IÁ”ÇlKey
* 
’d
);

245 
št64_t
 
MaxNextLev–Ov”ÏµšgBy‹s
();

249 
I‹¿tÜ
* 
MakeIÅutI‹¿tÜ
(
Com·ùiÚ
* 
c
);

252 
boŞ
 
N“dsCom·ùiÚ
() const {

253 
V”siÚ
* 
	gv
 = 
cu¼’t_
;

254  (
	gv
->
	gcom·ùiÚ_scÜe_
 >ğ1è|| (
v
->
fe_to_com·ù_
 !ğ
nuÎ±r
);

259 
AddLiveFes
(
¡d
::
£t
<
ušt64_t
>* 
live
);

263 
ušt64_t
 
Aµroxim©eOff£tOf
(
V”siÚ
* 
v
, cÚ¡ 
IÁ”ÇlKey
& 
key
);

267 
	sLev–Summ¬yStÜage
 {

268 
	gbufãr
[100];

270 cÚ¡ * 
Lev–Summ¬y
(
Lev–Summ¬yStÜage
* 
sü©ch
) const;

272 
	g´iv©e
:

273 
şass
 
Bud”
;

275 
ä›nd
 
şass
 
	gCom·ùiÚ
;

276 
ä›nd
 
şass
 
	gV”siÚ
;

278 
boŞ
 
Reu£Mªiã¡
(cÚ¡ 
¡d
::
¡ršg
& 
dsúame
, cÚ¡ std::¡ršg& 
dscba£
);

280 
Fš®ize
(
V”siÚ
* 
v
);

282 
G‘Rªge
(cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
šputs
, 
IÁ”ÇlKey
* 
sm®Ë¡
,

283 
IÁ”ÇlKey
* 
Ïrge¡
);

285 
G‘Rªge2
(cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
šputs1
,

286 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
šputs2
,

287 
IÁ”ÇlKey
* 
sm®Ë¡
, IÁ”ÇlKey* 
Ïrge¡
);

289 
S‘upOth”IÅuts
(
Com·ùiÚ
* 
c
);

292 
Stus
 
Wr™eSÇpshÙ
(
log
::
Wr™”
*†og);

294 
Aµ’dV”siÚ
(
V”siÚ
* 
v
);

296 
Env
* cÚ¡ 
	g’v_
;

297 cÚ¡ 
	g¡d
::
¡ršg
 
dbÇme_
;

298 cÚ¡ 
O±iÚs
* cÚ¡ 
	gİtiÚs_
;

299 
TabËCache
* cÚ¡ 
	gbË_ÿche_
;

300 cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
 
	gicmp_
;

301 
ušt64_t
 
	gÃxt_fe_numb”_
;

302 
ušt64_t
 
	gmªiã¡_fe_numb”_
;

303 
ušt64_t
 
	gÏ¡_£qu’û_
;

304 
ušt64_t
 
	glog_numb”_
;

305 
ušt64_t
 
	g´ev_log_numb”_
;

308 
Wr™abËFe
* 
	gdesütÜ_fe_
;

309 
	glog
::
Wr™”
* 
desütÜ_log_
;

310 
V”siÚ
 
	gdummy_v”siÚs_
;

311 
V”siÚ
* 
	gcu¼’t_
;

315 
	g¡d
::
¡ršg
 
com·ù_poš‹r_
[
cÚfig
::
kNumLev–s
];

319 şas 
	cCom·ùiÚ
 {

320 
	gpublic
:

321 ~
Com·ùiÚ
();

325 
Ëv–
(ècÚ¡ {  
	gËv–_
; }

329 
V”siÚEd™
* 
ed™
(è{  &
	ged™_
; }

332 
num_šput_fes
(
which
ècÚ¡ {  
	gšputs_
[which].
size
(); }

335 
FeM‘aD©a
* 
šput
(
which
, 
i
ècÚ¡ {  
	gšputs_
[which][i]; }

338 
ušt64_t
 
MaxOuutFeSize
(ècÚ¡ {  
	gmax_ouut_fe_size_
; }

342 
boŞ
 
IsTrivŸlMove
() const;

345 
AddIÅutD–‘iÚs
(
V”siÚEd™
* 
ed™
);

350 
boŞ
 
IsBa£Lev–FÜKey
(cÚ¡ 
Sliû
& 
u£r_key
);

354 
boŞ
 
ShouldStİBefÜe
(cÚ¡ 
Sliû
& 
š‹º®_key
);

358 
R–—£IÅuts
();

360 
	g´iv©e
:

361 
ä›nd
 
şass
 
V”siÚ
;

362 
ä›nd
 
şass
 
	gV”siÚS‘
;

364 
Com·ùiÚ
(cÚ¡ 
O±iÚs
* 
İtiÚs
, 
Ëv–
);

366 
	gËv–_
;

367 
ušt64_t
 
	gmax_ouut_fe_size_
;

368 
V”siÚ
* 
	gšput_v”siÚ_
;

369 
V”siÚEd™
 
	ged™_
;

372 
	g¡d
::
veùÜ
<
FeM‘aD©a
*> 
šputs_
[2];

376 
	g¡d
::
veùÜ
<
FeM‘aD©a
*> 
g¿nd·»Ás_
;

377 
size_t
 
	gg¿nd·»Á_šdex_
;

378 
boŞ
 
	g£’_key_
;

379 
št64_t
 
	gov”Ïµed_by‹s_
;

388 
size_t
 
	gËv–_±rs_
[
cÚfig
::
kNumLev–s
];

	@db/version_set_test.cc

5 
	~"db/v”siÚ_£t.h
"

6 
	~"ut/loggšg.h
"

7 
	~"ut/‹¡h¬Ãss.h
"

8 
	~"ut/‹¡ut.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 şas 
	cFšdFeTe¡
 {

13 
	gpublic
:

14 
FšdFeTe¡
(è: 
disjošt_sÜ‹d_fes_
(
Œue
) {}

16 ~
FšdFeTe¡
() {

17 
i
 = 0; 
	gi
 < 
	gfes_
.
size
(); i++) {

18 
d–‘e
 
	gfes_
[
i
];

22 
Add
(cÚ¡ * 
sm®Ë¡
, cÚ¡ * 
Ïrge¡
,

23 
Sequ’ûNumb”
 
sm®Ë¡_£q
 = 100,

24 
Sequ’ûNumb”
 
Ïrge¡_£q
 = 100) {

25 
FeM‘aD©a
* 
f
 = 
Ãw
 FileMetaData;

26 
	gf
->
	gnumb”
 = 
fes_
.
size
() + 1;

27 
	gf
->
	gsm®Ë¡
 = 
IÁ”ÇlKey
(
sm®Ë¡
, 
sm®Ë¡_£q
, 
kTy³V®ue
);

28 
	gf
->
	gÏrge¡
 = 
IÁ”ÇlKey
(
Ïrge¡
, 
Ïrge¡_£q
, 
kTy³V®ue
);

29 
	gfes_
.
push_back
(
f
);

32 
Fšd
(cÚ¡ * 
key
) {

33 
IÁ”ÇlKey
 
rg‘
(
key
, 100, 
kTy³V®ue
);

34 
IÁ”ÇlKeyCom·¿tÜ
 
cmp
(
By‹wi£Com·¿tÜ
());

35  
FšdFe
(
cmp
, 
fes_
, 
rg‘
.
Encode
());

38 
boŞ
 
Ov”Ïps
(cÚ¡ * 
sm®Ë¡
, cÚ¡ * 
Ïrge¡
) {

39 
IÁ”ÇlKeyCom·¿tÜ
 
cmp
(
By‹wi£Com·¿tÜ
());

40 
Sliû
 
s
(
sm®Ë¡
 !ğ
nuÎ±r
 ? smallest : "");

41 
Sliû
 
l
(
Ïrge¡
 !ğ
nuÎ±r
 ?†argest : "");

42  
SomeFeOv”ÏpsRªge
(
cmp
, 
disjošt_sÜ‹d_fes_
, 
fes_
,

43 (
sm®Ë¡
 !ğ
nuÎ±r
 ? &
s
 :‚ullptr),

44 (
Ïrge¡
 !ğ
nuÎ±r
 ? &
l
 :‚ullptr));

47 
boŞ
 
	gdisjošt_sÜ‹d_fes_
;

49 
	g´iv©e
:

50 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
fes_
;

53 
	$TEST
(
FšdFeTe¡
, 
Em±y
) {

54 
	`ASSERT_EQ
(0, 
	`Fšd
("foo"));

55 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("a", "z"));

56 
	`ASSERT_TRUE
(!
	`Ov”Ïps
(
nuÎ±r
, "z"));

57 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("a", 
nuÎ±r
));

58 
	`ASSERT_TRUE
(!
	`Ov”Ïps
(
nuÎ±r
,‚ullptr));

59 
	}
}

61 
	$TEST
(
FšdFeTe¡
, 
SšgË
) {

62 
	`Add
("p", "q");

63 
	`ASSERT_EQ
(0, 
	`Fšd
("a"));

64 
	`ASSERT_EQ
(0, 
	`Fšd
("p"));

65 
	`ASSERT_EQ
(0, 
	`Fšd
("p1"));

66 
	`ASSERT_EQ
(0, 
	`Fšd
("q"));

67 
	`ASSERT_EQ
(1, 
	`Fšd
("q1"));

68 
	`ASSERT_EQ
(1, 
	`Fšd
("z"));

70 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("a", "b"));

71 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("z1", "z2"));

72 
	`ASSERT_TRUE
(
	`Ov”Ïps
("a", "p"));

73 
	`ASSERT_TRUE
(
	`Ov”Ïps
("a", "q"));

74 
	`ASSERT_TRUE
(
	`Ov”Ïps
("a", "z"));

75 
	`ASSERT_TRUE
(
	`Ov”Ïps
("p", "p1"));

76 
	`ASSERT_TRUE
(
	`Ov”Ïps
("p", "q"));

77 
	`ASSERT_TRUE
(
	`Ov”Ïps
("p", "z"));

78 
	`ASSERT_TRUE
(
	`Ov”Ïps
("p1", "p2"));

79 
	`ASSERT_TRUE
(
	`Ov”Ïps
("p1", "z"));

80 
	`ASSERT_TRUE
(
	`Ov”Ïps
("q", "q"));

81 
	`ASSERT_TRUE
(
	`Ov”Ïps
("q", "q1"));

83 
	`ASSERT_TRUE
(!
	`Ov”Ïps
(
nuÎ±r
, "j"));

84 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("r", 
nuÎ±r
));

85 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "p"));

86 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "p1"));

87 
	`ASSERT_TRUE
(
	`Ov”Ïps
("q", 
nuÎ±r
));

88 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
,‚ullptr));

89 
	}
}

91 
	$TEST
(
FšdFeTe¡
, 
MuÉË
) {

92 
	`Add
("150", "200");

93 
	`Add
("200", "250");

94 
	`Add
("300", "350");

95 
	`Add
("400", "450");

96 
	`ASSERT_EQ
(0, 
	`Fšd
("100"));

97 
	`ASSERT_EQ
(0, 
	`Fšd
("150"));

98 
	`ASSERT_EQ
(0, 
	`Fšd
("151"));

99 
	`ASSERT_EQ
(0, 
	`Fšd
("199"));

100 
	`ASSERT_EQ
(0, 
	`Fšd
("200"));

101 
	`ASSERT_EQ
(1, 
	`Fšd
("201"));

102 
	`ASSERT_EQ
(1, 
	`Fšd
("249"));

103 
	`ASSERT_EQ
(1, 
	`Fšd
("250"));

104 
	`ASSERT_EQ
(2, 
	`Fšd
("251"));

105 
	`ASSERT_EQ
(2, 
	`Fšd
("299"));

106 
	`ASSERT_EQ
(2, 
	`Fšd
("300"));

107 
	`ASSERT_EQ
(2, 
	`Fšd
("349"));

108 
	`ASSERT_EQ
(2, 
	`Fšd
("350"));

109 
	`ASSERT_EQ
(3, 
	`Fšd
("351"));

110 
	`ASSERT_EQ
(3, 
	`Fšd
("400"));

111 
	`ASSERT_EQ
(3, 
	`Fšd
("450"));

112 
	`ASSERT_EQ
(4, 
	`Fšd
("451"));

114 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("100", "149"));

115 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("251", "299"));

116 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("451", "500"));

117 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("351", "399"));

119 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "150"));

120 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "200"));

121 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "300"));

122 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "400"));

123 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "500"));

124 
	`ASSERT_TRUE
(
	`Ov”Ïps
("375", "400"));

125 
	`ASSERT_TRUE
(
	`Ov”Ïps
("450", "450"));

126 
	`ASSERT_TRUE
(
	`Ov”Ïps
("450", "500"));

127 
	}
}

129 
	$TEST
(
FšdFeTe¡
, 
MuÉËNuÎBound¬›s
) {

130 
	`Add
("150", "200");

131 
	`Add
("200", "250");

132 
	`Add
("300", "350");

133 
	`Add
("400", "450");

134 
	`ASSERT_TRUE
(!
	`Ov”Ïps
(
nuÎ±r
, "149"));

135 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("451", 
nuÎ±r
));

136 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
,‚ullptr));

137 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "150"));

138 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "199"));

139 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "200"));

140 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "201"));

141 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "400"));

142 
	`ASSERT_TRUE
(
	`Ov”Ïps
(
nuÎ±r
, "800"));

143 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", 
nuÎ±r
));

144 
	`ASSERT_TRUE
(
	`Ov”Ïps
("200", 
nuÎ±r
));

145 
	`ASSERT_TRUE
(
	`Ov”Ïps
("449", 
nuÎ±r
));

146 
	`ASSERT_TRUE
(
	`Ov”Ïps
("450", 
nuÎ±r
));

147 
	}
}

149 
	$TEST
(
FšdFeTe¡
, 
Ov”ÏpSequ’ûChecks
) {

150 
	`Add
("200", "200", 5000, 3000);

151 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("199", "199"));

152 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("201", "300"));

153 
	`ASSERT_TRUE
(
	`Ov”Ïps
("200", "200"));

154 
	`ASSERT_TRUE
(
	`Ov”Ïps
("190", "200"));

155 
	`ASSERT_TRUE
(
	`Ov”Ïps
("200", "210"));

156 
	}
}

158 
	$TEST
(
FšdFeTe¡
, 
Ov”ÏµšgFes
) {

159 
	`Add
("150", "600");

160 
	`Add
("400", "500");

161 
disjošt_sÜ‹d_fes_
 = 
çl£
;

162 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("100", "149"));

163 
	`ASSERT_TRUE
(!
	`Ov”Ïps
("601", "700"));

164 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "150"));

165 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "200"));

166 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "300"));

167 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "400"));

168 
	`ASSERT_TRUE
(
	`Ov”Ïps
("100", "500"));

169 
	`ASSERT_TRUE
(
	`Ov”Ïps
("375", "400"));

170 
	`ASSERT_TRUE
(
	`Ov”Ïps
("450", "450"));

171 
	`ASSERT_TRUE
(
	`Ov”Ïps
("450", "500"));

172 
	`ASSERT_TRUE
(
	`Ov”Ïps
("450", "700"));

173 
	`ASSERT_TRUE
(
	`Ov”Ïps
("600", "700"));

174 
	}
}

176 
AddBound¬yIÅuts
(cÚ¡ 
IÁ”ÇlKeyCom·¿tÜ
& 
icmp
,

177 cÚ¡ 
¡d
::
veùÜ
<
FeM‘aD©a
*>& 
Ëv–_fes
,

178 
¡d
::
veùÜ
<
FeM‘aD©a
*>* 
com·ùiÚ_fes
);

180 şas 
	cAddBound¬yIÅutsTe¡
 {

181 
	gpublic
:

182 
¡d
::
veùÜ
<
FeM‘aD©a
*> 
Ëv–_fes_
;

183 
	g¡d
::
veùÜ
<
FeM‘aD©a
*> 
com·ùiÚ_fes_
;

184 
	g¡d
::
veùÜ
<
FeM‘aD©a
*> 
®l_fes_
;

185 
IÁ”ÇlKeyCom·¿tÜ
 
	gicmp_
;

187 
AddBound¬yIÅutsTe¡
(è: 
icmp_
(
By‹wi£Com·¿tÜ
()){};

189 ~
AddBound¬yIÅutsTe¡
() {

190 
size_t
 
	gi
 = 0; i < 
	g®l_fes_
.
size
(); ++i) {

191 
d–‘e
 
	g®l_fes_
[
i
];

193 
	g®l_fes_
.
ş—r
();

196 
FeM‘aD©a
* 
C»©eFeM‘aD©a
(
ušt64_t
 
numb”
, 
IÁ”ÇlKey
 
sm®Ë¡
,

197 
IÁ”ÇlKey
 
Ïrge¡
) {

198 
FeM‘aD©a
* 
	gf
 = 
Ãw
 FileMetaData();

199 
	gf
->
	gnumb”
 = 
numb”
;

200 
	gf
->
	gsm®Ë¡
 = 
sm®Ë¡
;

201 
	gf
->
	gÏrge¡
 = 
Ïrge¡
;

202 
	g®l_fes_
.
push_back
(
f
);

203  
	gf
;

207 
	$TEST
(
AddBound¬yIÅutsTe¡
, 
Te¡Em±yFeS‘s
) {

208 
	`AddBound¬yIÅuts
(
icmp_
, 
Ëv–_fes_
, &
com·ùiÚ_fes_
);

209 
	`ASSERT_TRUE
(
com·ùiÚ_fes_
.
	`em±y
());

210 
	`ASSERT_TRUE
(
Ëv–_fes_
.
	`em±y
());

211 
	}
}

213 
	$TEST
(
AddBound¬yIÅutsTe¡
, 
Te¡Em±yLev–Fes
) {

214 
FeM‘aD©a
* 
f1
 =

215 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 2, 
kTy³V®ue
),

216 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 1, 
kTy³V®ue
)));

217 
com·ùiÚ_fes_
.
	`push_back
(
f1
);

219 
	`AddBound¬yIÅuts
(
icmp_
, 
Ëv–_fes_
, &
com·ùiÚ_fes_
);

220 
	`ASSERT_EQ
(1, 
com·ùiÚ_fes_
.
	`size
());

221 
	`ASSERT_EQ
(
f1
, 
com·ùiÚ_fes_
[0]);

222 
	`ASSERT_TRUE
(
Ëv–_fes_
.
	`em±y
());

223 
	}
}

225 
	$TEST
(
AddBound¬yIÅutsTe¡
, 
Te¡Em±yCom·ùiÚFes
) {

226 
FeM‘aD©a
* 
f1
 =

227 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 2, 
kTy³V®ue
),

228 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 1, 
kTy³V®ue
)));

229 
Ëv–_fes_
.
	`push_back
(
f1
);

231 
	`AddBound¬yIÅuts
(
icmp_
, 
Ëv–_fes_
, &
com·ùiÚ_fes_
);

232 
	`ASSERT_TRUE
(
com·ùiÚ_fes_
.
	`em±y
());

233 
	`ASSERT_EQ
(1, 
Ëv–_fes_
.
	`size
());

234 
	`ASSERT_EQ
(
f1
, 
Ëv–_fes_
[0]);

235 
	}
}

237 
	$TEST
(
AddBound¬yIÅutsTe¡
, 
Te¡NoBound¬yFes
) {

238 
FeM‘aD©a
* 
f1
 =

239 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 2, 
kTy³V®ue
),

240 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 1, 
kTy³V®ue
)));

241 
FeM‘aD©a
* 
f2
 =

242 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("200", 2, 
kTy³V®ue
),

243 
	`IÁ”ÇlKey
(IÁ”ÇlKey("200", 1, 
kTy³V®ue
)));

244 
FeM‘aD©a
* 
f3
 =

245 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("300", 2, 
kTy³V®ue
),

246 
	`IÁ”ÇlKey
(IÁ”ÇlKey("300", 1, 
kTy³V®ue
)));

248 
Ëv–_fes_
.
	`push_back
(
f3
);

249 
Ëv–_fes_
.
	`push_back
(
f2
);

250 
Ëv–_fes_
.
	`push_back
(
f1
);

251 
com·ùiÚ_fes_
.
	`push_back
(
f2
);

252 
com·ùiÚ_fes_
.
	`push_back
(
f3
);

254 
	`AddBound¬yIÅuts
(
icmp_
, 
Ëv–_fes_
, &
com·ùiÚ_fes_
);

255 
	`ASSERT_EQ
(2, 
com·ùiÚ_fes_
.
	`size
());

256 
	}
}

258 
	$TEST
(
AddBound¬yIÅutsTe¡
, 
Te¡OÃBound¬yFes
) {

259 
FeM‘aD©a
* 
f1
 =

260 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 3, 
kTy³V®ue
),

261 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 2, 
kTy³V®ue
)));

262 
FeM‘aD©a
* 
f2
 =

263 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 1, 
kTy³V®ue
),

264 
	`IÁ”ÇlKey
(IÁ”ÇlKey("200", 3, 
kTy³V®ue
)));

265 
FeM‘aD©a
* 
f3
 =

266 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("300", 2, 
kTy³V®ue
),

267 
	`IÁ”ÇlKey
(IÁ”ÇlKey("300", 1, 
kTy³V®ue
)));

269 
Ëv–_fes_
.
	`push_back
(
f3
);

270 
Ëv–_fes_
.
	`push_back
(
f2
);

271 
Ëv–_fes_
.
	`push_back
(
f1
);

272 
com·ùiÚ_fes_
.
	`push_back
(
f1
);

274 
	`AddBound¬yIÅuts
(
icmp_
, 
Ëv–_fes_
, &
com·ùiÚ_fes_
);

275 
	`ASSERT_EQ
(2, 
com·ùiÚ_fes_
.
	`size
());

276 
	`ASSERT_EQ
(
f1
, 
com·ùiÚ_fes_
[0]);

277 
	`ASSERT_EQ
(
f2
, 
com·ùiÚ_fes_
[1]);

278 
	}
}

280 
	$TEST
(
AddBound¬yIÅutsTe¡
, 
Te¡TwoBound¬yFes
) {

281 
FeM‘aD©a
* 
f1
 =

282 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 6, 
kTy³V®ue
),

283 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 5, 
kTy³V®ue
)));

284 
FeM‘aD©a
* 
f2
 =

285 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 2, 
kTy³V®ue
),

286 
	`IÁ”ÇlKey
(IÁ”ÇlKey("300", 1, 
kTy³V®ue
)));

287 
FeM‘aD©a
* 
f3
 =

288 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 4, 
kTy³V®ue
),

289 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 3, 
kTy³V®ue
)));

291 
Ëv–_fes_
.
	`push_back
(
f2
);

292 
Ëv–_fes_
.
	`push_back
(
f3
);

293 
Ëv–_fes_
.
	`push_back
(
f1
);

294 
com·ùiÚ_fes_
.
	`push_back
(
f1
);

296 
	`AddBound¬yIÅuts
(
icmp_
, 
Ëv–_fes_
, &
com·ùiÚ_fes_
);

297 
	`ASSERT_EQ
(3, 
com·ùiÚ_fes_
.
	`size
());

298 
	`ASSERT_EQ
(
f1
, 
com·ùiÚ_fes_
[0]);

299 
	`ASSERT_EQ
(
f3
, 
com·ùiÚ_fes_
[1]);

300 
	`ASSERT_EQ
(
f2
, 
com·ùiÚ_fes_
[2]);

301 
	}
}

303 
	$TEST
(
AddBound¬yIÅutsTe¡
, 
Te¡DisjošFePoš‹rs
) {

304 
FeM‘aD©a
* 
f1
 =

305 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 6, 
kTy³V®ue
),

306 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 5, 
kTy³V®ue
)));

307 
FeM‘aD©a
* 
f2
 =

308 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 6, 
kTy³V®ue
),

309 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 5, 
kTy³V®ue
)));

310 
FeM‘aD©a
* 
f3
 =

311 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 2, 
kTy³V®ue
),

312 
	`IÁ”ÇlKey
(IÁ”ÇlKey("300", 1, 
kTy³V®ue
)));

313 
FeM‘aD©a
* 
f4
 =

314 
	`C»©eFeM‘aD©a
(1, 
	`IÁ”ÇlKey
("100", 4, 
kTy³V®ue
),

315 
	`IÁ”ÇlKey
(IÁ”ÇlKey("100", 3, 
kTy³V®ue
)));

317 
Ëv–_fes_
.
	`push_back
(
f2
);

318 
Ëv–_fes_
.
	`push_back
(
f3
);

319 
Ëv–_fes_
.
	`push_back
(
f4
);

321 
com·ùiÚ_fes_
.
	`push_back
(
f1
);

323 
	`AddBound¬yIÅuts
(
icmp_
, 
Ëv–_fes_
, &
com·ùiÚ_fes_
);

324 
	`ASSERT_EQ
(3, 
com·ùiÚ_fes_
.
	`size
());

325 
	`ASSERT_EQ
(
f1
, 
com·ùiÚ_fes_
[0]);

326 
	`ASSERT_EQ
(
f4
, 
com·ùiÚ_fes_
[1]);

327 
	`ASSERT_EQ
(
f3
, 
com·ùiÚ_fes_
[2]);

328 
	}
}

332 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@db/write_batch.cc

16 
	~"Ëv–db/wr™e_b©ch.h
"

18 
	~"db/dbfÜm©.h
"

19 
	~"db/membË.h
"

20 
	~"db/wr™e_b©ch_š‹º®.h
"

21 
	~"Ëv–db/db.h
"

22 
	~"ut/codšg.h
"

24 
Çme¥aû
 
	gËv–db
 {

27 cÚ¡ 
size_t
 
	gkH—d”
 = 12;

29 
	gWr™eB©ch
::
Wr™eB©ch
(è{ 
CË¬
(); }

31 
	gWr™eB©ch
::~
Wr™eB©ch
() {}

33 
Wr™eB©ch
::
HªdËr
::~Handler() {}

35 
Wr™eB©ch
::
CË¬
() {

36 
»p_
.
ş—r
();

37 
	g»p_
.
»size
(
kH—d”
);

40 
size_t
 
	gWr™eB©ch
::
Aµroxim©eSize
(ècÚ¡ {  
»p_
.
size
(); }

42 
Stus
 
	gWr™eB©ch
::
I‹¿‹
(
HªdËr
* 
hªdËr
) const {

43 
Sliû
 
šput
(
»p_
);

44 ià(
	gšput
.
size
(è< 
	gkH—d”
) {

45  
	gStus
::
CÜru±iÚ
("malformed WriteBatch (too small)");

48 
	gšput
.
»move_´efix
(
kH—d”
);

49 
Sliû
 
	gkey
, 
	gv®ue
;

50 
	gfound
 = 0;

51 !
	gšput
.
em±y
()) {

52 
	gfound
++;

53 
	gg
 = 
šput
[0];

54 
	gšput
.
»move_´efix
(1);

55 
	gg
) {

56 
	gkTy³V®ue
:

57 ià(
G‘L’gthP»fixedSliû
(&
šput
, &
key
) &&

58 
G‘L’gthP»fixedSliû
(&
šput
, &
v®ue
)) {

59 
	ghªdËr
->
Put
(
key
, 
v®ue
);

61  
	gStus
::
CÜru±iÚ
("bad WriteBatch Put");

64 
	gkTy³D–‘iÚ
:

65 ià(
G‘L’gthP»fixedSliû
(&
šput
, &
key
)) {

66 
	ghªdËr
->
D–‘e
(
key
);

68  
	gStus
::
CÜru±iÚ
("bad WriteBatch Delete");

72  
Stus
::
CÜru±iÚ
("unknown WriteBatchag");

75 ià(
	gfound
 !ğ
Wr™eB©chIÁ”Çl
::
CouÁ
(
this
)) {

76  
Stus
::
CÜru±iÚ
("WriteBatch has wrong count");

78  
	gStus
::
OK
();

82 
	gWr™eB©chIÁ”Çl
::
CouÁ
(cÚ¡ 
Wr™eB©ch
* 
b
) {

83  
DecodeFixed32
(
b
->
»p_
.
d©a
() + 8);

86 
	gWr™eB©chIÁ”Çl
::
S‘CouÁ
(
Wr™eB©ch
* 
b
, 
n
) {

87 
EncodeFixed32
(&
b
->
»p_
[8], 
n
);

90 
Sequ’ûNumb”
 
	gWr™eB©chIÁ”Çl
::
Sequ’û
(cÚ¡ 
Wr™eB©ch
* 
b
) {

91  
Sequ’ûNumb”
(
DecodeFixed64
(
b
->
»p_
.
d©a
()));

94 
	gWr™eB©chIÁ”Çl
::
S‘Sequ’û
(
Wr™eB©ch
* 
b
, 
Sequ’ûNumb”
 
£q
) {

95 
EncodeFixed64
(&
b
->
»p_
[0], 
£q
);

98 
	gWr™eB©ch
::
Put
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

99 
	gWr™eB©chIÁ”Çl
::
S‘CouÁ
(
this
, 
Wr™eB©chIÁ”Çl
::
CouÁ
(this) + 1);

100 
	g»p_
.
push_back
(
¡©ic_ÿ¡
<>(
kTy³V®ue
));

101 
PutL’gthP»fixedSliû
(&
»p_
, 
key
);

102 
PutL’gthP»fixedSliû
(&
»p_
, 
v®ue
);

105 
	gWr™eB©ch
::
D–‘e
(cÚ¡ 
Sliû
& 
key
) {

106 
Wr™eB©chIÁ”Çl
::
S‘CouÁ
(
this
, Wr™eB©chIÁ”Çl::
CouÁ
(this) + 1);

107 
	g»p_
.
push_back
(
¡©ic_ÿ¡
<>(
kTy³D–‘iÚ
));

108 
PutL’gthP»fixedSliû
(&
»p_
, 
key
);

111 
	gWr™eB©ch
::
Aµ’d
(cÚ¡ 
Wr™eB©ch
& 
sourû
) {

112 
Wr™eB©chIÁ”Çl
::
Aµ’d
(
this
, &
sourû
);

115 
	gÇme¥aû
 {

116 şas 
	cMemTabËIn£¹”
 : 
public
 
Wr™eB©ch
::
HªdËr
 {

117 
public
:

118 
Sequ’ûNumb”
 
£qu’û_
;

119 
MemTabË
* 
	gmem_
;

121 
vœtu®
 
Put
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

122 
	gmem_
->
Add
(
£qu’û_
, 
kTy³V®ue
, 
key
, 
v®ue
);

123 
	g£qu’û_
++;

125 
vœtu®
 
D–‘e
(cÚ¡ 
Sliû
& 
key
) {

126 
	gmem_
->
Add
(
£qu’û_
, 
kTy³D–‘iÚ
, 
key
, 
Sliû
());

127 
	g£qu’û_
++;

132 
Stus
 
	gWr™eB©chIÁ”Çl
::
	$In£¹IÁo
(cÚ¡ 
Wr™eB©ch
* 
b
, 
MemTabË
* 
membË
) {

133 
MemTabËIn£¹”
 
š£¹”
;

134 
š£¹”
.
£qu’û_
 = 
Wr™eB©chIÁ”Çl
::
	`Sequ’û
(
b
);

135 
š£¹”
.
mem_
 = 
membË
;

136  
b
->
	`I‹¿‹
(&
š£¹”
);

137 
	}
}

139 
	gWr™eB©chIÁ”Çl
::
	$S‘CÚ‹Ás
(
Wr™eB©ch
* 
b
, cÚ¡ 
Sliû
& 
cÚ‹Ás
) {

140 
	`as£¹
(
cÚ‹Ás
.
	`size
(è>ğ
kH—d”
);

141 
b
->
»p_
.
	`assign
(
cÚ‹Ás
.
	`d©a
(), cÚ‹Ás.
	`size
());

142 
	}
}

144 
	gWr™eB©chIÁ”Çl
::
	$Aµ’d
(
Wr™eB©ch
* 
d¡
, cÚ¡ Wr™eB©ch* 
¤c
) {

145 
	`S‘CouÁ
(
d¡
, 
	`CouÁ
(d¡è+ CouÁ(
¤c
));

146 
	`as£¹
(
¤c
->
»p_
.
	`size
(è>ğ
kH—d”
);

147 
d¡
->
»p_
.
	`­³nd
(
¤c
->»p_.
	`d©a
(è+ 
kH—d”
, src->»p_.
	`size
() - kHeader);

148 
	}
}

	@db/write_batch_internal.h

5 #iâdeà
STORAGE_LEVELDB_DB_WRITE_BATCH_INTERNAL_H_


6 
	#STORAGE_LEVELDB_DB_WRITE_BATCH_INTERNAL_H_


	)

8 
	~"db/dbfÜm©.h
"

9 
	~"Ëv–db/wr™e_b©ch.h
"

11 
Çme¥aû
 
	gËv–db
 {

13 
şass
 
	gMemTabË
;

17 şas 
	cWr™eB©chIÁ”Çl
 {

18 
	gpublic
:

20 
CouÁ
(cÚ¡ 
Wr™eB©ch
* 
b©ch
);

23 
S‘CouÁ
(
Wr™eB©ch
* 
b©ch
, 
n
);

26 
Sequ’ûNumb”
 
Sequ’û
(cÚ¡ 
Wr™eB©ch
* 
b©ch
);

30 
S‘Sequ’û
(
Wr™eB©ch
* 
b©ch
, 
Sequ’ûNumb”
 
£q
);

32 
Sliû
 
CÚ‹Ás
(cÚ¡ 
Wr™eB©ch
* 
b©ch
è{  Sliû(b©ch->
»p_
); }

34 
size_t
 
By‹Size
(cÚ¡ 
Wr™eB©ch
* 
b©ch
è{  
	gb©ch
->
	g»p_
.
size
(); }

36 
S‘CÚ‹Ás
(
Wr™eB©ch
* 
b©ch
, cÚ¡ 
Sliû
& 
cÚ‹Ás
);

38 
Stus
 
In£¹IÁo
(cÚ¡ 
Wr™eB©ch
* 
b©ch
, 
MemTabË
* 
membË
);

40 
Aµ’d
(
Wr™eB©ch
* 
d¡
, cÚ¡ Wr™eB©ch* 
¤c
);

	@db/write_batch_test.cc

5 
	~"Ëv–db/db.h
"

7 
	~"db/membË.h
"

8 
	~"db/wr™e_b©ch_š‹º®.h
"

9 
	~"Ëv–db/’v.h
"

10 
	~"ut/loggšg.h
"

11 
	~"ut/‹¡h¬Ãss.h
"

13 
Çme¥aû
 
	gËv–db
 {

15 
	g¡d
::
¡ršg
 
PrštCÚ‹Ás
(
Wr™eB©ch
* 
b
) {

16 
IÁ”ÇlKeyCom·¿tÜ
 
cmp
(
By‹wi£Com·¿tÜ
());

17 
MemTabË
* 
	gmem
 = 
Ãw
 MemTabË(
cmp
);

18 
	gmem
->
Ref
();

19 
	g¡d
::
¡ršg
 
¡©e
;

20 
Stus
 
	gs
 = 
Wr™eB©chIÁ”Çl
::
In£¹IÁo
(
b
, 
mem
);

21 
	gcouÁ
 = 0;

22 
I‹¿tÜ
* 
	g™”
 = 
mem
->
NewI‹¿tÜ
();

23 
	g™”
->
S“kToFœ¡
(); i‹r->
V®id
(); i‹r->
Next
()) {

24 
P¬£dIÁ”ÇlKey
 
	gikey
;

25 
ASSERT_TRUE
(
P¬£IÁ”ÇlKey
(
™”
->
key
(), &
ikey
));

26 
	gikey
.
	gty³
) {

27 
	gkTy³V®ue
:

28 
¡©e
.
­³nd
("Put(");

29 
	g¡©e
.
­³nd
(
ikey
.
u£r_key
.
ToSŒšg
());

30 
	g¡©e
.
­³nd
(", ");

31 
	g¡©e
.
­³nd
(
™”
->
v®ue
().
ToSŒšg
());

32 
	g¡©e
.
­³nd
(")");

33 
	gcouÁ
++;

35 
	gkTy³D–‘iÚ
:

36 
¡©e
.
­³nd
("Delete(");

37 
	g¡©e
.
­³nd
(
ikey
.
u£r_key
.
ToSŒšg
());

38 
	g¡©e
.
­³nd
(")");

39 
	gcouÁ
++;

42 
	g¡©e
.
­³nd
("@");

43 
	g¡©e
.
­³nd
(
Numb”ToSŒšg
(
ikey
.
£qu’û
));

45 
d–‘e
 
	g™”
;

46 ià(!
	gs
.
ok
()) {

47 
	g¡©e
.
­³nd
("ParseError()");

48 } ià(
	gcouÁ
 !ğ
Wr™eB©chIÁ”Çl
::
CouÁ
(
b
)) {

49 
¡©e
.
­³nd
("CountMismatch()");

51 
	gmem
->
UÄef
();

52  
	g¡©e
;

55 şas 
	cWr™eB©chTe¡
 {};

57 
	$TEST
(
Wr™eB©chTe¡
, 
Em±y
) {

58 
Wr™eB©ch
 
b©ch
;

59 
	`ASSERT_EQ
("", 
	`PrštCÚ‹Ás
(&
b©ch
));

60 
	`ASSERT_EQ
(0, 
Wr™eB©chIÁ”Çl
::
	`CouÁ
(&
b©ch
));

61 
	}
}

63 
	$TEST
(
Wr™eB©chTe¡
, 
MuÉË
) {

64 
Wr™eB©ch
 
b©ch
;

65 
b©ch
.
	`Put
(
	`Sliû
("foo"), Slice("bar"));

66 
b©ch
.
	`D–‘e
(
	`Sliû
("box"));

67 
b©ch
.
	`Put
(
	`Sliû
("baz"), Slice("boo"));

68 
Wr™eB©chIÁ”Çl
::
	`S‘Sequ’û
(&
b©ch
, 100);

69 
	`ASSERT_EQ
(100, 
Wr™eB©chIÁ”Çl
::
	`Sequ’û
(&
b©ch
));

70 
	`ASSERT_EQ
(3, 
Wr™eB©chIÁ”Çl
::
	`CouÁ
(&
b©ch
));

71 
	`ASSERT_EQ
(

75 
	`PrštCÚ‹Ás
(&
b©ch
));

76 
	}
}

78 
	$TEST
(
Wr™eB©chTe¡
, 
CÜru±iÚ
) {

79 
Wr™eB©ch
 
b©ch
;

80 
b©ch
.
	`Put
(
	`Sliû
("foo"), Slice("bar"));

81 
b©ch
.
	`D–‘e
(
	`Sliû
("box"));

82 
Wr™eB©chIÁ”Çl
::
	`S‘Sequ’û
(&
b©ch
, 200);

83 
Sliû
 
cÚ‹Ás
 = 
Wr™eB©chIÁ”Çl
::
	`CÚ‹Ás
(&
b©ch
);

84 
Wr™eB©chIÁ”Çl
::
	`S‘CÚ‹Ás
(&
b©ch
,

85 
	`Sliû
(
cÚ‹Ás
.
	`d©a
(), cÚ‹Ás.
	`size
() - 1));

86 
	`ASSERT_EQ
(

89 
	`PrštCÚ‹Ás
(&
b©ch
));

90 
	}
}

92 
	$TEST
(
Wr™eB©chTe¡
, 
Aµ’d
) {

93 
Wr™eB©ch
 
b1
, 
b2
;

94 
Wr™eB©chIÁ”Çl
::
	`S‘Sequ’û
(&
b1
, 200);

95 
Wr™eB©chIÁ”Çl
::
	`S‘Sequ’û
(&
b2
, 300);

96 
b1
.
	`Aµ’d
(
b2
);

97 
	`ASSERT_EQ
("", 
	`PrštCÚ‹Ás
(&
b1
));

98 
b2
.
	`Put
("a", "va");

99 
b1
.
	`Aµ’d
(
b2
);

100 
	`ASSERT_EQ
("Put×, va)@200", 
	`PrštCÚ‹Ás
(&
b1
));

101 
b2
.
	`CË¬
();

102 
b2
.
	`Put
("b", "vb");

103 
b1
.
	`Aµ’d
(
b2
);

104 
	`ASSERT_EQ
(

107 
	`PrštCÚ‹Ás
(&
b1
));

108 
b2
.
	`D–‘e
("foo");

109 
b1
.
	`Aµ’d
(
b2
);

110 
	`ASSERT_EQ
(

115 
	`PrštCÚ‹Ás
(&
b1
));

116 
	}
}

118 
	$TEST
(
Wr™eB©chTe¡
, 
Aµroxim©eSize
) {

119 
Wr™eB©ch
 
b©ch
;

120 
size_t
 
em±y_size
 = 
b©ch
.
	`Aµroxim©eSize
();

122 
b©ch
.
	`Put
(
	`Sliû
("foo"), Slice("bar"));

123 
size_t
 
Úe_key_size
 = 
b©ch
.
	`Aµroxim©eSize
();

124 
	`ASSERT_LT
(
em±y_size
, 
Úe_key_size
);

126 
b©ch
.
	`Put
(
	`Sliû
("baz"), Slice("boo"));

127 
size_t
 
two_keys_size
 = 
b©ch
.
	`Aµroxim©eSize
();

128 
	`ASSERT_LT
(
Úe_key_size
, 
two_keys_size
);

130 
b©ch
.
	`D–‘e
(
	`Sliû
("box"));

131 
size_t
 
po¡_d–‘e_size
 = 
b©ch
.
	`Aµroxim©eSize
();

132 
	`ASSERT_LT
(
two_keys_size
, 
po¡_d–‘e_size
);

133 
	}
}

137 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@doc/bench/db_bench_sqlite3.cc

5 
	~<sql™e3.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

9 
	~"ut/hi¡og¿m.h
"

10 
	~"ut/¿ndom.h
"

11 
	~"ut/‹¡ut.h
"

28 cÚ¡ * 
	gFLAGS_b’chm¬ks
 =

45 
	gFLAGS_num
 = 1000000;

48 
	gFLAGS_»ads
 = -1;

51 
	gFLAGS_v®ue_size
 = 100;

54 
boŞ
 
	gFLAGS_hi¡og¿m
 = 
çl£
;

58 
	gFLAGS_com´essiÚ_¿tio
 = 0.5;

61 
	gFLAGS_·ge_size
 = 1024;

65 
	gFLAGS_num_·ges
 = 4096;

70 
boŞ
 
	gFLAGS_u£_exi¡šg_db
 = 
çl£
;

73 
boŞ
 
	gFLAGS_Œª§ùiÚ
 = 
Œue
;

76 
boŞ
 
	gFLAGS_WAL_’abËd
 = 
Œue
;

79 cÚ¡ * 
	gFLAGS_db
 = 
nuÎ±r
;

81 
šlše
 
	$ExecE¼ÜCheck
(
¡©us
, * 
”r_msg
) {

82 ià(
¡©us
 !ğ
SQLITE_OK
) {

83 
	`årštf
(
¡d”r
, "SQLƒ¼Ü: %s\n", 
”r_msg
);

84 
	`sql™e3_ä“
(
”r_msg
);

85 
	`ex™
(1);

87 
	}
}

89 
šlše
 
	$S‹pE¼ÜCheck
(
¡©us
) {

90 ià(
¡©us
 !ğ
SQLITE_DONE
) {

91 
	`årštf
(
¡d”r
, "SQL s‹°”rÜ: stu ğ%d\n", 
¡©us
);

92 
	`ex™
(1);

94 
	}
}

96 
šlše
 
	$E¼ÜCheck
(
¡©us
) {

97 ià(
¡©us
 !ğ
SQLITE_OK
) {

98 
	`årštf
(
¡d”r
, "sql™e3ƒ¼Ü: stu ğ%d\n", 
¡©us
);

99 
	`ex™
(1);

101 
	}
}

103 
šlše
 
	$W®Checkpošt
(
sql™e3
* 
db_
) {

105 ià(
FLAGS_WAL_’abËd
) {

106 
	`sql™e3_w®_checkpošt_v2
(
db_
, 
nuÎ±r
, 
SQLITE_CHECKPOINT_FULL
,‚ullptr,

107 
nuÎ±r
);

109 
	}
}

111 
Çme¥aû
 
	gËv–db
 {

114 
	gÇme¥aû
 {

115 şas 
	cRªdomG’”©Ü
 {

116 
	g´iv©e
:

117 
¡d
::
¡ršg
 
d©a_
;

118 
	gpos_
;

120 
	gpublic
:

121 
RªdomG’”©Ü
() {

125 
Rªdom
 
ºd
(301);

126 
	g¡d
::
¡ršg
 
p›û
;

127 
	gd©a_
.
size
() < 1048576) {

130 
	g‹¡
::
Com´essibËSŒšg
(&
ºd
, 
FLAGS_com´essiÚ_¿tio
, 100, &
p›û
);

131 
	gd©a_
.
­³nd
(
p›û
);

133 
	gpos_
 = 0;

136 
Sliû
 
G’”©e
(
Ën
) {

137 ià(
	gpos_
 + 
	gËn
 > 
	gd©a_
.
size
()) {

138 
	gpos_
 = 0;

139 
as£¹
(
Ën
 < 
d©a_
.
size
());

141 
	gpos_
 +ğ
Ën
;

142  
Sliû
(
d©a_
.
d©a
(è+ 
pos_
 - 
Ën
,†en);

146 
Sliû
 
TrimS·û
(Sliû 
s
) {

147 
	g¡¬t
 = 0;

148 
	g¡¬t
 < 
	gs
.
size
(è&& 
is¥aû
(
s
[
¡¬t
])) {

149 
	g¡¬t
++;

151 
	glim™
 = 
s
.
size
();

152 
	glim™
 > 
	g¡¬t
 && 
is¥aû
(
s
[
lim™
 - 1])) {

153 
	glim™
--;

155  
Sliû
(
s
.
d©a
(è+ 
¡¬t
, 
lim™
 - start);

160 şas 
	cB’chm¬k
 {

161 
	g´iv©e
:

162 
sql™e3
* 
db_
;

163 
	gdb_num_
;

164 
	gnum_
;

165 
	g»ads_
;

166 
	g¡¬t_
;

167 
	gÏ¡_İ_fšish_
;

168 
št64_t
 
	gby‹s_
;

169 
	g¡d
::
¡ršg
 
mes§ge_
;

170 
Hi¡og¿m
 
	ghi¡_
;

171 
RªdomG’”©Ü
 
	gg’_
;

172 
Rªdom
 
	g¿nd_
;

175 
	gdÚe_
;

176 
	gÃxt_»pÜt_
;

178 
PrštH—d”
() {

179 cÚ¡ 
	gkKeySize
 = 16;

180 
PrštEnvœÚm’t
();

181 
årštf
(
¡dout
, "Keys: %d by‹ —ch\n", 
kKeySize
);

182 
årštf
(
¡dout
, "V®ues: %d by‹ —ch\n", 
FLAGS_v®ue_size
);

183 
årštf
(
¡dout
, "EÁr›s: %d\n", 
num_
);

184 
årštf
(
¡dout
, "RawSize: %.1f MB (estimated)\n",

185 ((
¡©ic_ÿ¡
<
št64_t
>(
kKeySize
 + 
FLAGS_v®ue_size
è* 
num_
) /

187 
PrštW¬nšgs
();

188 
årštf
(
¡dout
, "------------------------------------------------\n");

191 
PrštW¬nšgs
() {

192 #ià
defšed
(
__GNUC__
è&& !defšed(
__OPTIMIZE__
)

193 
årštf
(

194 
¡dout
,

197 #iâdeà
NDEBUG


198 
årštf
(
¡dout
,

203 
PrštEnvœÚm’t
() {

204 
årštf
(
¡d”r
, "SQL™e: v”siÚ %s\n", 
SQLITE_VERSION
);

206 #ià
defšed
(
__lšux
)

207 
time_t
 
	gnow
 = 
time
(
nuÎ±r
);

208 
årštf
(
¡d”r
, "D©e: %s", 
ùime
(&
now
));

210 
FILE
* 
	gıušfo
 = 
fİ’
("/proc/cpuinfo", "r");

211 ià(
	gıušfo
 !ğ
nuÎ±r
) {

212 
lše
[1000];

213 
	gnum_ıus
 = 0;

214 
	g¡d
::
¡ršg
 
ıu_ty³
;

215 
	g¡d
::
¡ršg
 
ÿche_size
;

216 
fg‘s
(
lše
, Öše), 
ıušfo
è!ğ
nuÎ±r
) {

217 cÚ¡ * 
£p
 = 
¡rchr
(
lše
, ':');

218 ià(
	g£p
 =ğ
nuÎ±r
) {

221 
Sliû
 
	gkey
 = 
TrimS·û
(Sliû(
lše
, 
£p
 - 1 -†ine));

222 
Sliû
 
	gv®
 = 
TrimS·û
(Sliû(
£p
 + 1));

223 ià(
	gkey
 == "model‚ame") {

224 ++
num_ıus
;

225 
	gıu_ty³
 = 
v®
.
ToSŒšg
();

226 } ià(
	gkey
 == "cache size") {

227 
ÿche_size
 = 
v®
.
ToSŒšg
();

230 
fşo£
(
ıušfo
);

231 
årštf
(
¡d”r
, "CPU: %d * %s\n", 
num_ıus
, 
ıu_ty³
.
c_¡r
());

232 
årštf
(
¡d”r
, "CPUCache: %s\n", 
ÿche_size
.
c_¡r
());

237 
S¹
() {

238 
	g¡¬t_
 = 
Env
::
DeçuÉ
()->
NowMiüos
() * 1e-6;

239 
	gby‹s_
 = 0;

240 
	gmes§ge_
.
ş—r
();

241 
	gÏ¡_İ_fšish_
 = 
¡¬t_
;

242 
	ghi¡_
.
CË¬
();

243 
	gdÚe_
 = 0;

244 
	gÃxt_»pÜt_
 = 100;

247 
FšishedSšgËOp
() {

248 ià(
	gFLAGS_hi¡og¿m
) {

249 
	gnow
 = 
Env
::
DeçuÉ
()->
NowMiüos
() * 1e-6;

250 
	gmiüos
 = (
now
 - 
Ï¡_İ_fšish_
) * 1e6;

251 
	ghi¡_
.
Add
(
miüos
);

252 ià(
	gmiüos
 > 20000) {

253 
årštf
(
¡d”r
, "lÚg op: %.1àmiüos%30s\r", 
miüos
, "");

254 
fæush
(
¡d”r
);

256 
	gÏ¡_İ_fšish_
 = 
now
;

259 
	gdÚe_
++;

260 ià(
	gdÚe_
 >ğ
Ãxt_»pÜt_
) {

261 ià(
Ãxt_»pÜt_
 < 1000)

262 
Ãxt_»pÜt_
 += 100;

263 ià(
	gÃxt_»pÜt_
 < 5000)

264 
	gÃxt_»pÜt_
 += 500;

265 ià(
	gÃxt_»pÜt_
 < 10000)

266 
	gÃxt_»pÜt_
 += 1000;

267 ià(
	gÃxt_»pÜt_
 < 50000)

268 
	gÃxt_»pÜt_
 += 5000;

269 ià(
	gÃxt_»pÜt_
 < 100000)

270 
	gÃxt_»pÜt_
 += 10000;

271 ià(
	gÃxt_»pÜt_
 < 500000)

272 
	gÃxt_»pÜt_
 += 50000;

274 
	gÃxt_»pÜt_
 += 100000;

275 
årštf
(
¡d”r
, "... fšished %d ops%30s\r", 
dÚe_
, "");

276 
fæush
(
¡d”r
);

280 
Stİ
(cÚ¡ 
Sliû
& 
Çme
) {

281 
	gfšish
 = 
Env
::
DeçuÉ
()->
NowMiüos
() * 1e-6;

285 ià(
	gdÚe_
 < 1) done_ = 1;

287 ià(
	gby‹s_
 > 0) {

288 
	g¿‹
[100];

289 
¢´štf
(
¿‹
, (rate), "%6.1f MB/s",

290 (
by‹s_
 / 1048576.0è/ (
fšish
 - 
¡¬t_
));

291 ià(!
	gmes§ge_
.
em±y
()) {

292 
	gmes§ge_
 = 
¡d
::
¡ršg
(
¿‹
è+ " " + 
mes§ge_
;

294 
	gmes§ge_
 = 
¿‹
;

298 
årštf
(
¡dout
, "%-12 : %11.3àmiüos/İ;%s%s\n", 
Çme
.
ToSŒšg
().
c_¡r
(),

299 (
fšish
 - 
¡¬t_
è* 1e6 / 
dÚe_
, (
mes§ge_
.
em±y
() ? "" : " "),

300 
mes§ge_
.
c_¡r
());

301 ià(
	gFLAGS_hi¡og¿m
) {

302 
årštf
(
¡dout
, "Miüo£cÚd ³¸İ:\n%s\n", 
hi¡_
.
ToSŒšg
().
c_¡r
());

304 
fæush
(
¡dout
);

307 
	gpublic
:

308 
	eOrd”
 { 
SEQUENTIAL
, 
	gRANDOM
 };

309 
	eDBS‹
 { 
	gFRESH
, 
	gEXISTING
 };

311 
B’chm¬k
()

312 : 
db_
(
nuÎ±r
),

313 
db_num_
(0),

314 
num_
(
FLAGS_num
),

315 
»ads_
(
FLAGS_»ads
 < 0 ? 
FLAGS_num
 : FLAGS_reads),

316 
by‹s_
(0),

317 
¿nd_
(301) {

318 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
fes
;

319 
	g¡d
::
¡ršg
 
‹¡_dœ
;

320 
	gEnv
::
DeçuÉ
()->
G‘Te¡DœeùÜy
(&
‹¡_dœ
);

321 
	gEnv
::
DeçuÉ
()->
G‘Chd»n
(
‹¡_dœ
, &
fes
);

322 ià(!
	gFLAGS_u£_exi¡šg_db
) {

323 
	gi
 = 0; i < 
	gfes
.
size
(); i++) {

324 ià(
Sliû
(
fes
[
i
]).
¡¬ts_w™h
("dbbench_sqlite3")) {

325 
	g¡d
::
¡ršg
 
fe_Çme
(
‹¡_dœ
);

326 
	gfe_Çme
 += "/";

327 
	gfe_Çme
 +ğ
fes
[
i
];

328 
	gEnv
::
DeçuÉ
()->
D–‘eFe
(
fe_Çme
.
c_¡r
());

334 ~
B’chm¬k
() {

335 
	g¡©us
 = 
sql™e3_şo£
(
db_
);

336 
E¼ÜCheck
(
¡©us
);

339 
Run
() {

340 
PrštH—d”
();

341 
O³n
();

343 cÚ¡ * 
	gb’chm¬ks
 = 
FLAGS_b’chm¬ks
;

344 
	gb’chm¬ks
 !ğ
nuÎ±r
) {

345 cÚ¡ * 
£p
 = 
¡rchr
(
b’chm¬ks
, ',');

346 
Sliû
 
	gÇme
;

347 ià(
	g£p
 =ğ
nuÎ±r
) {

348 
Çme
 = 
b’chm¬ks
;

349 
	gb’chm¬ks
 = 
nuÎ±r
;

351 
	gÇme
 = 
Sliû
(
b’chm¬ks
, 
£p
 - benchmarks);

352 
	gb’chm¬ks
 = 
£p
 + 1;

355 
	gby‹s_
 = 0;

356 
S¹
();

358 
boŞ
 
	gknown
 = 
Œue
;

359 
boŞ
 
	gwr™e_sync
 = 
çl£
;

360 ià(
	gÇme
 =ğ
Sliû
("fillseq")) {

361 
Wr™e
(
wr™e_sync
, 
SEQUENTIAL
, 
FRESH
, 
num_
, 
FLAGS_v®ue_size
, 1);

362 
W®Checkpošt
(
db_
);

363 } ià(
	gÇme
 =ğ
Sliû
("fillseqbatch")) {

364 
Wr™e
(
wr™e_sync
, 
SEQUENTIAL
, 
FRESH
, 
num_
, 
FLAGS_v®ue_size
, 1000);

365 
W®Checkpošt
(
db_
);

366 } ià(
	gÇme
 =ğ
Sliû
("fillrandom")) {

367 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
FRESH
, 
num_
, 
FLAGS_v®ue_size
, 1);

368 
W®Checkpošt
(
db_
);

369 } ià(
	gÇme
 =ğ
Sliû
("fillrandbatch")) {

370 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
FRESH
, 
num_
, 
FLAGS_v®ue_size
, 1000);

371 
W®Checkpošt
(
db_
);

372 } ià(
	gÇme
 =ğ
Sliû
("overwrite")) {

373 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
EXISTING
, 
num_
, 
FLAGS_v®ue_size
, 1);

374 
W®Checkpošt
(
db_
);

375 } ià(
	gÇme
 =ğ
Sliû
("overwritebatch")) {

376 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
EXISTING
, 
num_
, 
FLAGS_v®ue_size
, 1000);

377 
W®Checkpošt
(
db_
);

378 } ià(
	gÇme
 =ğ
Sliû
("fillrandsync")) {

379 
wr™e_sync
 = 
Œue
;

380 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
FRESH
, 
num_
 / 100, 
FLAGS_v®ue_size
, 1);

381 
W®Checkpošt
(
db_
);

382 } ià(
	gÇme
 =ğ
Sliû
("fillseqsync")) {

383 
wr™e_sync
 = 
Œue
;

384 
Wr™e
(
wr™e_sync
, 
SEQUENTIAL
, 
FRESH
, 
num_
 / 100, 
FLAGS_v®ue_size
, 1);

385 
W®Checkpošt
(
db_
);

386 } ià(
	gÇme
 =ğ
Sliû
("fillrand100K")) {

387 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
FRESH
, 
num_
 / 1000, 100 * 1000, 1);

388 
W®Checkpošt
(
db_
);

389 } ià(
	gÇme
 =ğ
Sliû
("fillseq100K")) {

390 
Wr™e
(
wr™e_sync
, 
SEQUENTIAL
, 
FRESH
, 
num_
 / 1000, 100 * 1000, 1);

391 
W®Checkpošt
(
db_
);

392 } ià(
	gÇme
 =ğ
Sliû
("readseq")) {

393 
R—dSequ’tŸl
();

394 } ià(
	gÇme
 =ğ
Sliû
("readrandom")) {

395 
R—d
(
RANDOM
, 1);

396 } ià(
	gÇme
 =ğ
Sliû
("readrand100K")) {

397 
n
 = 
»ads_
;

398 
	g»ads_
 /= 1000;

399 
R—d
(
RANDOM
, 1);

400 
	g»ads_
 = 
n
;

402 
	gknown
 = 
çl£
;

403 ià(
	gÇme
 !ğ
Sliû
()) {

404 
årštf
(
¡d”r
, "unknowÀb’chm¬k '%s'\n", 
Çme
.
ToSŒšg
().
c_¡r
());

407 ià(
	gknown
) {

408 
Stİ
(
Çme
);

413 
O³n
() {

414 
as£¹
(
db_
 =ğ
nuÎ±r
);

416 
	g¡©us
;

417 
	gfe_Çme
[100];

418 * 
	g”r_msg
 = 
nuÎ±r
;

419 
	gdb_num_
++;

422 
	g¡d
::
¡ršg
 
tmp_dœ
;

423 
	gEnv
::
DeçuÉ
()->
G‘Te¡DœeùÜy
(&
tmp_dœ
);

424 
¢´štf
(
fe_Çme
, (file_name), "%s/dbbench_sqlite3-%d.db",

425 
tmp_dœ
.
c_¡r
(), 
db_num_
);

426 
	g¡©us
 = 
sql™e3_İ’
(
fe_Çme
, &
db_
);

427 ià(
	g¡©us
) {

428 
årštf
(
¡d”r
, "İ’ƒ¼Ü: %s\n", 
sql™e3_”rmsg
(
db_
));

429 
ex™
(1);

433 
	gÿche_size
[100];

434 
¢´štf
(
ÿche_size
, (cache_size), "PRAGMA cache_size = %d",

435 
FLAGS_num_·ges
);

436 
	g¡©us
 = 
sql™e3_exec
(
db_
, 
ÿche_size
, 
nuÎ±r
,‚uÎ±r, &
”r_msg
);

437 
ExecE¼ÜCheck
(
¡©us
, 
”r_msg
);

440 ià(
	gFLAGS_·ge_size
 != 1024) {

441 
·ge_size
[100];

442 
¢´štf
(
·ge_size
, (page_size), "PRAGMA…age_size = %d",

443 
FLAGS_·ge_size
);

444 
	g¡©us
 = 
sql™e3_exec
(
db_
, 
·ge_size
, 
nuÎ±r
,‚uÎ±r, &
”r_msg
);

445 
ExecE¼ÜCheck
(
¡©us
, 
”r_msg
);

449 ià(
	gFLAGS_WAL_’abËd
) {

450 
	g¡d
::
¡ršg
 
WAL_¡mt
 = "PRAGMA journal_mode = WAL";

453 
	g¡d
::
¡ršg
 
WAL_checkpošt
 = "PRAGMA wal_autocheckpoint = 4096";

454 
	g¡©us
 = 
sql™e3_exec
(
db_
, 
WAL_¡mt
.
c_¡r
(), 
nuÎ±r
,‚uÎ±r, &
”r_msg
);

455 
ExecE¼ÜCheck
(
¡©us
, 
”r_msg
);

456 
	g¡©us
 =

457 
sql™e3_exec
(
db_
, 
WAL_checkpošt
.
c_¡r
(), 
nuÎ±r
,‚uÎ±r, &
”r_msg
);

458 
ExecE¼ÜCheck
(
¡©us
, 
”r_msg
);

462 
	g¡d
::
¡ršg
 
lockšg_¡mt
 = "PRAGMA†ocking_mode = EXCLUSIVE";

463 
	g¡d
::
¡ršg
 
ü—‹_¡mt
 =

465 
	g¡d
::
¡ršg
 
¡mt_¬¿y
[] = {
lockšg_¡mt
, 
ü—‹_¡mt
};

466 
	g¡mt_¬¿y_Ëngth
 = (
¡mt_¬¿y
è/ (
¡d
::
¡ršg
);

467 
	gi
 = 0; i < 
	g¡mt_¬¿y_Ëngth
; i++) {

468 
	g¡©us
 =

469 
sql™e3_exec
(
db_
, 
¡mt_¬¿y
[
i
].
c_¡r
(), 
nuÎ±r
,‚uÎ±r, &
”r_msg
);

470 
ExecE¼ÜCheck
(
¡©us
, 
”r_msg
);

474 
Wr™e
(
boŞ
 
wr™e_sync
, 
Ord”
 
Üd”
, 
DBS‹
 
¡©e
, 
num_’Œ›s
,

475 
v®ue_size
, 
’Œ›s_³r_b©ch
) {

477 ià(
	g¡©e
 =ğ
FRESH
) {

478 ià(
FLAGS_u£_exi¡šg_db
) {

479 
mes§ge_
 = "skipping (--use_existing_db isrue)";

482 
sql™e3_şo£
(
db_
);

483 
	gdb_
 = 
nuÎ±r
;

484 
O³n
();

485 
S¹
();

488 ià(
	gnum_’Œ›s
 !ğ
num_
) {

489 
msg
[100];

490 
¢´štf
(
msg
, (msg), "(%d ops)", 
num_’Œ›s
);

491 
	gmes§ge_
 = 
msg
;

494 * 
	g”r_msg
 = 
nuÎ±r
;

495 
	g¡©us
;

497 
sql™e3_¡mt
 *
	g»¶aû_¡mt
, *
	gbegš_Œªs_¡mt
, *
	g’d_Œªs_¡mt
;

498 
	g¡d
::
¡ršg
 
»¶aû_¡r
 = "REPLACE INTOest (key, value) VALUES (?, ?)";

499 
	g¡d
::
¡ršg
 
begš_Œªs_¡r
 = "BEGIN TRANSACTION;";

500 
	g¡d
::
¡ršg
 
’d_Œªs_¡r
 = "END TRANSACTION;";

503 
	g¡d
::
¡ršg
 
sync_¡mt
 =

504 (
wr™e_sync
) ? "PRAGMA synchronous = FULL" : "PRAGMA synchronous = OFF";

505 
	g¡©us
 = 
sql™e3_exec
(
db_
, 
sync_¡mt
.
c_¡r
(), 
nuÎ±r
,‚uÎ±r, &
”r_msg
);

506 
ExecE¼ÜCheck
(
¡©us
, 
”r_msg
);

509 
	g¡©us
 = 
sql™e3_´•¬e_v2
(
db_
, 
»¶aû_¡r
.
c_¡r
(), -1, &
»¶aû_¡mt
,

510 
nuÎ±r
);

511 
E¼ÜCheck
(
¡©us
);

512 
	g¡©us
 = 
sql™e3_´•¬e_v2
(
db_
, 
begš_Œªs_¡r
.
c_¡r
(), -1,

513 &
begš_Œªs_¡mt
, 
nuÎ±r
);

514 
E¼ÜCheck
(
¡©us
);

515 
	g¡©us
 = 
sql™e3_´•¬e_v2
(
db_
, 
’d_Œªs_¡r
.
c_¡r
(), -1, &
’d_Œªs_¡mt
,

516 
nuÎ±r
);

517 
E¼ÜCheck
(
¡©us
);

519 
boŞ
 
	gŒª§ùiÚ
 = (
’Œ›s_³r_b©ch
 > 1);

520 
	gi
 = 0; i < 
	gnum_’Œ›s
; i +ğ
’Œ›s_³r_b©ch
) {

522 ià(
FLAGS_Œª§ùiÚ
 && 
Œª§ùiÚ
) {

523 
¡©us
 = 
sql™e3_¡•
(
begš_Œªs_¡mt
);

524 
S‹pE¼ÜCheck
(
¡©us
);

525 
	g¡©us
 = 
sql™e3_»£t
(
begš_Œªs_¡mt
);

526 
E¼ÜCheck
(
¡©us
);

530 
	gj
 = 0; j < 
	g’Œ›s_³r_b©ch
; j++) {

531 cÚ¡ * 
	gv®ue
 = 
g’_
.
G’”©e
(
v®ue_size
).
d©a
();

534 cÚ¡ 
	gk
 =

535 (
Üd”
 =ğ
SEQUENTIAL
è? 
i
 + 
j
 : (
¿nd_
.
Next
(è% 
num_’Œ›s
);

536 
	gkey
[100];

537 
¢´štf
(
key
, (key), "%016d", 
k
);

540 
	g¡©us
 = 
sql™e3_bšd_blob
(
»¶aû_¡mt
, 1, 
key
, 16, 
SQLITE_STATIC
);

541 
E¼ÜCheck
(
¡©us
);

542 
	g¡©us
 = 
sql™e3_bšd_blob
(
»¶aû_¡mt
, 2, 
v®ue
, 
v®ue_size
,

543 
SQLITE_STATIC
);

544 
E¼ÜCheck
(
¡©us
);

547 
	gby‹s_
 +ğ
v®ue_size
 + 
¡¾’
(
key
);

548 
	g¡©us
 = 
sql™e3_¡•
(
»¶aû_¡mt
);

549 
S‹pE¼ÜCheck
(
¡©us
);

552 
	g¡©us
 = 
sql™e3_ş—r_bšdšgs
(
»¶aû_¡mt
);

553 
E¼ÜCheck
(
¡©us
);

554 
	g¡©us
 = 
sql™e3_»£t
(
»¶aû_¡mt
);

555 
E¼ÜCheck
(
¡©us
);

557 
FšishedSšgËOp
();

561 ià(
	gFLAGS_Œª§ùiÚ
 && 
	gŒª§ùiÚ
) {

562 
	g¡©us
 = 
sql™e3_¡•
(
’d_Œªs_¡mt
);

563 
S‹pE¼ÜCheck
(
¡©us
);

564 
	g¡©us
 = 
sql™e3_»£t
(
’d_Œªs_¡mt
);

565 
E¼ÜCheck
(
¡©us
);

569 
	g¡©us
 = 
sql™e3_fš®ize
(
»¶aû_¡mt
);

570 
E¼ÜCheck
(
¡©us
);

571 
	g¡©us
 = 
sql™e3_fš®ize
(
begš_Œªs_¡mt
);

572 
E¼ÜCheck
(
¡©us
);

573 
	g¡©us
 = 
sql™e3_fš®ize
(
’d_Œªs_¡mt
);

574 
E¼ÜCheck
(
¡©us
);

577 
R—d
(
Ord”
 
Üd”
, 
’Œ›s_³r_b©ch
) {

578 
	g¡©us
;

579 
sql™e3_¡mt
 *
	g»ad_¡mt
, *
	gbegš_Œªs_¡mt
, *
	g’d_Œªs_¡mt
;

581 
	g¡d
::
¡ršg
 
»ad_¡r
 = "SELECT * FROMest WHERE key = ?";

582 
	g¡d
::
¡ršg
 
begš_Œªs_¡r
 = "BEGIN TRANSACTION;";

583 
	g¡d
::
¡ršg
 
’d_Œªs_¡r
 = "END TRANSACTION;";

586 
	g¡©us
 = 
sql™e3_´•¬e_v2
(
db_
, 
begš_Œªs_¡r
.
c_¡r
(), -1,

587 &
begš_Œªs_¡mt
, 
nuÎ±r
);

588 
E¼ÜCheck
(
¡©us
);

589 
	g¡©us
 = 
sql™e3_´•¬e_v2
(
db_
, 
’d_Œªs_¡r
.
c_¡r
(), -1, &
’d_Œªs_¡mt
,

590 
nuÎ±r
);

591 
E¼ÜCheck
(
¡©us
);

592 
	g¡©us
 = 
sql™e3_´•¬e_v2
(
db_
, 
»ad_¡r
.
c_¡r
(), -1, &
»ad_¡mt
, 
nuÎ±r
);

593 
E¼ÜCheck
(
¡©us
);

595 
boŞ
 
	gŒª§ùiÚ
 = (
’Œ›s_³r_b©ch
 > 1);

596 
	gi
 = 0; i < 
	g»ads_
; i +ğ
’Œ›s_³r_b©ch
) {

598 ià(
FLAGS_Œª§ùiÚ
 && 
Œª§ùiÚ
) {

599 
¡©us
 = 
sql™e3_¡•
(
begš_Œªs_¡mt
);

600 
S‹pE¼ÜCheck
(
¡©us
);

601 
	g¡©us
 = 
sql™e3_»£t
(
begš_Œªs_¡mt
);

602 
E¼ÜCheck
(
¡©us
);

606 
	gj
 = 0; j < 
	g’Œ›s_³r_b©ch
; j++) {

608 
	gkey
[100];

609 
	gk
 = (
Üd”
 =ğ
SEQUENTIAL
è? 
i
 + 
j
 : (
¿nd_
.
Next
(è% 
»ads_
);

610 
¢´štf
(
key
, (key), "%016d", 
k
);

613 
	g¡©us
 = 
sql™e3_bšd_blob
(
»ad_¡mt
, 1, 
key
, 16, 
SQLITE_STATIC
);

614 
E¼ÜCheck
(
¡©us
);

617 (
	g¡©us
 = 
sql™e3_¡•
(
»ad_¡mt
)è=ğ
SQLITE_ROW
) {

619 
S‹pE¼ÜCheck
(
¡©us
);

622 
	g¡©us
 = 
sql™e3_ş—r_bšdšgs
(
»ad_¡mt
);

623 
E¼ÜCheck
(
¡©us
);

624 
	g¡©us
 = 
sql™e3_»£t
(
»ad_¡mt
);

625 
E¼ÜCheck
(
¡©us
);

626 
FšishedSšgËOp
();

630 ià(
	gFLAGS_Œª§ùiÚ
 && 
	gŒª§ùiÚ
) {

631 
	g¡©us
 = 
sql™e3_¡•
(
’d_Œªs_¡mt
);

632 
S‹pE¼ÜCheck
(
¡©us
);

633 
	g¡©us
 = 
sql™e3_»£t
(
’d_Œªs_¡mt
);

634 
E¼ÜCheck
(
¡©us
);

638 
	g¡©us
 = 
sql™e3_fš®ize
(
»ad_¡mt
);

639 
E¼ÜCheck
(
¡©us
);

640 
	g¡©us
 = 
sql™e3_fš®ize
(
begš_Œªs_¡mt
);

641 
E¼ÜCheck
(
¡©us
);

642 
	g¡©us
 = 
sql™e3_fš®ize
(
’d_Œªs_¡mt
);

643 
E¼ÜCheck
(
¡©us
);

646 
R—dSequ’tŸl
() {

647 
	g¡©us
;

648 
sql™e3_¡mt
* 
	gpStmt
;

649 
	g¡d
::
¡ršg
 
»ad_¡r
 = "SELECT * FROMest ORDER BY key";

651 
	g¡©us
 = 
sql™e3_´•¬e_v2
(
db_
, 
»ad_¡r
.
c_¡r
(), -1, &
pStmt
, 
nuÎ±r
);

652 
E¼ÜCheck
(
¡©us
);

653 
	gi
 = 0; i < 
	g»ads_
 && 
	gSQLITE_ROW
 =ğ
sql™e3_¡•
(
pStmt
); i++) {

654 
	gby‹s_
 +ğ
sql™e3_cŞumn_by‹s
(
pStmt
, 1) + sqlite3_column_bytes(pStmt, 2);

655 
FšishedSšgËOp
();

658 
	g¡©us
 = 
sql™e3_fš®ize
(
pStmt
);

659 
E¼ÜCheck
(
¡©us
);

665 
	$maš
(
¬gc
, ** 
¬gv
) {

666 
¡d
::
¡ršg
 
deçuÉ_db_·th
;

667 
i
 = 1; i < 
¬gc
; i++) {

668 
d
;

669 
n
;

670 
junk
;

671 ià(
Ëv–db
::
	`Sliû
(
¬gv
[
i
]).
	`¡¬ts_w™h
("--benchmarks=")) {

672 
FLAGS_b’chm¬ks
 = 
¬gv
[
i
] + 
	`¡¾’
("--benchmarks=");

673 } ià(
	`ssÿnf
(
¬gv
[
i
], "--hi¡og¿m=%d%c", &
n
, &
junk
) == 1 &&

674 (
n
 == 0 ||‚ == 1)) {

675 
FLAGS_hi¡og¿m
 = 
n
;

676 } ià(
	`ssÿnf
(
¬gv
[
i
], "--com´essiÚ_¿tio=%lf%c", &
d
, &
junk
) == 1) {

677 
FLAGS_com´essiÚ_¿tio
 = 
d
;

678 } ià(
	`ssÿnf
(
¬gv
[
i
], "--u£_exi¡šg_db=%d%c", &
n
, &
junk
) == 1 &&

679 (
n
 == 0 ||‚ == 1)) {

680 
FLAGS_u£_exi¡šg_db
 = 
n
;

681 } ià(
	`ssÿnf
(
¬gv
[
i
], "--num=%d%c", &
n
, &
junk
) == 1) {

682 
FLAGS_num
 = 
n
;

683 } ià(
	`ssÿnf
(
¬gv
[
i
], "--»ads=%d%c", &
n
, &
junk
) == 1) {

684 
FLAGS_»ads
 = 
n
;

685 } ià(
	`ssÿnf
(
¬gv
[
i
], "--v®ue_size=%d%c", &
n
, &
junk
) == 1) {

686 
FLAGS_v®ue_size
 = 
n
;

687 } ià(
Ëv–db
::
	`Sliû
(
¬gv
[
i
]) ==†eveldb::Slice("--no_transaction")) {

688 
FLAGS_Œª§ùiÚ
 = 
çl£
;

689 } ià(
	`ssÿnf
(
¬gv
[
i
], "--·ge_size=%d%c", &
n
, &
junk
) == 1) {

690 
FLAGS_·ge_size
 = 
n
;

691 } ià(
	`ssÿnf
(
¬gv
[
i
], "--num_·ges=%d%c", &
n
, &
junk
) == 1) {

692 
FLAGS_num_·ges
 = 
n
;

693 } ià(
	`ssÿnf
(
¬gv
[
i
], "--WAL_’abËd=%d%c", &
n
, &
junk
) == 1 &&

694 (
n
 == 0 ||‚ == 1)) {

695 
FLAGS_WAL_’abËd
 = 
n
;

696 } ià(
	`¡ºcmp
(
¬gv
[
i
], "--db=", 5) == 0) {

697 
FLAGS_db
 = 
¬gv
[
i
] + 5;

699 
	`årštf
(
¡d”r
, "Inv®id fÏg '%s'\n", 
¬gv
[
i
]);

700 
	`ex™
(1);

705 ià(
FLAGS_db
 =ğ
nuÎ±r
) {

706 
Ëv–db
::
Env
::
	`DeçuÉ
()->
	`G‘Te¡DœeùÜy
(&
deçuÉ_db_·th
);

707 
deçuÉ_db_·th
 += "/dbbench";

708 
FLAGS_db
 = 
deçuÉ_db_·th
.
	`c_¡r
();

711 
Ëv–db
::
B’chm¬k
 
b’chm¬k
;

712 
b’chm¬k
.
	`Run
();

714 
	}
}

	@doc/bench/db_bench_tree_db.cc

5 
	~<kıŞydb.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

9 
	~"ut/hi¡og¿m.h
"

10 
	~"ut/¿ndom.h
"

11 
	~"ut/‹¡ut.h
"

27 cÚ¡ * 
	gFLAGS_b’chm¬ks
 =

41 
	gFLAGS_num
 = 1000000;

44 
	gFLAGS_»ads
 = -1;

47 
	gFLAGS_v®ue_size
 = 100;

51 
	gFLAGS_com´essiÚ_¿tio
 = 0.5;

54 
boŞ
 
	gFLAGS_hi¡og¿m
 = 
çl£
;

57 
	gFLAGS_ÿche_size
 = 4194304;

60 
	gFLAGS_·ge_size
 = 1024;

65 
boŞ
 
	gFLAGS_u£_exi¡šg_db
 = 
çl£
;

69 
boŞ
 
	gFLAGS_com´essiÚ
 = 
Œue
;

72 cÚ¡ * 
	gFLAGS_db
 = 
nuÎ±r
;

74 
šlše
 
	$DBSynchrÚize
(
kyÙoÿbš‘
::
T»eDB
* 
db_
) {

76 ià(!
db_
->
	`synchrÚize
()) {

77 
	`årštf
(
¡d”r
, "synchrÚiz”rÜ: %s\n", 
db_
->
	`”rÜ
().
	`Çme
());

79 
	}
}

81 
Çme¥aû
 
	gËv–db
 {

84 
	gÇme¥aû
 {

85 şas 
	cRªdomG’”©Ü
 {

86 
	g´iv©e
:

87 
¡d
::
¡ršg
 
d©a_
;

88 
	gpos_
;

90 
	gpublic
:

91 
RªdomG’”©Ü
() {

95 
Rªdom
 
ºd
(301);

96 
	g¡d
::
¡ršg
 
p›û
;

97 
	gd©a_
.
size
() < 1048576) {

100 
	g‹¡
::
Com´essibËSŒšg
(&
ºd
, 
FLAGS_com´essiÚ_¿tio
, 100, &
p›û
);

101 
	gd©a_
.
­³nd
(
p›û
);

103 
	gpos_
 = 0;

106 
Sliû
 
G’”©e
(
Ën
) {

107 ià(
	gpos_
 + 
	gËn
 > 
	gd©a_
.
size
()) {

108 
	gpos_
 = 0;

109 
as£¹
(
Ën
 < 
d©a_
.
size
());

111 
	gpos_
 +ğ
Ën
;

112  
Sliû
(
d©a_
.
d©a
(è+ 
pos_
 - 
Ën
,†en);

116 
Sliû
 
TrimS·û
(Sliû 
s
) {

117 
	g¡¬t
 = 0;

118 
	g¡¬t
 < 
	gs
.
size
(è&& 
is¥aû
(
s
[
¡¬t
])) {

119 
	g¡¬t
++;

121 
	glim™
 = 
s
.
size
();

122 
	glim™
 > 
	g¡¬t
 && 
is¥aû
(
s
[
lim™
 - 1])) {

123 
	glim™
--;

125  
Sliû
(
s
.
d©a
(è+ 
¡¬t
, 
lim™
 - start);

130 şas 
	cB’chm¬k
 {

131 
	g´iv©e
:

132 
kyÙoÿbš‘
::
T»eDB
* 
db_
;

133 
	gdb_num_
;

134 
	gnum_
;

135 
	g»ads_
;

136 
	g¡¬t_
;

137 
	gÏ¡_İ_fšish_
;

138 
št64_t
 
	gby‹s_
;

139 
	g¡d
::
¡ršg
 
mes§ge_
;

140 
Hi¡og¿m
 
	ghi¡_
;

141 
RªdomG’”©Ü
 
	gg’_
;

142 
Rªdom
 
	g¿nd_
;

143 
	gkyÙoÿbš‘
::
LZOCom´essÜ
<
kyÙoÿbš‘
::
LZO
::
RAW
> 
comp_
;

146 
	gdÚe_
;

147 
	gÃxt_»pÜt_
;

149 
PrštH—d”
() {

150 cÚ¡ 
	gkKeySize
 = 16;

151 
PrštEnvœÚm’t
();

152 
årštf
(
¡dout
, "Keys: %d by‹ —ch\n", 
kKeySize
);

153 
årštf
(
¡dout
, "Values: %d bytesƒach (%d bytes‡fter compression)\n",

154 
FLAGS_v®ue_size
,

155 
¡©ic_ÿ¡
<>(
FLAGS_v®ue_size
 * 
FLAGS_com´essiÚ_¿tio
 + 0.5));

156 
årštf
(
¡dout
, "EÁr›s: %d\n", 
num_
);

157 
årštf
(
¡dout
, "RawSize: %.1f MB (estimated)\n",

158 ((
¡©ic_ÿ¡
<
št64_t
>(
kKeySize
 + 
FLAGS_v®ue_size
è* 
num_
) /

160 
årštf
(
¡dout
, "FileSize: %.1f MB (estimated)\n",

161 (((
kKeySize
 + 
FLAGS_v®ue_size
 * 
FLAGS_com´essiÚ_¿tio
è* 
num_
) /

163 
PrštW¬nšgs
();

164 
årštf
(
¡dout
, "------------------------------------------------\n");

167 
PrštW¬nšgs
() {

168 #ià
defšed
(
__GNUC__
è&& !defšed(
__OPTIMIZE__
)

169 
årštf
(

170 
¡dout
,

173 #iâdeà
NDEBUG


174 
årštf
(
¡dout
,

179 
PrštEnvœÚm’t
() {

180 
årštf
(
¡d”r
, "Kyoto Cabinet: version %s,†ib ver %d,†ib„ev %d\n",

181 
kyÙoÿbš‘
::
VERSION
, kyÙoÿbš‘::
LIBVER
, kyÙoÿbš‘::
LIBREV
);

183 #ià
defšed
(
__lšux
)

184 
time_t
 
	gnow
 = 
time
(
nuÎ±r
);

185 
årštf
(
¡d”r
, "D©e: %s", 
ùime
(&
now
));

187 
FILE
* 
	gıušfo
 = 
fİ’
("/proc/cpuinfo", "r");

188 ià(
	gıušfo
 !ğ
nuÎ±r
) {

189 
lše
[1000];

190 
	gnum_ıus
 = 0;

191 
	g¡d
::
¡ršg
 
ıu_ty³
;

192 
	g¡d
::
¡ršg
 
ÿche_size
;

193 
fg‘s
(
lše
, Öše), 
ıušfo
è!ğ
nuÎ±r
) {

194 cÚ¡ * 
£p
 = 
¡rchr
(
lše
, ':');

195 ià(
	g£p
 =ğ
nuÎ±r
) {

198 
Sliû
 
	gkey
 = 
TrimS·û
(Sliû(
lše
, 
£p
 - 1 -†ine));

199 
Sliû
 
	gv®
 = 
TrimS·û
(Sliû(
£p
 + 1));

200 ià(
	gkey
 == "model‚ame") {

201 ++
num_ıus
;

202 
	gıu_ty³
 = 
v®
.
ToSŒšg
();

203 } ià(
	gkey
 == "cache size") {

204 
ÿche_size
 = 
v®
.
ToSŒšg
();

207 
fşo£
(
ıušfo
);

208 
årštf
(
¡d”r
, "CPU: %d * %s\n", 
num_ıus
, 
ıu_ty³
.
c_¡r
());

209 
årštf
(
¡d”r
, "CPUCache: %s\n", 
ÿche_size
.
c_¡r
());

214 
S¹
() {

215 
	g¡¬t_
 = 
Env
::
DeçuÉ
()->
NowMiüos
() * 1e-6;

216 
	gby‹s_
 = 0;

217 
	gmes§ge_
.
ş—r
();

218 
	gÏ¡_İ_fšish_
 = 
¡¬t_
;

219 
	ghi¡_
.
CË¬
();

220 
	gdÚe_
 = 0;

221 
	gÃxt_»pÜt_
 = 100;

224 
FšishedSšgËOp
() {

225 ià(
	gFLAGS_hi¡og¿m
) {

226 
	gnow
 = 
Env
::
DeçuÉ
()->
NowMiüos
() * 1e-6;

227 
	gmiüos
 = (
now
 - 
Ï¡_İ_fšish_
) * 1e6;

228 
	ghi¡_
.
Add
(
miüos
);

229 ià(
	gmiüos
 > 20000) {

230 
årštf
(
¡d”r
, "lÚg op: %.1àmiüos%30s\r", 
miüos
, "");

231 
fæush
(
¡d”r
);

233 
	gÏ¡_İ_fšish_
 = 
now
;

236 
	gdÚe_
++;

237 ià(
	gdÚe_
 >ğ
Ãxt_»pÜt_
) {

238 ià(
Ãxt_»pÜt_
 < 1000)

239 
Ãxt_»pÜt_
 += 100;

240 ià(
	gÃxt_»pÜt_
 < 5000)

241 
	gÃxt_»pÜt_
 += 500;

242 ià(
	gÃxt_»pÜt_
 < 10000)

243 
	gÃxt_»pÜt_
 += 1000;

244 ià(
	gÃxt_»pÜt_
 < 50000)

245 
	gÃxt_»pÜt_
 += 5000;

246 ià(
	gÃxt_»pÜt_
 < 100000)

247 
	gÃxt_»pÜt_
 += 10000;

248 ià(
	gÃxt_»pÜt_
 < 500000)

249 
	gÃxt_»pÜt_
 += 50000;

251 
	gÃxt_»pÜt_
 += 100000;

252 
årštf
(
¡d”r
, "... fšished %d ops%30s\r", 
dÚe_
, "");

253 
fæush
(
¡d”r
);

257 
Stİ
(cÚ¡ 
Sliû
& 
Çme
) {

258 
	gfšish
 = 
Env
::
DeçuÉ
()->
NowMiüos
() * 1e-6;

262 ià(
	gdÚe_
 < 1) done_ = 1;

264 ià(
	gby‹s_
 > 0) {

265 
	g¿‹
[100];

266 
¢´štf
(
¿‹
, (rate), "%6.1f MB/s",

267 (
by‹s_
 / 1048576.0è/ (
fšish
 - 
¡¬t_
));

268 ià(!
	gmes§ge_
.
em±y
()) {

269 
	gmes§ge_
 = 
¡d
::
¡ršg
(
¿‹
è+ " " + 
mes§ge_
;

271 
	gmes§ge_
 = 
¿‹
;

275 
årštf
(
¡dout
, "%-12 : %11.3àmiüos/İ;%s%s\n", 
Çme
.
ToSŒšg
().
c_¡r
(),

276 (
fšish
 - 
¡¬t_
è* 1e6 / 
dÚe_
, (
mes§ge_
.
em±y
() ? "" : " "),

277 
mes§ge_
.
c_¡r
());

278 ià(
	gFLAGS_hi¡og¿m
) {

279 
årštf
(
¡dout
, "Miüo£cÚd ³¸İ:\n%s\n", 
hi¡_
.
ToSŒšg
().
c_¡r
());

281 
fæush
(
¡dout
);

284 
	gpublic
:

285 
	eOrd”
 { 
SEQUENTIAL
, 
	gRANDOM
 };

286 
	eDBS‹
 { 
	gFRESH
, 
	gEXISTING
 };

288 
B’chm¬k
()

289 : 
db_
(
nuÎ±r
),

290 
num_
(
FLAGS_num
),

291 
»ads_
(
FLAGS_»ads
 < 0 ? 
FLAGS_num
 : FLAGS_reads),

292 
by‹s_
(0),

293 
¿nd_
(301) {

294 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
fes
;

295 
	g¡d
::
¡ršg
 
‹¡_dœ
;

296 
	gEnv
::
DeçuÉ
()->
G‘Te¡DœeùÜy
(&
‹¡_dœ
);

297 
	gEnv
::
DeçuÉ
()->
G‘Chd»n
(
‹¡_dœ
.
c_¡r
(), &
fes
);

298 ià(!
	gFLAGS_u£_exi¡šg_db
) {

299 
	gi
 = 0; i < 
	gfes
.
size
(); i++) {

300 ià(
Sliû
(
fes
[
i
]).
¡¬ts_w™h
("dbbench_polyDB")) {

301 
	g¡d
::
¡ršg
 
fe_Çme
(
‹¡_dœ
);

302 
	gfe_Çme
 += "/";

303 
	gfe_Çme
 +ğ
fes
[
i
];

304 
	gEnv
::
DeçuÉ
()->
D–‘eFe
(
fe_Çme
.
c_¡r
());

310 ~
B’chm¬k
() {

311 ià(!
	gdb_
->
şo£
()) {

312 
årštf
(
¡d”r
, "şo£ƒ¼Ü: %s\n", 
db_
->
”rÜ
().
Çme
());

316 
Run
() {

317 
PrštH—d”
();

318 
O³n
(
çl£
);

320 cÚ¡ * 
	gb’chm¬ks
 = 
FLAGS_b’chm¬ks
;

321 
	gb’chm¬ks
 !ğ
nuÎ±r
) {

322 cÚ¡ * 
£p
 = 
¡rchr
(
b’chm¬ks
, ',');

323 
Sliû
 
	gÇme
;

324 ià(
	g£p
 =ğ
nuÎ±r
) {

325 
Çme
 = 
b’chm¬ks
;

326 
	gb’chm¬ks
 = 
nuÎ±r
;

328 
	gÇme
 = 
Sliû
(
b’chm¬ks
, 
£p
 - benchmarks);

329 
	gb’chm¬ks
 = 
£p
 + 1;

332 
S¹
();

334 
boŞ
 
	gknown
 = 
Œue
;

335 
boŞ
 
	gwr™e_sync
 = 
çl£
;

336 ià(
	gÇme
 =ğ
Sliû
("fillseq")) {

337 
Wr™e
(
wr™e_sync
, 
SEQUENTIAL
, 
FRESH
, 
num_
, 
FLAGS_v®ue_size
, 1);

338 
DBSynchrÚize
(
db_
);

339 } ià(
	gÇme
 =ğ
Sliû
("fillrandom")) {

340 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
FRESH
, 
num_
, 
FLAGS_v®ue_size
, 1);

341 
DBSynchrÚize
(
db_
);

342 } ià(
	gÇme
 =ğ
Sliû
("overwrite")) {

343 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
EXISTING
, 
num_
, 
FLAGS_v®ue_size
, 1);

344 
DBSynchrÚize
(
db_
);

345 } ià(
	gÇme
 =ğ
Sliû
("fillrandsync")) {

346 
wr™e_sync
 = 
Œue
;

347 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
FRESH
, 
num_
 / 100, 
FLAGS_v®ue_size
, 1);

348 
DBSynchrÚize
(
db_
);

349 } ià(
	gÇme
 =ğ
Sliû
("fillseqsync")) {

350 
wr™e_sync
 = 
Œue
;

351 
Wr™e
(
wr™e_sync
, 
SEQUENTIAL
, 
FRESH
, 
num_
 / 100, 
FLAGS_v®ue_size
, 1);

352 
DBSynchrÚize
(
db_
);

353 } ià(
	gÇme
 =ğ
Sliû
("fillrand100K")) {

354 
Wr™e
(
wr™e_sync
, 
RANDOM
, 
FRESH
, 
num_
 / 1000, 100 * 1000, 1);

355 
DBSynchrÚize
(
db_
);

356 } ià(
	gÇme
 =ğ
Sliû
("fillseq100K")) {

357 
Wr™e
(
wr™e_sync
, 
SEQUENTIAL
, 
FRESH
, 
num_
 / 1000, 100 * 1000, 1);

358 
DBSynchrÚize
(
db_
);

359 } ià(
	gÇme
 =ğ
Sliû
("readseq")) {

360 
R—dSequ’tŸl
();

361 } ià(
	gÇme
 =ğ
Sliû
("readrandom")) {

362 
R—dRªdom
();

363 } ià(
	gÇme
 =ğ
Sliû
("readrand100K")) {

364 
n
 = 
»ads_
;

365 
	g»ads_
 /= 1000;

366 
R—dRªdom
();

367 
	g»ads_
 = 
n
;

368 } ià(
	gÇme
 =ğ
Sliû
("readseq100K")) {

369 
n
 = 
»ads_
;

370 
	g»ads_
 /= 1000;

371 
R—dSequ’tŸl
();

372 
	g»ads_
 = 
n
;

374 
	gknown
 = 
çl£
;

375 ià(
	gÇme
 !ğ
Sliû
()) {

376 
årštf
(
¡d”r
, "unknowÀb’chm¬k '%s'\n", 
Çme
.
ToSŒšg
().
c_¡r
());

379 ià(
	gknown
) {

380 
Stİ
(
Çme
);

385 
	g´iv©e
:

386 
O³n
(
boŞ
 
sync
) {

387 
as£¹
(
db_
 =ğ
nuÎ±r
);

390 
	gdb_
 = 
Ãw
 
kyÙoÿbš‘
::
T»eDB
();

391 
	gfe_Çme
[100];

392 
	gdb_num_
++;

393 
	g¡d
::
¡ršg
 
‹¡_dœ
;

394 
	gEnv
::
DeçuÉ
()->
G‘Te¡DœeùÜy
(&
‹¡_dœ
);

395 
¢´štf
(
fe_Çme
, (file_name), "%s/dbbench_polyDB-%d.kct",

396 
‹¡_dœ
.
c_¡r
(), 
db_num_
);

399 
	gİ’_İtiÚs
 =

400 
kyÙoÿbš‘
::
PŞyDB
::
OWRITER
 | kyÙoÿbš‘::PŞyDB::
OCREATE
;

401 
	gtuÃ_İtiÚs
 =

402 
kyÙoÿbš‘
::
T»eDB
::
TSMALL
 | kyÙoÿbš‘::T»eDB::
TLINEAR
;

403 ià(
	gFLAGS_com´essiÚ
) {

404 
	gtuÃ_İtiÚs
 |ğ
kyÙoÿbš‘
::
T»eDB
::
TCOMPRESS
;

405 
	gdb_
->
tuÃ_com´essÜ
(&
comp_
);

407 
	gdb_
->
tuÃ_İtiÚs
(tune_options);

408 
	gdb_
->
tuÃ_·ge_ÿche
(
FLAGS_ÿche_size
);

409 
	gdb_
->
tuÃ_·ge
(
FLAGS_·ge_size
);

410 
	gdb_
->
tuÃ_m­
(256LL << 20);

411 ià(
	gsync
) {

412 
	gİ’_İtiÚs
 |ğ
kyÙoÿbš‘
::
PŞyDB
::
OAUTOSYNC
;

414 ià(!
	gdb_
->
İ’
(
fe_Çme
, 
İ’_İtiÚs
)) {

415 
årštf
(
¡d”r
, "İ’ƒ¼Ü: %s\n", 
db_
->
”rÜ
().
Çme
());

419 
Wr™e
(
boŞ
 
sync
, 
Ord”
 
Üd”
, 
DBS‹
 
¡©e
, 
num_’Œ›s
,

420 
v®ue_size
, 
’Œ›s_³r_b©ch
) {

422 ià(
	g¡©e
 =ğ
FRESH
) {

423 ià(
FLAGS_u£_exi¡šg_db
) {

424 
mes§ge_
 = "skipping (--use_existing_db isrue)";

427 
d–‘e
 
	gdb_
;

428 
	gdb_
 = 
nuÎ±r
;

429 
O³n
(
sync
);

430 
S¹
();

433 ià(
	gnum_’Œ›s
 !ğ
num_
) {

434 
msg
[100];

435 
¢´štf
(
msg
, (msg), "(%d ops)", 
num_’Œ›s
);

436 
	gmes§ge_
 = 
msg
;

440 
	gi
 = 0; i < 
	gnum_’Œ›s
; i++) {

441 cÚ¡ 
	gk
 = (
Üd”
 =ğ
SEQUENTIAL
è? 
i
 : (
¿nd_
.
Next
(è% 
num_’Œ›s
);

442 
	gkey
[100];

443 
¢´štf
(
key
, (key), "%016d", 
k
);

444 
	gby‹s_
 +ğ
v®ue_size
 + 
¡¾’
(
key
);

445 
	g¡d
::
¡ršg
 
ıp_key
 = 
key
;

446 ià(!
	gdb_
->
£t
(
ıp_key
, 
g’_
.
G’”©e
(
v®ue_size
).
ToSŒšg
())) {

447 
årštf
(
¡d”r
, "£ˆ”rÜ: %s\n", 
db_
->
”rÜ
().
Çme
());

449 
FšishedSšgËOp
();

453 
R—dSequ’tŸl
() {

454 
	gkyÙoÿbš‘
::
DB
::
CursÜ
* 
cur
 = 
db_
->
cursÜ
();

455 
	gcur
->
jump
();

456 
	g¡d
::
¡ršg
 
ckey
, 
	gcv®ue
;

457 
	gcur
->
g‘
(&
ckey
, &
cv®ue
, 
Œue
)) {

458 
	gby‹s_
 +ğ
ckey
.
size
(è+ 
cv®ue
.size();

459 
FšishedSšgËOp
();

461 
d–‘e
 
	gcur
;

464 
R—dRªdom
() {

465 
	g¡d
::
¡ršg
 
v®ue
;

466 
	gi
 = 0; i < 
	g»ads_
; i++) {

467 
	gkey
[100];

468 cÚ¡ 
	gk
 = 
¿nd_
.
Next
(è% 
»ads_
;

469 
¢´štf
(
key
, (key), "%016d", 
k
);

470 
	gdb_
->
g‘
(
key
, &
v®ue
);

471 
FšishedSšgËOp
();

478 
	$maš
(
¬gc
, ** 
¬gv
) {

479 
¡d
::
¡ršg
 
deçuÉ_db_·th
;

480 
i
 = 1; i < 
¬gc
; i++) {

481 
d
;

482 
n
;

483 
junk
;

484 ià(
Ëv–db
::
	`Sliû
(
¬gv
[
i
]).
	`¡¬ts_w™h
("--benchmarks=")) {

485 
FLAGS_b’chm¬ks
 = 
¬gv
[
i
] + 
	`¡¾’
("--benchmarks=");

486 } ià(
	`ssÿnf
(
¬gv
[
i
], "--com´essiÚ_¿tio=%lf%c", &
d
, &
junk
) == 1) {

487 
FLAGS_com´essiÚ_¿tio
 = 
d
;

488 } ià(
	`ssÿnf
(
¬gv
[
i
], "--hi¡og¿m=%d%c", &
n
, &
junk
) == 1 &&

489 (
n
 == 0 ||‚ == 1)) {

490 
FLAGS_hi¡og¿m
 = 
n
;

491 } ià(
	`ssÿnf
(
¬gv
[
i
], "--num=%d%c", &
n
, &
junk
) == 1) {

492 
FLAGS_num
 = 
n
;

493 } ià(
	`ssÿnf
(
¬gv
[
i
], "--»ads=%d%c", &
n
, &
junk
) == 1) {

494 
FLAGS_»ads
 = 
n
;

495 } ià(
	`ssÿnf
(
¬gv
[
i
], "--v®ue_size=%d%c", &
n
, &
junk
) == 1) {

496 
FLAGS_v®ue_size
 = 
n
;

497 } ià(
	`ssÿnf
(
¬gv
[
i
], "--ÿche_size=%d%c", &
n
, &
junk
) == 1) {

498 
FLAGS_ÿche_size
 = 
n
;

499 } ià(
	`ssÿnf
(
¬gv
[
i
], "--·ge_size=%d%c", &
n
, &
junk
) == 1) {

500 
FLAGS_·ge_size
 = 
n
;

501 } ià(
	`ssÿnf
(
¬gv
[
i
], "--com´essiÚ=%d%c", &
n
, &
junk
) == 1 &&

502 (
n
 == 0 ||‚ == 1)) {

503 
FLAGS_com´essiÚ
 = (
n
 =ğ1è? 
Œue
 : 
çl£
;

504 } ià(
	`¡ºcmp
(
¬gv
[
i
], "--db=", 5) == 0) {

505 
FLAGS_db
 = 
¬gv
[
i
] + 5;

507 
	`årštf
(
¡d”r
, "Inv®id fÏg '%s'\n", 
¬gv
[
i
]);

508 
	`ex™
(1);

513 ià(
FLAGS_db
 =ğ
nuÎ±r
) {

514 
Ëv–db
::
Env
::
	`DeçuÉ
()->
	`G‘Te¡DœeùÜy
(&
deçuÉ_db_·th
);

515 
deçuÉ_db_·th
 += "/dbbench";

516 
FLAGS_db
 = 
deçuÉ_db_·th
.
	`c_¡r
();

519 
Ëv–db
::
B’chm¬k
 
b’chm¬k
;

520 
b’chm¬k
.
	`Run
();

522 
	}
}

	@helpers/memenv/memenv.cc

5 
	~"h–³rs/mem’v/mem’v.h
"

7 
	~<¡ršg.h
>

9 
	~<lim™s
>

10 
	~<m­
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 
	~"Ëv–db/’v.h
"

15 
	~"Ëv–db/¡©us.h
"

16 
	~"pÜt/pÜt.h
"

17 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

18 
	~"ut/mu‹xlock.h
"

20 
Çme¥aû
 
	gËv–db
 {

22 
	gÇme¥aû
 {

24 şas 
	cFeS‹
 {

25 
	gpublic
:

28 
FeS‹
(è: 
»fs_
(0), 
size_
(0) {}

31 
FeS‹
(cÚ¡ FeS‹&èğ
d–‘e
;

32 
	gFeS‹
& 
	gİ”©Ü
=(cÚ¡ 
FeS‹
&èğ
d–‘e
;

35 
Ref
() {

36 
Mu‹xLock
 
lock
(&
»fs_mu‹x_
);

37 ++
	g»fs_
;

41 
UÄef
() {

42 
boŞ
 
	gdo_d–‘e
 = 
çl£
;

45 
Mu‹xLock
 
lock
(&
»fs_mu‹x_
);

46 --
	g»fs_
;

47 
as£¹
(
»fs_
 >= 0);

48 ià(
	g»fs_
 <= 0) {

49 
do_d–‘e
 = 
Œue
;

53 ià(
	gdo_d–‘e
) {

54 
d–‘e
 
	gthis
;

58 
ušt64_t
 
Size
() const {

59 
Mu‹xLock
 
lock
(&
blocks_mu‹x_
);

60  
	gsize_
;

63 
Trunÿ‹
() {

64 
Mu‹xLock
 
lock
(&
blocks_mu‹x_
);

65 *& 
	gblock
 : 
blocks_
) {

66 
d–‘e
[] 
block
;

68 
	gblocks_
.
ş—r
();

69 
	gsize_
 = 0;

72 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
, * 
sü©ch
) const {

73 
Mu‹xLock
 
lock
(&
blocks_mu‹x_
);

74 ià(
	goff£t
 > 
	gsize_
) {

75  
	gStus
::
IOE¼Ü
("Offset greaterhan file size.");

77 cÚ¡ 
ušt64_t
 
	gavaabË
 = 
size_
 - 
off£t
;

78 ià(
	gn
 > 
	gavaabË
) {

79 
	gn
 = 
¡©ic_ÿ¡
<
size_t
>(
avaabË
);

81 ià(
	gn
 == 0) {

82 *
»suÉ
 = 
Sliû
();

83  
	gStus
::
OK
();

86 
as£¹
(
off£t
 / 
kBlockSize
 <ğ
¡d
::
num”ic_lim™s
<
size_t
>::
max
());

87 
size_t
 
	gblock
 = 
¡©ic_ÿ¡
<size_t>(
off£t
 / 
kBlockSize
);

88 
size_t
 
	gblock_off£t
 = 
off£t
 % 
kBlockSize
;

89 
size_t
 
	gby‹s_to_cİy
 = 
n
;

90 * 
	gd¡
 = 
sü©ch
;

92 
	gby‹s_to_cİy
 > 0) {

93 
size_t
 
	gava
 = 
kBlockSize
 - 
block_off£t
;

94 ià(
	gava
 > 
	gby‹s_to_cİy
) {

95 
	gava
 = 
by‹s_to_cİy
;

97 
memıy
(
d¡
, 
blocks_
[
block
] + 
block_off£t
, 
ava
);

99 
	gby‹s_to_cİy
 -ğ
ava
;

100 
	gd¡
 +ğ
ava
;

101 
	gblock
++;

102 
	gblock_off£t
 = 0;

105 *
	g»suÉ
 = 
Sliû
(
sü©ch
, 
n
);

106  
	gStus
::
OK
();

109 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
) {

110 cÚ¡ * 
	g¤c
 = 
d©a
.data();

111 
size_t
 
	g¤c_Ën
 = 
d©a
.
size
();

113 
Mu‹xLock
 
lock
(&
blocks_mu‹x_
);

114 
	g¤c_Ën
 > 0) {

115 
size_t
 
	gava
;

116 
size_t
 
	goff£t
 = 
size_
 % 
kBlockSize
;

118 ià(
	goff£t
 != 0) {

120 
ava
 = 
kBlockSize
 - 
off£t
;

123 
	gblocks_
.
push_back
(
Ãw
 [
kBlockSize
]);

124 
	gava
 = 
kBlockSize
;

127 ià(
	gava
 > 
	g¤c_Ën
) {

128 
	gava
 = 
¤c_Ën
;

130 
memıy
(
blocks_
.
back
(è+ 
off£t
, 
¤c
, 
ava
);

131 
	g¤c_Ën
 -ğ
ava
;

132 
	g¤c
 +ğ
ava
;

133 
	gsize_
 +ğ
ava
;

136  
	gStus
::
OK
();

139 
	g´iv©e
:

140 ’um { 
kBlockSize
 = 8 * 1024 };

143 ~
FeS‹
(è{ 
Trunÿ‹
(); }

145 
	gpÜt
::
Mu‹x
 
»fs_mu‹x_
;

146 
»fs_
 
GUARDED_BY
(
»fs_mu‹x_
);

148 
mubË
 
	gpÜt
::
Mu‹x
 
blocks_mu‹x_
;

149 
	g¡d
::
veùÜ
<*> 
blocks_
 
GUARDED_BY
(
blocks_mu‹x_
);

150 
ušt64_t
 
size_
 
GUARDED_BY
(
blocks_mu‹x_
);

153 şas 
	cSequ’tŸlFeIm¶
 : 
public
 
Sequ’tŸlFe
 {

154 
public
:

155 
ex¶ic™
 
Sequ’tŸlFeIm¶
(
FeS‹
* 
fe
è: 
fe_
(fe), 
pos_
(0) {

156 
	gfe_
->
Ref
();

159 ~
Sequ’tŸlFeIm¶
(è{ 
	gfe_
->
UÄef
(); }

161 
vœtu®
 
Stus
 
R—d
(
size_t
 
n
, 
Sliû
* 
»suÉ
, * 
sü©ch
) {

162 
Stus
 
	gs
 = 
fe_
->
R—d
(
pos_
, 
n
, 
»suÉ
, 
sü©ch
);

163 ià(
	gs
.
ok
()) {

164 
	gpos_
 +ğ
»suÉ
->
size
();

166  
	gs
;

169 
vœtu®
 
Stus
 
Sk
(
ušt64_t
 
n
) {

170 ià(
	gpos_
 > 
	gfe_
->
Size
()) {

171  
	gStus
::
IOE¼Ü
("pos_ > file_->Size()");

173 cÚ¡ 
ušt64_t
 
	gavaabË
 = 
fe_
->
Size
(è- 
pos_
;

174 ià(
	gn
 > 
	gavaabË
) {

175 
	gn
 = 
avaabË
;

177 
	gpos_
 +ğ
n
;

178  
	gStus
::
OK
();

181 
	g´iv©e
:

182 
FeS‹
* 
fe_
;

183 
ušt64_t
 
	gpos_
;

186 şas 
	cRªdomAcûssFeIm¶
 : 
public
 
RªdomAcûssFe
 {

187 
public
:

188 
ex¶ic™
 
RªdomAcûssFeIm¶
(
FeS‹
* 
fe
è: 
fe_
(feè{ fe_->
Ref
(); }

190 ~
RªdomAcûssFeIm¶
(è{ 
	gfe_
->
UÄef
(); }

192 
vœtu®
 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

193 * 
sü©ch
) const {

194  
	gfe_
->
R—d
(
off£t
, 
n
, 
»suÉ
, 
sü©ch
);

197 
	g´iv©e
:

198 
FeS‹
* 
fe_
;

201 şas 
	cWr™abËFeIm¶
 : 
public
 
Wr™abËFe
 {

202 
public
:

203 
Wr™abËFeIm¶
(
FeS‹
* 
fe
è: 
fe_
(feè{ fe_->
Ref
(); }

205 ~
Wr™abËFeIm¶
(è{ 
	gfe_
->
UÄef
(); }

207 
vœtu®
 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
è{  
	gfe_
->Append(data); }

209 
vœtu®
 
Stus
 
Clo£
(è{  
	gStus
::
OK
(); }

210 
vœtu®
 
Stus
 
Flush
(è{  
	gStus
::
OK
(); }

211 
vœtu®
 
Stus
 
Sync
(è{  
	gStus
::
OK
(); }

213 
	g´iv©e
:

214 
FeS‹
* 
fe_
;

217 şas 
	cNoOpLogg”
 : 
public
 
Logg”
 {

218 
public
:

219 
vœtu®
 
Logv
(cÚ¡ * 
fÜm©
, 
va_li¡
 
­
) {}

222 şas 
	cInMemÜyEnv
 : 
public
 
EnvW¿µ”
 {

223 
public
:

224 
ex¶ic™
 
InMemÜyEnv
(
Env
* 
ba£_’v
è: 
EnvW¿µ”
(base_env) {}

226 
vœtu®
 ~
InMemÜyEnv
() {

227 
FeSy¡em
::
™”©Ü
 
i
 = 
fe_m­_
.
begš
(); 
	gi
 !ğfe_m­_.
’d
();

228 ++
	gi
) {

229 
	gi
->
	g£cÚd
->
UÄef
();

234 
vœtu®
 
Stus
 
NewSequ’tŸlFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

235 
Sequ’tŸlFe
** 
»suÉ
) {

236 
Mu‹xLock
 
lock
(&
mu‹x_
);

237 ià(
	gfe_m­_
.
fšd
(
âame
è=ğ
fe_m­_
.
’d
()) {

238 *
»suÉ
 = 
nuÎ±r
;

239  
	gStus
::
IOE¼Ü
(
âame
, "File‚ot found");

242 *
	g»suÉ
 = 
Ãw
 
Sequ’tŸlFeIm¶
(
fe_m­_
[
âame
]);

243  
	gStus
::
OK
();

246 
vœtu®
 
Stus
 
NewRªdomAcûssFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

247 
RªdomAcûssFe
** 
»suÉ
) {

248 
Mu‹xLock
 
lock
(&
mu‹x_
);

249 ià(
	gfe_m­_
.
fšd
(
âame
è=ğ
fe_m­_
.
’d
()) {

250 *
»suÉ
 = 
nuÎ±r
;

251  
	gStus
::
IOE¼Ü
(
âame
, "File‚ot found");

254 *
	g»suÉ
 = 
Ãw
 
RªdomAcûssFeIm¶
(
fe_m­_
[
âame
]);

255  
	gStus
::
OK
();

258 
vœtu®
 
Stus
 
NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

259 
Wr™abËFe
** 
»suÉ
) {

260 
Mu‹xLock
 
lock
(&
mu‹x_
);

261 
	gFeSy¡em
::
™”©Ü
 
™
 = 
fe_m­_
.
fšd
(
âame
);

263 
FeS‹
* 
	gfe
;

264 ià(
	g™
 =ğ
fe_m­_
.
’d
()) {

266 
fe
 = 
Ãw
 
FeS‹
();

267 
	gfe
->
Ref
();

268 
	gfe_m­_
[
âame
] = 
fe
;

270 
	gfe
 = 
™
->
£cÚd
;

271 
	gfe
->
Trunÿ‹
();

274 *
	g»suÉ
 = 
Ãw
 
Wr™abËFeIm¶
(
fe
);

275  
	gStus
::
OK
();

278 
vœtu®
 
Stus
 
NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

279 
Wr™abËFe
** 
»suÉ
) {

280 
Mu‹xLock
 
lock
(&
mu‹x_
);

281 
FeS‹
** 
	g¥Œ
 = &
fe_m­_
[
âame
];

282 
FeS‹
* 
	gfe
 = *
¥Œ
;

283 ià(
	gfe
 =ğ
nuÎ±r
) {

284 
fe
 = 
Ãw
 
FeS‹
();

285 
	gfe
->
Ref
();

287 *
	g»suÉ
 = 
Ãw
 
Wr™abËFeIm¶
(
fe
);

288  
	gStus
::
OK
();

291 
vœtu®
 
boŞ
 
FeExi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
âame
) {

292 
Mu‹xLock
 
lock
(&
mu‹x_
);

293  
	gfe_m­_
.
fšd
(
âame
è!ğ
fe_m­_
.
’d
();

296 
vœtu®
 
Stus
 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
dœ
,

297 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
»suÉ
) {

298 
Mu‹xLock
 
lock
(&
mu‹x_
);

299 
	g»suÉ
->
ş—r
();

301 
	gFeSy¡em
::
™”©Ü
 
i
 = 
fe_m­_
.
begš
(); 
	gi
 !ğfe_m­_.
’d
();

302 ++
	gi
) {

303 cÚ¡ 
	g¡d
::
¡ršg
& 
f’ame
 = 
i
->
fœ¡
;

305 ià(
	gf’ame
.
size
(è>ğ
dœ
.size(è+ 1 && 
f’ame
[dir.size()] == '/' &&

306 
Sliû
(
f’ame
).
¡¬ts_w™h
(Sliû(
dœ
))) {

307 
»suÉ
->
push_back
(
f’ame
.
sub¡r
(
dœ
.
size
() + 1));

311  
	gStus
::
OK
();

314 
D–‘eFeIÁ”Çl
(cÚ¡ 
¡d
::
¡ršg
& 
âame
)

315 
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
) {

316 ià(
fe_m­_
.
fšd
(
âame
è=ğfe_m­_.
’d
()) {

320 
	gfe_m­_
[
âame
]->
UÄef
();

321 
	gfe_m­_
.
”a£
(
âame
);

324 
vœtu®
 
Stus
 
D–‘eFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
) {

325 
Mu‹xLock
 
lock
(&
mu‹x_
);

326 ià(
	gfe_m­_
.
fšd
(
âame
è=ğ
fe_m­_
.
’d
()) {

327  
Stus
::
IOE¼Ü
(
âame
, "File‚ot found");

330 
D–‘eFeIÁ”Çl
(
âame
);

331  
	gStus
::
OK
();

334 
vœtu®
 
Stus
 
C»©eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
dœÇme
è{  Stus::
OK
(); }

336 
vœtu®
 
Stus
 
D–‘eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
dœÇme
è{  Stus::
OK
(); }

338 
vœtu®
 
Stus
 
G‘FeSize
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
ušt64_t
* 
fe_size
) {

339 
Mu‹xLock
 
lock
(&
mu‹x_
);

340 ià(
	gfe_m­_
.
fšd
(
âame
è=ğ
fe_m­_
.
’d
()) {

341  
Stus
::
IOE¼Ü
(
âame
, "File‚ot found");

344 *
	gfe_size
 = 
fe_m­_
[
âame
]->
Size
();

345  
	gStus
::
OK
();

348 
vœtu®
 
Stus
 
R’ameFe
(cÚ¡ 
¡d
::
¡ršg
& 
¤c
, cÚ¡ std::¡ršg& 
rg‘
) {

349 
Mu‹xLock
 
lock
(&
mu‹x_
);

350 ià(
	gfe_m­_
.
fšd
(
¤c
è=ğ
fe_m­_
.
’d
()) {

351  
Stus
::
IOE¼Ü
(
¤c
, "File‚ot found");

354 
D–‘eFeIÁ”Çl
(
rg‘
);

355 
	gfe_m­_
[
rg‘
] = 
fe_m­_
[
¤c
];

356 
	gfe_m­_
.
”a£
(
¤c
);

357  
	gStus
::
OK
();

360 
vœtu®
 
Stus
 
LockFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
FeLock
** 
lock
) {

361 *
	glock
 = 
Ãw
 
FeLock
;

362  
	gStus
::
OK
();

365 
vœtu®
 
Stus
 
UÆockFe
(
FeLock
* 
lock
) {

366 
d–‘e
 
	glock
;

367  
	gStus
::
OK
();

370 
vœtu®
 
Stus
 
G‘Te¡DœeùÜy
(
¡d
::
¡ršg
* 
·th
) {

371 *
·th
 = "/test";

372  
	gStus
::
OK
();

375 
vœtu®
 
Stus
 
NewLogg”
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Logg”
** 
»suÉ
) {

376 *
	g»suÉ
 = 
Ãw
 
NoOpLogg”
;

377  
	gStus
::
OK
();

380 
	g´iv©e
:

382 
¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, 
	tFeS‹
*> 
	tFeSy¡em
;

384 
	gpÜt
::
Mu‹x
 
mu‹x_
;

385 
FeSy¡em
 
fe_m­_
 
GUARDED_BY
(
mu‹x_
);

390 
Env
* 
	$NewMemEnv
(
Env
* 
ba£_’v
è{  
Ãw
 
	`InMemÜyEnv
(ba£_’v); 
	}
}

	@helpers/memenv/memenv.h

5 #iâdeà
STORAGE_LEVELDB_HELPERS_MEMENV_MEMENV_H_


6 
	#STORAGE_LEVELDB_HELPERS_MEMENV_MEMENV_H_


	)

8 
	~"Ëv–db/expÜt.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 
şass
 
	gEnv
;

18 
LEVELDB_EXPORT
 
Env
* 
NewMemEnv
(Env* 
ba£_’v
);

	@helpers/memenv/memenv_test.cc

5 
	~"h–³rs/mem’v/mem’v.h
"

7 
	~<¡ršg
>

8 
	~<veùÜ
>

10 
	~"db/db_im¶.h
"

11 
	~"Ëv–db/db.h
"

12 
	~"Ëv–db/’v.h
"

13 
	~"ut/‹¡h¬Ãss.h
"

15 
Çme¥aû
 
	gËv–db
 {

17 şas 
	cMemEnvTe¡
 {

18 
	gpublic
:

19 
MemEnvTe¡
(è: 
’v_
(
NewMemEnv
(
Env
::
DeçuÉ
())) {}

20 ~
MemEnvTe¡
(è{ 
d–‘e
 
’v_
; }

22 
Env
* 
	g’v_
;

25 
	$TEST
(
MemEnvTe¡
, 
Basics
) {

26 
ušt64_t
 
fe_size
;

27 
Wr™abËFe
* 
wr™abË_fe
;

28 
¡d
::
veùÜ
<¡d::
¡ršg
> 
chd»n
;

30 
	`ASSERT_OK
(
’v_
->
	`C»©eDœ
("/dir"));

33 
	`ASSERT_TRUE
(!
’v_
->
	`FeExi¡s
("/dir/non_existent"));

34 
	`ASSERT_TRUE
(!
’v_
->
	`G‘FeSize
("/dœ/nÚ_exi¡’t", &
fe_size
).
	`ok
());

35 
	`ASSERT_OK
(
’v_
->
	`G‘Chd»n
("/dœ", &
chd»n
));

36 
	`ASSERT_EQ
(0, 
chd»n
.
	`size
());

39 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
("/dœ/f", &
wr™abË_fe
));

40 
	`ASSERT_OK
(
’v_
->
	`G‘FeSize
("/dœ/f", &
fe_size
));

41 
	`ASSERT_EQ
(0, 
fe_size
);

42 
d–‘e
 
wr™abË_fe
;

45 
	`ASSERT_TRUE
(
’v_
->
	`FeExi¡s
("/dir/f"));

46 
	`ASSERT_OK
(
’v_
->
	`G‘FeSize
("/dœ/f", &
fe_size
));

47 
	`ASSERT_EQ
(0, 
fe_size
);

48 
	`ASSERT_OK
(
’v_
->
	`G‘Chd»n
("/dœ", &
chd»n
));

49 
	`ASSERT_EQ
(1, 
chd»n
.
	`size
());

50 
	`ASSERT_EQ
("f", 
chd»n
[0]);

53 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
("/dœ/f", &
wr™abË_fe
));

54 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
("abc"));

55 
d–‘e
 
wr™abË_fe
;

58 
	`ASSERT_OK
(
’v_
->
	`NewAµ’dabËFe
("/dœ/f", &
wr™abË_fe
));

59 
	`ASSERT_OK
(
’v_
->
	`G‘FeSize
("/dœ/f", &
fe_size
));

60 
	`ASSERT_EQ
(3, 
fe_size
);

61 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
("hello"));

62 
d–‘e
 
wr™abË_fe
;

65 
	`ASSERT_OK
(
’v_
->
	`G‘FeSize
("/dœ/f", &
fe_size
));

66 
	`ASSERT_EQ
(8, 
fe_size
);

69 
	`ASSERT_TRUE
(!
’v_
->
	`R’ameFe
("/dœ/nÚ_exi¡’t", "/dœ/g").
	`ok
());

70 
	`ASSERT_OK
(
’v_
->
	`R’ameFe
("/dir/f", "/dir/g"));

71 
	`ASSERT_TRUE
(!
’v_
->
	`FeExi¡s
("/dir/f"));

72 
	`ASSERT_TRUE
(
’v_
->
	`FeExi¡s
("/dir/g"));

73 
	`ASSERT_OK
(
’v_
->
	`G‘FeSize
("/dœ/g", &
fe_size
));

74 
	`ASSERT_EQ
(8, 
fe_size
);

77 
Sequ’tŸlFe
* 
£q_fe
;

78 
RªdomAcûssFe
* 
¿nd_fe
;

79 
	`ASSERT_TRUE
(!
’v_
->
	`NewSequ’tŸlFe
("/dœ/nÚ_exi¡’t", &
£q_fe
).
	`ok
());

80 
	`ASSERT_TRUE
(!
£q_fe
);

81 
	`ASSERT_TRUE
(!
’v_
->
	`NewRªdomAcûssFe
("/dœ/nÚ_exi¡’t", &
¿nd_fe
).
	`ok
());

82 
	`ASSERT_TRUE
(!
¿nd_fe
);

85 
	`ASSERT_TRUE
(!
’v_
->
	`D–‘eFe
("/dœ/nÚ_exi¡’t").
	`ok
());

86 
	`ASSERT_OK
(
’v_
->
	`D–‘eFe
("/dir/g"));

87 
	`ASSERT_TRUE
(!
’v_
->
	`FeExi¡s
("/dir/g"));

88 
	`ASSERT_OK
(
’v_
->
	`G‘Chd»n
("/dœ", &
chd»n
));

89 
	`ASSERT_EQ
(0, 
chd»n
.
	`size
());

90 
	`ASSERT_OK
(
’v_
->
	`D–‘eDœ
("/dir"));

91 
	}
}

93 
	$TEST
(
MemEnvTe¡
, 
R—dWr™e
) {

94 
Wr™abËFe
* 
wr™abË_fe
;

95 
Sequ’tŸlFe
* 
£q_fe
;

96 
RªdomAcûssFe
* 
¿nd_fe
;

97 
Sliû
 
»suÉ
;

98 
sü©ch
[100];

100 
	`ASSERT_OK
(
’v_
->
	`C»©eDœ
("/dir"));

102 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
("/dœ/f", &
wr™abË_fe
));

103 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
("hello "));

104 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
("world"));

105 
d–‘e
 
wr™abË_fe
;

108 
	`ASSERT_OK
(
’v_
->
	`NewSequ’tŸlFe
("/dœ/f", &
£q_fe
));

109 
	`ASSERT_OK
(
£q_fe
->
	`R—d
(5, &
»suÉ
, 
sü©ch
));

110 
	`ASSERT_EQ
(0, 
»suÉ
.
	`com·»
("hello"));

111 
	`ASSERT_OK
(
£q_fe
->
	`Sk
(1));

112 
	`ASSERT_OK
(
£q_fe
->
	`R—d
(1000, &
»suÉ
, 
sü©ch
));

113 
	`ASSERT_EQ
(0, 
»suÉ
.
	`com·»
("world"));

114 
	`ASSERT_OK
(
£q_fe
->
	`R—d
(1000, &
»suÉ
, 
sü©ch
));

115 
	`ASSERT_EQ
(0, 
»suÉ
.
	`size
());

116 
	`ASSERT_OK
(
£q_fe
->
	`Sk
(100));

117 
	`ASSERT_OK
(
£q_fe
->
	`R—d
(1000, &
»suÉ
, 
sü©ch
));

118 
	`ASSERT_EQ
(0, 
»suÉ
.
	`size
());

119 
d–‘e
 
£q_fe
;

122 
	`ASSERT_OK
(
’v_
->
	`NewRªdomAcûssFe
("/dœ/f", &
¿nd_fe
));

123 
	`ASSERT_OK
(
¿nd_fe
->
	`R—d
(6, 5, &
»suÉ
, 
sü©ch
));

124 
	`ASSERT_EQ
(0, 
»suÉ
.
	`com·»
("world"));

125 
	`ASSERT_OK
(
¿nd_fe
->
	`R—d
(0, 5, &
»suÉ
, 
sü©ch
));

126 
	`ASSERT_EQ
(0, 
»suÉ
.
	`com·»
("hello"));

127 
	`ASSERT_OK
(
¿nd_fe
->
	`R—d
(10, 100, &
»suÉ
, 
sü©ch
));

128 
	`ASSERT_EQ
(0, 
»suÉ
.
	`com·»
("d"));

131 
	`ASSERT_TRUE
(!
¿nd_fe
->
	`R—d
(1000, 5, &
»suÉ
, 
sü©ch
).
	`ok
());

132 
d–‘e
 
¿nd_fe
;

133 
	}
}

135 
	$TEST
(
MemEnvTe¡
, 
Locks
) {

136 
FeLock
* 
lock
;

139 
	`ASSERT_OK
(
’v_
->
	`LockFe
("somfe", &
lock
));

140 
	`ASSERT_OK
(
’v_
->
	`UÆockFe
(
lock
));

141 
	}
}

143 
	$TEST
(
MemEnvTe¡
, 
Misc
) {

144 
¡d
::
¡ršg
 
‹¡_dœ
;

145 
	`ASSERT_OK
(
’v_
->
	`G‘Te¡DœeùÜy
(&
‹¡_dœ
));

146 
	`ASSERT_TRUE
(!
‹¡_dœ
.
	`em±y
());

148 
Wr™abËFe
* 
wr™abË_fe
;

149 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
("/a/b", &
wr™abË_fe
));

152 
	`ASSERT_OK
(
wr™abË_fe
->
	`Sync
());

153 
	`ASSERT_OK
(
wr™abË_fe
->
	`Flush
());

154 
	`ASSERT_OK
(
wr™abË_fe
->
	`Clo£
());

155 
d–‘e
 
wr™abË_fe
;

156 
	}
}

158 
	$TEST
(
MemEnvTe¡
, 
L¬geWr™e
) {

159 cÚ¡ 
size_t
 
kWr™eSize
 = 300 * 1024;

160 * 
sü©ch
 = 
Ãw
 [
kWr™eSize
 * 2];

162 
¡d
::
¡ršg
 
wr™e_d©a
;

163 
size_t
 
i
 = 0; i < 
kWr™eSize
; ++i) {

164 
wr™e_d©a
.
	`­³nd
(1, 
¡©ic_ÿ¡
<>(
i
));

167 
Wr™abËFe
* 
wr™abË_fe
;

168 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
("/dœ/f", &
wr™abË_fe
));

169 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
("foo"));

170 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
(
wr™e_d©a
));

171 
d–‘e
 
wr™abË_fe
;

173 
Sequ’tŸlFe
* 
£q_fe
;

174 
Sliû
 
»suÉ
;

175 
	`ASSERT_OK
(
’v_
->
	`NewSequ’tŸlFe
("/dœ/f", &
£q_fe
));

176 
	`ASSERT_OK
(
£q_fe
->
	`R—d
(3, &
»suÉ
, 
sü©ch
));

177 
	`ASSERT_EQ
(0, 
»suÉ
.
	`com·»
("foo"));

179 
size_t
 
»ad
 = 0;

180 
¡d
::
¡ršg
 
»ad_d©a
;

181 
»ad
 < 
kWr™eSize
) {

182 
	`ASSERT_OK
(
£q_fe
->
	`R—d
(
kWr™eSize
 - 
»ad
, &
»suÉ
, 
sü©ch
));

183 
»ad_d©a
.
	`­³nd
(
»suÉ
.
	`d©a
(),„esuÉ.
	`size
());

184 
»ad
 +ğ
»suÉ
.
	`size
();

186 
	`ASSERT_TRUE
(
wr™e_d©a
 =ğ
»ad_d©a
);

187 
d–‘e
 
£q_fe
;

188 
d–‘e
[] 
sü©ch
;

189 
	}
}

191 
	$TEST
(
MemEnvTe¡
, 
Ov”wr™eO³nFe
) {

192 cÚ¡ 
kWr™e1D©a
[] = "Write #1 data";

193 cÚ¡ 
size_t
 
kFeD©aL’
 = (
kWr™e1D©a
) - 1;

194 cÚ¡ 
¡d
::
¡ršg
 
kTe¡FeName
 = 
‹¡
::
	`TmpDœ
() + "/leveldb-TestFile.dat";

196 
	`ASSERT_OK
(
	`Wr™eSŒšgToFe
(
’v_
, 
kWr™e1D©a
, 
kTe¡FeName
));

198 
RªdomAcûssFe
* 
¿nd_fe
;

199 
	`ASSERT_OK
(
’v_
->
	`NewRªdomAcûssFe
(
kTe¡FeName
, &
¿nd_fe
));

201 cÚ¡ 
kWr™e2D©a
[] = "Write #2 data";

202 
	`ASSERT_OK
(
	`Wr™eSŒšgToFe
(
’v_
, 
kWr™e2D©a
, 
kTe¡FeName
));

206 
Sliû
 
»suÉ
;

207 
sü©ch
[
kFeD©aL’
];

208 
	`ASSERT_OK
(
¿nd_fe
->
	`R—d
(0, 
kFeD©aL’
, &
»suÉ
, 
sü©ch
));

209 
	`ASSERT_EQ
(0, 
»suÉ
.
	`com·»
(
kWr™e2D©a
));

211 
d–‘e
 
¿nd_fe
;

212 
	}
}

214 
	$TEST
(
MemEnvTe¡
, 
DBTe¡
) {

215 
O±iÚs
 
İtiÚs
;

216 
İtiÚs
.
ü—‹_if_missšg
 = 
Œue
;

217 
İtiÚs
.
’v
 = 
’v_
;

218 
DB
* 
db
;

220 cÚ¡ 
Sliû
 
keys
[] = {
	`Sliû
("aaa"), Slice("bbb"), Slice("ccc")};

221 cÚ¡ 
Sliû
 
v®s
[] = {
	`Sliû
("foo"), Slice("bar"), Slice("baz")};

223 
	`ASSERT_OK
(
DB
::
	`O³n
(
İtiÚs
, "/dœ/db", &
db
));

224 
size_t
 
i
 = 0; i < 3; ++i) {

225 
	`ASSERT_OK
(
db
->
	`Put
(
	`Wr™eO±iÚs
(), 
keys
[
i
], 
v®s
[i]));

228 
size_t
 
i
 = 0; i < 3; ++i) {

229 
¡d
::
¡ršg
 
»s
;

230 
	`ASSERT_OK
(
db
->
	`G‘
(
	`R—dO±iÚs
(), 
keys
[
i
], &
»s
));

231 
	`ASSERT_TRUE
(
»s
 =ğ
v®s
[
i
]);

234 
I‹¿tÜ
* 
™”©Ü
 = 
db
->
	`NewI‹¿tÜ
(
	`R—dO±iÚs
());

235 
™”©Ü
->
	`S“kToFœ¡
();

236 
size_t
 
i
 = 0; i < 3; ++i) {

237 
	`ASSERT_TRUE
(
™”©Ü
->
	`V®id
());

238 
	`ASSERT_TRUE
(
keys
[
i
] =ğ
™”©Ü
->
	`key
());

239 
	`ASSERT_TRUE
(
v®s
[
i
] =ğ
™”©Ü
->
	`v®ue
());

240 
™”©Ü
->
	`Next
();

242 
	`ASSERT_TRUE
(!
™”©Ü
->
	`V®id
());

243 
d–‘e
 
™”©Ü
;

245 
DBIm¶
* 
dbi
 = 
»š‹½»t_ÿ¡
<DBIm¶*>(
db
);

246 
	`ASSERT_OK
(
dbi
->
	`TEST_Com·ùMemTabË
());

248 
size_t
 
i
 = 0; i < 3; ++i) {

249 
¡d
::
¡ršg
 
»s
;

250 
	`ASSERT_OK
(
db
->
	`G‘
(
	`R—dO±iÚs
(), 
keys
[
i
], &
»s
));

251 
	`ASSERT_TRUE
(
»s
 =ğ
v®s
[
i
]);

254 
d–‘e
 
db
;

255 
	}
}

259 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@include/leveldb/c.h

40 #iâdeà
STORAGE_LEVELDB_INCLUDE_C_H_


41 
	#STORAGE_LEVELDB_INCLUDE_C_H_


	)

43 #ifdeà
__ılu¥lus


47 
	~<¡d¬g.h
>

48 
	~<¡ddef.h
>

49 
	~<¡dšt.h
>

51 
	~"Ëv–db/expÜt.h
"

55 
Ëv–db_t
 
	tËv–db_t
;

56 
Ëv–db_ÿche_t
 
	tËv–db_ÿche_t
;

57 
Ëv–db_com·¿tÜ_t
 
	tËv–db_com·¿tÜ_t
;

58 
Ëv–db_’v_t
 
	tËv–db_’v_t
;

59 
Ëv–db_f–ock_t
 
	tËv–db_f–ock_t
;

60 
Ëv–db_f‹½Şicy_t
 
	tËv–db_f‹½Şicy_t
;

61 
Ëv–db_™”©Ü_t
 
	tËv–db_™”©Ü_t
;

62 
Ëv–db_logg”_t
 
	tËv–db_logg”_t
;

63 
Ëv–db_İtiÚs_t
 
	tËv–db_İtiÚs_t
;

64 
Ëv–db_¿ndomfe_t
 
	tËv–db_¿ndomfe_t
;

65 
Ëv–db_»adİtiÚs_t
 
	tËv–db_»adİtiÚs_t
;

66 
Ëv–db_£qfe_t
 
	tËv–db_£qfe_t
;

67 
Ëv–db_¢­shÙ_t
 
	tËv–db_¢­shÙ_t
;

68 
Ëv–db_wr™abËfe_t
 
	tËv–db_wr™abËfe_t
;

69 
Ëv–db_wr™eb©ch_t
 
	tËv–db_wr™eb©ch_t
;

70 
Ëv–db_wr™eİtiÚs_t
 
	tËv–db_wr™eİtiÚs_t
;

74 
LEVELDB_EXPORT
 
Ëv–db_t
* 
Ëv–db_İ’
(cÚ¡ 
Ëv–db_İtiÚs_t
* 
İtiÚs
,

75 cÚ¡ * 
Çme
, ** 
”½Œ
);

77 
LEVELDB_EXPORT
 
Ëv–db_şo£
(
Ëv–db_t
* 
db
);

79 
LEVELDB_EXPORT
 
Ëv–db_put
(
Ëv–db_t
* 
db
,

80 cÚ¡ 
Ëv–db_wr™eİtiÚs_t
* 
İtiÚs
,

81 cÚ¡ * 
key
, 
size_t
 
keyËn
, cÚ¡ * 
v®
,

82 
size_t
 
v®Ën
, ** 
”½Œ
);

84 
LEVELDB_EXPORT
 
Ëv–db_d–‘e
(
Ëv–db_t
* 
db
,

85 cÚ¡ 
Ëv–db_wr™eİtiÚs_t
* 
İtiÚs
,

86 cÚ¡ * 
key
, 
size_t
 
keyËn
,

87 ** 
”½Œ
);

89 
LEVELDB_EXPORT
 
Ëv–db_wr™e
(
Ëv–db_t
* 
db
,

90 cÚ¡ 
Ëv–db_wr™eİtiÚs_t
* 
İtiÚs
,

91 
Ëv–db_wr™eb©ch_t
* 
b©ch
, ** 
”½Œ
);

95 
LEVELDB_EXPORT
 * 
Ëv–db_g‘
(
Ëv–db_t
* 
db
,

96 cÚ¡ 
Ëv–db_»adİtiÚs_t
* 
İtiÚs
,

97 cÚ¡ * 
key
, 
size_t
 
keyËn
, size_t* 
v®Ën
,

98 ** 
”½Œ
);

100 
LEVELDB_EXPORT
 
Ëv–db_™”©Ü_t
* 
Ëv–db_ü—‹_™”©Ü
(

101 
Ëv–db_t
* 
db
, cÚ¡ 
Ëv–db_»adİtiÚs_t
* 
İtiÚs
);

103 
LEVELDB_EXPORT
 cÚ¡ 
Ëv–db_¢­shÙ_t
* 
Ëv–db_ü—‹_¢­shÙ
(
Ëv–db_t
* 
db
);

105 
LEVELDB_EXPORT
 
Ëv–db_»Ëa£_¢­shÙ
(

106 
Ëv–db_t
* 
db
, cÚ¡ 
Ëv–db_¢­shÙ_t
* 
¢­shÙ
);

110 
LEVELDB_EXPORT
 * 
Ëv–db_´İ”ty_v®ue
(
Ëv–db_t
* 
db
,

111 cÚ¡ * 
´İÇme
);

113 
LEVELDB_EXPORT
 
Ëv–db_­´oxim©e_sizes
(

114 
Ëv–db_t
* 
db
, 
num_¿nges
, cÚ¡ * cÚ¡* 
¿nge_¡¬t_key
,

115 cÚ¡ 
size_t
* 
¿nge_¡¬t_key_Ën
, cÚ¡ * cÚ¡* 
¿nge_lim™_key
,

116 cÚ¡ 
size_t
* 
¿nge_lim™_key_Ën
, 
ušt64_t
* 
sizes
);

118 
LEVELDB_EXPORT
 
Ëv–db_com·ù_¿nge
(
Ëv–db_t
* 
db
, cÚ¡ * 
¡¬t_key
,

119 
size_t
 
¡¬t_key_Ën
,

120 cÚ¡ * 
lim™_key
,

121 
size_t
 
lim™_key_Ën
);

125 
LEVELDB_EXPORT
 
Ëv–db_de¡roy_db
(cÚ¡ 
Ëv–db_İtiÚs_t
* 
İtiÚs
,

126 cÚ¡ * 
Çme
, ** 
”½Œ
);

128 
LEVELDB_EXPORT
 
Ëv–db_»·œ_db
(cÚ¡ 
Ëv–db_İtiÚs_t
* 
İtiÚs
,

129 cÚ¡ * 
Çme
, ** 
”½Œ
);

133 
LEVELDB_EXPORT
 
Ëv–db_™”_de¡roy
(
Ëv–db_™”©Ü_t
*);

134 
LEVELDB_EXPORT
 
Ëv–db_™”_v®id
(cÚ¡ 
Ëv–db_™”©Ü_t
*);

135 
LEVELDB_EXPORT
 
Ëv–db_™”_£ek_to_fœ¡
(
Ëv–db_™”©Ü_t
*);

136 
LEVELDB_EXPORT
 
Ëv–db_™”_£ek_to_Ï¡
(
Ëv–db_™”©Ü_t
*);

137 
LEVELDB_EXPORT
 
Ëv–db_™”_£ek
(
Ëv–db_™”©Ü_t
*, cÚ¡ * 
k
,

138 
size_t
 
kËn
);

139 
LEVELDB_EXPORT
 
Ëv–db_™”_Ãxt
(
Ëv–db_™”©Ü_t
*);

140 
LEVELDB_EXPORT
 
Ëv–db_™”_´ev
(
Ëv–db_™”©Ü_t
*);

141 
LEVELDB_EXPORT
 cÚ¡ * 
Ëv–db_™”_key
(cÚ¡ 
Ëv–db_™”©Ü_t
*,

142 
size_t
* 
kËn
);

143 
LEVELDB_EXPORT
 cÚ¡ * 
Ëv–db_™”_v®ue
(cÚ¡ 
Ëv–db_™”©Ü_t
*,

144 
size_t
* 
vËn
);

145 
LEVELDB_EXPORT
 
Ëv–db_™”_g‘_”rÜ
(cÚ¡ 
Ëv–db_™”©Ü_t
*,

146 ** 
”½Œ
);

150 
LEVELDB_EXPORT
 
Ëv–db_wr™eb©ch_t
* 
Ëv–db_wr™eb©ch_ü—‹
();

151 
LEVELDB_EXPORT
 
Ëv–db_wr™eb©ch_de¡roy
(
Ëv–db_wr™eb©ch_t
*);

152 
LEVELDB_EXPORT
 
Ëv–db_wr™eb©ch_ş—r
(
Ëv–db_wr™eb©ch_t
*);

153 
LEVELDB_EXPORT
 
Ëv–db_wr™eb©ch_put
(
Ëv–db_wr™eb©ch_t
*,

154 cÚ¡ * 
key
, 
size_t
 
kËn
,

155 cÚ¡ * 
v®
, 
size_t
 
vËn
);

156 
LEVELDB_EXPORT
 
Ëv–db_wr™eb©ch_d–‘e
(
Ëv–db_wr™eb©ch_t
*,

157 cÚ¡ * 
key
, 
size_t
 
kËn
);

158 
LEVELDB_EXPORT
 
Ëv–db_wr™eb©ch_™”©e
(

159 cÚ¡ 
Ëv–db_wr™eb©ch_t
*, * 
¡©e
,

160 (*
put
)(*, cÚ¡ * 
k
, 
size_t
 
kËn
, cÚ¡ * 
v
, size_ˆ
vËn
),

161 (*
d–‘ed
)(*, cÚ¡ * 
k
, 
size_t
 
kËn
));

162 
LEVELDB_EXPORT
 
Ëv–db_wr™eb©ch_­³nd
(

163 
Ëv–db_wr™eb©ch_t
* 
de¡š©iÚ
, cÚ¡†ev–db_wr™eb©ch_t* 
sourû
);

167 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_t
* 
Ëv–db_İtiÚs_ü—‹
();

168 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_de¡roy
(
Ëv–db_İtiÚs_t
*);

169 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_com·¿tÜ
(
Ëv–db_İtiÚs_t
*,

170 
Ëv–db_com·¿tÜ_t
*);

171 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_f‹r_pŞicy
(
Ëv–db_İtiÚs_t
*,

172 
Ëv–db_f‹½Şicy_t
*);

173 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_ü—‹_if_missšg
(
Ëv–db_İtiÚs_t
*,

175 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_”rÜ_if_exi¡s
(
Ëv–db_İtiÚs_t
*,

177 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_·¿noid_checks
(
Ëv–db_İtiÚs_t
*,

179 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_’v
(
Ëv–db_İtiÚs_t
*, 
Ëv–db_’v_t
*);

180 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_šfo_log
(
Ëv–db_İtiÚs_t
*,

181 
Ëv–db_logg”_t
*);

182 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_wr™e_bufãr_size
(
Ëv–db_İtiÚs_t
*,

183 
size_t
);

184 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_max_İ’_fes
(
Ëv–db_İtiÚs_t
*, );

185 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_ÿche
(
Ëv–db_İtiÚs_t
*,

186 
Ëv–db_ÿche_t
*);

187 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_block_size
(
Ëv–db_İtiÚs_t
*, 
size_t
);

188 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_block_»¡¬t_š‹rv®
(

189 
Ëv–db_İtiÚs_t
*, );

190 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_max_fe_size
(
Ëv–db_İtiÚs_t
*,

191 
size_t
);

193 ’um { 
Ëv–db_no_com´essiÚ
 = 0, 
Ëv–db_¢­py_com´essiÚ
 = 1 };

194 
LEVELDB_EXPORT
 
Ëv–db_İtiÚs_£t_com´essiÚ
(
Ëv–db_İtiÚs_t
*, );

198 
LEVELDB_EXPORT
 
Ëv–db_com·¿tÜ_t
* 
Ëv–db_com·¿tÜ_ü—‹
(

199 * 
¡©e
, (*
de¡ruùÜ
)(*),

200 (*
com·»
)(*, cÚ¡ * 
a
, 
size_t
 
®’
, cÚ¡ * 
b
,

201 
size_t
 
bËn
),

202 cÚ¡ * (*
Çme
)(*));

203 
LEVELDB_EXPORT
 
Ëv–db_com·¿tÜ_de¡roy
(
Ëv–db_com·¿tÜ_t
*);

207 
LEVELDB_EXPORT
 
Ëv–db_f‹½Şicy_t
* 
Ëv–db_f‹½Şicy_ü—‹
(

208 * 
¡©e
, (*
de¡ruùÜ
)(*),

209 * (*
ü—‹_f‹r
)(*, cÚ¡ * cÚ¡* 
key_¬¿y
,

210 cÚ¡ 
size_t
* 
key_Ëngth_¬¿y
, 
num_keys
,

211 
size_t
* 
f‹r_Ëngth
),

212 (*
key_may_m©ch
)(*, cÚ¡ * 
key
, 
size_t
 
Ëngth
,

213 cÚ¡ * 
f‹r
, 
size_t
 
f‹r_Ëngth
),

214 cÚ¡ * (*
Çme
)(*));

215 
LEVELDB_EXPORT
 
Ëv–db_f‹½Şicy_de¡roy
(
Ëv–db_f‹½Şicy_t
*);

217 
LEVELDB_EXPORT
 
Ëv–db_f‹½Şicy_t
* 
Ëv–db_f‹½Şicy_ü—‹_bloom
(

218 
b™s_³r_key
);

222 
LEVELDB_EXPORT
 
Ëv–db_»adİtiÚs_t
* 
Ëv–db_»adİtiÚs_ü—‹
();

223 
LEVELDB_EXPORT
 
Ëv–db_»adİtiÚs_de¡roy
(
Ëv–db_»adİtiÚs_t
*);

224 
LEVELDB_EXPORT
 
Ëv–db_»adİtiÚs_£t_v”ify_checksums
(

225 
Ëv–db_»adİtiÚs_t
*, );

226 
LEVELDB_EXPORT
 
Ëv–db_»adİtiÚs_£t_fl_ÿche
(
Ëv–db_»adİtiÚs_t
*,

228 
LEVELDB_EXPORT
 
Ëv–db_»adİtiÚs_£t_¢­shÙ
(
Ëv–db_»adİtiÚs_t
*,

229 cÚ¡ 
Ëv–db_¢­shÙ_t
*);

233 
LEVELDB_EXPORT
 
Ëv–db_wr™eİtiÚs_t
* 
Ëv–db_wr™eİtiÚs_ü—‹
();

234 
LEVELDB_EXPORT
 
Ëv–db_wr™eİtiÚs_de¡roy
(
Ëv–db_wr™eİtiÚs_t
*);

235 
LEVELDB_EXPORT
 
Ëv–db_wr™eİtiÚs_£t_sync
(
Ëv–db_wr™eİtiÚs_t
*,

240 
LEVELDB_EXPORT
 
Ëv–db_ÿche_t
* 
Ëv–db_ÿche_ü—‹_Ìu
(
size_t
 
ÿ·c™y
);

241 
LEVELDB_EXPORT
 
Ëv–db_ÿche_de¡roy
(
Ëv–db_ÿche_t
* 
ÿche
);

245 
LEVELDB_EXPORT
 
Ëv–db_’v_t
* 
Ëv–db_ü—‹_deçuÉ_’v
();

246 
LEVELDB_EXPORT
 
Ëv–db_’v_de¡roy
(
Ëv–db_’v_t
*);

249 
LEVELDB_EXPORT
 * 
Ëv–db_’v_g‘_‹¡_dœeùÜy
(
Ëv–db_’v_t
*);

258 
LEVELDB_EXPORT
 
Ëv–db_ä“
(* 
±r
);

261 
LEVELDB_EXPORT
 
Ëv–db_majÜ_v”siÚ
();

264 
LEVELDB_EXPORT
 
Ëv–db_mšÜ_v”siÚ
();

266 #ifdeà
__ılu¥lus


	@include/leveldb/cache.h

18 #iâdeà
STORAGE_LEVELDB_INCLUDE_CACHE_H_


19 
	#STORAGE_LEVELDB_INCLUDE_CACHE_H_


	)

21 
	~<¡dšt.h
>

23 
	~"Ëv–db/expÜt.h
"

24 
	~"Ëv–db/¦iû.h
"

26 
Çme¥aû
 
	gËv–db
 {

28 
şass
 
LEVELDB_EXPORT
 
	gCache
;

32 
LEVELDB_EXPORT
 
Cache
* 
NewLRUCache
(
size_t
 
ÿ·c™y
);

34 şas 
	cLEVELDB_EXPORT
 
	gCache
 {

35 
	gpublic
:

36 
Cache
() = ;

38 
Cache
(cÚ¡ Cache&èğ
d–‘e
;

39 
	gCache
& 
	gİ”©Ü
=(cÚ¡ 
Cache
&èğ
d–‘e
;

43 
	gvœtu®
 ~
Cache
();

46 
	sHªdË
 {};

57 
vœtu®
 
HªdË
* 
In£¹
(cÚ¡ 
Sliû
& 
key
, * 
v®ue
, 
size_t
 
ch¬ge
,

58 (*
d–‘”
)(cÚ¡ 
Sliû
& 
key
, * 
v®ue
)) = 0;

65 
vœtu®
 
HªdË
* 
Lookup
(cÚ¡ 
Sliû
& 
key
) = 0;

70 
vœtu®
 
R–—£
(
HªdË
* 
hªdË
) = 0;

76 
vœtu®
 * 
V®ue
(
HªdË
* 
hªdË
) = 0;

81 
vœtu®
 
E¿£
(cÚ¡ 
Sliû
& 
key
) = 0;

87 
vœtu®
 
ušt64_t
 
NewId
() = 0;

94 
vœtu®
 
PruÃ
() {}

98 
vœtu®
 
size_t
 
TÙ®Ch¬ge
() const = 0;

100 
	g´iv©e
:

101 
LRU_Remove
(
HªdË
* 
e
);

102 
LRU_Aµ’d
(
HªdË
* 
e
);

103 
UÄef
(
HªdË
* 
e
);

105 
	gR•
;

106 
R•
* 
	g»p_
;

	@include/leveldb/comparator.h

5 #iâdeà
STORAGE_LEVELDB_INCLUDE_COMPARATOR_H_


6 
	#STORAGE_LEVELDB_INCLUDE_COMPARATOR_H_


	)

8 
	~<¡ršg
>

10 
	~"Ëv–db/expÜt.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 
şass
 
	gSliû
;

20 şas 
	cLEVELDB_EXPORT
 
	gCom·¿tÜ
 {

21 
	gpublic
:

22 
vœtu®
 ~
Com·¿tÜ
();

28 
vœtu®
 
Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const = 0;

40 
vœtu®
 cÚ¡ * 
Name
() const = 0;

48 
vœtu®
 
FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
* 
¡¬t
,

49 cÚ¡ 
Sliû
& 
lim™
) const = 0;

54 
vœtu®
 
FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const = 0;

60 
LEVELDB_EXPORT
 cÚ¡ 
Com·¿tÜ
* 
By‹wi£Com·¿tÜ
();

	@include/leveldb/db.h

5 #iâdeà
STORAGE_LEVELDB_INCLUDE_DB_H_


6 
	#STORAGE_LEVELDB_INCLUDE_DB_H_


	)

8 
	~<¡dšt.h
>

9 
	~<¡dio.h
>

11 
	~"Ëv–db/expÜt.h
"

12 
	~"Ëv–db/™”©Ü.h
"

13 
	~"Ëv–db/İtiÚs.h
"

15 
Çme¥aû
 
	gËv–db
 {

18 cÚ¡ 
	gkMajÜV”siÚ
 = 1;

19 cÚ¡ 
	gkMšÜV”siÚ
 = 22;

21 
	gO±iÚs
;

22 
	gR—dO±iÚs
;

23 
	gWr™eO±iÚs
;

24 
şass
 
	gWr™eB©ch
;

29 şas 
	cLEVELDB_EXPORT
 
	gSÇpshÙ
 {

30 
	g´Ùeùed
:

31 
vœtu®
 ~
SÇpshÙ
();

35 
LEVELDB_EXPORT
 
	gRªge
 {

36 
Rªge
() {}

37 
Rªge
(cÚ¡ 
Sliû
& 
s
, cÚ¡ Sliû& 
l
è: 
¡¬t
(s), 
lim™
(l) {}

39 
Sliû
 
	g¡¬t
;

40 
Sliû
 
	glim™
;

46 şas 
	cLEVELDB_EXPORT
 
	gDB
 {

47 
	gpublic
:

53 
Stus
 
O³n
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
¡d
::
¡ršg
& 
Çme
,

54 
DB
** 
db±r
);

56 
DB
() = ;

58 
DB
(cÚ¡ DB&èğ
d–‘e
;

59 
	gDB
& 
	gİ”©Ü
=(cÚ¡ 
DB
&èğ
d–‘e
;

61 
	gvœtu®
 ~
DB
();

66 
vœtu®
 
Stus
 
Put
(cÚ¡ 
Wr™eO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
key
,

67 cÚ¡ 
Sliû
& 
v®ue
) = 0;

73 
vœtu®
 
Stus
 
D–‘e
(cÚ¡ 
Wr™eO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
key
) = 0;

78 
vœtu®
 
Stus
 
Wr™e
(cÚ¡ 
Wr™eO±iÚs
& 
İtiÚs
, 
Wr™eB©ch
* 
upd©es
) = 0;

87 
vœtu®
 
Stus
 
G‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
key
,

88 
¡d
::
¡ršg
* 
v®ue
) = 0;

96 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
) = 0;

102 
vœtu®
 cÚ¡ 
SÇpshÙ
* 
G‘SÇpshÙ
() = 0;

106 
vœtu®
 
R–—£SÇpshÙ
(cÚ¡ 
SÇpshÙ
* 
¢­shÙ
) = 0;

124 
vœtu®
 
boŞ
 
G‘Prİ”ty
(cÚ¡ 
Sliû
& 
´İ”ty
, 
¡d
::
¡ršg
* 
v®ue
) = 0;

134 
vœtu®
 
G‘Aµroxim©eSizes
(cÚ¡ 
Rªge
* 
¿nge
, 
n
,

135 
ušt64_t
* 
sizes
) = 0;

147 
vœtu®
 
Com·ùRªge
(cÚ¡ 
Sliû
* 
begš
, cÚ¡ Sliû* 
’d
) = 0;

155 
LEVELDB_EXPORT
 
Stus
 
De¡royDB
(cÚ¡ 
¡d
::
¡ršg
& 
Çme
,

156 cÚ¡ 
O±iÚs
& 
İtiÚs
);

162 
LEVELDB_EXPORT
 
Stus
 
R•aœDB
(cÚ¡ 
¡d
::
¡ršg
& 
dbÇme
,

163 cÚ¡ 
O±iÚs
& 
İtiÚs
);

	@include/leveldb/dumpfile.h

5 #iâdeà
STORAGE_LEVELDB_INCLUDE_DUMPFILE_H_


6 
	#STORAGE_LEVELDB_INCLUDE_DUMPFILE_H_


	)

8 
	~<¡ršg
>

10 
	~"Ëv–db/’v.h
"

11 
	~"Ëv–db/expÜt.h
"

12 
	~"Ëv–db/¡©us.h
"

14 
Çme¥aû
 
	gËv–db
 {

23 
LEVELDB_EXPORT
 
Stus
 
DumpFe
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
,

24 
Wr™abËFe
* 
d¡
);

	@include/leveldb/env.h

13 #iâdeà
STORAGE_LEVELDB_INCLUDE_ENV_H_


14 
	#STORAGE_LEVELDB_INCLUDE_ENV_H_


	)

16 
	~<¡d¬g.h
>

17 
	~<¡dšt.h
>

19 
	~<¡ršg
>

20 
	~<veùÜ
>

22 
	~"Ëv–db/expÜt.h
"

23 
	~"Ëv–db/¡©us.h
"

25 #ià
defšed
(
_WIN32
)

40 #ià
defšed
(
D–‘eFe
)

41 #undeà
D–‘eFe


42 
	#LEVELDB_DELETEFILE_UNDEFINED


	)

46 
Çme¥aû
 
	gËv–db
 {

48 
şass
 
	gFeLock
;

49 
şass
 
	gLogg”
;

50 
şass
 
	gRªdomAcûssFe
;

51 
şass
 
	gSequ’tŸlFe
;

52 
şass
 
	gSliû
;

53 
şass
 
	gWr™abËFe
;

55 şas 
	cLEVELDB_EXPORT
 
	gEnv
 {

56 
	gpublic
:

57 
Env
() = ;

59 
Env
(cÚ¡ Env&èğ
d–‘e
;

60 
	gEnv
& 
	gİ”©Ü
=(cÚ¡ 
Env
&èğ
d–‘e
;

62 
	gvœtu®
 ~
Env
();

69 
Env
* 
DeçuÉ
();

78 
vœtu®
 
Stus
 
NewSequ’tŸlFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

79 
Sequ’tŸlFe
** 
»suÉ
) = 0;

89 
vœtu®
 
Stus
 
NewRªdomAcûssFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

90 
RªdomAcûssFe
** 
»suÉ
) = 0;

99 
vœtu®
 
Stus
 
NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

100 
Wr™abËFe
** 
»suÉ
) = 0;

114 
vœtu®
 
Stus
 
NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

115 
Wr™abËFe
** 
»suÉ
);

118 
vœtu®
 
boŞ
 
FeExi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
âame
) = 0;

123 
vœtu®
 
Stus
 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
dœ
,

124 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
»suÉ
) = 0;

127 
vœtu®
 
Stus
 
D–‘eFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
) = 0;

130 
vœtu®
 
Stus
 
C»©eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
dœÇme
) = 0;

133 
vœtu®
 
Stus
 
D–‘eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
dœÇme
) = 0;

136 
vœtu®
 
Stus
 
G‘FeSize
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
ušt64_t
* 
fe_size
) = 0;

139 
vœtu®
 
Stus
 
R’ameFe
(cÚ¡ 
¡d
::
¡ršg
& 
¤c
,

140 cÚ¡ 
¡d
::
¡ršg
& 
rg‘
) = 0;

156 
vœtu®
 
Stus
 
LockFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
FeLock
** 
lock
) = 0;

161 
vœtu®
 
Stus
 
UÆockFe
(
FeLock
* 
lock
) = 0;

169 
vœtu®
 
ScheduË
((*
funùiÚ
)(* 
¬g
), *‡rg) = 0;

173 
vœtu®
 
S¹Th»ad
((*
funùiÚ
)(* 
¬g
), *‡rg) = 0;

179 
vœtu®
 
Stus
 
G‘Te¡DœeùÜy
(
¡d
::
¡ršg
* 
·th
) = 0;

182 
vœtu®
 
Stus
 
NewLogg”
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Logg”
** 
»suÉ
) = 0;

186 
vœtu®
 
ušt64_t
 
NowMiüos
() = 0;

189 
vœtu®
 
SË•FÜMiüo£cÚds
(
miüos
) = 0;

193 şas 
	cLEVELDB_EXPORT
 
	gSequ’tŸlFe
 {

194 
	gpublic
:

195 
Sequ’tŸlFe
() = ;

197 
Sequ’tŸlFe
(cÚ¡ Sequ’tŸlFe&èğ
d–‘e
;

198 
	gSequ’tŸlFe
& 
	gİ”©Ü
=(cÚ¡ 
Sequ’tŸlFe
&èğ
d–‘e
;

200 
	gvœtu®
 ~
Sequ’tŸlFe
();

210 
vœtu®
 
Stus
 
R—d
(
size_t
 
n
, 
Sliû
* 
»suÉ
, * 
sü©ch
) = 0;

219 
vœtu®
 
Stus
 
Sk
(
ušt64_t
 
n
) = 0;

223 şas 
	cLEVELDB_EXPORT
 
	gRªdomAcûssFe
 {

224 
	gpublic
:

225 
RªdomAcûssFe
() = ;

227 
RªdomAcûssFe
(cÚ¡ RªdomAcûssFe&èğ
d–‘e
;

228 
	gRªdomAcûssFe
& 
	gİ”©Ü
=(cÚ¡ 
RªdomAcûssFe
&èğ
d–‘e
;

230 
	gvœtu®
 ~
RªdomAcûssFe
();

241 
vœtu®
 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

242 * 
sü©ch
) const = 0;

248 şas 
	cLEVELDB_EXPORT
 
	gWr™abËFe
 {

249 
	gpublic
:

250 
Wr™abËFe
() = ;

252 
Wr™abËFe
(cÚ¡ Wr™abËFe&èğ
d–‘e
;

253 
	gWr™abËFe
& 
	gİ”©Ü
=(cÚ¡ 
Wr™abËFe
&èğ
d–‘e
;

255 
	gvœtu®
 ~
Wr™abËFe
();

257 
vœtu®
 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
) = 0;

258 
vœtu®
 
Stus
 
Clo£
() = 0;

259 
vœtu®
 
Stus
 
Flush
() = 0;

260 
vœtu®
 
Stus
 
Sync
() = 0;

264 şas 
	cLEVELDB_EXPORT
 
	gLogg”
 {

265 
	gpublic
:

266 
Logg”
() = ;

268 
Logg”
(cÚ¡ Logg”&èğ
d–‘e
;

269 
	gLogg”
& 
	gİ”©Ü
=(cÚ¡ 
Logg”
&èğ
d–‘e
;

271 
	gvœtu®
 ~
Logg”
();

274 
vœtu®
 
Logv
(cÚ¡ * 
fÜm©
, 
va_li¡
 
­
) = 0;

278 şas 
	cLEVELDB_EXPORT
 
	gFeLock
 {

279 
	gpublic
:

280 
FeLock
() = ;

282 
FeLock
(cÚ¡ FeLock&èğ
d–‘e
;

283 
	gFeLock
& 
	gİ”©Ü
=(cÚ¡ 
FeLock
&èğ
d–‘e
;

285 
	gvœtu®
 ~
FeLock
();

289 
	$Log
(
Logg”
* 
šfo_log
, cÚ¡ * 
fÜm©
, ...)

290 #ià
	`defšed
(
__GNUC__
è|| 
	$defšed
(
__şªg__
)

291 
	`__©Œibu‹__
((
	$__fÜm©__
(
__´štf__
, 2, 3)))

296 
LEVELDB_EXPORT
 
Stus
 
	`Wr™eSŒšgToFe
(
Env
* 
’v
, cÚ¡ 
Sliû
& 
d©a
,

297 cÚ¡ 
¡d
::
¡ršg
& 
âame
);

300 
LEVELDB_EXPORT
 
Stus
 
	`R—dFeToSŒšg
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
,

301 
¡d
::
¡ršg
* 
d©a
);

306 şas 
	cLEVELDB_EXPORT
 
EnvW¿µ”
 : 
public
 
Env
 {

307 
public
:

309 
ex¶ic™
 
	`EnvW¿µ”
(
Env
* 
t
è: 
	`rg‘_
(t) {}

310 
vœtu®
 ~
	`EnvW¿µ”
();

313 
Env
* 
	`rg‘
(ècÚ¡ {  
rg‘_
; }

316 
Stus
 
	`NewSequ’tŸlFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
, 
Sequ’tŸlFe
** 
r
è
ov”ride
 {

317  
rg‘_
->
	`NewSequ’tŸlFe
(
f
, 
r
);

319 
Stus
 
	`NewRªdomAcûssFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
,

320 
RªdomAcûssFe
** 
r
è
ov”ride
 {

321  
rg‘_
->
	`NewRªdomAcûssFe
(
f
, 
r
);

323 
Stus
 
	`NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
, 
Wr™abËFe
** 
r
è
ov”ride
 {

324  
rg‘_
->
	`NewWr™abËFe
(
f
, 
r
);

326 
Stus
 
	`NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
, 
Wr™abËFe
** 
r
è
ov”ride
 {

327  
rg‘_
->
	`NewAµ’dabËFe
(
f
, 
r
);

329 
boŞ
 
	`FeExi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
f
è
ov”ride
 {

330  
rg‘_
->
	`FeExi¡s
(
f
);

332 
Stus
 
	`G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
dœ
,

333 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
r
è
ov”ride
 {

334  
rg‘_
->
	`G‘Chd»n
(
dœ
, 
r
);

336 
Stus
 
	`D–‘eFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
è
ov”ride
 {

337  
rg‘_
->
	`D–‘eFe
(
f
);

339 
Stus
 
	`C»©eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
d
è
ov”ride
 {

340  
rg‘_
->
	`C»©eDœ
(
d
);

342 
Stus
 
	`D–‘eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
d
è
ov”ride
 {

343  
rg‘_
->
	`D–‘eDœ
(
d
);

345 
Stus
 
	`G‘FeSize
(cÚ¡ 
¡d
::
¡ršg
& 
f
, 
ušt64_t
* 
s
è
ov”ride
 {

346  
rg‘_
->
	`G‘FeSize
(
f
, 
s
);

348 
Stus
 
	`R’ameFe
(cÚ¡ 
¡d
::
¡ršg
& 
s
, cÚ¡ std::¡ršg& 
t
è
ov”ride
 {

349  
rg‘_
->
	`R’ameFe
(
s
, 
t
);

351 
Stus
 
	`LockFe
(cÚ¡ 
¡d
::
¡ršg
& 
f
, 
FeLock
** 
l
è
ov”ride
 {

352  
rg‘_
->
	`LockFe
(
f
, 
l
);

354 
Stus
 
	`UÆockFe
(
FeLock
* 
l
è
ov”ride
 {  
rg‘_
->UnlockFile(l); }

355 
	`ScheduË
((*
f
)(*), * 
a
è
ov”ride
 {

356  
rg‘_
->
	`ScheduË
(
f
, 
a
);

358 
	`S¹Th»ad
((*
f
)(*), * 
a
è
ov”ride
 {

359  
rg‘_
->
	`S¹Th»ad
(
f
, 
a
);

361 
Stus
 
	`G‘Te¡DœeùÜy
(
¡d
::
¡ršg
* 
·th
è
ov”ride
 {

362  
rg‘_
->
	`G‘Te¡DœeùÜy
(
·th
);

364 
Stus
 
	`NewLogg”
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Logg”
** 
»suÉ
è
ov”ride
 {

365  
rg‘_
->
	`NewLogg”
(
âame
, 
»suÉ
);

367 
ušt64_t
 
	`NowMiüos
(è
ov”ride
 {  
rg‘_
->NowMicros(); }

368 
	`SË•FÜMiüo£cÚds
(
miüos
è
ov”ride
 {

369 
rg‘_
->
	`SË•FÜMiüo£cÚds
(
miüos
);

372 
´iv©e
:

373 
Env
* 
rg‘_
;

374 
	}
};

379 #ià
defšed
(
_WIN32
è&& defšed(
LEVELDB_DELETEFILE_UNDEFINED
)

380 #ià
defšed
(
UNICODE
)

381 
	#D–‘eFe
 
D–‘eFeW


	)

383 
	#D–‘eFe
 
D–‘eFeA


	)

	@include/leveldb/export.h

5 #iâdeà
STORAGE_LEVELDB_INCLUDE_EXPORT_H_


6 
	#STORAGE_LEVELDB_INCLUDE_EXPORT_H_


	)

8 #ià!
defšed
(
LEVELDB_EXPORT
)

10 #ià
defšed
(
LEVELDB_SHARED_LIBRARY
)

11 #ià
defšed
(
_WIN32
)

13 #ià
defšed
(
LEVELDB_COMPILE_LIBRARY
)

14 
	#LEVELDB_EXPORT
 
	`__deş¥ec
(
dÎexpÜt
)

	)

16 
	#LEVELDB_EXPORT
 
	`__deş¥ec
(
dÎimpÜt
)

	)

20 #ià
defšed
(
LEVELDB_COMPILE_LIBRARY
)

21 
	#LEVELDB_EXPORT
 
	`__©Œibu‹__
((
	`visib™y
("deçuÉ")))

	)

23 
	#LEVELDB_EXPORT


	)

28 
	#LEVELDB_EXPORT


	)

	@include/leveldb/filter_policy.h

16 #iâdeà
STORAGE_LEVELDB_INCLUDE_FILTER_POLICY_H_


17 
	#STORAGE_LEVELDB_INCLUDE_FILTER_POLICY_H_


	)

19 
	~<¡ršg
>

21 
	~"Ëv–db/expÜt.h
"

23 
Çme¥aû
 
	gËv–db
 {

25 
şass
 
	gSliû
;

27 şas 
	cLEVELDB_EXPORT
 
	gF‹rPŞicy
 {

28 
	gpublic
:

29 
vœtu®
 ~
F‹rPŞicy
();

35 
vœtu®
 cÚ¡ * 
Name
() const = 0;

43 
vœtu®
 
C»©eF‹r
(cÚ¡ 
Sliû
* 
keys
, 
n
,

44 
¡d
::
¡ršg
* 
d¡
) const = 0;

51 
vœtu®
 
boŞ
 
KeyMayM©ch
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
f‹r
) const = 0;

68 
LEVELDB_EXPORT
 cÚ¡ 
F‹rPŞicy
* 
NewBloomF‹rPŞicy
(
b™s_³r_key
);

	@include/leveldb/iterator.h

15 #iâdeà
STORAGE_LEVELDB_INCLUDE_ITERATOR_H_


16 
	#STORAGE_LEVELDB_INCLUDE_ITERATOR_H_


	)

18 
	~"Ëv–db/expÜt.h
"

19 
	~"Ëv–db/¦iû.h
"

20 
	~"Ëv–db/¡©us.h
"

22 
Çme¥aû
 
	gËv–db
 {

24 şas 
	cLEVELDB_EXPORT
 
	gI‹¿tÜ
 {

25 
	gpublic
:

26 
I‹¿tÜ
();

28 
I‹¿tÜ
(cÚ¡ I‹¿tÜ&èğ
d–‘e
;

29 
	gI‹¿tÜ
& 
	gİ”©Ü
=(cÚ¡ 
I‹¿tÜ
&èğ
d–‘e
;

31 
	gvœtu®
 ~
I‹¿tÜ
();

35 
vœtu®
 
boŞ
 
V®id
() const = 0;

39 
vœtu®
 
S“kToFœ¡
() = 0;

43 
vœtu®
 
S“kToLa¡
() = 0;

48 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
rg‘
) = 0;

53 
vœtu®
 
Next
() = 0;

58 
vœtu®
 
P»v
() = 0;

64 
vœtu®
 
Sliû
 
key
() const = 0;

70 
vœtu®
 
Sliû
 
v®ue
() const = 0;

73 
vœtu®
 
Stus
 
¡©us
() const = 0;

80 
usšg
 
	gCËªupFunùiÚ
 = (*)(* 
¬g1
, * 
	g¬g2
);

81 
Regi¡”CËªup
(
CËªupFunùiÚ
 
funùiÚ
, * 
¬g1
, * 
¬g2
);

83 
	g´iv©e
:

86 
	sCËªupNode
 {

88 
boŞ
 
IsEm±y
(ècÚ¡ {  
funùiÚ
 =ğ
nuÎ±r
; }

90 
Run
() {

91 
as£¹
(
funùiÚ
 !ğ
nuÎ±r
);

92 (*
	gfunùiÚ
)(
	g¬g1
, 
	g¬g2
);

96 
CËªupFunùiÚ
 
	gfunùiÚ
;

97 * 
	g¬g1
;

98 * 
	g¬g2
;

99 
CËªupNode
* 
	gÃxt
;

101 
CËªupNode
 
	gş—nup_h—d_
;

105 
LEVELDB_EXPORT
 
I‹¿tÜ
* 
NewEm±yI‹¿tÜ
();

108 
LEVELDB_EXPORT
 
I‹¿tÜ
* 
NewE¼ÜI‹¿tÜ
(cÚ¡ 
Stus
& 
¡©us
);

	@include/leveldb/options.h

5 #iâdeà
STORAGE_LEVELDB_INCLUDE_OPTIONS_H_


6 
	#STORAGE_LEVELDB_INCLUDE_OPTIONS_H_


	)

8 
	~<¡ddef.h
>

10 
	~"Ëv–db/expÜt.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 
şass
 
	gCache
;

15 
şass
 
	gCom·¿tÜ
;

16 
şass
 
	gEnv
;

17 
şass
 
	gF‹rPŞicy
;

18 
şass
 
	gLogg”
;

19 
şass
 
	gSÇpshÙ
;

25 
	eCom´essiÚTy³
 {

28 
	gkNoCom´essiÚ
 = 0x0,

29 
	gkSÇµyCom´essiÚ
 = 0x1

33 
LEVELDB_EXPORT
 
	gO±iÚs
 {

35 
O±iÚs
();

46 cÚ¡ 
Com·¿tÜ
* 
	gcom·¿tÜ
;

49 
boŞ
 
	gü—‹_if_missšg
 = 
çl£
;

52 
boŞ
 
	g”rÜ_if_exi¡s
 = 
çl£
;

59 
boŞ
 
	g·¿noid_checks
 = 
çl£
;

64 
Env
* 
	g’v
;

69 
Logg”
* 
	gšfo_log
 = 
nuÎ±r
;

82 
size_t
 
	gwr™e_bufãr_size
 = 4 * 1024 * 1024;

87 
	gmax_İ’_fes
 = 1000;

94 
Cache
* 
	gblock_ÿche
 = 
nuÎ±r
;

100 
size_t
 
	gblock_size
 = 4 * 1024;

105 
	gblock_»¡¬t_š‹rv®
 = 16;

115 
size_t
 
	gmax_fe_size
 = 2 * 1024 * 1024;

131 
Com´essiÚTy³
 
	gcom´essiÚ
 = 
kSÇµyCom´essiÚ
;

137 
boŞ
 
	g»u£_logs
 = 
çl£
;

142 cÚ¡ 
F‹rPŞicy
* 
	gf‹r_pŞicy
 = 
nuÎ±r
;

146 
LEVELDB_EXPORT
 
	gR—dO±iÚs
 {

147 
R—dO±iÚs
() = ;

151 
boŞ
 
	gv”ify_checksums
 = 
çl£
;

155 
boŞ
 
	gfl_ÿche
 = 
Œue
;

161 cÚ¡ 
SÇpshÙ
* 
	g¢­shÙ
 = 
nuÎ±r
;

165 
LEVELDB_EXPORT
 
	gWr™eO±iÚs
 {

166 
Wr™eO±iÚs
() = ;

182 
boŞ
 
	gsync
 = 
çl£
;

	@include/leveldb/slice.h

15 #iâdeà
STORAGE_LEVELDB_INCLUDE_SLICE_H_


16 
	#STORAGE_LEVELDB_INCLUDE_SLICE_H_


	)

18 
	~<as£¹.h
>

19 
	~<¡ddef.h
>

20 
	~<¡ršg.h
>

22 
	~<¡ršg
>

24 
	~"Ëv–db/expÜt.h
"

26 
Çme¥aû
 
	gËv–db
 {

28 şas 
	cLEVELDB_EXPORT
 
	gSliû
 {

29 
	gpublic
:

31 
Sliû
(è: 
d©a_
(""), 
size_
(0) {}

34 
Sliû
(cÚ¡ * 
d
, 
size_t
 
n
è: 
d©a_
(d), 
size_
(n) {}

37 
Sliû
(cÚ¡ 
¡d
::
¡ršg
& 
s
è: 
d©a_
(s.
d©a
()), 
size_
(s.
size
()) {}

40 
Sliû
(cÚ¡ * 
s
è: 
d©a_
(s), 
size_
(
¡¾’
(s)) {}

43 
Sliû
(const Slice&) = ;

44 
	gSliû
& 
	gİ”©Ü
=(cÚ¡ 
Sliû
&) = ;

47 cÚ¡ * 
d©a
(ècÚ¡ {  
	gd©a_
; }

50 
size_t
 
size
(ècÚ¡ {  
	gsize_
; }

53 
boŞ
 
em±y
(ècÚ¡ {  
	gsize_
 == 0; }

57 
	gİ”©Ü
[](
size_t
 
	gn
) const {

58 
as£¹
(
n
 < 
size
());

59  
	gd©a_
[
n
];

63 
ş—r
() {

64 
	gd©a_
 = "";

65 
	gsize_
 = 0;

69 
»move_´efix
(
size_t
 
n
) {

70 
as£¹
(
n
 <ğ
size
());

71 
	gd©a_
 +ğ
n
;

72 
	gsize_
 -ğ
n
;

76 
	g¡d
::
¡ršg
 
ToSŒšg
(ècÚ¡ {  
¡d
::¡ršg(
d©a_
, 
size_
); }

82 
com·»
(cÚ¡ 
Sliû
& 
b
) const;

85 
boŞ
 
¡¬ts_w™h
(cÚ¡ 
Sliû
& 
x
) const {

86  ((
	gsize_
 >ğ
x
.
size_
è&& (
memcmp
(
d©a_
, x.data_, x.size_) == 0));

89 
	g´iv©e
:

90 cÚ¡ * 
d©a_
;

91 
size_t
 
	gsize_
;

94 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Sliû
& 
x
, cÚ¡ 
	gSliû
& 
	gy
) {

95  ((
	gx
.
size
(è=ğ
y
.size()) &&

96 (
memcmp
(
x
.
d©a
(), 
y
.d©a(), x.
size
()) == 0));

99 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Sliû
& 
x
, cÚ¡ 
	gSliû
& 
	gy
è{  !(
	gx
 =ğ
y
); }

101 
šlše
 
	gSliû
::
	$com·»
(cÚ¡ 
Sliû
& 
b
) const {

102 cÚ¡ 
size_t
 
mš_Ën
 = (
size_
 < 
b
.size_) ? size_ : b.size_;

103 
r
 = 
	`memcmp
(
d©a_
, 
b
.d©a_, 
mš_Ën
);

104 ià(
r
 == 0) {

105 ià(
size_
 < 
b
.size_)

106 
r
 = -1;

107 ià(
size_
 > 
b
.size_)

108 
r
 = +1;

110  
r
;

111 
	}
}

	@include/leveldb/status.h

13 #iâdeà
STORAGE_LEVELDB_INCLUDE_STATUS_H_


14 
	#STORAGE_LEVELDB_INCLUDE_STATUS_H_


	)

16 
	~<®gÜ™hm
>

17 
	~<¡ršg
>

19 
	~"Ëv–db/expÜt.h
"

20 
	~"Ëv–db/¦iû.h
"

22 
Çme¥aû
 
	gËv–db
 {

24 şas 
	cLEVELDB_EXPORT
 
	gStus
 {

25 
	gpublic
:

27 
Stus
(è
nÛxû±
 : 
¡©e_
(
nuÎ±r
) {}

28 ~
Stus
(è{ 
d–‘e
[] 
¡©e_
; }

30 
Stus
(cÚ¡ Stus& 
rhs
);

31 
	gStus
& 
	gİ”©Ü
=(cÚ¡ 
Stus
& 
rhs
);

33 
Stus
(Stus&& 
rhs
è
	gnÛxû±
 : 
¡©e_
Ôhs.¡©e_è{„hs.¡©e_ = 
nuÎ±r
; }

34 
	gStus
& 
	gİ”©Ü
=(
Stus
&& 
rhs
è
nÛxû±
;

37 
Stus
 
OK
() {  Status(); }

40 
Stus
 
NÙFound
(cÚ¡ 
Sliû
& 
msg
, cÚ¡ Sliû& 
msg2
 = Slice()) {

41  
Stus
(
kNÙFound
, 
msg
, 
msg2
);

43 
Stus
 
CÜru±iÚ
(cÚ¡ 
Sliû
& 
msg
, cÚ¡ Sliû& 
msg2
 = Slice()) {

44  
Stus
(
kCÜru±iÚ
, 
msg
, 
msg2
);

46 
Stus
 
NÙSuµÜ‹d
(cÚ¡ 
Sliû
& 
msg
, cÚ¡ Sliû& 
msg2
 = Slice()) {

47  
Stus
(
kNÙSuµÜ‹d
, 
msg
, 
msg2
);

49 
Stus
 
Inv®idArgum’t
(cÚ¡ 
Sliû
& 
msg
, cÚ¡ Sliû& 
msg2
 = Slice()) {

50  
Stus
(
kInv®idArgum’t
, 
msg
, 
msg2
);

52 
Stus
 
IOE¼Ü
(cÚ¡ 
Sliû
& 
msg
, cÚ¡ Sliû& 
msg2
 = Slice()) {

53  
Stus
(
kIOE¼Ü
, 
msg
, 
msg2
);

57 
boŞ
 
ok
(ècÚ¡ {  (
	g¡©e_
 =ğ
nuÎ±r
); }

60 
boŞ
 
IsNÙFound
(ècÚ¡ {  
code
(è=ğ
kNÙFound
; }

63 
boŞ
 
IsCÜru±iÚ
(ècÚ¡ {  
code
(è=ğ
kCÜru±iÚ
; }

66 
boŞ
 
IsIOE¼Ü
(ècÚ¡ {  
code
(è=ğ
kIOE¼Ü
; }

69 
boŞ
 
IsNÙSuµÜ‹dE¼Ü
(ècÚ¡ {  
code
(è=ğ
kNÙSuµÜ‹d
; }

72 
boŞ
 
IsInv®idArgum’t
(ècÚ¡ {  
code
(è=ğ
kInv®idArgum’t
; }

76 
	g¡d
::
¡ršg
 
ToSŒšg
() const;

78 
	g´iv©e
:

79 
	eCode
 {

80 
kOk
 = 0,

81 
	gkNÙFound
 = 1,

82 
	gkCÜru±iÚ
 = 2,

83 
	gkNÙSuµÜ‹d
 = 3,

84 
	gkInv®idArgum’t
 = 4,

85 
	gkIOE¼Ü
 = 5

88 
Code
 
code
() const {

89  (
	g¡©e_
 =ğ
nuÎ±r
è? 
kOk
 : 
¡©ic_ÿ¡
<
Code
>(
¡©e_
[4]);

92 
Stus
(
Code
 
code
, cÚ¡ 
Sliû
& 
msg
, cÚ¡ Sliû& 
msg2
);

93 cÚ¡ * 
CİyS‹
(cÚ¡ * 
s
);

100 cÚ¡ * 
	g¡©e_
;

103 
šlše
 
	gStus
::
	$Stus
(cÚ¡ 
Stus
& 
rhs
) {

104 
¡©e_
 = (
rhs
.¡©e_ =ğ
nuÎ±r
è?‚uÎ±¸: 
	`CİyS‹
(rhs.state_);

105 
	}
}

106 
šlše
 
	gStus
& Stus::
İ”©Ü
=(cÚ¡ 
Stus
& 
rhs
) {

109 ià(
¡©e_
 !ğ
rhs
.state_) {

110 
d–‘e
[] 
¡©e_
;

111 
	g¡©e_
 = (
rhs
.
¡©e_
 =ğ
nuÎ±r
è?‚uÎ±¸: 
CİyS‹
(rhs.state_);

113  *
	gthis
;

115 
šlše
 
	gStus
& Stus::
İ”©Ü
=(
Stus
&& 
rhs
è
nÛxû±
 {

116 
¡d
::
sw­
(
¡©e_
, 
rhs
.state_);

117  *
	gthis
;

	@include/leveldb/table.h

5 #iâdeà
STORAGE_LEVELDB_INCLUDE_TABLE_H_


6 
	#STORAGE_LEVELDB_INCLUDE_TABLE_H_


	)

8 
	~<¡dšt.h
>

10 
	~"Ëv–db/expÜt.h
"

11 
	~"Ëv–db/™”©Ü.h
"

13 
Çme¥aû
 
	gËv–db
 {

15 
şass
 
	gBlock
;

16 
şass
 
	gBlockHªdË
;

17 
şass
 
	gFoÙ”
;

18 
	gO±iÚs
;

19 
şass
 
	gRªdomAcûssFe
;

20 
	gR—dO±iÚs
;

21 
şass
 
	gTabËCache
;

26 şas 
	cLEVELDB_EXPORT
 
	gTabË
 {

27 
	gpublic
:

40 
Stus
 
O³n
(cÚ¡ 
O±iÚs
& 
İtiÚs
, 
RªdomAcûssFe
* 
fe
,

41 
ušt64_t
 
fe_size
, 
TabË
** 
bË
);

43 
TabË
(cÚ¡ TabË&èğ
d–‘e
;

44 
	gTabË
& 
	gİ”©Ü
=(cÚ¡ 
TabË
&èğ
d–‘e
;

46 ~
TabË
();

51 
I‹¿tÜ
* 
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
&) const;

59 
ušt64_t
 
Aµroxim©eOff£tOf
(cÚ¡ 
Sliû
& 
key
) const;

61 
	g´iv©e
:

62 
ä›nd
 
şass
 
TabËCache
;

63 
	gR•
;

65 
I‹¿tÜ
* 
BlockR—d”
(*, cÚ¡ 
R—dO±iÚs
&, cÚ¡ 
Sliû
&);

67 
ex¶ic™
 
TabË
(
R•
* 
»p
è: 
»p_
(rep) {}

72 
Stus
 
IÁ”ÇlG‘
(cÚ¡ 
R—dO±iÚs
&, cÚ¡ 
Sliû
& 
key
, * 
¬g
,

73 (*
hªdË_»suÉ
)(* 
¬g
, cÚ¡ 
Sliû
& 
k
,

74 cÚ¡ 
Sliû
& 
v
));

76 
R—dM‘a
(cÚ¡ 
FoÙ”
& 
foÙ”
);

77 
R—dF‹r
(cÚ¡ 
Sliû
& 
f‹r_hªdË_v®ue
);

79 
R•
* cÚ¡ 
	g»p_
;

	@include/leveldb/table_builder.h

13 #iâdeà
STORAGE_LEVELDB_INCLUDE_TABLE_BUILDER_H_


14 
	#STORAGE_LEVELDB_INCLUDE_TABLE_BUILDER_H_


	)

16 
	~<¡dšt.h
>

18 
	~"Ëv–db/expÜt.h
"

19 
	~"Ëv–db/İtiÚs.h
"

20 
	~"Ëv–db/¡©us.h
"

22 
Çme¥aû
 
	gËv–db
 {

24 
şass
 
	gBlockBud”
;

25 
şass
 
	gBlockHªdË
;

26 
şass
 
	gWr™abËFe
;

28 şas 
	cLEVELDB_EXPORT
 
	gTabËBud”
 {

29 
	gpublic
:

33 
TabËBud”
(cÚ¡ 
O±iÚs
& 
İtiÚs
, 
Wr™abËFe
* 
fe
);

35 
TabËBud”
(cÚ¡ TabËBud”&èğ
d–‘e
;

36 
	gTabËBud”
& 
	gİ”©Ü
=(cÚ¡ 
TabËBud”
&èğ
d–‘e
;

39 ~
TabËBud”
();

47 
Stus
 
ChªgeO±iÚs
(cÚ¡ 
O±iÚs
& 
İtiÚs
);

52 
Add
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
);

58 
Flush
();

61 
Stus
 
¡©us
() const;

66 
Stus
 
Fšish
();

73 
AbªdÚ
();

76 
ušt64_t
 
NumEÁr›s
() const;

80 
ušt64_t
 
FeSize
() const;

82 
	g´iv©e
:

83 
boŞ
 
ok
(ècÚ¡ {  
¡©us
().ok(); }

84 
Wr™eBlock
(
BlockBud”
* 
block
, 
BlockHªdË
* 
hªdË
);

85 
Wr™eRawBlock
(cÚ¡ 
Sliû
& 
d©a
, 
Com´essiÚTy³
, 
BlockHªdË
* 
hªdË
);

87 
	gR•
;

88 
R•
* 
	g»p_
;

	@include/leveldb/write_batch.h

21 #iâdeà
STORAGE_LEVELDB_INCLUDE_WRITE_BATCH_H_


22 
	#STORAGE_LEVELDB_INCLUDE_WRITE_BATCH_H_


	)

24 
	~<¡ršg
>

26 
	~"Ëv–db/expÜt.h
"

27 
	~"Ëv–db/¡©us.h
"

29 
Çme¥aû
 
	gËv–db
 {

31 
şass
 
	gSliû
;

33 şas 
	cLEVELDB_EXPORT
 
	gWr™eB©ch
 {

34 
	gpublic
:

35 şas 
	cLEVELDB_EXPORT
 
HªdËr
 {

36 
public
:

37 
vœtu®
 ~
HªdËr
();

38 
vœtu®
 
Put
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) = 0;

39 
vœtu®
 
D–‘e
(cÚ¡ 
Sliû
& 
key
) = 0;

42 
Wr™eB©ch
();

45 
Wr™eB©ch
(const WriteBatch&) = ;

46 
	gWr™eB©ch
& 
	gİ”©Ü
=(cÚ¡ 
Wr™eB©ch
&) = ;

48 ~
Wr™eB©ch
();

51 
Put
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
);

54 
D–‘e
(cÚ¡ 
Sliû
& 
key
);

57 
CË¬
();

63 
size_t
 
Aµroxim©eSize
() const;

70 
Aµ’d
(cÚ¡ 
Wr™eB©ch
& 
sourû
);

73 
Stus
 
I‹¿‹
(
HªdËr
* 
hªdËr
) const;

75 
	g´iv©e
:

76 
ä›nd
 
şass
 
Wr™eB©chIÁ”Çl
;

78 
	g¡d
::
¡ršg
 
»p_
;

	@issues/issue178_test.cc

6 
	~<c¡dlib
>

7 
	~<io¡»am
>

8 
	~<s¡»am
>

10 
	~"Ëv–db/db.h
"

11 
	~"Ëv–db/wr™e_b©ch.h
"

12 
	~"ut/‹¡h¬Ãss.h
"

14 
	gÇme¥aû
 {

16 cÚ¡ 
	gkNumKeys
 = 1100000;

18 
	g¡d
::
¡ršg
 
Key1
(
i
) {

19 
buf
[100];

20 
¢´štf
(
buf
, (buf), "my_key_%d", 
i
);

21  
	gbuf
;

24 
	g¡d
::
¡ršg
 
Key2
(
i
è{  
Key1
(i) + "_xxx"; }

26 şas 
	cIssue178
 {};

28 
	$TEST
(
Issue178
, 
Te¡
) {

30 
¡d
::
¡ršg
 
db·th
 = 
Ëv–db
::
‹¡
::
	`TmpDœ
() + "/leveldb_cbug_test";

31 
	`De¡royDB
(
db·th
, 
Ëv–db
::
	`O±iÚs
());

36 
Ëv–db
::
DB
* 
db
;

37 
Ëv–db
::
O±iÚs
 
db_İtiÚs
;

38 
db_İtiÚs
.
ü—‹_if_missšg
 = 
Œue
;

39 
db_İtiÚs
.
com´essiÚ
 = 
Ëv–db
::
kNoCom´essiÚ
;

40 
	`ASSERT_OK
(
Ëv–db
::
DB
::
	`O³n
(
db_İtiÚs
, 
db·th
, &
db
));

43 
Ëv–db
::
Wr™eB©ch
 
b©ch
;

44 
size_t
 
i
 = 0; i < 
kNumKeys
; i++) {

45 
b©ch
.
	`Put
(
	`Key1
(
i
), "value for„ange 1 key");

47 
	`ASSERT_OK
(
db
->
	`Wr™e
(
Ëv–db
::
	`Wr™eO±iÚs
(), &
b©ch
));

50 
b©ch
.
	`CË¬
();

51 
size_t
 
i
 = 0; i < 
kNumKeys
; i++) {

52 
b©ch
.
	`Put
(
	`Key2
(
i
), "value for„ange 2 key");

54 
	`ASSERT_OK
(
db
->
	`Wr™e
(
Ëv–db
::
	`Wr™eO±iÚs
(), &
b©ch
));

57 
b©ch
.
	`CË¬
();

58 
size_t
 
i
 = 0; i < 
kNumKeys
; i++) {

59 
b©ch
.
	`D–‘e
(
	`Key2
(
i
));

61 
	`ASSERT_OK
(
db
->
	`Wr™e
(
Ëv–db
::
	`Wr™eO±iÚs
(), &
b©ch
));

64 
¡d
::
¡ršg
 
¡¬t_key
 = 
	`Key1
(0);

65 
¡d
::
¡ršg
 
’d_key
 = 
	`Key1
(
kNumKeys
 - 1);

66 
Ëv–db
::
Sliû
 
	`Ëa¡
(
¡¬t_key
.
	`d©a
(), s¹_key.
	`size
());

67 
Ëv–db
::
Sliû
 
	`g»©e¡
(
’d_key
.
	`d©a
(),ƒnd_key.
	`size
());

70 
db
->
	`Com·ùRªge
(&
Ëa¡
, &
g»©e¡
);

73 
Ëv–db
::
I‹¿tÜ
* 
™”
 = 
db
->
	`NewI‹¿tÜ
Öev–db::
	`R—dO±iÚs
());

74 
size_t
 
num_keys
 = 0;

75 
™”
->
	`S“kToFœ¡
(); i‹r->
	`V®id
(); i‹r->
	`Next
()) {

76 
num_keys
++;

78 
d–‘e
 
™”
;

79 
	`ASSERT_EQ
(
kNumKeys
, 
num_keys
) << "Bad‚umber of keys";

82 
d–‘e
 
db
;

83 
	`De¡royDB
(
db·th
, 
Ëv–db
::
	`O±iÚs
());

84 
	}
}

88 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@issues/issue200_test.cc

9 
	~"Ëv–db/db.h
"

10 
	~"ut/‹¡h¬Ãss.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 şas 
	cIssue200
 {};

16 
	$TEST
(
Issue200
, 
Te¡
) {

18 
¡d
::
¡ršg
 
db·th
 = 
‹¡
::
	`TmpDœ
() + "/leveldb_issue200_test";

19 
	`De¡royDB
(
db·th
, 
	`O±iÚs
());

21 
DB
* 
db
;

22 
O±iÚs
 
İtiÚs
;

23 
İtiÚs
.
ü—‹_if_missšg
 = 
Œue
;

24 
	`ASSERT_OK
(
DB
::
	`O³n
(
İtiÚs
, 
db·th
, &
db
));

26 
Wr™eO±iÚs
 
wr™e_İtiÚs
;

27 
	`ASSERT_OK
(
db
->
	`Put
(
wr™e_İtiÚs
, "1", "b"));

28 
	`ASSERT_OK
(
db
->
	`Put
(
wr™e_İtiÚs
, "2", "c"));

29 
	`ASSERT_OK
(
db
->
	`Put
(
wr™e_İtiÚs
, "3", "d"));

30 
	`ASSERT_OK
(
db
->
	`Put
(
wr™e_İtiÚs
, "4", "e"));

31 
	`ASSERT_OK
(
db
->
	`Put
(
wr™e_İtiÚs
, "5", "f"));

33 
R—dO±iÚs
 
»ad_İtiÚs
;

34 
I‹¿tÜ
* 
™”
 = 
db
->
	`NewI‹¿tÜ
(
»ad_İtiÚs
);

37 
	`ASSERT_OK
(
db
->
	`Put
(
wr™e_İtiÚs
, "25", "cd"));

39 
™”
->
	`S“k
("5");

40 
	`ASSERT_EQ
(
™”
->
	`key
().
	`ToSŒšg
(), "5");

41 
™”
->
	`P»v
();

42 
	`ASSERT_EQ
(
™”
->
	`key
().
	`ToSŒšg
(), "4");

43 
™”
->
	`P»v
();

44 
	`ASSERT_EQ
(
™”
->
	`key
().
	`ToSŒšg
(), "3");

45 
™”
->
	`Next
();

46 
	`ASSERT_EQ
(
™”
->
	`key
().
	`ToSŒšg
(), "4");

47 
™”
->
	`Next
();

48 
	`ASSERT_EQ
(
™”
->
	`key
().
	`ToSŒšg
(), "5");

50 
d–‘e
 
™”
;

51 
d–‘e
 
db
;

52 
	`De¡royDB
(
db·th
, 
İtiÚs
);

53 
	}
}

57 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@issues/issue320_test.cc

5 
	~<c¡dšt
>

6 
	~<c¡dlib
>

7 
	~<io¡»am
>

8 
	~<memÜy
>

9 
	~<¡ršg
>

10 
	~<veùÜ
>

12 
	~"Ëv–db/db.h
"

13 
	~"Ëv–db/wr™e_b©ch.h
"

14 
	~"ut/‹¡h¬Ãss.h
"

16 
Çme¥aû
 
	gËv–db
 {

18 
	gÇme¥aû
 {

21 
G’”©eRªdomNumb”
(
max
è{  
	g¡d
::
¿nd
() % max; }

23 
	g¡d
::
¡ršg
 
C»©eRªdomSŒšg
(
št32_t
 
šdex
) {

24 cÚ¡ 
size_t
 
Ën
 = 1024;

25 
	gby‹s
[
Ën
];

26 
size_t
 
	gi
 = 0;

27 
	gi
 < 8) {

28 
	gby‹s
[
i
] = 'a' + ((
šdex
 >> (4 * i)) & 0xf);

29 ++
	gi
;

31 
	gi
 < (
	gby‹s
)) {

32 
	gby‹s
[
i
] = 'a' + 
G’”©eRªdomNumb”
(26);

33 ++
	gi
;

35  
	g¡d
::
¡ršg
(
by‹s
, (bytes));

40 şas 
	cIssue320
 {};

42 
	$TEST
(
Issue320
, 
Te¡
) {

43 
¡d
::
	`¤ªd
(0);

45 
boŞ
 
d–‘e_befÜe_put
 = 
çl£
;

46 
boŞ
 
k“p_¢­shÙs
 = 
Œue
;

48 
¡d
::
veùÜ
<¡d::
unique_±r
<¡d::
·œ
<¡d::
¡ršg
, std::¡ršg>>> 
	`‹¡_m­
(

50 
¡d
::
veùÜ
<
SÇpshÙ
 cÚ¡*> 
	`¢­shÙs
(100, 
nuÎ±r
);

52 
DB
* 
db
;

53 
O±iÚs
 
İtiÚs
;

54 
İtiÚs
.
ü—‹_if_missšg
 = 
Œue
;

56 
¡d
::
¡ršg
 
db·th
 = 
‹¡
::
	`TmpDœ
() + "/leveldb_issue320_test";

57 
	`ASSERT_OK
(
DB
::
	`O³n
(
İtiÚs
, 
db·th
, &
db
));

59 
ušt32_t
 
rg‘_size
 = 10000;

60 
ušt32_t
 
num_™ems
 = 0;

61 
ušt32_t
 
couÁ
 = 0;

62 
¡d
::
¡ršg
 
key
;

63 
¡d
::
¡ršg
 
v®ue
, 
Şd_v®ue
;

65 
Wr™eO±iÚs
 
wr™eO±iÚs
;

66 
R—dO±iÚs
 
»adO±iÚs
;

67 
couÁ
 < 200000) {

68 ià((++
couÁ
 % 1000) == 0) {

69 
¡d
::
cout
 << "couÁ: " << 
couÁ
 << std::
’dl
;

72 
šdex
 = 
	`G’”©eRªdomNumb”
(
‹¡_m­
.
	`size
());

73 
Wr™eB©ch
 
b©ch
;

75 ià(
‹¡_m­
[
šdex
] =ğ
nuÎ±r
) {

76 
num_™ems
++;

77 
‹¡_m­
[
šdex
].
	`»£t
(
Ãw
 
¡d
::
·œ
<¡d::
¡ršg
, std::string>(

78 
	`C»©eRªdomSŒšg
(
šdex
), CreateRandomString(index)));

79 
b©ch
.
	`Put
(
‹¡_m­
[
šdex
]->
fœ¡
,e¡_m­[šdex]->
£cÚd
);

81 
	`ASSERT_OK
(
db
->
	`G‘
(
»adO±iÚs
, 
‹¡_m­
[
šdex
]->
fœ¡
, &
Şd_v®ue
));

82 ià(
Şd_v®ue
 !ğ
‹¡_m­
[
šdex
]->
£cÚd
) {

83 
¡d
::
cout
 << "ERROR incÜ»ù v®u»tuºed by G‘" << std::
’dl
;

84 
¡d
::
cout
 << " couÁ=" << 
couÁ
 << std::
’dl
;

85 
¡d
::
cout
 << " old v®ue=" << 
Şd_v®ue
 << std::
’dl
;

86 
¡d
::
cout
 << "e¡_m­[šdex]->£cÚd=" << 
‹¡_m­
[
šdex
]->
£cÚd


87 << 
¡d
::
’dl
;

88 
¡d
::
cout
 << "e¡_m­[šdex]->fœ¡=" << 
‹¡_m­
[
šdex
]->
fœ¡


89 << 
¡d
::
’dl
;

90 
¡d
::
cout
 << " index=" << 
šdex
 << std::
’dl
;

91 
	`ASSERT_EQ
(
Şd_v®ue
, 
‹¡_m­
[
šdex
]->
£cÚd
);

94 ià(
num_™ems
 >ğ
rg‘_size
 && 
	`G’”©eRªdomNumb”
(100) > 30) {

95 
b©ch
.
	`D–‘e
(
‹¡_m­
[
šdex
]->
fœ¡
);

96 
‹¡_m­
[
šdex
] = 
nuÎ±r
;

97 --
num_™ems
;

99 
‹¡_m­
[
šdex
]->
£cÚd
 = 
	`C»©eRªdomSŒšg
(index);

100 ià(
d–‘e_befÜe_put
è
b©ch
.
	`D–‘e
(
‹¡_m­
[
šdex
]->
fœ¡
);

101 
b©ch
.
	`Put
(
‹¡_m­
[
šdex
]->
fœ¡
,e¡_m­[šdex]->
£cÚd
);

105 
	`ASSERT_OK
(
db
->
	`Wr™e
(
wr™eO±iÚs
, &
b©ch
));

107 ià(
k“p_¢­shÙs
 && 
	`G’”©eRªdomNumb”
(10) == 0) {

108 
i
 = 
	`G’”©eRªdomNumb”
(
¢­shÙs
.
	`size
());

109 ià(
¢­shÙs
[
i
] !ğ
nuÎ±r
) {

110 
db
->
	`R–—£SÇpshÙ
(
¢­shÙs
[
i
]);

112 
¢­shÙs
[
i
] = 
db
->
	`G‘SÇpshÙ
();

116 
SÇpshÙ
 cÚ¡* 
¢­shÙ
 : 
¢­shÙs
) {

117 ià(
¢­shÙ
) {

118 
db
->
	`R–—£SÇpshÙ
(
¢­shÙ
);

122 
d–‘e
 
db
;

123 
	`De¡royDB
(
db·th
, 
İtiÚs
);

124 
	}
}

128 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@port/port.h

5 #iâdeà
STORAGE_LEVELDB_PORT_PORT_H_


6 
	#STORAGE_LEVELDB_PORT_PORT_H_


	)

8 
	~<¡ršg.h
>

13 #ià
defšed
(
LEVELDB_PLATFORM_POSIX
è|| defšed(
LEVELDB_PLATFORM_WINDOWS
)

14 
	~"pÜt/pÜt_¡dcxx.h
"

15 #–ià
defšed
(
LEVELDB_PLATFORM_CHROMIUM
)

16 
	~"pÜt/pÜt_chromium.h
"

	@port/port_example.h

10 #iâdeà
STORAGE_LEVELDB_PORT_PORT_EXAMPLE_H_


11 
	#STORAGE_LEVELDB_PORT_PORT_EXAMPLE_H_


	)

13 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

15 
Çme¥aû
 
	gËv–db
 {

16 
Çme¥aû
 
	gpÜt
 {

23 cÚ¡ 
boŞ
 
	gkL™eEndŸn
 = 
Œue
 ;

28 şas 
	cLOCKABLE
 
	gMu‹x
 {

29 
	gpublic
:

30 
Mu‹x
();

31 ~
Mu‹x
();

35 
Lock
(è
EXCLUSIVE_LOCK_FUNCTION
();

39 
UÆock
(è
UNLOCK_FUNCTION
();

44 
As£¹H–d
(è
ASSERT_EXCLUSIVE_LOCK
();

47 şas 
	cCÚdV¬
 {

48 
	gpublic
:

49 
ex¶ic™
 
CÚdV¬
(
Mu‹x
* 
mu
);

50 ~
CÚdV¬
();

56 
Wa™
();

59 
SigÇl
();

62 
SigÇÎAÎ
();

69 
boŞ
 
SÇµy_Com´ess
(cÚ¡ * 
šput
, 
size_t
 
šput_Ëngth
,

70 
¡d
::
¡ršg
* 
ouut
);

75 
boŞ
 
SÇµy_G‘Uncom´es£dL’gth
(cÚ¡ * 
šput
, 
size_t
 
Ëngth
,

76 
size_t
* 
»suÉ
);

85 
boŞ
 
SÇµy_Uncom´ess
(cÚ¡ * 
šput_d©a
, 
size_t
 
šput_Ëngth
,

86 * 
ouut
);

93 
boŞ
 
G‘H—pProfe
((*
func
)(*, cÚ¡ *, ), * 
¬g
);

99 
ušt32_t
 
AcûË¿‹dCRC32C
(ušt32_ˆ
üc
, cÚ¡ * 
buf
, 
size_t
 
size
);

	@port/port_stdcxx.h

5 #iâdeà
STORAGE_LEVELDB_PORT_PORT_STDCXX_H_


6 
	#STORAGE_LEVELDB_PORT_PORT_STDCXX_H_


	)

11 #ià
defšed
(
LEVELDB_HAS_PORT_CONFIG_H
)

13 #ià
LEVELDB_HAS_PORT_CONFIG_H


14 
	~"pÜt/pÜt_cÚfig.h
"

17 #–ià
defšed
(
__has_šşude
)

19 #ià
__has_šşude
("port/port_config.h")

20 
	~"pÜt/pÜt_cÚfig.h
"

25 #ià
HAVE_CRC32C


26 
	~<üc32c/üc32c.h
>

28 #ià
HAVE_SNAPPY


29 
	~<¢­py.h
>

32 
	~<ÿs£¹
>

33 
	~<cÚd™iÚ_v¬ŸbË
>

34 
	~<c¡ddef
>

35 
	~<c¡dšt
>

36 
	~<mu‹x
>

37 
	~<¡ršg
>

39 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

41 
Çme¥aû
 
	gËv–db
 {

42 
Çme¥aû
 
	gpÜt
 {

44 cÚ¡ 
boŞ
 
	gkL™eEndŸn
 = !
LEVELDB_IS_BIG_ENDIAN
;

46 
şass
 
	gCÚdV¬
;

49 şas 
	cLOCKABLE
 
	gMu‹x
 {

50 
	gpublic
:

51 
Mu‹x
() = ;

52 ~
Mu‹x
() = ;

54 
Mu‹x
(cÚ¡ Mu‹x&èğ
d–‘e
;

55 
	gMu‹x
& 
	gİ”©Ü
=(cÚ¡ 
Mu‹x
&èğ
d–‘e
;

57 
Lock
(è
EXCLUSIVE_LOCK_FUNCTION
(è{ 
	gmu_
.
lock
(); }

58 
UÆock
(è
UNLOCK_FUNCTION
(è{ 
	gmu_
.
uÆock
(); }

59 
As£¹H–d
(è
ASSERT_EXCLUSIVE_LOCK
() {}

61 
	g´iv©e
:

62 
ä›nd
 
şass
 
CÚdV¬
;

63 
	g¡d
::
mu‹x
 
mu_
;

67 şas 
	cCÚdV¬
 {

68 
	gpublic
:

69 
ex¶ic™
 
CÚdV¬
(
Mu‹x
* 
mu
è: 
mu_
(muè{ 
as£¹
(mu !ğ
nuÎ±r
); }

70 ~
CÚdV¬
() = ;

72 
CÚdV¬
(cÚ¡ CÚdV¬&èğ
d–‘e
;

73 
	gCÚdV¬
& 
	gİ”©Ü
=(cÚ¡ 
CÚdV¬
&èğ
d–‘e
;

75 
Wa™
() {

76 
	g¡d
::
unique_lock
<
¡d
::
mu‹x
> 
lock
(
mu_
->mu_, std::
adİt_lock
);

77 
	gcv_
.
wa™
(
lock
);

78 
	glock
.
»Ëa£
();

80 
SigÇl
(è{ 
	gcv_
.
nÙify_Úe
(); }

81 
SigÇlAÎ
(è{ 
	gcv_
.
nÙify_®l
(); }

83 
	g´iv©e
:

84 
¡d
::
cÚd™iÚ_v¬ŸbË
 
cv_
;

85 
Mu‹x
* cÚ¡ 
	gmu_
;

88 
šlše
 
boŞ
 
SÇµy_Com´ess
(cÚ¡ * 
šput
, 
size_t
 
Ëngth
,

89 
¡d
::
¡ršg
* 
ouut
) {

90 #ià
HAVE_SNAPPY


91 
ouut
->
»size
(
¢­py
::
MaxCom´es£dL’gth
(
Ëngth
));

92 
size_t
 
	gou’
;

93 
	g¢­py
::
RawCom´ess
(
šput
, 
Ëngth
, &(*
ouut
)[0], &
ou’
);

94 
	gouut
->
»size
(
ou’
);

95  
	gŒue
;

98 ()
	gšput
;

99 ()
	gËngth
;

100 ()
	gouut
;

103  
	gçl£
;

106 
šlše
 
boŞ
 
SÇµy_G‘Uncom´es£dL’gth
(cÚ¡ * 
šput
, 
size_t
 
Ëngth
,

107 
size_t
* 
»suÉ
) {

108 #ià
HAVE_SNAPPY


109  
	g¢­py
::
G‘Uncom´es£dL’gth
(
šput
, 
Ëngth
, 
»suÉ
);

112 ()
	gšput
;

113 ()
	gËngth
;

114 ()
	g»suÉ
;

115  
	gçl£
;

119 
šlše
 
boŞ
 
SÇµy_Uncom´ess
(cÚ¡ * 
šput
, 
size_t
 
Ëngth
, * 
ouut
) {

120 #ià
HAVE_SNAPPY


121  
	g¢­py
::
RawUncom´ess
(
šput
, 
Ëngth
, 
ouut
);

124 ()
	gšput
;

125 ()
	gËngth
;

126 ()
	gouut
;

127  
	gçl£
;

131 
šlše
 
boŞ
 
G‘H—pProfe
((*
func
)(*, cÚ¡ *, ), * 
¬g
) {

133 ()
	gfunc
;

134 ()
	g¬g
;

135  
	gçl£
;

138 
šlše
 
ušt32_t
 
AcûË¿‹dCRC32C
(ušt32_ˆ
üc
, cÚ¡ * 
buf
, 
size_t
 
size
) {

139 #ià
HAVE_CRC32C


140  ::
üc32c
::
Ex‹nd
(
üc
, 
»š‹½»t_ÿ¡
<cÚ¡ 
ušt8_t
*>(
buf
), 
size
);

143 ()
	güc
;

144 ()
	gbuf
;

145 ()
	gsize
;

	@port/thread_annotations.h

5 #iâdeà
STORAGE_LEVELDB_PORT_THREAD_ANNOTATIONS_H_


6 
	#STORAGE_LEVELDB_PORT_THREAD_ANNOTATIONS_H_


	)

12 #ià!
defšed
(
THREAD_ANNOTATION_ATTRIBUTE__
)

14 #ià
defšed
(
__şªg__
)

16 
	#THREAD_ANNOTATION_ATTRIBUTE__
(
x
è
	`__©Œibu‹__
((x))

	)

18 
	#THREAD_ANNOTATION_ATTRIBUTE__
(
x
)

20 

	)

23 #iâdeà
GUARDED_BY


24 
	#GUARDED_BY
(
x
è
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`gu¬ded_by
(x))

	)

27 #iâdeà
PT_GUARDED_BY


28 
	#PT_GUARDED_BY
(
x
è
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`±_gu¬ded_by
(x))

	)

31 #iâdeà
ACQUIRED_AFTER


32 
	#ACQUIRED_AFTER
(...) \

33 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`acquœed_aá”
(
__VA_ARGS__
))

	)

36 #iâdeà
ACQUIRED_BEFORE


37 
	#ACQUIRED_BEFORE
(...) \

38 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`acquœed_befÜe
(
__VA_ARGS__
))

	)

41 #iâdeà
EXCLUSIVE_LOCKS_REQUIRED


42 
	#EXCLUSIVE_LOCKS_REQUIRED
(...) \

43 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`exşusive_locks_»quœed
(
__VA_ARGS__
))

	)

46 #iâdeà
SHARED_LOCKS_REQUIRED


47 
	#SHARED_LOCKS_REQUIRED
(...) \

48 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`sh¬ed_locks_»quœed
(
__VA_ARGS__
))

	)

51 #iâdeà
LOCKS_EXCLUDED


52 
	#LOCKS_EXCLUDED
(...) \

53 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`locks_exşuded
(
__VA_ARGS__
))

	)

56 #iâdeà
LOCK_RETURNED


57 
	#LOCK_RETURNED
(
x
è
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`lock_»tuºed
(x))

	)

60 #iâdeà
LOCKABLE


61 
	#LOCKABLE
 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
lockabË
)

	)

64 #iâdeà
SCOPED_LOCKABLE


65 
	#SCOPED_LOCKABLE
 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
scİed_lockabË
)

	)

68 #iâdeà
EXCLUSIVE_LOCK_FUNCTION


69 
	#EXCLUSIVE_LOCK_FUNCTION
(...) \

70 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`exşusive_lock_funùiÚ
(
__VA_ARGS__
))

	)

73 #iâdeà
SHARED_LOCK_FUNCTION


74 
	#SHARED_LOCK_FUNCTION
(...) \

75 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`sh¬ed_lock_funùiÚ
(
__VA_ARGS__
))

	)

78 #iâdeà
EXCLUSIVE_TRYLOCK_FUNCTION


79 
	#EXCLUSIVE_TRYLOCK_FUNCTION
(...) \

80 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`exşusive_Œylock_funùiÚ
(
__VA_ARGS__
))

	)

83 #iâdeà
SHARED_TRYLOCK_FUNCTION


84 
	#SHARED_TRYLOCK_FUNCTION
(...) \

85 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`sh¬ed_Œylock_funùiÚ
(
__VA_ARGS__
))

	)

88 #iâdeà
UNLOCK_FUNCTION


89 
	#UNLOCK_FUNCTION
(...) \

90 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`uÆock_funùiÚ
(
__VA_ARGS__
))

	)

93 #iâdeà
NO_THREAD_SAFETY_ANALYSIS


94 
	#NO_THREAD_SAFETY_ANALYSIS
 \

95 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
no_th»ad_§ãty_ª®ysis
)

	)

98 #iâdeà
ASSERT_EXCLUSIVE_LOCK


99 
	#ASSERT_EXCLUSIVE_LOCK
(...) \

100 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`as£¹_exşusive_lock
(
__VA_ARGS__
))

	)

103 #iâdeà
ASSERT_SHARED_LOCK


104 
	#ASSERT_SHARED_LOCK
(...) \

105 
	`THREAD_ANNOTATION_ATTRIBUTE__
(
	`as£¹_sh¬ed_lock
(
__VA_ARGS__
))

	)

	@table/block.cc

7 
	~"bË/block.h
"

9 
	~<®gÜ™hm
>

10 
	~<veùÜ
>

12 
	~"Ëv–db/com·¿tÜ.h
"

13 
	~"bË/fÜm©.h
"

14 
	~"ut/codšg.h
"

15 
	~"ut/loggšg.h
"

17 
Çme¥aû
 
	gËv–db
 {

19 
šlše
 
ušt32_t
 
	gBlock
::
NumRe¡¬ts
() const {

20 
as£¹
(
size_
 >ğ(
ušt32_t
));

21  
DecodeFixed32
(
d©a_
 + 
size_
 - (
ušt32_t
));

24 
	gBlock
::
Block
(cÚ¡ 
BlockCÚ‹Ás
& 
cÚ‹Ás
)

25 : 
d©a_
(
cÚ‹Ás
.
d©a
.data()),

26 
size_
(
cÚ‹Ás
.
d©a
.
size
()),

27 
owÃd_
(
cÚ‹Ás
.
h—p_®loÿ‹d
) {

28 ià(
	gsize_
 < (
	gušt32_t
)) {

29 
	gsize_
 = 0;

31 
size_t
 
	gmax_»¡¬ts_®lowed
 = (
size_
 - (
ušt32_t
)) / (uint32_t);

32 ià(
NumRe¡¬ts
(è> 
	gmax_»¡¬ts_®lowed
) {

34 
	gsize_
 = 0;

36 
	g»¡¬t_off£t_
 = 
size_
 - (1 + 
NumRe¡¬ts
()è* (
ušt32_t
);

41 
	gBlock
::~
Block
() {

42 ià(
owÃd_
) {

43 
d–‘e
[] 
d©a_
;

54 
šlše
 cÚ¡ * 
DecodeEÁry
(cÚ¡ * 
p
, cÚ¡ * 
lim™
,

55 
ušt32_t
* 
sh¬ed
, ušt32_t* 
nÚ_sh¬ed
,

56 
ušt32_t
* 
v®ue_Ëngth
) {

57 ià(
	glim™
 - 
	gp
 < 3è 
	gnuÎ±r
;

58 *
	gsh¬ed
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
)[0];

59 *
	gnÚ_sh¬ed
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
)[1];

60 *
	gv®ue_Ëngth
 = 
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
)[2];

61 ià((*
	gsh¬ed
 | *
	gnÚ_sh¬ed
 | *
	gv®ue_Ëngth
) < 128) {

63 
	gp
 += 3;

65 ià((
	gp
 = 
G‘V¬št32PŒ
(
p
, 
lim™
, 
sh¬ed
)è=ğ
nuÎ±r
) ‚ullptr;

66 ià((
	gp
 = 
G‘V¬št32PŒ
(
p
, 
lim™
, 
nÚ_sh¬ed
)è=ğ
nuÎ±r
) ‚ullptr;

67 ià((
	gp
 = 
G‘V¬št32PŒ
(
p
, 
lim™
, 
v®ue_Ëngth
)è=ğ
nuÎ±r
) ‚ullptr;

70 ià(
	g¡©ic_ÿ¡
<
	gušt32_t
>(
	glim™
 - 
	gp
è< (*
	gnÚ_sh¬ed
 + *
	gv®ue_Ëngth
)) {

71  
	gnuÎ±r
;

73  
	gp
;

76 şas 
	cBlock
::
I‹r
 : 
public
 
I‹¿tÜ
 {

77 
´iv©e
:

78 cÚ¡ 
Com·¿tÜ
* cÚ¡ 
com·¿tÜ_
;

79 cÚ¡ * cÚ¡ 
	gd©a_
;

80 
ušt32_t
 cÚ¡ 
	g»¡¬ts_
;

81 
ušt32_t
 cÚ¡ 
	gnum_»¡¬ts_
;

84 
ušt32_t
 
	gcu¼’t_
;

85 
ušt32_t
 
	g»¡¬t_šdex_
;

86 
	g¡d
::
¡ršg
 
key_
;

87 
Sliû
 
	gv®ue_
;

88 
Stus
 
	g¡©us_
;

90 
šlše
 
Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const {

91  
	gcom·¿tÜ_
->
Com·»
(
a
, 
b
);

95 
šlše
 
ušt32_t
 
NextEÁryOff£t
() const {

96  (
	gv®ue_
.
d©a
(è+ v®ue_.
size
()è- 
	gd©a_
;

99 
ušt32_t
 
G‘Re¡¬tPošt
(ušt32_ˆ
šdex
) {

100 
as£¹
(
šdex
 < 
num_»¡¬ts_
);

101  
DecodeFixed32
(
d©a_
 + 
»¡¬ts_
 + 
šdex
 * (
ušt32_t
));

104 
S“kToRe¡¬tPošt
(
ušt32_t
 
šdex
) {

105 
	gkey_
.
ş—r
();

106 
	g»¡¬t_šdex_
 = 
šdex
;

110 
ušt32_t
 
	goff£t
 = 
G‘Re¡¬tPošt
(
šdex
);

111 
	gv®ue_
 = 
Sliû
(
d©a_
 + 
off£t
, 0);

114 
	gpublic
:

115 
I‹r
(cÚ¡ 
Com·¿tÜ
* 
com·¿tÜ
, cÚ¡ * 
d©a
, 
ušt32_t
 
»¡¬ts
,

116 
ušt32_t
 
num_»¡¬ts
)

117 : 
com·¿tÜ_
(
com·¿tÜ
),

118 
d©a_
(
d©a
),

119 
»¡¬ts_
(
»¡¬ts
),

120 
num_»¡¬ts_
(
num_»¡¬ts
),

121 
cu¼’t_
(
»¡¬ts_
),

122 
»¡¬t_šdex_
(
num_»¡¬ts_
) {

123 
as£¹
(
num_»¡¬ts_
 > 0);

126 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  
	gcu¼’t_
 < 
	g»¡¬ts_
; }

127 
vœtu®
 
Stus
 
¡©us
(ècÚ¡ {  
	g¡©us_
; }

128 
vœtu®
 
Sliû
 
key
() const {

129 
as£¹
(
V®id
());

130  
	gkey_
;

132 
vœtu®
 
Sliû
 
v®ue
() const {

133 
as£¹
(
V®id
());

134  
	gv®ue_
;

137 
vœtu®
 
Next
() {

138 
as£¹
(
V®id
());

139 
P¬£NextKey
();

142 
vœtu®
 
P»v
() {

143 
as£¹
(
V®id
());

146 cÚ¡ 
ušt32_t
 
	gÜigš®
 = 
cu¼’t_
;

147 
G‘Re¡¬tPošt
(
»¡¬t_šdex_
è>ğ
Üigš®
) {

148 ià(
»¡¬t_šdex_
 == 0) {

150 
cu¼’t_
 = 
»¡¬ts_
;

151 
	g»¡¬t_šdex_
 = 
num_»¡¬ts_
;

154 
	g»¡¬t_šdex_
--;

157 
S“kToRe¡¬tPošt
(
»¡¬t_šdex_
);

160 } 
P¬£NextKey
(è&& 
NextEÁryOff£t
(è< 
	gÜigš®
);

163 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
rg‘
) {

166 
ušt32_t
 
	gËá
 = 0;

167 
ušt32_t
 
	gright
 = 
num_»¡¬ts_
 - 1;

168 
	gËá
 < 
	gright
) {

169 
ušt32_t
 
	gmid
 = (
Ëá
 + 
right
 + 1) / 2;

170 
ušt32_t
 
	g»giÚ_off£t
 = 
G‘Re¡¬tPošt
(
mid
);

171 
ušt32_t
 
	gsh¬ed
, 
	gnÚ_sh¬ed
, 
	gv®ue_Ëngth
;

172 cÚ¡ * 
	gkey_±r
 =

173 
DecodeEÁry
(
d©a_
 + 
»giÚ_off£t
, d©a_ + 
»¡¬ts_
, &
sh¬ed
,

174 &
nÚ_sh¬ed
, &
v®ue_Ëngth
);

175 ià(
	gkey_±r
 =ğ
nuÎ±r
 || (
sh¬ed
 != 0)) {

176 
CÜru±iÚE¼Ü
();

179 
Sliû
 
mid_key
(
key_±r
, 
nÚ_sh¬ed
);

180 ià(
Com·»
(
mid_key
, 
rg‘
) < 0) {

183 
	gËá
 = 
mid
;

187 
	gright
 = 
mid
 - 1;

192 
S“kToRe¡¬tPošt
(
Ëá
);

193 
	gŒue
) {

194 ià(!
P¬£NextKey
()) {

197 ià(
Com·»
(
key_
, 
rg‘
) >= 0) {

203 
vœtu®
 
S“kToFœ¡
() {

204 
S“kToRe¡¬tPošt
(0);

205 
P¬£NextKey
();

208 
vœtu®
 
S“kToLa¡
() {

209 
S“kToRe¡¬tPošt
(
num_»¡¬ts_
 - 1);

210 
P¬£NextKey
(è&& 
NextEÁryOff£t
(è< 
	g»¡¬ts_
) {

215 
	g´iv©e
:

216 
CÜru±iÚE¼Ü
() {

217 
cu¼’t_
 = 
»¡¬ts_
;

218 
	g»¡¬t_šdex_
 = 
num_»¡¬ts_
;

219 
	g¡©us_
 = 
Stus
::
CÜru±iÚ
("badƒntry in block");

220 
	gkey_
.
ş—r
();

221 
	gv®ue_
.
ş—r
();

224 
boŞ
 
P¬£NextKey
() {

225 
	gcu¼’t_
 = 
NextEÁryOff£t
();

226 cÚ¡ * 
	gp
 = 
d©a_
 + 
cu¼’t_
;

227 cÚ¡ * 
	glim™
 = 
d©a_
 + 
»¡¬ts_
;

228 ià(
	gp
 >ğ
lim™
) {

230 
cu¼’t_
 = 
»¡¬ts_
;

231 
	g»¡¬t_šdex_
 = 
num_»¡¬ts_
;

232  
	gçl£
;

236 
ušt32_t
 
	gsh¬ed
, 
	gnÚ_sh¬ed
, 
	gv®ue_Ëngth
;

237 
	gp
 = 
DecodeEÁry
(
p
, 
lim™
, &
sh¬ed
, &
nÚ_sh¬ed
, &
v®ue_Ëngth
);

238 ià(
	gp
 =ğ
nuÎ±r
 || 
key_
.
size
(è< 
sh¬ed
) {

239 
CÜru±iÚE¼Ü
();

240  
	gçl£
;

242 
	gkey_
.
»size
(
sh¬ed
);

243 
	gkey_
.
­³nd
(
p
, 
nÚ_sh¬ed
);

244 
	gv®ue_
 = 
Sliû
(
p
 + 
nÚ_sh¬ed
, 
v®ue_Ëngth
);

245 
	g»¡¬t_šdex_
 + 1 < 
	gnum_»¡¬ts_
 &&

246 
G‘Re¡¬tPošt
(
»¡¬t_šdex_
 + 1è< 
	gcu¼’t_
) {

247 ++
	g»¡¬t_šdex_
;

249  
	gŒue
;

254 
I‹¿tÜ
* 
	gBlock
::
	$NewI‹¿tÜ
(cÚ¡ 
Com·¿tÜ
* 
com·¿tÜ
) {

255 ià(
size_
 < (
ušt32_t
)) {

256  
	`NewE¼ÜI‹¿tÜ
(
Stus
::
	`CÜru±iÚ
("bad block contents"));

258 cÚ¡ 
ušt32_t
 
num_»¡¬ts
 = 
	`NumRe¡¬ts
();

259 ià(
num_»¡¬ts
 == 0) {

260  
	`NewEm±yI‹¿tÜ
();

262  
Ãw
 
	`I‹r
(
com·¿tÜ
, 
d©a_
, 
»¡¬t_off£t_
, 
num_»¡¬ts
);

264 
	}
}

	@table/block.h

5 #iâdeà
STORAGE_LEVELDB_TABLE_BLOCK_H_


6 
	#STORAGE_LEVELDB_TABLE_BLOCK_H_


	)

8 
	~<¡ddef.h
>

9 
	~<¡dšt.h
>

11 
	~"Ëv–db/™”©Ü.h
"

13 
Çme¥aû
 
	gËv–db
 {

15 
	gBlockCÚ‹Ás
;

16 
şass
 
	gCom·¿tÜ
;

18 şas 
	cBlock
 {

19 
	gpublic
:

21 
ex¶ic™
 
Block
(cÚ¡ 
BlockCÚ‹Ás
& 
cÚ‹Ás
);

23 
Block
(cÚ¡ Block&èğ
d–‘e
;

24 
	gBlock
& 
	gİ”©Ü
=(cÚ¡ 
Block
&èğ
d–‘e
;

26 ~
Block
();

28 
size_t
 
size
(ècÚ¡ {  
	gsize_
; }

29 
I‹¿tÜ
* 
NewI‹¿tÜ
(cÚ¡ 
Com·¿tÜ
* 
com·¿tÜ
);

31 
	g´iv©e
:

32 
şass
 
I‹r
;

34 
ušt32_t
 
NumRe¡¬ts
() const;

36 cÚ¡ * 
	gd©a_
;

37 
size_t
 
	gsize_
;

38 
ušt32_t
 
	g»¡¬t_off£t_
;

39 
boŞ
 
	gowÃd_
;

	@table/block_builder.cc

29 
	~"bË/block_bud”.h
"

31 
	~<as£¹.h
>

33 
	~<®gÜ™hm
>

35 
	~"Ëv–db/com·¿tÜ.h
"

36 
	~"Ëv–db/bË_bud”.h
"

37 
	~"ut/codšg.h
"

39 
Çme¥aû
 
	gËv–db
 {

41 
	gBlockBud”
::
BlockBud”
(cÚ¡ 
O±iÚs
* 
İtiÚs
)

42 : 
İtiÚs_
(
İtiÚs
), 
»¡¬ts_
(), 
couÁ”_
(0), 
fšished_
(
çl£
) {

43 
as£¹
(
İtiÚs
->
block_»¡¬t_š‹rv®
 >= 1);

44 
	g»¡¬ts_
.
push_back
(0);

47 
	gBlockBud”
::
Re£t
() {

48 
bufãr_
.
ş—r
();

49 
	g»¡¬ts_
.
ş—r
();

50 
	g»¡¬ts_
.
push_back
(0);

51 
	gcouÁ”_
 = 0;

52 
	gfšished_
 = 
çl£
;

53 
	gÏ¡_key_
.
ş—r
();

56 
size_t
 
	gBlockBud”
::
Cu¼’tSizeE¡im©e
() const {

57  (
bufãr_
.
size
() +

58 
»¡¬ts_
.
size
(è* (
ušt32_t
) +

59 (
ušt32_t
));

62 
Sliû
 
	gBlockBud”
::
Fšish
() {

64 
size_t
 
i
 = 0; 
	gi
 < 
	g»¡¬ts_
.
size
(); i++) {

65 
PutFixed32
(&
bufãr_
, 
»¡¬ts_
[
i
]);

67 
PutFixed32
(&
bufãr_
, 
»¡¬ts_
.
size
());

68 
	gfšished_
 = 
Œue
;

69  
Sliû
(
bufãr_
);

72 
	gBlockBud”
::
Add
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

73 
Sliû
 
Ï¡_key_p›û
(
Ï¡_key_
);

74 
as£¹
(!
fšished_
);

75 
as£¹
(
couÁ”_
 <ğ
İtiÚs_
->
block_»¡¬t_š‹rv®
);

76 
as£¹
(
bufãr_
.
em±y
()

77 || 
İtiÚs_
->
com·¿tÜ
->
Com·»
(
key
, 
Ï¡_key_p›û
) > 0);

78 
size_t
 
	gsh¬ed
 = 0;

79 ià(
	gcouÁ”_
 < 
	gİtiÚs_
->
	gblock_»¡¬t_š‹rv®
) {

81 cÚ¡ 
size_t
 
	gmš_Ëngth
 = 
¡d
::
mš
(
Ï¡_key_p›û
.
size
(), 
key
.size());

82 (
	gsh¬ed
 < 
	gmš_Ëngth
è&& (
	gÏ¡_key_p›û
[
sh¬ed
] =ğ
key
[shared])) {

83 
sh¬ed
++;

87 
	g»¡¬ts_
.
push_back
(
bufãr_
.
size
());

88 
	gcouÁ”_
 = 0;

90 cÚ¡ 
size_t
 
	gnÚ_sh¬ed
 = 
key
.
size
(è- 
sh¬ed
;

93 
PutV¬št32
(&
bufãr_
, 
sh¬ed
);

94 
PutV¬št32
(&
bufãr_
, 
nÚ_sh¬ed
);

95 
PutV¬št32
(&
bufãr_
, 
v®ue
.
size
());

98 
	gbufãr_
.
­³nd
(
key
.
d©a
(è+ 
sh¬ed
, 
nÚ_sh¬ed
);

99 
	gbufãr_
.
­³nd
(
v®ue
.
d©a
(), v®ue.
size
());

102 
	gÏ¡_key_
.
»size
(
sh¬ed
);

103 
	gÏ¡_key_
.
­³nd
(
key
.
d©a
(è+ 
sh¬ed
, 
nÚ_sh¬ed
);

104 
as£¹
(
Sliû
(
Ï¡_key_
è=ğ
key
);

105 
	gcouÁ”_
++;

	@table/block_builder.h

5 #iâdeà
STORAGE_LEVELDB_TABLE_BLOCK_BUILDER_H_


6 
	#STORAGE_LEVELDB_TABLE_BLOCK_BUILDER_H_


	)

8 
	~<¡dšt.h
>

10 
	~<veùÜ
>

12 
	~"Ëv–db/¦iû.h
"

14 
Çme¥aû
 
	gËv–db
 {

16 
	gO±iÚs
;

18 şas 
	cBlockBud”
 {

19 
	gpublic
:

20 
ex¶ic™
 
BlockBud”
(cÚ¡ 
O±iÚs
* 
İtiÚs
);

22 
BlockBud”
(cÚ¡ BlockBud”&èğ
d–‘e
;

23 
	gBlockBud”
& 
	gİ”©Ü
=(cÚ¡ 
BlockBud”
&èğ
d–‘e
;

26 
Re£t
();

30 
Add
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
);

35 
Sliû
 
Fšish
();

39 
size_t
 
Cu¼’tSizeE¡im©e
() const;

42 
boŞ
 
em±y
(ècÚ¡ {  
	gbufãr_
.empty(); }

44 
	g´iv©e
:

45 cÚ¡ 
O±iÚs
* 
İtiÚs_
;

46 
	g¡d
::
¡ršg
 
bufãr_
;

47 
	g¡d
::
veùÜ
<
ušt32_t
> 
»¡¬ts_
;

48 
	gcouÁ”_
;

49 
boŞ
 
	gfšished_
;

50 
	g¡d
::
¡ršg
 
Ï¡_key_
;

	@table/filter_block.cc

5 
	~"bË/f‹r_block.h
"

7 
	~"Ëv–db/f‹r_pŞicy.h
"

8 
	~"ut/codšg.h
"

10 
Çme¥aû
 
	gËv–db
 {

15 cÚ¡ 
size_t
 
	gkF‹rBa£Lg
 = 11;

16 cÚ¡ 
size_t
 
	gkF‹rBa£
 = 1 << 
kF‹rBa£Lg
;

18 
	gF‹rBlockBud”
::
F‹rBlockBud”
(cÚ¡ 
F‹rPŞicy
* 
pŞicy
)

19 : 
pŞicy_
(
pŞicy
) {}

21 
F‹rBlockBud”
::
S¹Block
(
ušt64_t
 
block_off£t
) {

22 
ušt64_t
 
f‹r_šdex
 = (
block_off£t
 / 
kF‹rBa£
);

23 
as£¹
(
f‹r_šdex
 >ğ
f‹r_off£ts_
.
size
());

24 
	gf‹r_šdex
 > 
	gf‹r_off£ts_
.
size
()) {

25 
G’”©eF‹r
();

29 
	gF‹rBlockBud”
::
AddKey
(cÚ¡ 
Sliû
& 
key
) {

30 
Sliû
 
k
 = 
key
;

31 
	g¡¬t_
.
push_back
(
keys_
.
size
());

32 
	gkeys_
.
­³nd
(
k
.
d©a
(), k.
size
());

35 
Sliû
 
	gF‹rBlockBud”
::
Fšish
() {

36 ià(!
¡¬t_
.
em±y
()) {

37 
G’”©eF‹r
();

41 cÚ¡ 
ušt32_t
 
	g¬¿y_off£t
 = 
»suÉ_
.
size
();

42 
size_t
 
	gi
 = 0; i < 
	gf‹r_off£ts_
.
size
(); i++) {

43 
PutFixed32
(&
»suÉ_
, 
f‹r_off£ts_
[
i
]);

46 
PutFixed32
(&
»suÉ_
, 
¬¿y_off£t
);

47 
	g»suÉ_
.
push_back
(
kF‹rBa£Lg
);

48  
Sliû
(
»suÉ_
);

51 
	gF‹rBlockBud”
::
G’”©eF‹r
() {

52 cÚ¡ 
size_t
 
num_keys
 = 
¡¬t_
.
size
();

53 ià(
	gnum_keys
 == 0) {

55 
f‹r_off£ts_
.
push_back
(
»suÉ_
.
size
());

60 
	g¡¬t_
.
push_back
(
keys_
.
size
());

61 
	gtmp_keys_
.
»size
(
num_keys
);

62 
size_t
 
	gi
 = 0; i < 
	gnum_keys
; i++) {

63 cÚ¡ * 
	gba£
 = 
keys_
.
d©a
(è+ 
¡¬t_
[
i
];

64 
size_t
 
	gËngth
 = 
¡¬t_
[
i
 + 1] - start_[i];

65 
	gtmp_keys_
[
i
] = 
Sliû
(
ba£
, 
Ëngth
);

69 
	gf‹r_off£ts_
.
push_back
(
»suÉ_
.
size
());

70 
	gpŞicy_
->
C»©eF‹r
(&
tmp_keys_
[0], 
¡©ic_ÿ¡
<>(
num_keys
), &
»suÉ_
);

72 
	gtmp_keys_
.
ş—r
();

73 
	gkeys_
.
ş—r
();

74 
	g¡¬t_
.
ş—r
();

77 
	gF‹rBlockR—d”
::
F‹rBlockR—d”
(cÚ¡ 
F‹rPŞicy
* 
pŞicy
,

78 cÚ¡ 
Sliû
& 
cÚ‹Ás
)

79 : 
pŞicy_
(
pŞicy
), 
d©a_
(
nuÎ±r
), 
off£t_
ÒuÎ±r), 
num_
(0), 
ba£_lg_
(0) {

80 
size_t
 
	gn
 = 
cÚ‹Ás
.
size
();

81 ià(
	gn
 < 5) ;

82 
	gba£_lg_
 = 
cÚ‹Ás
[
n
 - 1];

83 
ušt32_t
 
	gÏ¡_wÜd
 = 
DecodeFixed32
(
cÚ‹Ás
.
d©a
(è+ 
n
 - 5);

84 ià(
	gÏ¡_wÜd
 > 
	gn
 - 5) ;

85 
	gd©a_
 = 
cÚ‹Ás
.
d©a
();

86 
	goff£t_
 = 
d©a_
 + 
Ï¡_wÜd
;

87 
	gnum_
 = (
n
 - 5 - 
Ï¡_wÜd
) / 4;

90 
boŞ
 
	gF‹rBlockR—d”
::
KeyMayM©ch
(
ušt64_t
 
block_off£t
, cÚ¡ 
Sliû
& 
key
) {

91 
ušt64_t
 
	gšdex
 = 
block_off£t
 >> 
ba£_lg_
;

92 ià(
	gšdex
 < 
	gnum_
) {

93 
ušt32_t
 
	g¡¬t
 = 
DecodeFixed32
(
off£t_
 + 
šdex
 * 4);

94 
ušt32_t
 
	glim™
 = 
DecodeFixed32
(
off£t_
 + 
šdex
 * 4 + 4);

95 ià(
	g¡¬t
 <ğ
lim™
 &&†im™ <ğ
¡©ic_ÿ¡
<
size_t
>(
off£t_
 - 
d©a_
)) {

96 
Sliû
 
f‹r
 = Sliû(
d©a_
 + 
¡¬t
, 
lim™
 - start);

97  
	gpŞicy_
->
KeyMayM©ch
(
key
, 
f‹r
);

98 } ià(
	g¡¬t
 =ğ
lim™
) {

100  
çl£
;

103  
	gŒue
;

	@table/filter_block.h

9 #iâdeà
STORAGE_LEVELDB_TABLE_FILTER_BLOCK_H_


10 
	#STORAGE_LEVELDB_TABLE_FILTER_BLOCK_H_


	)

12 
	~<¡ddef.h
>

13 
	~<¡dšt.h
>

15 
	~<¡ršg
>

16 
	~<veùÜ
>

18 
	~"Ëv–db/¦iû.h
"

19 
	~"ut/hash.h
"

21 
Çme¥aû
 
	gËv–db
 {

23 
şass
 
	gF‹rPŞicy
;

31 şas 
	cF‹rBlockBud”
 {

32 
	gpublic
:

33 
ex¶ic™
 
F‹rBlockBud”
(cÚ¡ 
F‹rPŞicy
*);

35 
F‹rBlockBud”
(cÚ¡ F‹rBlockBud”&èğ
d–‘e
;

36 
	gF‹rBlockBud”
& 
	gİ”©Ü
=(cÚ¡ 
F‹rBlockBud”
&èğ
d–‘e
;

38 
S¹Block
(
ušt64_t
 
block_off£t
);

39 
AddKey
(cÚ¡ 
Sliû
& 
key
);

40 
Sliû
 
Fšish
();

42 
	g´iv©e
:

43 
G’”©eF‹r
();

45 cÚ¡ 
F‹rPŞicy
* 
	gpŞicy_
;

46 
	g¡d
::
¡ršg
 
keys_
;

47 
	g¡d
::
veùÜ
<
size_t
> 
¡¬t_
;

48 
	g¡d
::
¡ršg
 
»suÉ_
;

49 
	g¡d
::
veùÜ
<
Sliû
> 
tmp_keys_
;

50 
	g¡d
::
veùÜ
<
ušt32_t
> 
f‹r_off£ts_
;

53 şas 
	cF‹rBlockR—d”
 {

54 
	gpublic
:

56 
F‹rBlockR—d”
(cÚ¡ 
F‹rPŞicy
* 
pŞicy
, cÚ¡ 
Sliû
& 
cÚ‹Ás
);

57 
boŞ
 
KeyMayM©ch
(
ušt64_t
 
block_off£t
, cÚ¡ 
Sliû
& 
key
);

59 
	g´iv©e
:

60 cÚ¡ 
F‹rPŞicy
* 
pŞicy_
;

61 cÚ¡ * 
	gd©a_
;

62 cÚ¡ * 
	goff£t_
;

63 
size_t
 
	gnum_
;

64 
size_t
 
	gba£_lg_
;

	@table/filter_block_test.cc

5 
	~"bË/f‹r_block.h
"

7 
	~"Ëv–db/f‹r_pŞicy.h
"

8 
	~"ut/codšg.h
"

9 
	~"ut/hash.h
"

10 
	~"ut/loggšg.h
"

11 
	~"ut/‹¡h¬Ãss.h
"

12 
	~"ut/‹¡ut.h
"

14 
Çme¥aû
 
	gËv–db
 {

17 şas 
	cTe¡HashF‹r
 : 
public
 
F‹rPŞicy
 {

18 
public
:

19 
vœtu®
 cÚ¡ * 
Name
() const {  "TestHashFilter"; }

21 
vœtu®
 
C»©eF‹r
(cÚ¡ 
Sliû
* 
keys
, 
n
, 
¡d
::
¡ršg
* 
d¡
) const {

22 
i
 = 0; 
	gi
 < 
	gn
; i++) {

23 
ušt32_t
 
	gh
 = 
Hash
(
keys
[
i
].
d©a
(), keys[i].
size
(), 1);

24 
PutFixed32
(
d¡
, 
h
);

28 
vœtu®
 
boŞ
 
KeyMayM©ch
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
f‹r
) const {

29 
ušt32_t
 
	gh
 = 
Hash
(
key
.
d©a
(), key.
size
(), 1);

30 
size_t
 
	gi
 = 0; i + 4 <ğ
f‹r
.
size
(); i += 4) {

31 ià(
h
 =ğ
DecodeFixed32
(
f‹r
.
d©a
(è+ 
i
)) {

32  
Œue
;

35  
	gçl£
;

39 şas 
	cF‹rBlockTe¡
 {

40 
	gpublic
:

41 
Te¡HashF‹r
 
pŞicy_
;

44 
	$TEST
(
F‹rBlockTe¡
, 
Em±yBud”
) {

45 
F‹rBlockBud”
 
	`bud”
(&
pŞicy_
);

46 
Sliû
 
block
 = 
bud”
.
	`Fšish
();

47 
	`ASSERT_EQ
("\\x00\\x00\\x00\\x00\\x0b", 
	`Esÿ³SŒšg
(
block
));

48 
F‹rBlockR—d”
 
	`»ad”
(&
pŞicy_
, 
block
);

49 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(0, "foo"));

50 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(100000, "foo"));

51 
	}
}

53 
	$TEST
(
F‹rBlockTe¡
, 
SšgËChunk
) {

54 
F‹rBlockBud”
 
	`bud”
(&
pŞicy_
);

55 
bud”
.
	`S¹Block
(100);

56 
bud”
.
	`AddKey
("foo");

57 
bud”
.
	`AddKey
("bar");

58 
bud”
.
	`AddKey
("box");

59 
bud”
.
	`S¹Block
(200);

60 
bud”
.
	`AddKey
("box");

61 
bud”
.
	`S¹Block
(300);

62 
bud”
.
	`AddKey
("hello");

63 
Sliû
 
block
 = 
bud”
.
	`Fšish
();

64 
F‹rBlockR—d”
 
	`»ad”
(&
pŞicy_
, 
block
);

65 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(100, "foo"));

66 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(100, "bar"));

67 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(100, "box"));

68 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(100, "hello"));

69 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(100, "foo"));

70 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(100, "missing"));

71 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(100, "other"));

72 
	}
}

74 
	$TEST
(
F‹rBlockTe¡
, 
MuÉiChunk
) {

75 
F‹rBlockBud”
 
	`bud”
(&
pŞicy_
);

78 
bud”
.
	`S¹Block
(0);

79 
bud”
.
	`AddKey
("foo");

80 
bud”
.
	`S¹Block
(2000);

81 
bud”
.
	`AddKey
("bar");

84 
bud”
.
	`S¹Block
(3100);

85 
bud”
.
	`AddKey
("box");

90 
bud”
.
	`S¹Block
(9000);

91 
bud”
.
	`AddKey
("box");

92 
bud”
.
	`AddKey
("hello");

94 
Sliû
 
block
 = 
bud”
.
	`Fšish
();

95 
F‹rBlockR—d”
 
	`»ad”
(&
pŞicy_
, 
block
);

98 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(0, "foo"));

99 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(2000, "bar"));

100 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(0, "box"));

101 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(0, "hello"));

104 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(3100, "box"));

105 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(3100, "foo"));

106 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(3100, "bar"));

107 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(3100, "hello"));

110 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(4100, "foo"));

111 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(4100, "bar"));

112 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(4100, "box"));

113 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(4100, "hello"));

116 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(9000, "box"));

117 
	`ASSERT_TRUE
(
»ad”
.
	`KeyMayM©ch
(9000, "hello"));

118 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(9000, "foo"));

119 
	`ASSERT_TRUE
(!
»ad”
.
	`KeyMayM©ch
(9000, "bar"));

120 
	}
}

124 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@table/format.cc

5 
	~"bË/fÜm©.h
"

7 
	~"Ëv–db/’v.h
"

8 
	~"pÜt/pÜt.h
"

9 
	~"bË/block.h
"

10 
	~"ut/codšg.h
"

11 
	~"ut/üc32c.h
"

13 
Çme¥aû
 
	gËv–db
 {

15 
	gBlockHªdË
::
EncodeTo
(
¡d
::
¡ršg
* 
d¡
) const {

17 
as£¹
(
off£t_
 !ğ~
¡©ic_ÿ¡
<
ušt64_t
>(0));

18 
as£¹
(
size_
 !ğ~
¡©ic_ÿ¡
<
ušt64_t
>(0));

19 
PutV¬št64
(
d¡
, 
off£t_
);

20 
PutV¬št64
(
d¡
, 
size_
);

23 
Stus
 
	gBlockHªdË
::
DecodeFrom
(
Sliû
* 
šput
) {

24 ià(
G‘V¬št64
(
šput
, &
off£t_
è&& G‘V¬št64(šput, &
size_
)) {

25  
	gStus
::
OK
();

27  
	gStus
::
CÜru±iÚ
("bad block handle");

31 
	gFoÙ”
::
EncodeTo
(
¡d
::
¡ršg
* 
d¡
) const {

32 cÚ¡ 
size_t
 
Üigš®_size
 = 
d¡
->
size
();

33 
	gm‘ašdex_hªdË_
.
EncodeTo
(
d¡
);

34 
	gšdex_hªdË_
.
EncodeTo
(
d¡
);

35 
	gd¡
->
»size
(2 * 
BlockHªdË
::
kMaxEncodedL’gth
);

36 
PutFixed32
(
d¡
, 
¡©ic_ÿ¡
<
ušt32_t
>(
kTabËMagicNumb”
 & 0xffffffffu));

37 
PutFixed32
(
d¡
, 
¡©ic_ÿ¡
<
ušt32_t
>(
kTabËMagicNumb”
 >> 32));

38 
as£¹
(
d¡
->
size
(è=ğ
Üigš®_size
 + 
kEncodedL’gth
);

39 ()
	gÜigš®_size
;

42 
Stus
 
	gFoÙ”
::
DecodeFrom
(
Sliû
* 
šput
) {

43 cÚ¡ * 
magic_±r
 = 
šput
->
d©a
(è+ 
kEncodedL’gth
 - 8;

44 cÚ¡ 
ušt32_t
 
	gmagic_lo
 = 
DecodeFixed32
(
magic_±r
);

45 cÚ¡ 
ušt32_t
 
	gmagic_hi
 = 
DecodeFixed32
(
magic_±r
 + 4);

46 cÚ¡ 
ušt64_t
 
	gmagic
 = ((
¡©ic_ÿ¡
<ušt64_t>(
magic_hi
) << 32) |

47 (
¡©ic_ÿ¡
<
ušt64_t
>(
magic_lo
)));

48 ià(
	gmagic
 !ğ
kTabËMagicNumb”
) {

49  
Stus
::
CÜru±iÚ
("not‡n sstable (bad magic‚umber)");

52 
Stus
 
	g»suÉ
 = 
m‘ašdex_hªdË_
.
DecodeFrom
(
šput
);

53 ià(
	g»suÉ
.
ok
()) {

54 
	g»suÉ
 = 
šdex_hªdË_
.
DecodeFrom
(
šput
);

56 ià(
	g»suÉ
.
ok
()) {

58 cÚ¡ * 
	g’d
 = 
magic_±r
 + 8;

59 *
	gšput
 = 
Sliû
(
’d
, 
šput
->
d©a
(è+ iÅut->
size
() -ƒnd);

61  
	g»suÉ
;

64 
Stus
 
R—dBlock
(
RªdomAcûssFe
* 
fe
, cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

65 cÚ¡ 
BlockHªdË
& 
hªdË
, 
BlockCÚ‹Ás
* 
»suÉ
) {

66 
	g»suÉ
->
	gd©a
 = 
Sliû
();

67 
	g»suÉ
->
	gÿchabË
 = 
çl£
;

68 
	g»suÉ
->
	gh—p_®loÿ‹d
 = 
çl£
;

72 
size_t
 
	gn
 = 
¡©ic_ÿ¡
<size_t>(
hªdË
.
size
());

73 * 
	gbuf
 = 
Ãw
 [
n
 + 
kBlockT¿”Size
];

74 
Sliû
 
	gcÚ‹Ás
;

75 
Stus
 
	gs
 = 
fe
->
R—d
(
hªdË
.
off£t
(), 
n
 + 
kBlockT¿”Size
, &
cÚ‹Ás
, 
buf
);

76 ià(!
	gs
.
ok
()) {

77 
	gd–‘e
[] 
	gbuf
;

78  
	gs
;

80 ià(
	gcÚ‹Ás
.
size
(è!ğ
n
 + 
kBlockT¿”Size
) {

81 
d–‘e
[] 
buf
;

82  
	gStus
::
CÜru±iÚ
("truncated block„ead");

86 cÚ¡ * 
	gd©a
 = 
cÚ‹Ás
.
d©a
();

87 ià(
	gİtiÚs
.
	gv”ify_checksums
) {

88 cÚ¡ 
ušt32_t
 
	güc
 = 
üc32c
::
Unmask
(
DecodeFixed32
(
d©a
 + 
n
 + 1));

89 cÚ¡ 
ušt32_t
 
	gaùu®
 = 
üc32c
::
V®ue
(
d©a
, 
n
 + 1);

90 ià(
	gaùu®
 !ğ
üc
) {

91 
d–‘e
[] 
buf
;

92 
	gs
 = 
Stus
::
CÜru±iÚ
("block checksum mismatch");

93  
	gs
;

97 
	gd©a
[
n
]) {

98 
	gkNoCom´essiÚ
:

99 ià(
d©a
 !ğ
buf
) {

103 
d–‘e
[] 
buf
;

104 
	g»suÉ
->
	gd©a
 = 
Sliû
(
d©a
, 
n
);

105 
	g»suÉ
->
	gh—p_®loÿ‹d
 = 
çl£
;

106 
	g»suÉ
->
	gÿchabË
 = 
çl£
;

108 
	g»suÉ
->
	gd©a
 = 
Sliû
(
buf
, 
n
);

109 
	g»suÉ
->
	gh—p_®loÿ‹d
 = 
Œue
;

110 
	g»suÉ
->
	gÿchabË
 = 
Œue
;

115 
	gkSÇµyCom´essiÚ
: {

116 
size_t
 
uËngth
 = 0;

117 ià(!
	gpÜt
::
SÇµy_G‘Uncom´es£dL’gth
(
d©a
, 
n
, &
uËngth
)) {

118 
	gd–‘e
[] 
	gbuf
;

119  
	gStus
::
CÜru±iÚ
("corrupted compressed block contents");

121 * 
	gubuf
 = 
Ãw
 [
uËngth
];

122 ià(!
	gpÜt
::
SÇµy_Uncom´ess
(
d©a
, 
n
, 
ubuf
)) {

123 
	gd–‘e
[] 
	gbuf
;

124 
	gd–‘e
[] 
	gubuf
;

125  
	gStus
::
CÜru±iÚ
("corrupted compressed block contents");

127 
	gd–‘e
[] 
	gbuf
;

128 
	g»suÉ
->
	gd©a
 = 
Sliû
(
ubuf
, 
uËngth
);

129 
	g»suÉ
->
	gh—p_®loÿ‹d
 = 
Œue
;

130 
	g»suÉ
->
	gÿchabË
 = 
Œue
;

134 
d–‘e
[] 
buf
;

135  
	gStus
::
CÜru±iÚ
("bad blockype");

138  
	gStus
::
OK
();

	@table/format.h

5 #iâdeà
STORAGE_LEVELDB_TABLE_FORMAT_H_


6 
	#STORAGE_LEVELDB_TABLE_FORMAT_H_


	)

8 
	~<¡dšt.h
>

10 
	~<¡ršg
>

12 
	~"Ëv–db/¦iû.h
"

13 
	~"Ëv–db/¡©us.h
"

14 
	~"Ëv–db/bË_bud”.h
"

16 
Çme¥aû
 
	gËv–db
 {

18 
şass
 
	gBlock
;

19 
şass
 
	gRªdomAcûssFe
;

20 
	gR—dO±iÚs
;

24 şas 
	cBlockHªdË
 {

25 
	gpublic
:

27 ’um { 
kMaxEncodedL’gth
 = 10 + 10 };

29 
BlockHªdË
();

32 
ušt64_t
 
off£t
(ècÚ¡ {  
	goff£t_
; }

33 
£t_off£t
(
ušt64_t
 
off£t
è{ 
	goff£t_
 = offset; }

36 
ušt64_t
 
size
(ècÚ¡ {  
	gsize_
; }

37 
£t_size
(
ušt64_t
 
size
è{ 
	gsize_
 = size; }

39 
EncodeTo
(
¡d
::
¡ršg
* 
d¡
) const;

40 
Stus
 
DecodeFrom
(
Sliû
* 
šput
);

42 
	g´iv©e
:

43 
ušt64_t
 
off£t_
;

44 
ušt64_t
 
	gsize_
;

49 şas 
	cFoÙ”
 {

50 
	gpublic
:

54 ’um { 
kEncodedL’gth
 = 2 * 
BlockHªdË
::
kMaxEncodedL’gth
 + 8 };

56 
FoÙ”
() {}

59 cÚ¡ 
	gBlockHªdË
& 
m‘ašdex_hªdË
(ècÚ¡ {  
	gm‘ašdex_hªdË_
; }

60 
£t_m‘ašdex_hªdË
(cÚ¡ 
BlockHªdË
& 
h
è{ 
	gm‘ašdex_hªdË_
 = h; }

63 cÚ¡ 
	gBlockHªdË
& 
šdex_hªdË
(ècÚ¡ {  
	gšdex_hªdË_
; }

64 
£t_šdex_hªdË
(cÚ¡ 
BlockHªdË
& 
h
è{ 
	gšdex_hªdË_
 = h; }

66 
EncodeTo
(
¡d
::
¡ršg
* 
d¡
) const;

67 
Stus
 
DecodeFrom
(
Sliû
* 
šput
);

69 
	g´iv©e
:

70 
BlockHªdË
 
m‘ašdex_hªdË_
;

71 
BlockHªdË
 
	gšdex_hªdË_
;

77 cÚ¡ 
ušt64_t
 
	gkTabËMagicNumb”
 = 0xdb4775248b80fb57ull;

80 cÚ¡ 
size_t
 
	gkBlockT¿”Size
 = 5;

82 
	sBlockCÚ‹Ás
 {

83 
Sliû
 
	gd©a
;

84 
boŞ
 
	gÿchabË
;

85 
boŞ
 
	gh—p_®loÿ‹d
;

90 
Stus
 
R—dBlock
(
RªdomAcûssFe
* 
fe
, cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

91 cÚ¡ 
BlockHªdË
& 
hªdË
, 
BlockCÚ‹Ás
* 
»suÉ
);

95 
šlše
 
	gBlockHªdË
::
	$BlockHªdË
()

96 : 
	`off£t_
(~
¡©ic_ÿ¡
<
ušt64_t
>(0)), 
	`size_
(~¡©ic_ÿ¡<ušt64_t>(0)è{
	}
}

	@table/iterator.cc

5 
	~"Ëv–db/™”©Ü.h
"

7 
Çme¥aû
 
	gËv–db
 {

9 
	gI‹¿tÜ
::
I‹¿tÜ
() {

10 
ş—nup_h—d_
.
funùiÚ
 = 
nuÎ±r
;

11 
	gş—nup_h—d_
.
	gÃxt
 = 
nuÎ±r
;

14 
	gI‹¿tÜ
::~
I‹¿tÜ
() {

15 ià(!
ş—nup_h—d_
.
IsEm±y
()) {

16 
ş—nup_h—d_
.
Run
();

17 
CËªupNode
* 
	gnode
 = 
ş—nup_h—d_
.
Ãxt
;‚od!ğ
nuÎ±r
;) {

18 
	gnode
->
Run
();

19 
CËªupNode
* 
	gÃxt_node
 = 
node
->
Ãxt
;

20 
d–‘e
 
	gnode
;

21 
	gnode
 = 
Ãxt_node
;

26 
	gI‹¿tÜ
::
Regi¡”CËªup
(
CËªupFunùiÚ
 
func
, * 
¬g1
, * 
¬g2
) {

27 
as£¹
(
func
 !ğ
nuÎ±r
);

28 
CËªupNode
* 
	gnode
;

29 ià(
	gş—nup_h—d_
.
IsEm±y
()) {

30 
	gnode
 = &
ş—nup_h—d_
;

32 
	gnode
 = 
Ãw
 
CËªupNode
();

33 
	gnode
->
	gÃxt
 = 
ş—nup_h—d_
.
Ãxt
;

34 
	gş—nup_h—d_
.
	gÃxt
 = 
node
;

36 
	gnode
->
	gfunùiÚ
 = 
func
;

37 
	gnode
->
	g¬g1
 = 
¬g1
;

38 
	gnode
->
	g¬g2
 = 
¬g2
;

41 
	gÇme¥aû
 {

43 şas 
	cEm±yI‹¿tÜ
 : 
public
 
I‹¿tÜ
 {

44 
public
:

45 
Em±yI‹¿tÜ
(cÚ¡ 
Stus
& 
s
è: 
¡©us_
(s) {}

46 ~
Em±yI‹¿tÜ
(è
ov”ride
 = ;

48 
boŞ
 
V®id
(ècÚ¡ 
	gov”ride
 {  
	gçl£
; }

49 
S“k
(cÚ¡ 
Sliû
& 
rg‘
è
	gov”ride
 {}

50 
S“kToFœ¡
(è
	gov”ride
 {}

51 
S“kToLa¡
(è
	gov”ride
 {}

52 
Next
(è
	gov”ride
 { 
as£¹
(
çl£
); }

53 
P»v
(è
	gov”ride
 { 
as£¹
(
çl£
); }

54 
Sliû
 
key
(ècÚ¡ 
	gov”ride
 {

55 
as£¹
(
çl£
);

56  
Sliû
();

58 
Sliû
 
v®ue
(ècÚ¡ 
	gov”ride
 {

59 
as£¹
(
çl£
);

60  
Sliû
();

62 
Stus
 
¡©us
(ècÚ¡ 
	gov”ride
 {  
	g¡©us_
; }

64 
	g´iv©e
:

65 
Stus
 
¡©us_
;

70 
I‹¿tÜ
* 
	$NewEm±yI‹¿tÜ
(è{  
Ãw
 
	`Em±yI‹¿tÜ
(
Stus
::
	`OK
()); 
	}
}

72 
I‹¿tÜ
* 
	$NewE¼ÜI‹¿tÜ
(cÚ¡ 
Stus
& 
¡©us
) {

73  
Ãw
 
	`Em±yI‹¿tÜ
(
¡©us
);

74 
	}
}

	@table/iterator_wrapper.h

5 #iâdeà
STORAGE_LEVELDB_TABLE_ITERATOR_WRAPPER_H_


6 
	#STORAGE_LEVELDB_TABLE_ITERATOR_WRAPPER_H_


	)

8 
	~"Ëv–db/™”©Ü.h
"

9 
	~"Ëv–db/¦iû.h
"

11 
Çme¥aû
 
	gËv–db
 {

17 şas 
	cI‹¿tÜW¿µ”
 {

18 
	gpublic
:

19 
I‹¿tÜW¿µ”
(è: 
™”_
(
nuÎ±r
), 
v®id_
(
çl£
) {}

20 
ex¶ic™
 
I‹¿tÜW¿µ”
(
I‹¿tÜ
* 
™”
è: 
™”_
(
nuÎ±r
è{ 
S‘
(iter); }

21 ~
I‹¿tÜW¿µ”
(è{ 
d–‘e
 
	g™”_
; }

22 
I‹¿tÜ
* 
™”
(ècÚ¡ {  
	g™”_
; }

26 
S‘
(
I‹¿tÜ
* 
™”
) {

27 
d–‘e
 
	g™”_
;

28 
	g™”_
 = 
™”
;

29 ià(
	g™”_
 =ğ
nuÎ±r
) {

30 
v®id_
 = 
çl£
;

32 
Upd©e
();

37 
boŞ
 
V®id
(ècÚ¡ {  
	gv®id_
; }

38 
Sliû
 
key
() const {

39 
as£¹
(
V®id
());

40  
	gkey_
;

42 
Sliû
 
v®ue
() const {

43 
as£¹
(
V®id
());

44  
	g™”_
->
v®ue
();

47 
Stus
 
¡©us
() const {

48 
as£¹
(
™”_
);

49  
	g™”_
->
¡©us
();

51 
Next
() {

52 
as£¹
(
™”_
);

53 
	g™”_
->
Next
();

54 
Upd©e
();

56 
P»v
() {

57 
as£¹
(
™”_
);

58 
	g™”_
->
P»v
();

59 
Upd©e
();

61 
S“k
(cÚ¡ 
Sliû
& 
k
) {

62 
as£¹
(
™”_
);

63 
	g™”_
->
S“k
(
k
);

64 
Upd©e
();

66 
S“kToFœ¡
() {

67 
as£¹
(
™”_
);

68 
	g™”_
->
S“kToFœ¡
();

69 
Upd©e
();

71 
S“kToLa¡
() {

72 
as£¹
(
™”_
);

73 
	g™”_
->
S“kToLa¡
();

74 
Upd©e
();

77 
	g´iv©e
:

78 
Upd©e
() {

79 
v®id_
 = 
™”_
->
V®id
();

80 ià(
	gv®id_
) {

81 
	gkey_
 = 
™”_
->
key
();

85 
I‹¿tÜ
* 
	g™”_
;

86 
boŞ
 
	gv®id_
;

87 
Sliû
 
	gkey_
;

	@table/merger.cc

5 
	~"bË/m”g”.h
"

7 
	~"Ëv–db/com·¿tÜ.h
"

8 
	~"Ëv–db/™”©Ü.h
"

9 
	~"bË/™”©Ü_w¿µ”.h
"

11 
Çme¥aû
 
	gËv–db
 {

13 
	gÇme¥aû
 {

14 şas 
	cM”gšgI‹¿tÜ
 : 
public
 
I‹¿tÜ
 {

15 
public
:

16 
M”gšgI‹¿tÜ
(cÚ¡ 
Com·¿tÜ
* 
com·¿tÜ
, 
I‹¿tÜ
** 
chd»n
, 
n
)

17 : 
com·¿tÜ_
(
com·¿tÜ
),

18 
chd»n_
(
Ãw
 
I‹¿tÜW¿µ”
[
n
]),

19 
n_
(
n
),

20 
cu¼’t_
(
nuÎ±r
),

21 
dœeùiÚ_
(
kFÜw¬d
) {

22 
	gi
 = 0; i < 
	gn
; i++) {

23 
	gchd»n_
[
i
].
S‘
(
chd»n
[i]);

27 
	gvœtu®
 ~
M”gšgI‹¿tÜ
(è{ 
	gd–‘e
[] 
	gchd»n_
; }

29 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  (
	gcu¼’t_
 !ğ
nuÎ±r
); }

31 
vœtu®
 
S“kToFœ¡
() {

32 
	gi
 = 0; i < 
	gn_
; i++) {

33 
	gchd»n_
[
i
].
S“kToFœ¡
();

35 
FšdSm®Ë¡
();

36 
	gdœeùiÚ_
 = 
kFÜw¬d
;

39 
vœtu®
 
S“kToLa¡
() {

40 
	gi
 = 0; i < 
	gn_
; i++) {

41 
	gchd»n_
[
i
].
S“kToLa¡
();

43 
FšdL¬ge¡
();

44 
	gdœeùiÚ_
 = 
kRev”£
;

47 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
rg‘
) {

48 
	gi
 = 0; i < 
	gn_
; i++) {

49 
	gchd»n_
[
i
].
S“k
(
rg‘
);

51 
FšdSm®Ë¡
();

52 
	gdœeùiÚ_
 = 
kFÜw¬d
;

55 
vœtu®
 
Next
() {

56 
as£¹
(
V®id
());

63 ià(
	gdœeùiÚ_
 !ğ
kFÜw¬d
) {

64 
i
 = 0; 
	gi
 < 
	gn_
; i++) {

65 
I‹¿tÜW¿µ”
* 
	gchd
 = &
chd»n_
[
i
];

66 ià(
	gchd
 !ğ
cu¼’t_
) {

67 
chd
->
S“k
(
key
());

68 ià(
	gchd
->
V®id
() &&

69 
	gcom·¿tÜ_
->
Com·»
(
key
(), 
chd
->key()) == 0) {

70 
chd
->
Next
();

74 
	gdœeùiÚ_
 = 
kFÜw¬d
;

77 
	gcu¼’t_
->
Next
();

78 
FšdSm®Ë¡
();

81 
vœtu®
 
P»v
() {

82 
as£¹
(
V®id
());

89 ià(
	gdœeùiÚ_
 !ğ
kRev”£
) {

90 
i
 = 0; 
	gi
 < 
	gn_
; i++) {

91 
I‹¿tÜW¿µ”
* 
	gchd
 = &
chd»n_
[
i
];

92 ià(
	gchd
 !ğ
cu¼’t_
) {

93 
chd
->
S“k
(
key
());

94 ià(
	gchd
->
V®id
()) {

96 
	gchd
->
P»v
();

99 
	gchd
->
S“kToLa¡
();

103 
	gdœeùiÚ_
 = 
kRev”£
;

106 
	gcu¼’t_
->
P»v
();

107 
FšdL¬ge¡
();

110 
vœtu®
 
Sliû
 
key
() const {

111 
as£¹
(
V®id
());

112  
	gcu¼’t_
->
key
();

115 
vœtu®
 
Sliû
 
v®ue
() const {

116 
as£¹
(
V®id
());

117  
	gcu¼’t_
->
v®ue
();

120 
vœtu®
 
Stus
 
¡©us
() const {

121 
Stus
 
	g¡©us
;

122 
	gi
 = 0; i < 
	gn_
; i++) {

123 
	g¡©us
 = 
chd»n_
[
i
].
¡©us
();

124 ià(!
	g¡©us
.
ok
()) {

128  
	g¡©us
;

131 
	g´iv©e
:

133 
	eDœeùiÚ
 { 
kFÜw¬d
, 
	gkRev”£
 };

135 
FšdSm®Ë¡
();

136 
FšdL¬ge¡
();

141 cÚ¡ 
Com·¿tÜ
* 
	gcom·¿tÜ_
;

142 
I‹¿tÜW¿µ”
* 
	gchd»n_
;

143 
	gn_
;

144 
I‹¿tÜW¿µ”
* 
	gcu¼’t_
;

145 
DœeùiÚ
 
	gdœeùiÚ_
;

148 
	gM”gšgI‹¿tÜ
::
FšdSm®Ë¡
() {

149 
I‹¿tÜW¿µ”
* 
sm®Ë¡
 = 
nuÎ±r
;

150 
	gi
 = 0; i < 
	gn_
; i++) {

151 
I‹¿tÜW¿µ”
* 
	gchd
 = &
chd»n_
[
i
];

152 ià(
	gchd
->
V®id
()) {

153 ià(
	gsm®Ë¡
 =ğ
nuÎ±r
) {

154 
sm®Ë¡
 = 
chd
;

155 } ià(
	gcom·¿tÜ_
->
Com·»
(
chd
->
key
(), 
sm®Ë¡
->key()) < 0) {

156 
	gsm®Ë¡
 = 
chd
;

160 
	gcu¼’t_
 = 
sm®Ë¡
;

163 
	gM”gšgI‹¿tÜ
::
FšdL¬ge¡
() {

164 
I‹¿tÜW¿µ”
* 
Ïrge¡
 = 
nuÎ±r
;

165 
	gi
 = 
n_
 - 1; i >= 0; i--) {

166 
I‹¿tÜW¿µ”
* 
	gchd
 = &
chd»n_
[
i
];

167 ià(
	gchd
->
V®id
()) {

168 ià(
	gÏrge¡
 =ğ
nuÎ±r
) {

169 
Ïrge¡
 = 
chd
;

170 } ià(
	gcom·¿tÜ_
->
Com·»
(
chd
->
key
(), 
Ïrge¡
->key()) > 0) {

171 
	gÏrge¡
 = 
chd
;

175 
	gcu¼’t_
 = 
Ïrge¡
;

179 
I‹¿tÜ
* 
	$NewM”gšgI‹¿tÜ
(cÚ¡ 
Com·¿tÜ
* 
com·¿tÜ
, 
I‹¿tÜ
** 
chd»n
,

180 
n
) {

181 
	`as£¹
(
n
 >= 0);

182 ià(
n
 == 0) {

183  
	`NewEm±yI‹¿tÜ
();

184 } ià(
n
 == 1) {

185  
chd»n
[0];

187  
Ãw
 
	`M”gšgI‹¿tÜ
(
com·¿tÜ
, 
chd»n
, 
n
);

189 
	}
}

	@table/merger.h

5 #iâdeà
STORAGE_LEVELDB_TABLE_MERGER_H_


6 
	#STORAGE_LEVELDB_TABLE_MERGER_H_


	)

8 
Çme¥aû
 
	gËv–db
 {

10 
şass
 
	gCom·¿tÜ
;

11 
şass
 
	gI‹¿tÜ
;

21 
I‹¿tÜ
* 
NewM”gšgI‹¿tÜ
(cÚ¡ 
Com·¿tÜ
* 
com·¿tÜ
, I‹¿tÜ** 
chd»n
,

22 
n
);

	@table/table.cc

5 
	~"Ëv–db/bË.h
"

7 
	~"Ëv–db/ÿche.h
"

8 
	~"Ëv–db/com·¿tÜ.h
"

9 
	~"Ëv–db/’v.h
"

10 
	~"Ëv–db/f‹r_pŞicy.h
"

11 
	~"Ëv–db/İtiÚs.h
"

12 
	~"bË/block.h
"

13 
	~"bË/f‹r_block.h
"

14 
	~"bË/fÜm©.h
"

15 
	~"bË/two_Ëv–_™”©Ü.h
"

16 
	~"ut/codšg.h
"

18 
Çme¥aû
 
	gËv–db
 {

20 
	gTabË
::
R•
 {

21 ~
R•
() {

22 
d–‘e
 
f‹r
;

23 
	gd–‘e
[] 
	gf‹r_d©a
;

24 
d–‘e
 
	gšdex_block
;

27 
O±iÚs
 
	gİtiÚs
;

28 
Stus
 
	g¡©us
;

29 
RªdomAcûssFe
* 
	gfe
;

30 
ušt64_t
 
	gÿche_id
;

31 
F‹rBlockR—d”
* 
	gf‹r
;

32 cÚ¡ * 
	gf‹r_d©a
;

34 
BlockHªdË
 
	gm‘ašdex_hªdË
;

35 
Block
* 
	gšdex_block
;

38 
Stus
 
	gTabË
::
O³n
(cÚ¡ 
O±iÚs
& 
İtiÚs
, 
RªdomAcûssFe
* 
fe
,

39 
ušt64_t
 
size
, 
TabË
** 
bË
) {

40 *
	gbË
 = 
nuÎ±r
;

41 ià(
	gsize
 < 
	gFoÙ”
::
kEncodedL’gth
) {

42  
Stus
::
CÜru±iÚ
("file isoo shorto be‡n sstable");

45 
	gfoÙ”_¥aû
[
FoÙ”
::
kEncodedL’gth
];

46 
Sliû
 
	gfoÙ”_šput
;

47 
Stus
 
	gs
 = 
fe
->
R—d
(
size
 - 
FoÙ”
::
kEncodedL’gth
, Footer::kEncodedLength,

48 &
foÙ”_šput
, 
foÙ”_¥aû
);

49 ià(!
	gs
.
ok
())  s;

51 
FoÙ”
 
	gfoÙ”
;

52 
	gs
 = 
foÙ”
.
DecodeFrom
(&
foÙ”_šput
);

53 ià(!
	gs
.
ok
())  s;

56 
BlockCÚ‹Ás
 
	gšdex_block_cÚ‹Ás
;

57 ià(
	gs
.
ok
()) {

58 
R—dO±iÚs
 
	gİt
;

59 ià(
	gİtiÚs
.
	g·¿noid_checks
) {

60 
	gİt
.
	gv”ify_checksums
 = 
Œue
;

62 
	gs
 = 
R—dBlock
(
fe
, 
İt
, 
foÙ”
.
šdex_hªdË
(), &
šdex_block_cÚ‹Ás
);

65 ià(
	gs
.
ok
()) {

68 
Block
* 
	gšdex_block
 = 
Ãw
 Block(
šdex_block_cÚ‹Ás
);

69 
R•
* 
	g»p
 = 
Ãw
 
TabË
::Rep;

70 
	g»p
->
	gİtiÚs
 = 
İtiÚs
;

71 
	g»p
->
	gfe
 = 
fe
;

72 
	g»p
->
	gm‘ašdex_hªdË
 = 
foÙ”
.
m‘ašdex_hªdË
();

73 
	g»p
->
	gšdex_block
 = 
šdex_block
;

74 
	g»p
->
	gÿche_id
 = (
İtiÚs
.
block_ÿche
 ? o±iÚs.block_ÿche->
NewId
() : 0);

75 
	g»p
->
	gf‹r_d©a
 = 
nuÎ±r
;

76 
	g»p
->
	gf‹r
 = 
nuÎ±r
;

77 *
	gbË
 = 
Ãw
 
TabË
(
»p
);

78 (*
	gbË
)->
R—dM‘a
(
foÙ”
);

81  
	gs
;

84 
	gTabË
::
R—dM‘a
(cÚ¡ 
FoÙ”
& 
foÙ”
) {

85 ià(
»p_
->
İtiÚs
.
f‹r_pŞicy
 =ğ
nuÎ±r
) {

91 
R—dO±iÚs
 
	gİt
;

92 ià(
	g»p_
->
	gİtiÚs
.
	g·¿noid_checks
) {

93 
	gİt
.
	gv”ify_checksums
 = 
Œue
;

95 
BlockCÚ‹Ás
 
	gcÚ‹Ás
;

96 ià(!
R—dBlock
(
»p_
->
fe
, 
İt
, 
foÙ”
.
m‘ašdex_hªdË
(), &
cÚ‹Ás
).
ok
()) {

100 
Block
* 
	gm‘a
 = 
Ãw
 Block(
cÚ‹Ás
);

102 
I‹¿tÜ
* 
	g™”
 = 
m‘a
->
NewI‹¿tÜ
(
By‹wi£Com·¿tÜ
());

103 
	g¡d
::
¡ršg
 
key
 = "filter.";

104 
	gkey
.
­³nd
(
»p_
->
İtiÚs
.
f‹r_pŞicy
->
Name
());

105 
	g™”
->
S“k
(
key
);

106 ià(
	g™”
->
V®id
(è&& i‹r->
key
(è=ğ
Sliû
(key)) {

107 
R—dF‹r
(
™”
->
v®ue
());

109 
d–‘e
 
	g™”
;

110 
d–‘e
 
	gm‘a
;

113 
	gTabË
::
R—dF‹r
(cÚ¡ 
Sliû
& 
f‹r_hªdË_v®ue
) {

114 
Sliû
 
v
 = 
f‹r_hªdË_v®ue
;

115 
BlockHªdË
 
	gf‹r_hªdË
;

116 ià(!
	gf‹r_hªdË
.
DecodeFrom
(&
v
).
ok
()) {

122 
R—dO±iÚs
 
	gİt
;

123 ià(
	g»p_
->
	gİtiÚs
.
	g·¿noid_checks
) {

124 
	gİt
.
	gv”ify_checksums
 = 
Œue
;

126 
BlockCÚ‹Ás
 
	gblock
;

127 ià(!
R—dBlock
(
»p_
->
fe
, 
İt
, 
f‹r_hªdË
, &
block
).
ok
()) {

130 ià(
	gblock
.
	gh—p_®loÿ‹d
) {

131 
	g»p_
->
	gf‹r_d©a
 = 
block
.
d©a
.data();

133 
	g»p_
->
	gf‹r
 = 
Ãw
 
F‹rBlockR—d”
(
»p_
->
İtiÚs
.
f‹r_pŞicy
, 
block
.
d©a
);

136 
	gTabË
::~
TabË
(è{ 
d–‘e
 
»p_
; }

138 
D–‘eBlock
(* 
¬g
, * 
ignÜed
) {

139 
d–‘e
 
	g»š‹½»t_ÿ¡
<
	gBlock
*>(
	g¬g
);

142 
D–‘eCachedBlock
(cÚ¡ 
Sliû
& 
key
, * 
v®ue
) {

143 
Block
* 
	gblock
 = 
»š‹½»t_ÿ¡
<Block*>(
v®ue
);

144 
d–‘e
 
	gblock
;

147 
R–—£Block
(* 
¬g
, * 
h
) {

148 
Cache
* 
	gÿche
 = 
»š‹½»t_ÿ¡
<Cache*>(
¬g
);

149 
	gCache
::
HªdË
* 
hªdË
 = 
»š‹½»t_ÿ¡
<
Cache
::HªdË*>(
h
);

150 
	gÿche
->
R–—£
(
hªdË
);

155 
I‹¿tÜ
* 
	gTabË
::
BlockR—d”
(* 
¬g
, cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

156 cÚ¡ 
Sliû
& 
šdex_v®ue
) {

157 
TabË
* 
	gbË
 = 
»š‹½»t_ÿ¡
<TabË*>(
¬g
);

158 
Cache
* 
	gblock_ÿche
 = 
bË
->
»p_
->
İtiÚs
.
block_ÿche
;

159 
Block
* 
	gblock
 = 
nuÎ±r
;

160 
	gCache
::
HªdË
* 
ÿche_hªdË
 = 
nuÎ±r
;

162 
BlockHªdË
 
	ghªdË
;

163 
Sliû
 
	gšput
 = 
šdex_v®ue
;

164 
Stus
 
	gs
 = 
hªdË
.
DecodeFrom
(&
šput
);

168 ià(
	gs
.
ok
()) {

169 
BlockCÚ‹Ás
 
	gcÚ‹Ás
;

170 ià(
	gblock_ÿche
 !ğ
nuÎ±r
) {

171 
ÿche_key_bufãr
[16];

172 
EncodeFixed64
(
ÿche_key_bufãr
, 
bË
->
»p_
->
ÿche_id
);

173 
EncodeFixed64
(
ÿche_key_bufãr
 + 8, 
hªdË
.
off£t
());

174 
Sliû
 
key
(
ÿche_key_bufãr
, (cache_key_buffer));

175 
	gÿche_hªdË
 = 
block_ÿche
->
Lookup
(
key
);

176 ià(
	gÿche_hªdË
 !ğ
nuÎ±r
) {

177 
block
 = 
»š‹½»t_ÿ¡
<
Block
*>(
block_ÿche
->
V®ue
(
ÿche_hªdË
));

179 
	gs
 = 
R—dBlock
(
bË
->
»p_
->
fe
, 
İtiÚs
, 
hªdË
, &
cÚ‹Ás
);

180 ià(
	gs
.
ok
()) {

181 
	gblock
 = 
Ãw
 
Block
(
cÚ‹Ás
);

182 ià(
	gcÚ‹Ás
.
	gÿchabË
 && 
	gİtiÚs
.
	gfl_ÿche
) {

183 
	gÿche_hªdË
 = 
block_ÿche
->
In£¹
(
key
, 
block
, block->
size
(),

184 &
D–‘eCachedBlock
);

189 
	gs
 = 
R—dBlock
(
bË
->
»p_
->
fe
, 
İtiÚs
, 
hªdË
, &
cÚ‹Ás
);

190 ià(
	gs
.
ok
()) {

191 
	gblock
 = 
Ãw
 
Block
(
cÚ‹Ás
);

196 
I‹¿tÜ
* 
	g™”
;

197 ià(
	gblock
 !ğ
nuÎ±r
) {

198 
™”
 = 
block
->
NewI‹¿tÜ
(
bË
->
»p_
->
İtiÚs
.
com·¿tÜ
);

199 ià(
	gÿche_hªdË
 =ğ
nuÎ±r
) {

200 
™”
->
Regi¡”CËªup
(&
D–‘eBlock
, 
block
, 
nuÎ±r
);

202 
	g™”
->
Regi¡”CËªup
(&
R–—£Block
, 
block_ÿche
, 
ÿche_hªdË
);

205 
	g™”
 = 
NewE¼ÜI‹¿tÜ
(
s
);

207  
	g™”
;

210 
I‹¿tÜ
* 
	gTabË
::
NewI‹¿tÜ
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
) const {

211  
NewTwoLev–I‹¿tÜ
(

212 
»p_
->
šdex_block
->
NewI‹¿tÜ
Ô•_->
İtiÚs
.
com·¿tÜ
),

213 &
TabË
::
BlockR—d”
, 
cÚ¡_ÿ¡
<TabË*>(
this
), 
İtiÚs
);

216 
Stus
 
	gTabË
::
IÁ”ÇlG‘
(cÚ¡ 
R—dO±iÚs
& 
İtiÚs
, cÚ¡ 
Sliû
& 
k
, * 
¬g
,

217 (*
hªdË_»suÉ
)(*, cÚ¡ 
Sliû
&,

218 cÚ¡ 
Sliû
&)) {

219 
Stus
 
	gs
;

220 
I‹¿tÜ
* 
	gi™”
 = 
»p_
->
šdex_block
->
NewI‹¿tÜ
Ô•_->
İtiÚs
.
com·¿tÜ
);

221 
	gi™”
->
S“k
(
k
);

222 ià(
	gi™”
->
V®id
()) {

223 
Sliû
 
	ghªdË_v®ue
 = 
i™”
->
v®ue
();

224 
F‹rBlockR—d”
* 
	gf‹r
 = 
»p_
->
f‹r
;

225 
BlockHªdË
 
	ghªdË
;

226 ià(
	gf‹r
 !ğ
nuÎ±r
 && 
hªdË
.
DecodeFrom
(&
hªdË_v®ue
).
ok
() &&

227 !
f‹r
->
KeyMayM©ch
(
hªdË
.
off£t
(), 
k
)) {

230 
I‹¿tÜ
* 
	gblock_™”
 = 
BlockR—d”
(
this
, 
İtiÚs
, 
i™”
->
v®ue
());

231 
	gblock_™”
->
S“k
(
k
);

232 ià(
	gblock_™”
->
V®id
()) {

233 (*
	ghªdË_»suÉ
)(
	g¬g
, 
	gblock_™”
->
key
(), block_™”->
v®ue
());

235 
	gs
 = 
block_™”
->
¡©us
();

236 
d–‘e
 
	gblock_™”
;

239 ià(
	gs
.
ok
()) {

240 
	gs
 = 
i™”
->
¡©us
();

242 
d–‘e
 
	gi™”
;

243  
	gs
;

246 
ušt64_t
 
	gTabË
::
Aµroxim©eOff£tOf
(cÚ¡ 
Sliû
& 
key
) const {

247 
I‹¿tÜ
* 
šdex_™”
 =

248 
»p_
->
šdex_block
->
NewI‹¿tÜ
Ô•_->
İtiÚs
.
com·¿tÜ
);

249 
	gšdex_™”
->
S“k
(
key
);

250 
ušt64_t
 
	g»suÉ
;

251 ià(
	gšdex_™”
->
V®id
()) {

252 
BlockHªdË
 
	ghªdË
;

253 
Sliû
 
	gšput
 = 
šdex_™”
->
v®ue
();

254 
Stus
 
	gs
 = 
hªdË
.
DecodeFrom
(&
šput
);

255 ià(
	gs
.
ok
()) {

256 
	g»suÉ
 = 
hªdË
.
off£t
();

261 
	g»suÉ
 = 
»p_
->
m‘ašdex_hªdË
.
off£t
();

267 
	g»suÉ
 = 
»p_
->
m‘ašdex_hªdË
.
off£t
();

269 
d–‘e
 
	gšdex_™”
;

270  
	g»suÉ
;

	@table/table_builder.cc

5 
	~"Ëv–db/bË_bud”.h
"

7 
	~<as£¹.h
>

9 
	~"Ëv–db/com·¿tÜ.h
"

10 
	~"Ëv–db/’v.h
"

11 
	~"Ëv–db/f‹r_pŞicy.h
"

12 
	~"Ëv–db/İtiÚs.h
"

13 
	~"bË/block_bud”.h
"

14 
	~"bË/f‹r_block.h
"

15 
	~"bË/fÜm©.h
"

16 
	~"ut/codšg.h
"

17 
	~"ut/üc32c.h
"

19 
Çme¥aû
 
	gËv–db
 {

21 
	gTabËBud”
::
R•
 {

22 
R•
(cÚ¡ 
O±iÚs
& 
İt
, 
Wr™abËFe
* 
f
)

23 : 
İtiÚs
(
İt
),

24 
šdex_block_İtiÚs
(
İt
),

25 
fe
(
f
),

26 
off£t
(0),

27 
d©a_block
(&
İtiÚs
),

28 
šdex_block
(&
šdex_block_İtiÚs
),

29 
num_’Œ›s
(0),

30 
şo£d
(
çl£
),

31 
f‹r_block
(
İt
.
f‹r_pŞicy
 =ğ
nuÎ±r


32 ? 
nuÎ±r


33 : 
Ãw
 
F‹rBlockBud”
(
İt
.
f‹r_pŞicy
)),

34 
³ndšg_šdex_’Œy
(
çl£
) {

35 
	gšdex_block_İtiÚs
.
	gblock_»¡¬t_š‹rv®
 = 1;

38 
O±iÚs
 
	gİtiÚs
;

39 
O±iÚs
 
	gšdex_block_İtiÚs
;

40 
Wr™abËFe
* 
	gfe
;

41 
ušt64_t
 
	goff£t
;

42 
Stus
 
	g¡©us
;

43 
BlockBud”
 
	gd©a_block
;

44 
BlockBud”
 
	gšdex_block
;

45 
	g¡d
::
¡ršg
 
Ï¡_key
;

46 
št64_t
 
	gnum_’Œ›s
;

47 
boŞ
 
	gşo£d
;

48 
F‹rBlockBud”
* 
	gf‹r_block
;

59 
boŞ
 
	g³ndšg_šdex_’Œy
;

60 
BlockHªdË
 
	g³ndšg_hªdË
;

62 
	g¡d
::
¡ršg
 
com´es£d_ouut
;

65 
	gTabËBud”
::
TabËBud”
(cÚ¡ 
O±iÚs
& 
İtiÚs
, 
Wr™abËFe
* 
fe
)

66 : 
»p_
(
Ãw
 
R•
(
İtiÚs
, 
fe
)) {

67 ià(
	g»p_
->
	gf‹r_block
 !ğ
nuÎ±r
) {

68 
»p_
->
f‹r_block
->
S¹Block
(0);

72 
	gTabËBud”
::~
TabËBud”
() {

73 
as£¹
(
»p_
->
şo£d
);

74 
d–‘e
 
	g»p_
->
	gf‹r_block
;

75 
d–‘e
 
	g»p_
;

78 
Stus
 
	gTabËBud”
::
ChªgeO±iÚs
(cÚ¡ 
O±iÚs
& 
İtiÚs
) {

82 ià(
İtiÚs
.
com·¿tÜ
 !ğ
»p_
->options.comparator) {

83  
Stus
::
Inv®idArgum’t
("changing comparator while buildingable");

88 
	g»p_
->
	gİtiÚs
 = 
İtiÚs
;

89 
	g»p_
->
	gšdex_block_İtiÚs
 = 
İtiÚs
;

90 
	g»p_
->
	gšdex_block_İtiÚs
.
	gblock_»¡¬t_š‹rv®
 = 1;

91  
	gStus
::
OK
();

94 
	gTabËBud”
::
Add
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
v®ue
) {

95 
R•
* 
	gr
 = 
»p_
;

96 
as£¹
(!
r
->
şo£d
);

97 ià(!
ok
()) ;

98 ià(
	gr
->
	gnum_’Œ›s
 > 0) {

99 
as£¹
(
r
->
İtiÚs
.
com·¿tÜ
->
Com·»
(
key
, 
Sliû
Ô->
Ï¡_key
)) > 0);

102 ià(
	gr
->
	g³ndšg_šdex_’Œy
) {

103 
as£¹
(
r
->
d©a_block
.
em±y
());

104 
	gr
->
	gİtiÚs
.
	gcom·¿tÜ
->
FšdShÜ‹¡S•¬©Ü
(&
r
->
Ï¡_key
, 
key
);

105 
	g¡d
::
¡ršg
 
hªdË_’codšg
;

106 
	gr
->
	g³ndšg_hªdË
.
EncodeTo
(&
hªdË_’codšg
);

107 
	gr
->
	gšdex_block
.
Add
(
r
->
Ï¡_key
, 
Sliû
(
hªdË_’codšg
));

108 
	gr
->
	g³ndšg_šdex_’Œy
 = 
çl£
;

111 ià(
	gr
->
	gf‹r_block
 !ğ
nuÎ±r
) {

112 
r
->
f‹r_block
->
AddKey
(
key
);

115 
	gr
->
	gÏ¡_key
.
assign
(
key
.
d©a
(), key.
size
());

116 
	gr
->
	gnum_’Œ›s
++;

117 
	gr
->
	gd©a_block
.
Add
(
key
, 
v®ue
);

119 cÚ¡ 
size_t
 
	ge¡im©ed_block_size
 = 
r
->
d©a_block
.
Cu¼’tSizeE¡im©e
();

120 ià(
	ge¡im©ed_block_size
 >ğ
r
->
İtiÚs
.
block_size
) {

121 
Flush
();

125 
	gTabËBud”
::
Flush
() {

126 
R•
* 
r
 = 
»p_
;

127 
as£¹
(!
r
->
şo£d
);

128 ià(!
ok
()) ;

129 ià(
	gr
->
	gd©a_block
.
em±y
()) ;

130 
as£¹
(!
r
->
³ndšg_šdex_’Œy
);

131 
Wr™eBlock
(&
r
->
d©a_block
, &r->
³ndšg_hªdË
);

132 ià(
ok
()) {

133 
	gr
->
	g³ndšg_šdex_’Œy
 = 
Œue
;

134 
	gr
->
	g¡©us
 = 
r
->
fe
->
Flush
();

136 ià(
	gr
->
	gf‹r_block
 !ğ
nuÎ±r
) {

137 
r
->
f‹r_block
->
S¹Block
Ô->
off£t
);

141 
	gTabËBud”
::
Wr™eBlock
(
BlockBud”
* 
block
, 
BlockHªdË
* 
hªdË
) {

146 
as£¹
(
ok
());

147 
R•
* 
	gr
 = 
»p_
;

148 
Sliû
 
	g¿w
 = 
block
->
Fšish
();

150 
Sliû
 
	gblock_cÚ‹Ás
;

151 
Com´essiÚTy³
 
	gty³
 = 
r
->
İtiÚs
.
com´essiÚ
;

153 
	gty³
) {

154 
	gkNoCom´essiÚ
:

155 
block_cÚ‹Ás
 = 
¿w
;

158 
	gkSÇµyCom´essiÚ
: {

159 
¡d
::
¡ršg
* 
com´es£d
 = &
r
->
com´es£d_ouut
;

160 ià(
	gpÜt
::
SÇµy_Com´ess
(
¿w
.
d©a
(),„aw.
size
(), 
com´es£d
) &&

161 
	gcom´es£d
->
size
(è< 
	g¿w
.size() - (raw.size() / 8u)) {

162 
	gblock_cÚ‹Ás
 = *
com´es£d
;

166 
	gblock_cÚ‹Ás
 = 
¿w
;

167 
	gty³
 = 
kNoCom´essiÚ
;

172 
Wr™eRawBlock
(
block_cÚ‹Ás
, 
ty³
, 
hªdË
);

173 
	gr
->
	gcom´es£d_ouut
.
ş—r
();

174 
	gblock
->
Re£t
();

177 
	gTabËBud”
::
Wr™eRawBlock
(cÚ¡ 
Sliû
& 
block_cÚ‹Ás
,

178 
Com´essiÚTy³
 
ty³
, 
BlockHªdË
* 
hªdË
) {

179 
R•
* 
	gr
 = 
»p_
;

180 
	ghªdË
->
£t_off£t
(
r
->
off£t
);

181 
	ghªdË
->
£t_size
(
block_cÚ‹Ás
.
size
());

182 
	gr
->
	g¡©us
 = 
r
->
fe
->
Aµ’d
(
block_cÚ‹Ás
);

183 ià(
	gr
->
	g¡©us
.
ok
()) {

184 
	gŒa”
[
kBlockT¿”Size
];

185 
	gŒa”
[0] = 
ty³
;

186 
ušt32_t
 
	güc
 = 
üc32c
::
V®ue
(
block_cÚ‹Ás
.
d©a
(), block_cÚ‹Ás.
size
());

187 
	güc
 = 
üc32c
::
Ex‹nd
(
üc
, 
Œa”
, 1);

188 
EncodeFixed32
(
Œa”
 + 1, 
üc32c
::
Mask
(
üc
));

189 
	gr
->
	g¡©us
 = 
r
->
fe
->
Aµ’d
(
Sliû
(
Œa”
, 
kBlockT¿”Size
));

190 ià(
	gr
->
	g¡©us
.
ok
()) {

191 
	gr
->
	goff£t
 +ğ
block_cÚ‹Ás
.
size
(è+ 
kBlockT¿”Size
;

196 
Stus
 
	gTabËBud”
::
¡©us
(ècÚ¡ {  
»p_
->status; }

198 
Stus
 
	gTabËBud”
::
Fšish
() {

199 
R•
* 
r
 = 
»p_
;

200 
Flush
();

201 
as£¹
(!
r
->
şo£d
);

202 
	gr
->
	gşo£d
 = 
Œue
;

204 
BlockHªdË
 
	gf‹r_block_hªdË
, 
	gm‘ašdex_block_hªdË
, 
	gšdex_block_hªdË
;

207 ià(
ok
(è&& 
	gr
->
	gf‹r_block
 !ğ
nuÎ±r
) {

208 
Wr™eRawBlock
(
r
->
f‹r_block
->
Fšish
(), 
kNoCom´essiÚ
,

209 &
f‹r_block_hªdË
);

213 ià(
ok
()) {

214 
BlockBud”
 
m‘a_šdex_block
(&
r
->
İtiÚs
);

215 ià(
	gr
->
	gf‹r_block
 !ğ
nuÎ±r
) {

217 
¡d
::
¡ršg
 
key
 = "filter.";

218 
	gkey
.
­³nd
(
r
->
İtiÚs
.
f‹r_pŞicy
->
Name
());

219 
	g¡d
::
¡ršg
 
hªdË_’codšg
;

220 
	gf‹r_block_hªdË
.
EncodeTo
(&
hªdË_’codšg
);

221 
	gm‘a_šdex_block
.
Add
(
key
, 
hªdË_’codšg
);

225 
Wr™eBlock
(&
m‘a_šdex_block
, &
m‘ašdex_block_hªdË
);

229 ià(
ok
()) {

230 ià(
	gr
->
	g³ndšg_šdex_’Œy
) {

231 
	gr
->
	gİtiÚs
.
	gcom·¿tÜ
->
FšdShÜtSucûssÜ
(&
r
->
Ï¡_key
);

232 
	g¡d
::
¡ršg
 
hªdË_’codšg
;

233 
	gr
->
	g³ndšg_hªdË
.
EncodeTo
(&
hªdË_’codšg
);

234 
	gr
->
	gšdex_block
.
Add
(
r
->
Ï¡_key
, 
Sliû
(
hªdË_’codšg
));

235 
	gr
->
	g³ndšg_šdex_’Œy
 = 
çl£
;

237 
Wr™eBlock
(&
r
->
šdex_block
, &
šdex_block_hªdË
);

241 ià(
ok
()) {

242 
FoÙ”
 
	gfoÙ”
;

243 
	gfoÙ”
.
£t_m‘ašdex_hªdË
(
m‘ašdex_block_hªdË
);

244 
	gfoÙ”
.
£t_šdex_hªdË
(
šdex_block_hªdË
);

245 
	g¡d
::
¡ršg
 
foÙ”_’codšg
;

246 
	gfoÙ”
.
EncodeTo
(&
foÙ”_’codšg
);

247 
	gr
->
	g¡©us
 = 
r
->
fe
->
Aµ’d
(
foÙ”_’codšg
);

248 ià(
	gr
->
	g¡©us
.
ok
()) {

249 
	gr
->
	goff£t
 +ğ
foÙ”_’codšg
.
size
();

252  
	gr
->
	g¡©us
;

255 
	gTabËBud”
::
AbªdÚ
() {

256 
R•
* 
r
 = 
»p_
;

257 
as£¹
(!
r
->
şo£d
);

258 
	gr
->
	gşo£d
 = 
Œue
;

261 
ušt64_t
 
	gTabËBud”
::
NumEÁr›s
(ècÚ¡ {  
»p_
->
num_’Œ›s
; }

263 
ušt64_t
 
	gTabËBud”
::
FeSize
(ècÚ¡ {  
»p_
->
off£t
; }

	@table/table_test.cc

5 
	~"Ëv–db/bË.h
"

7 
	~<m­
>

8 
	~<¡ršg
>

10 
	~"db/dbfÜm©.h
"

11 
	~"db/membË.h
"

12 
	~"db/wr™e_b©ch_š‹º®.h
"

13 
	~"Ëv–db/db.h
"

14 
	~"Ëv–db/’v.h
"

15 
	~"Ëv–db/™”©Ü.h
"

16 
	~"Ëv–db/bË_bud”.h
"

17 
	~"bË/block.h
"

18 
	~"bË/block_bud”.h
"

19 
	~"bË/fÜm©.h
"

20 
	~"ut/¿ndom.h
"

21 
	~"ut/‹¡h¬Ãss.h
"

22 
	~"ut/‹¡ut.h
"

24 
Çme¥aû
 
	gËv–db
 {

28 
	g¡d
::
¡ršg
 
Rev”£
(cÚ¡ 
Sliû
& 
key
) {

29 
¡d
::
¡ršg
 
¡r
(
key
.
ToSŒšg
());

30 
	g¡d
::
¡ršg
 
»v
("");

31 
	g¡d
::
¡ršg
::
»v”£_™”©Ü
 
r™
 = 
¡r
.
rbegš
(); 
	gr™
 !ğ¡r.
»nd
();

32 ++
	gr™
) {

33 
	g»v
.
push_back
(*
r™
);

35  
	g»v
;

38 
	gÇme¥aû
 {

39 şas 
	cRev”£KeyCom·¿tÜ
 : 
public
 
Com·¿tÜ
 {

40 
public
:

41 
vœtu®
 cÚ¡ * 
Name
() const {

45 
vœtu®
 
Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const {

46  
By‹wi£Com·¿tÜ
()->
Com·»
(
Rev”£
(
a
), Rev”£(
b
));

49 
vœtu®
 
FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
* 
¡¬t
,

50 cÚ¡ 
Sliû
& 
lim™
) const {

51 
	g¡d
::
¡ršg
 
s
 = 
Rev”£
(*
¡¬t
);

52 
	g¡d
::
¡ršg
 
l
 = 
Rev”£
(
lim™
);

53 
By‹wi£Com·¿tÜ
()->
FšdShÜ‹¡S•¬©Ü
(&
s
, 
l
);

54 *
	g¡¬t
 = 
Rev”£
(
s
);

57 
vœtu®
 
FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const {

58 
¡d
::
¡ršg
 
s
 = 
Rev”£
(*
key
);

59 
By‹wi£Com·¿tÜ
()->
FšdShÜtSucûssÜ
(&
s
);

60 *
	gkey
 = 
Rev”£
(
s
);

64 
Rev”£KeyCom·¿tÜ
 
	g»v”£_key_com·¿tÜ
;

66 
	$Inüem’t
(cÚ¡ 
Com·¿tÜ
* 
cmp
, 
¡d
::
¡ršg
* 
key
) {

67 ià(
cmp
 =ğ
	`By‹wi£Com·¿tÜ
()) {

68 
key
->
	`push_back
('\0');

70 
	`as£¹
(
cmp
 =ğ&
»v”£_key_com·¿tÜ
);

71 
¡d
::
¡ršg
 
»v
 = 
	`Rev”£
(*
key
);

72 
»v
.
	`push_back
('\0');

73 *
key
 = 
	`Rev”£
(
»v
);

75 
	}
}

78 
	gÇme¥aû
 {

79 
	sSTLLessThª
 {

80 cÚ¡ 
Com·¿tÜ
* 
	gcmp
;

82 
STLLessThª
(è: 
cmp
(
By‹wi£Com·¿tÜ
()) {}

83 
STLLessThª
(cÚ¡ 
Com·¿tÜ
* 
c
è: 
cmp
(c) {}

84 
boŞ
 
İ”©Ü
()(cÚ¡ 
¡d
::
¡ršg
& 
a
, cÚ¡ 
	g¡d
::¡ršg& 
b
) const {

85  
cmp
->
Com·»
(
Sliû
(
a
), Sliû(
b
)) < 0;

90 şas 
	cSŒšgSšk
 : 
public
 
Wr™abËFe
 {

91 
public
:

92 ~
SŒšgSšk
() {}

94 cÚ¡ 
¡d
::
¡ršg
& 
cÚ‹Ás
(ècÚ¡ {  
cÚ‹Ás_
; }

96 
vœtu®
 
Stus
 
Clo£
(è{  
	gStus
::
OK
(); }

97 
vœtu®
 
Stus
 
Flush
(è{  
	gStus
::
OK
(); }

98 
vœtu®
 
Stus
 
Sync
(è{  
	gStus
::
OK
(); }

100 
vœtu®
 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
) {

101 
	gcÚ‹Ás_
.
­³nd
(
d©a
.d©a(), d©a.
size
());

102  
	gStus
::
OK
();

105 
	g´iv©e
:

106 
¡d
::
¡ršg
 
cÚ‹Ás_
;

109 şas 
	cSŒšgSourû
 : 
public
 
RªdomAcûssFe
 {

110 
public
:

111 
SŒšgSourû
(cÚ¡ 
Sliû
& 
cÚ‹Ás
)

112 : 
cÚ‹Ás_
(
cÚ‹Ás
.
d©a
(), cÚ‹Ás.
size
()) {}

114 
	gvœtu®
 ~
SŒšgSourû
() {}

116 
ušt64_t
 
Size
(ècÚ¡ {  
	gcÚ‹Ás_
.
size
(); }

118 
vœtu®
 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

119 * 
sü©ch
) const {

120 ià(
	goff£t
 >ğ
cÚ‹Ás_
.
size
()) {

121  
Stus
::
Inv®idArgum’t
("invalid Read offset");

123 ià(
	goff£t
 + 
	gn
 > 
	gcÚ‹Ás_
.
size
()) {

124 
	gn
 = 
cÚ‹Ás_
.
size
(è- 
off£t
;

126 
memıy
(
sü©ch
, &
cÚ‹Ás_
[
off£t
], 
n
);

127 *
	g»suÉ
 = 
Sliû
(
sü©ch
, 
n
);

128  
	gStus
::
OK
();

131 
	g´iv©e
:

132 
¡d
::
¡ršg
 
cÚ‹Ás_
;

135 
	g¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, std::¡ršg, 
	tSTLLessThª
> 
	tKVM­
;

139 şas 
	cCÚ¡ruùÜ
 {

140 
	gpublic
:

141 
ex¶ic™
 
CÚ¡ruùÜ
(cÚ¡ 
Com·¿tÜ
* 
cmp
è: 
d©a_
(
STLLessThª
(cmp)) {}

142 
vœtu®
 ~
CÚ¡ruùÜ
() {}

144 
Add
(cÚ¡ 
¡d
::
¡ršg
& 
key
, cÚ¡ 
Sliû
& 
v®ue
) {

145 
	gd©a_
[
key
] = 
v®ue
.
ToSŒšg
();

151 
Fšish
(cÚ¡ 
O±iÚs
& 
İtiÚs
, 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
keys
,

152 
KVM­
* 
kvm­
) {

153 *
	gkvm­
 = 
d©a_
;

154 
	gkeys
->
ş—r
();

155 
	gKVM­
::
cÚ¡_™”©Ü
 
™
 = 
d©a_
.
begš
(); 
	g™
 !ğd©a_.
’d
(); ++it) {

156 
	gkeys
->
push_back
(
™
->
fœ¡
);

158 
	gd©a_
.
ş—r
();

159 
Stus
 
	gs
 = 
FšishIm¶
(
İtiÚs
, *
kvm­
);

160 
ASSERT_TRUE
(
s
.
ok
()è<< 
	gs
.
ToSŒšg
();

164 
vœtu®
 
Stus
 
FšishIm¶
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
KVM­
& 
d©a
) = 0;

166 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
() const = 0;

168 
vœtu®
 cÚ¡ 
	gKVM­
& 
d©a
(è{  
	gd©a_
; }

170 
vœtu®
 
DB
* 
db
(ècÚ¡ {  
	gnuÎ±r
; }

172 
	g´iv©e
:

173 
KVM­
 
d©a_
;

176 şas 
	cBlockCÚ¡ruùÜ
 : 
public
 
CÚ¡ruùÜ
 {

177 
public
:

178 
ex¶ic™
 
BlockCÚ¡ruùÜ
(cÚ¡ 
Com·¿tÜ
* 
cmp
)

179 : 
CÚ¡ruùÜ
(
cmp
), 
com·¿tÜ_
(cmp), 
block_
(
nuÎ±r
) {}

180 ~
BlockCÚ¡ruùÜ
(è{ 
d–‘e
 
	gblock_
; }

181 
vœtu®
 
Stus
 
FšishIm¶
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
KVM­
& 
d©a
) {

182 
d–‘e
 
	gblock_
;

183 
	gblock_
 = 
nuÎ±r
;

184 
BlockBud”
 
bud”
(&
İtiÚs
);

186 
	gKVM­
::
cÚ¡_™”©Ü
 
™
 = 
d©a
.
begš
(); 
	g™
 !ğd©a.
’d
(); ++it) {

187 
	gbud”
.
Add
(
™
->
fœ¡
, it->
£cÚd
);

190 
	gd©a_
 = 
bud”
.
Fšish
().
ToSŒšg
();

191 
BlockCÚ‹Ás
 
	gcÚ‹Ás
;

192 
	gcÚ‹Ás
.
	gd©a
 = 
d©a_
;

193 
	gcÚ‹Ás
.
	gÿchabË
 = 
çl£
;

194 
	gcÚ‹Ás
.
	gh—p_®loÿ‹d
 = 
çl£
;

195 
	gblock_
 = 
Ãw
 
Block
(
cÚ‹Ás
);

196  
	gStus
::
OK
();

198 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
() const {

199  
	gblock_
->
NewI‹¿tÜ
(
com·¿tÜ_
);

202 
	g´iv©e
:

203 cÚ¡ 
Com·¿tÜ
* 
com·¿tÜ_
;

204 
	g¡d
::
¡ršg
 
d©a_
;

205 
Block
* 
	gblock_
;

207 
BlockCÚ¡ruùÜ
();

210 şas 
	cTabËCÚ¡ruùÜ
 : 
public
 
CÚ¡ruùÜ
 {

211 
public
:

212 
TabËCÚ¡ruùÜ
(cÚ¡ 
Com·¿tÜ
* 
cmp
)

213 : 
CÚ¡ruùÜ
(
cmp
), 
sourû_
(
nuÎ±r
), 
bË_
(nullptr) {}

214 ~
TabËCÚ¡ruùÜ
(è{ 
Re£t
(); }

215 
vœtu®
 
Stus
 
FšishIm¶
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
KVM­
& 
d©a
) {

216 
Re£t
();

217 
SŒšgSšk
 
	gsšk
;

218 
TabËBud”
 
bud”
(
İtiÚs
, &
sšk
);

220 
	gKVM­
::
cÚ¡_™”©Ü
 
™
 = 
d©a
.
begš
(); 
	g™
 !ğd©a.
’d
(); ++it) {

221 
	gbud”
.
Add
(
™
->
fœ¡
, it->
£cÚd
);

222 
ASSERT_TRUE
(
bud”
.
¡©us
().
ok
());

224 
Stus
 
	gs
 = 
bud”
.
Fšish
();

225 
ASSERT_TRUE
(
s
.
ok
()è<< 
	gs
.
ToSŒšg
();

227 
ASSERT_EQ
(
sšk
.
cÚ‹Ás
().
size
(), 
bud”
.
FeSize
());

230 
	gsourû_
 = 
Ãw
 
SŒšgSourû
(
sšk
.
cÚ‹Ás
());

231 
O±iÚs
 
	gbË_İtiÚs
;

232 
	gbË_İtiÚs
.
	gcom·¿tÜ
 = 
İtiÚs
.
com·¿tÜ
;

233  
	gTabË
::
O³n
(
bË_İtiÚs
, 
sourû_
, 
sšk
.
cÚ‹Ás
().
size
(), &
bË_
);

236 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
() const {

237  
	gbË_
->
NewI‹¿tÜ
(
R—dO±iÚs
());

240 
ušt64_t
 
Aµroxim©eOff£tOf
(cÚ¡ 
Sliû
& 
key
) const {

241  
	gbË_
->
Aµroxim©eOff£tOf
(
key
);

244 
	g´iv©e
:

245 
Re£t
() {

246 
d–‘e
 
bË_
;

247 
d–‘e
 
	gsourû_
;

248 
	gbË_
 = 
nuÎ±r
;

249 
	gsourû_
 = 
nuÎ±r
;

252 
SŒšgSourû
* 
	gsourû_
;

253 
TabË
* 
	gbË_
;

255 
TabËCÚ¡ruùÜ
();

259 şas 
	cKeyCÚv”tšgI‹¿tÜ
 : 
public
 
I‹¿tÜ
 {

260 
public
:

261 
ex¶ic™
 
KeyCÚv”tšgI‹¿tÜ
(
I‹¿tÜ
* 
™”
è: 
™”_
(iter) {}

262 
vœtu®
 ~
KeyCÚv”tšgI‹¿tÜ
(è{ 
d–‘e
 
™”_
; }

263 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  
	g™”_
->Valid(); }

264 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
rg‘
) {

265 
P¬£dIÁ”ÇlKey
 
ikey
(
rg‘
, 
kMaxSequ’ûNumb”
, 
kTy³V®ue
);

266 
	g¡d
::
¡ršg
 
’coded
;

267 
Aµ’dIÁ”ÇlKey
(&
’coded
, 
ikey
);

268 
	g™”_
->
S“k
(
’coded
);

270 
vœtu®
 
S“kToFœ¡
(è{ 
	g™”_
->SeekToFirst(); }

271 
vœtu®
 
S“kToLa¡
(è{ 
	g™”_
->SeekToLast(); }

272 
vœtu®
 
Next
(è{ 
	g™”_
->Next(); }

273 
vœtu®
 
P»v
(è{ 
	g™”_
->Prev(); }

275 
vœtu®
 
Sliû
 
key
() const {

276 
as£¹
(
V®id
());

277 
P¬£dIÁ”ÇlKey
 
	gkey
;

278 ià(!
P¬£IÁ”ÇlKey
(
™”_
->
key
(), &key)) {

279 
	g¡©us_
 = 
Stus
::
CÜru±iÚ
("malformed internal key");

280  
Sliû
("corrupted key");

282  
	gkey
.
	gu£r_key
;

285 
vœtu®
 
Sliû
 
v®ue
(ècÚ¡ {  
	g™”_
->value(); }

286 
vœtu®
 
Stus
 
¡©us
() const {

287  
	g¡©us_
.
ok
(è? 
	g™”_
->
¡©us
(è: 
¡©us_
;

290 
	g´iv©e
:

291 
mubË
 
Stus
 
¡©us_
;

292 
I‹¿tÜ
* 
	g™”_
;

295 
KeyCÚv”tšgI‹¿tÜ
(const KeyConvertingIterator&);

296 
	gİ”©Ü
=(cÚ¡ 
KeyCÚv”tšgI‹¿tÜ
&);

299 şas 
	cMemTabËCÚ¡ruùÜ
 : 
public
 
CÚ¡ruùÜ
 {

300 
public
:

301 
ex¶ic™
 
MemTabËCÚ¡ruùÜ
(cÚ¡ 
Com·¿tÜ
* 
cmp
)

302 : 
CÚ¡ruùÜ
(
cmp
), 
š‹º®_com·¿tÜ_
(cmp) {

303 
	gmembË_
 = 
Ãw
 
MemTabË
(
š‹º®_com·¿tÜ_
);

304 
	gmembË_
->
Ref
();

306 ~
MemTabËCÚ¡ruùÜ
(è{ 
	gmembË_
->
UÄef
(); }

307 
vœtu®
 
Stus
 
FšishIm¶
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
KVM­
& 
d©a
) {

308 
	gmembË_
->
UÄef
();

309 
	gmembË_
 = 
Ãw
 
MemTabË
(
š‹º®_com·¿tÜ_
);

310 
	gmembË_
->
Ref
();

311 
	g£q
 = 1;

312 
	gKVM­
::
cÚ¡_™”©Ü
 
™
 = 
d©a
.
begš
(); 
	g™
 !ğd©a.
’d
(); ++it) {

313 
	gmembË_
->
Add
(
£q
, 
kTy³V®ue
, 
™
->
fœ¡
, it->
£cÚd
);

314 
	g£q
++;

316  
	gStus
::
OK
();

318 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
() const {

319  
Ãw
 
KeyCÚv”tšgI‹¿tÜ
(
membË_
->
NewI‹¿tÜ
());

322 
	g´iv©e
:

323 
IÁ”ÇlKeyCom·¿tÜ
 
š‹º®_com·¿tÜ_
;

324 
MemTabË
* 
	gmembË_
;

327 şas 
	cDBCÚ¡ruùÜ
 : 
public
 
CÚ¡ruùÜ
 {

328 
public
:

329 
ex¶ic™
 
DBCÚ¡ruùÜ
(cÚ¡ 
Com·¿tÜ
* 
cmp
)

330 : 
CÚ¡ruùÜ
(
cmp
), 
com·¿tÜ_
(cmp) {

331 
	gdb_
 = 
nuÎ±r
;

332 
NewDB
();

334 ~
DBCÚ¡ruùÜ
(è{ 
d–‘e
 
	gdb_
; }

335 
vœtu®
 
Stus
 
FšishIm¶
(cÚ¡ 
O±iÚs
& 
İtiÚs
, cÚ¡ 
KVM­
& 
d©a
) {

336 
d–‘e
 
	gdb_
;

337 
	gdb_
 = 
nuÎ±r
;

338 
NewDB
();

339 
	gKVM­
::
cÚ¡_™”©Ü
 
™
 = 
d©a
.
begš
(); 
	g™
 !ğd©a.
’d
(); ++it) {

340 
Wr™eB©ch
 
	gb©ch
;

341 
	gb©ch
.
Put
(
™
->
fœ¡
, it->
£cÚd
);

342 
ASSERT_TRUE
(
db_
->
Wr™e
(
Wr™eO±iÚs
(), &
b©ch
).
ok
());

344  
	gStus
::
OK
();

346 
vœtu®
 
I‹¿tÜ
* 
NewI‹¿tÜ
() const {

347  
	gdb_
->
NewI‹¿tÜ
(
R—dO±iÚs
());

350 
vœtu®
 
DB
* 
db
(ècÚ¡ {  
	gdb_
; }

352 
	g´iv©e
:

353 
NewDB
() {

354 
¡d
::
¡ršg
 
Çme
 = 
‹¡
::
TmpDœ
() + "/table_testdb";

356 
O±iÚs
 
	gİtiÚs
;

357 
	gİtiÚs
.
	gcom·¿tÜ
 = 
com·¿tÜ_
;

358 
Stus
 
	g¡©us
 = 
De¡royDB
(
Çme
, 
İtiÚs
);

359 
ASSERT_TRUE
(
¡©us
.
ok
()è<< 
	g¡©us
.
ToSŒšg
();

361 
	gİtiÚs
.
	gü—‹_if_missšg
 = 
Œue
;

362 
	gİtiÚs
.
	g”rÜ_if_exi¡s
 = 
Œue
;

363 
	gİtiÚs
.
	gwr™e_bufãr_size
 = 10000;

364 
	g¡©us
 = 
DB
::
O³n
(
İtiÚs
, 
Çme
, &
db_
);

365 
ASSERT_TRUE
(
¡©us
.
ok
()è<< 
	g¡©us
.
ToSŒšg
();

368 cÚ¡ 
Com·¿tÜ
* 
	gcom·¿tÜ_
;

369 
DB
* 
	gdb_
;

372 
	eTe¡Ty³
 { 
	gTABLE_TEST
, 
	gBLOCK_TEST
, 
	gMEMTABLE_TEST
, 
	gDB_TEST
 };

374 
	sTe¡Args
 {

375 
Te¡Ty³
 
	gty³
;

376 
boŞ
 
	g»v”£_com·»
;

377 
	g»¡¬t_š‹rv®
;

380 cÚ¡ 
Te¡Args
 
	gkTe¡ArgLi¡
[] = {

381 {
TABLE_TEST
, 
çl£
, 16},

382 {
TABLE_TEST
, 
çl£
, 1},

383 {
TABLE_TEST
, 
çl£
, 1024},

384 {
TABLE_TEST
, 
Œue
, 16},

385 {
TABLE_TEST
, 
Œue
, 1},

386 {
TABLE_TEST
, 
Œue
, 1024},

388 {
BLOCK_TEST
, 
çl£
, 16},

389 {
BLOCK_TEST
, 
çl£
, 1},

390 {
BLOCK_TEST
, 
çl£
, 1024},

391 {
BLOCK_TEST
, 
Œue
, 16},

392 {
BLOCK_TEST
, 
Œue
, 1},

393 {
BLOCK_TEST
, 
Œue
, 1024},

396 {
MEMTABLE_TEST
, 
çl£
, 16},

397 {
MEMTABLE_TEST
, 
Œue
, 16},

400 {
DB_TEST
, 
çl£
, 16},

401 {
DB_TEST
, 
Œue
, 16},

403 cÚ¡ 
	gkNumTe¡Args
 = (
kTe¡ArgLi¡
) / (kTestArgList[0]);

405 şas 
	cH¬Ãss
 {

406 
	gpublic
:

407 
H¬Ãss
(è: 
cÚ¡ruùÜ_
(
nuÎ±r
) {}

409 
In™
(cÚ¡ 
Te¡Args
& 
¬gs
) {

410 
d–‘e
 
cÚ¡ruùÜ_
;

411 
	gcÚ¡ruùÜ_
 = 
nuÎ±r
;

412 
	gİtiÚs_
 = 
O±iÚs
();

414 
	gİtiÚs_
.
	gblock_»¡¬t_š‹rv®
 = 
¬gs
.
»¡¬t_š‹rv®
;

417 
	gİtiÚs_
.
	gblock_size
 = 256;

418 ià(
	g¬gs
.
	g»v”£_com·»
) {

419 
	gİtiÚs_
.
	gcom·¿tÜ
 = &
»v”£_key_com·¿tÜ
;

421 
	g¬gs
.
	gty³
) {

422 
	gTABLE_TEST
:

423 
cÚ¡ruùÜ_
 = 
Ãw
 
TabËCÚ¡ruùÜ
(
İtiÚs_
.
com·¿tÜ
);

425 
	gBLOCK_TEST
:

426 
cÚ¡ruùÜ_
 = 
Ãw
 
BlockCÚ¡ruùÜ
(
İtiÚs_
.
com·¿tÜ
);

428 
	gMEMTABLE_TEST
:

429 
cÚ¡ruùÜ_
 = 
Ãw
 
MemTabËCÚ¡ruùÜ
(
İtiÚs_
.
com·¿tÜ
);

431 
	gDB_TEST
:

432 
cÚ¡ruùÜ_
 = 
Ãw
 
DBCÚ¡ruùÜ
(
İtiÚs_
.
com·¿tÜ
);

437 ~
H¬Ãss
(è{ 
d–‘e
 
	gcÚ¡ruùÜ_
; }

439 
Add
(cÚ¡ 
¡d
::
¡ršg
& 
key
, cÚ¡ std::¡ršg& 
v®ue
) {

440 
cÚ¡ruùÜ_
->
Add
(
key
, 
v®ue
);

443 
Te¡
(
Rªdom
* 
ºd
) {

444 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
keys
;

445 
KVM­
 
	gd©a
;

446 
	gcÚ¡ruùÜ_
->
Fšish
(
İtiÚs_
, &
keys
, &
d©a
);

448 
Te¡FÜw¬dSÿn
(
keys
, 
d©a
);

449 
Te¡Backw¬dSÿn
(
keys
, 
d©a
);

450 
Te¡RªdomAcûss
(
ºd
, 
keys
, 
d©a
);

453 
Te¡FÜw¬dSÿn
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
>& 
keys
,

454 cÚ¡ 
KVM­
& 
d©a
) {

455 
I‹¿tÜ
* 
	g™”
 = 
cÚ¡ruùÜ_
->
NewI‹¿tÜ
();

456 
ASSERT_TRUE
(!
™”
->
V®id
());

457 
	g™”
->
S“kToFœ¡
();

458 
	gKVM­
::
cÚ¡_™”©Ü
 
mod–_™”
 = 
d©a
.
begš
();

459 
	gmod–_™”
 !ğ
d©a
.
’d
(); ++model_iter) {

460 
ASSERT_EQ
(
ToSŒšg
(
d©a
, 
mod–_™”
), ToSŒšg(
™”
));

461 
	g™”
->
Next
();

463 
ASSERT_TRUE
(!
™”
->
V®id
());

464 
d–‘e
 
	g™”
;

467 
Te¡Backw¬dSÿn
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
>& 
keys
,

468 cÚ¡ 
KVM­
& 
d©a
) {

469 
I‹¿tÜ
* 
	g™”
 = 
cÚ¡ruùÜ_
->
NewI‹¿tÜ
();

470 
ASSERT_TRUE
(!
™”
->
V®id
());

471 
	g™”
->
S“kToLa¡
();

472 
	gKVM­
::
cÚ¡_»v”£_™”©Ü
 
mod–_™”
 = 
d©a
.
rbegš
();

473 
	gmod–_™”
 !ğ
d©a
.
»nd
(); ++model_iter) {

474 
ASSERT_EQ
(
ToSŒšg
(
d©a
, 
mod–_™”
), ToSŒšg(
™”
));

475 
	g™”
->
P»v
();

477 
ASSERT_TRUE
(!
™”
->
V®id
());

478 
d–‘e
 
	g™”
;

481 
Te¡RªdomAcûss
(
Rªdom
* 
ºd
, cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
>& 
keys
,

482 cÚ¡ 
KVM­
& 
d©a
) {

483 cÚ¡ 
boŞ
 
	gkV”bo£
 = 
çl£
;

484 
I‹¿tÜ
* 
	g™”
 = 
cÚ¡ruùÜ_
->
NewI‹¿tÜ
();

485 
ASSERT_TRUE
(!
™”
->
V®id
());

486 
	gKVM­
::
cÚ¡_™”©Ü
 
mod–_™”
 = 
d©a
.
begš
();

487 ià(
	gkV”bo£
è
årštf
(
¡d”r
, "---\n");

488 
	gi
 = 0; i < 200; i++) {

489 cÚ¡ 
	gtoss
 = 
ºd
->
UnifÜm
(5);

490 
	gtoss
) {

492 ià(
™”
->
V®id
()) {

493 ià(
kV”bo£
è
årštf
(
¡d”r
, "Next\n");

494 
	g™”
->
Next
();

495 ++
	gmod–_™”
;

496 
ASSERT_EQ
(
ToSŒšg
(
d©a
, 
mod–_™”
), ToSŒšg(
™”
));

502 ià(
kV”bo£
è
årštf
(
¡d”r
, "SeekToFirst\n");

503 
	g™”
->
S“kToFœ¡
();

504 
	gmod–_™”
 = 
d©a
.
begš
();

505 
ASSERT_EQ
(
ToSŒšg
(
d©a
, 
mod–_™”
), ToSŒšg(
™”
));

510 
¡d
::
¡ršg
 
key
 = 
PickRªdomKey
(
ºd
, 
keys
);

511 
	gmod–_™”
 = 
d©a
.
low”_bound
(
key
);

512 ià(
	gkV”bo£
)

513 
årštf
(
¡d”r
, "S“k '%s'\n", 
Esÿ³SŒšg
(
key
).
c_¡r
());

514 
	g™”
->
S“k
(
Sliû
(
key
));

515 
ASSERT_EQ
(
ToSŒšg
(
d©a
, 
mod–_™”
), ToSŒšg(
™”
));

520 ià(
™”
->
V®id
()) {

521 ià(
kV”bo£
è
årštf
(
¡d”r
, "Prev\n");

522 
	g™”
->
P»v
();

523 ià(
	gmod–_™”
 =ğ
d©a
.
begš
()) {

524 
mod–_™”
 = 
d©a
.
’d
();

526 --
	gmod–_™”
;

528 
ASSERT_EQ
(
ToSŒšg
(
d©a
, 
mod–_™”
), ToSŒšg(
™”
));

534 ià(
kV”bo£
è
årštf
(
¡d”r
, "SeekToLast\n");

535 
	g™”
->
S“kToLa¡
();

536 ià(
	gkeys
.
em±y
()) {

537 
	gmod–_™”
 = 
d©a
.
’d
();

539 
	g¡d
::
¡ršg
 
Ï¡
 = 
d©a
.
rbegš
()->
fœ¡
;

540 
	gmod–_™”
 = 
d©a
.
low”_bound
(
Ï¡
);

542 
ASSERT_EQ
(
ToSŒšg
(
d©a
, 
mod–_™”
), ToSŒšg(
™”
));

547 
d–‘e
 
	g™”
;

550 
	g¡d
::
¡ršg
 
ToSŒšg
(cÚ¡ 
KVM­
& 
d©a
, cÚ¡ KVM­::
cÚ¡_™”©Ü
& 
™
) {

551 ià(
™
 =ğ
d©a
.
’d
()) {

554  "'" + 
	g™
->
	gfœ¡
 + "->" + it->
	g£cÚd
 + "'";

558 
	g¡d
::
¡ršg
 
ToSŒšg
(cÚ¡ 
KVM­
& 
d©a
,

559 cÚ¡ 
KVM­
::
cÚ¡_»v”£_™”©Ü
& 
™
) {

560 ià(
™
 =ğ
d©a
.
»nd
()) {

563  "'" + 
	g™
->
	gfœ¡
 + "->" + it->
	g£cÚd
 + "'";

567 
	g¡d
::
¡ršg
 
ToSŒšg
(cÚ¡ 
I‹¿tÜ
* 
™
) {

568 ià(!
™
->
V®id
()) {

571  "'" + 
	g™
->
key
().
ToSŒšg
(è+ "->" + it->
v®ue
().ToString() + "'";

575 
	g¡d
::
¡ršg
 
PickRªdomKey
(
Rªdom
* 
ºd
, cÚ¡ 
¡d
::
veùÜ
<¡d::¡ršg>& 
keys
) {

576 ià(
keys
.
em±y
()) {

579 cÚ¡ 
	gšdex
 = 
ºd
->
UnifÜm
(
keys
.
size
());

580 
	g¡d
::
¡ršg
 
»suÉ
 = 
keys
[
šdex
];

581 
	gºd
->
UnifÜm
(3)) {

587 ià(!
»suÉ
.
em±y
(è&&„esuÉ[»suÉ.
size
() - 1] > '\0') {

588 
»suÉ
[»suÉ.
size
() - 1]--;

594 
Inüem’t
(
İtiÚs_
.
com·¿tÜ
, &
»suÉ
);

598  
	g»suÉ
;

603 
DB
* 
db
(ècÚ¡ {  
	gcÚ¡ruùÜ_
->db(); }

605 
	g´iv©e
:

606 
O±iÚs
 
İtiÚs_
;

607 
CÚ¡ruùÜ
* 
	gcÚ¡ruùÜ_
;

611 
	$TEST
(
H¬Ãss
, 
Em±y
) {

612 
i
 = 0; i < 
kNumTe¡Args
; i++) {

613 
	`In™
(
kTe¡ArgLi¡
[
i
]);

614 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
() + 1);

615 
	`Te¡
(&
ºd
);

617 
	}
}

622 
	$TEST
(
H¬Ãss
, 
Z”oRe¡¬tPoštsInBlock
) {

623 
d©a
[(
ušt32_t
)];

624 
	`mem£t
(
d©a
, 0, (data));

625 
BlockCÚ‹Ás
 
cÚ‹Ás
;

626 
cÚ‹Ás
.
d©a
 = 
	`Sliû
(data, (data));

627 
cÚ‹Ás
.
ÿchabË
 = 
çl£
;

628 
cÚ‹Ás
.
h—p_®loÿ‹d
 = 
çl£
;

629 
Block
 
	`block
(
cÚ‹Ás
);

630 
I‹¿tÜ
* 
™”
 = 
block
.
	`NewI‹¿tÜ
(
	`By‹wi£Com·¿tÜ
());

631 
™”
->
	`S“kToFœ¡
();

632 
	`ASSERT_TRUE
(!
™”
->
	`V®id
());

633 
™”
->
	`S“kToLa¡
();

634 
	`ASSERT_TRUE
(!
™”
->
	`V®id
());

635 
™”
->
	`S“k
("foo");

636 
	`ASSERT_TRUE
(!
™”
->
	`V®id
());

637 
d–‘e
 
™”
;

638 
	}
}

641 
	$TEST
(
H¬Ãss
, 
Sim¶eEm±yKey
) {

642 
i
 = 0; i < 
kNumTe¡Args
; i++) {

643 
	`In™
(
kTe¡ArgLi¡
[
i
]);

644 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
() + 1);

645 
	`Add
("", "v");

646 
	`Te¡
(&
ºd
);

648 
	}
}

650 
	$TEST
(
H¬Ãss
, 
Sim¶eSšgË
) {

651 
i
 = 0; i < 
kNumTe¡Args
; i++) {

652 
	`In™
(
kTe¡ArgLi¡
[
i
]);

653 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
() + 2);

654 
	`Add
("abc", "v");

655 
	`Te¡
(&
ºd
);

657 
	}
}

659 
	$TEST
(
H¬Ãss
, 
Sim¶eMuÉi
) {

660 
i
 = 0; i < 
kNumTe¡Args
; i++) {

661 
	`In™
(
kTe¡ArgLi¡
[
i
]);

662 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
() + 3);

663 
	`Add
("abc", "v");

664 
	`Add
("abcd", "v");

665 
	`Add
("ac", "v2");

666 
	`Te¡
(&
ºd
);

668 
	}
}

670 
	$TEST
(
H¬Ãss
, 
Sim¶eS³cŸlKey
) {

671 
i
 = 0; i < 
kNumTe¡Args
; i++) {

672 
	`In™
(
kTe¡ArgLi¡
[
i
]);

673 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
() + 4);

674 
	`Add
("\xff\xff", "v3");

675 
	`Te¡
(&
ºd
);

677 
	}
}

679 
	$TEST
(
H¬Ãss
, 
Rªdomized
) {

680 
i
 = 0; i < 
kNumTe¡Args
; i++) {

681 
	`In™
(
kTe¡ArgLi¡
[
i
]);

682 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
() + 5);

683 
num_’Œ›s
 = 0;‚um_entries < 2000;

684 
num_’Œ›s
 += (num_entries < 50 ? 1 : 200)) {

685 ià((
num_’Œ›s
 % 10) == 0) {

686 
	`årštf
(
¡d”r
, "ÿ£ %d oà%d:‚um_’Œ› ğ%d\n", (
i
 + 1),

687 (
kNumTe¡Args
), 
num_’Œ›s
);

689 
e
 = 0;ƒ < 
num_’Œ›s
;ƒ++) {

690 
¡d
::
¡ršg
 
v
;

691 
	`Add
(
‹¡
::
	`RªdomKey
(&
ºd
,„nd.
	`Skewed
(4)),

692 
‹¡
::
	`RªdomSŒšg
(&
ºd
,„nd.
	`Skewed
(5), &
v
).
	`ToSŒšg
());

694 
	`Te¡
(&
ºd
);

697 
	}
}

699 
	$TEST
(
H¬Ãss
, 
RªdomizedLÚgDB
) {

700 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
());

701 
Te¡Args
 
¬gs
 = {
DB_TEST
, 
çl£
, 16};

702 
	`In™
(
¬gs
);

703 
num_’Œ›s
 = 100000;

704 
e
 = 0;ƒ < 
num_’Œ›s
;ƒ++) {

705 
¡d
::
¡ršg
 
v
;

706 
	`Add
(
‹¡
::
	`RªdomKey
(&
ºd
,„nd.
	`Skewed
(4)),

707 
‹¡
::
	`RªdomSŒšg
(&
ºd
,„nd.
	`Skewed
(5), &
v
).
	`ToSŒšg
());

709 
	`Te¡
(&
ºd
);

712 
fes
 = 0;

713 
Ëv–
 = 0;†ev– < 
cÚfig
::
kNumLev–s
;†evel++) {

714 
¡d
::
¡ršg
 
v®ue
;

715 
Çme
[100];

716 
	`¢´štf
(
Çme
, Òame), "Ëv–db.num-fes-©-Ëv–%d", 
Ëv–
);

717 
	`ASSERT_TRUE
(
	`db
()->
	`G‘Prİ”ty
(
Çme
, &
v®ue
));

718 
fes
 +ğ
	`©oi
(
v®ue
.
	`c_¡r
());

720 
	`ASSERT_GT
(
fes
, 0);

721 
	}
}

723 şas 
	cMemTabËTe¡
 {};

725 
	$TEST
(
MemTabËTe¡
, 
Sim¶e
) {

726 
IÁ”ÇlKeyCom·¿tÜ
 
	`cmp
(
	`By‹wi£Com·¿tÜ
());

727 
MemTabË
* 
membË
 = 
Ãw
 
	`MemTabË
(
cmp
);

728 
membË
->
	`Ref
();

729 
Wr™eB©ch
 
b©ch
;

730 
Wr™eB©chIÁ”Çl
::
	`S‘Sequ’û
(&
b©ch
, 100);

731 
b©ch
.
	`Put
(
¡d
::
	`¡ršg
("k1"), std::string("v1"));

732 
b©ch
.
	`Put
(
¡d
::
	`¡ršg
("k2"), std::string("v2"));

733 
b©ch
.
	`Put
(
¡d
::
	`¡ršg
("k3"), std::string("v3"));

734 
b©ch
.
	`Put
(
¡d
::
	`¡ršg
("largekey"), std::string("vlarge"));

735 
	`ASSERT_TRUE
(
Wr™eB©chIÁ”Çl
::
	`In£¹IÁo
(&
b©ch
, 
membË
).
	`ok
());

737 
I‹¿tÜ
* 
™”
 = 
membË
->
	`NewI‹¿tÜ
();

738 
™”
->
	`S“kToFœ¡
();

739 
™”
->
	`V®id
()) {

740 
	`årštf
(
¡d”r
, "key: '%s' -> '%s'\n", 
™”
->
	`key
().
	`ToSŒšg
().
	`c_¡r
(),

741 
™”
->
	`v®ue
().
	`ToSŒšg
().
	`c_¡r
());

742 
™”
->
	`Next
();

745 
d–‘e
 
™”
;

746 
membË
->
	`UÄef
();

747 
	}
}

749 
boŞ
 
	$B‘w“n
(
ušt64_t
 
v®
, ušt64_ˆ
low
, ušt64_ˆ
high
) {

750 
boŞ
 
»suÉ
 = (
v®
 >ğ
low
è&& (v® <ğ
high
);

751 ià(!
»suÉ
) {

752 
	`årštf
(
¡d”r
, "Value %llu is‚ot in„ange [%llu, %llu]\n",

753 ()(
v®
), ()(
low
),

754 ()(
high
));

756  
»suÉ
;

757 
	}
}

759 şas 
	cTabËTe¡
 {};

761 
	$TEST
(
TabËTe¡
, 
Aµroxim©eOff£tOfPÏš
) {

762 
TabËCÚ¡ruùÜ
 
	`c
(
	`By‹wi£Com·¿tÜ
());

763 
c
.
	`Add
("k01", "hello");

764 
c
.
	`Add
("k02", "hello2");

765 
c
.
	`Add
("k03", 
¡d
::
	`¡ršg
(10000, 'x'));

766 
c
.
	`Add
("k04", 
¡d
::
	`¡ršg
(200000, 'x'));

767 
c
.
	`Add
("k05", 
¡d
::
	`¡ršg
(300000, 'x'));

768 
c
.
	`Add
("k06", "hello3");

769 
c
.
	`Add
("k07", 
¡d
::
	`¡ršg
(100000, 'x'));

770 
¡d
::
veùÜ
<¡d::
¡ršg
> 
keys
;

771 
KVM­
 
kvm­
;

772 
O±iÚs
 
İtiÚs
;

773 
İtiÚs
.
block_size
 = 1024;

774 
İtiÚs
.
com´essiÚ
 = 
kNoCom´essiÚ
;

775 
c
.
	`Fšish
(
İtiÚs
, &
keys
, &
kvm­
);

777 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("abc"), 0, 0));

778 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k01"), 0, 0));

779 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k01a"), 0, 0));

780 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k02"), 0, 0));

781 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k03"), 0, 0));

782 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k04"), 10000, 11000));

783 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k04a"), 210000, 211000));

784 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k05"), 210000, 211000));

785 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k06"), 510000, 511000));

786 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k07"), 510000, 511000));

787 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("xyz"), 610000, 612000));

788 
	}
}

790 
boŞ
 
	$SÇµyCom´essiÚSuµÜ‹d
() {

791 
¡d
::
¡ršg
 
out
;

792 
Sliû
 
š
 = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";

793  
pÜt
::
	`SÇµy_Com´ess
(
š
.
	`d©a
(), in.
	`size
(), &
out
);

794 
	}
}

796 
	$TEST
(
TabËTe¡
, 
Aµroxim©eOff£tOfCom´es£d
) {

797 ià(!
	`SÇµyCom´essiÚSuµÜ‹d
()) {

798 
	`årštf
(
¡d”r
, "skipping compressionests\n");

802 
Rªdom
 
	`ºd
(301);

803 
TabËCÚ¡ruùÜ
 
	`c
(
	`By‹wi£Com·¿tÜ
());

804 
¡d
::
¡ršg
 
tmp
;

805 
c
.
	`Add
("k01", "hello");

806 
c
.
	`Add
("k02", 
‹¡
::
	`Com´essibËSŒšg
(&
ºd
, 0.25, 10000, &
tmp
));

807 
c
.
	`Add
("k03", "hello3");

808 
c
.
	`Add
("k04", 
‹¡
::
	`Com´essibËSŒšg
(&
ºd
, 0.25, 10000, &
tmp
));

809 
¡d
::
veùÜ
<¡d::
¡ršg
> 
keys
;

810 
KVM­
 
kvm­
;

811 
O±iÚs
 
İtiÚs
;

812 
İtiÚs
.
block_size
 = 1024;

813 
İtiÚs
.
com´essiÚ
 = 
kSÇµyCom´essiÚ
;

814 
c
.
	`Fšish
(
İtiÚs
, &
keys
, &
kvm­
);

817 cÚ¡ 
kSlİ
 = 1000;

818 cÚ¡ 
ex³ùed
 = 2500;

819 cÚ¡ 
mš_z
 = 
ex³ùed
 - 
kSlİ
;

820 cÚ¡ 
max_z
 = 
ex³ùed
 + 
kSlİ
;

822 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("abc"), 0, 
kSlİ
));

823 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k01"), 0, 
kSlİ
));

824 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k02"), 0, 
kSlİ
));

826 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k03"), 
mš_z
, 
max_z
));

827 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("k04"), 
mš_z
, 
max_z
));

829 
	`ASSERT_TRUE
(
	`B‘w“n
(
c
.
	`Aµroxim©eOff£tOf
("xyz"), 2 * 
mš_z
, 2 * 
max_z
));

830 
	}
}

834 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@table/two_level_iterator.cc

5 
	~"bË/two_Ëv–_™”©Ü.h
"

7 
	~"Ëv–db/bË.h
"

8 
	~"bË/block.h
"

9 
	~"bË/fÜm©.h
"

10 
	~"bË/™”©Ü_w¿µ”.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 
	gÇme¥aû
 {

16 
	gI‹¿tÜ
* (*
	tBlockFunùiÚ
)(*, cÚ¡ 
	tR—dO±iÚs
&, cÚ¡ 
	tSliû
&);

18 şas 
	cTwoLev–I‹¿tÜ
 : 
public
 
I‹¿tÜ
 {

19 
public
:

20 
TwoLev–I‹¿tÜ
(
I‹¿tÜ
* 
šdex_™”
, 
BlockFunùiÚ
 
block_funùiÚ
,

21 * 
¬g
, cÚ¡ 
R—dO±iÚs
& 
İtiÚs
);

23 
	gvœtu®
 ~
TwoLev–I‹¿tÜ
();

25 
vœtu®
 
S“k
(cÚ¡ 
Sliû
& 
rg‘
);

26 
vœtu®
 
S“kToFœ¡
();

27 
vœtu®
 
S“kToLa¡
();

28 
vœtu®
 
Next
();

29 
vœtu®
 
P»v
();

31 
vœtu®
 
boŞ
 
V®id
(ècÚ¡ {  
	gd©a_™”_
.Valid(); }

32 
vœtu®
 
Sliû
 
key
() const {

33 
as£¹
(
V®id
());

34  
	gd©a_™”_
.
key
();

36 
vœtu®
 
Sliû
 
v®ue
() const {

37 
as£¹
(
V®id
());

38  
	gd©a_™”_
.
v®ue
();

40 
vœtu®
 
Stus
 
¡©us
() const {

42 ià(!
	gšdex_™”_
.
¡©us
().
ok
()) {

43  
	gšdex_™”_
.
¡©us
();

44 } ià(
	gd©a_™”_
.
™”
(è!ğ
nuÎ±r
 && !
d©a_™”_
.
¡©us
().
ok
()) {

45  
d©a_™”_
.
¡©us
();

47  
	g¡©us_
;

51 
	g´iv©e
:

52 
SaveE¼Ü
(cÚ¡ 
Stus
& 
s
) {

53 ià(
¡©us_
.
ok
(è&& !
s
.ok()) status_ = s;

55 
SkEm±yD©aBlocksFÜw¬d
();

56 
SkEm±yD©aBlocksBackw¬d
();

57 
S‘D©aI‹¿tÜ
(
I‹¿tÜ
* 
d©a_™”
);

58 
In™D©aBlock
();

60 
BlockFunùiÚ
 
	gblock_funùiÚ_
;

61 * 
	g¬g_
;

62 cÚ¡ 
R—dO±iÚs
 
	gİtiÚs_
;

63 
Stus
 
	g¡©us_
;

64 
I‹¿tÜW¿µ”
 
	gšdex_™”_
;

65 
I‹¿tÜW¿µ”
 
	gd©a_™”_
;

68 
	g¡d
::
¡ršg
 
d©a_block_hªdË_
;

71 
	gTwoLev–I‹¿tÜ
::
TwoLev–I‹¿tÜ
(
I‹¿tÜ
* 
šdex_™”
,

72 
BlockFunùiÚ
 
block_funùiÚ
, * 
¬g
,

73 cÚ¡ 
R—dO±iÚs
& 
İtiÚs
)

74 : 
block_funùiÚ_
(
block_funùiÚ
),

75 
¬g_
(
¬g
),

76 
İtiÚs_
(
İtiÚs
),

77 
šdex_™”_
(
šdex_™”
),

78 
d©a_™”_
(
nuÎ±r
) {}

80 
	gTwoLev–I‹¿tÜ
::~
TwoLev–I‹¿tÜ
() {}

82 
TwoLev–I‹¿tÜ
::
S“k
(cÚ¡ 
Sliû
& 
rg‘
) {

83 
šdex_™”_
.
S“k
(
rg‘
);

84 
In™D©aBlock
();

85 ià(
	gd©a_™”_
.
™”
(è!ğ
nuÎ±r
è
d©a_™”_
.
S“k
(
rg‘
);

86 
SkEm±yD©aBlocksFÜw¬d
();

89 
	gTwoLev–I‹¿tÜ
::
S“kToFœ¡
() {

90 
šdex_™”_
.
S“kToFœ¡
();

91 
In™D©aBlock
();

92 ià(
	gd©a_™”_
.
™”
(è!ğ
nuÎ±r
è
d©a_™”_
.
S“kToFœ¡
();

93 
SkEm±yD©aBlocksFÜw¬d
();

96 
	gTwoLev–I‹¿tÜ
::
S“kToLa¡
() {

97 
šdex_™”_
.
S“kToLa¡
();

98 
In™D©aBlock
();

99 ià(
	gd©a_™”_
.
™”
(è!ğ
nuÎ±r
è
d©a_™”_
.
S“kToLa¡
();

100 
SkEm±yD©aBlocksBackw¬d
();

103 
	gTwoLev–I‹¿tÜ
::
Next
() {

104 
as£¹
(
V®id
());

105 
	gd©a_™”_
.
Next
();

106 
SkEm±yD©aBlocksFÜw¬d
();

109 
	gTwoLev–I‹¿tÜ
::
P»v
() {

110 
as£¹
(
V®id
());

111 
	gd©a_™”_
.
P»v
();

112 
SkEm±yD©aBlocksBackw¬d
();

115 
	gTwoLev–I‹¿tÜ
::
SkEm±yD©aBlocksFÜw¬d
() {

116 
d©a_™”_
.
™”
(è=ğ
nuÎ±r
 || !d©a_™”_.
V®id
()) {

118 ià(!
šdex_™”_
.
V®id
()) {

119 
S‘D©aI‹¿tÜ
(
nuÎ±r
);

122 
	gšdex_™”_
.
Next
();

123 
In™D©aBlock
();

124 ià(
	gd©a_™”_
.
™”
(è!ğ
nuÎ±r
è
d©a_™”_
.
S“kToFœ¡
();

128 
	gTwoLev–I‹¿tÜ
::
SkEm±yD©aBlocksBackw¬d
() {

129 
d©a_™”_
.
™”
(è=ğ
nuÎ±r
 || !d©a_™”_.
V®id
()) {

131 ià(!
šdex_™”_
.
V®id
()) {

132 
S‘D©aI‹¿tÜ
(
nuÎ±r
);

135 
	gšdex_™”_
.
P»v
();

136 
In™D©aBlock
();

137 ià(
	gd©a_™”_
.
™”
(è!ğ
nuÎ±r
è
d©a_™”_
.
S“kToLa¡
();

141 
	gTwoLev–I‹¿tÜ
::
S‘D©aI‹¿tÜ
(
I‹¿tÜ
* 
d©a_™”
) {

142 ià(
d©a_™”_
.
™”
(è!ğ
nuÎ±r
è
SaveE¼Ü
(d©a_™”_.
¡©us
());

143 
	gd©a_™”_
.
S‘
(
d©a_™”
);

146 
	gTwoLev–I‹¿tÜ
::
In™D©aBlock
() {

147 ià(!
šdex_™”_
.
V®id
()) {

148 
S‘D©aI‹¿tÜ
(
nuÎ±r
);

150 
Sliû
 
	ghªdË
 = 
šdex_™”_
.
v®ue
();

151 ià(
	gd©a_™”_
.
™”
(è!ğ
nuÎ±r
 &&

152 
hªdË
.
com·»
(
d©a_block_hªdË_
) == 0) {

156 
I‹¿tÜ
* 
™”
 = (*
block_funùiÚ_
)(
¬g_
, 
	gİtiÚs_
, 
	ghªdË
);

157 
	gd©a_block_hªdË_
.
assign
(
hªdË
.
d©a
(), hªdË.
size
());

158 
S‘D©aI‹¿tÜ
(
™”
);

165 
I‹¿tÜ
* 
	$NewTwoLev–I‹¿tÜ
(
I‹¿tÜ
* 
šdex_™”
,

166 
BlockFunùiÚ
 
block_funùiÚ
, * 
¬g
,

167 cÚ¡ 
R—dO±iÚs
& 
İtiÚs
) {

168  
Ãw
 
	`TwoLev–I‹¿tÜ
(
šdex_™”
, 
block_funùiÚ
, 
¬g
, 
İtiÚs
);

169 
	}
}

	@table/two_level_iterator.h

5 #iâdeà
STORAGE_LEVELDB_TABLE_TWO_LEVEL_ITERATOR_H_


6 
	#STORAGE_LEVELDB_TABLE_TWO_LEVEL_ITERATOR_H_


	)

8 
	~"Ëv–db/™”©Ü.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 
	gR—dO±iÚs
;

23 
I‹¿tÜ
* 
NewTwoLev–I‹¿tÜ
(

24 
I‹¿tÜ
* 
šdex_™”
,

25 
I‹¿tÜ
* (*
block_funùiÚ
)(* 
¬g
, cÚ¡ 
R—dO±iÚs
& 
İtiÚs
,

26 cÚ¡ 
Sliû
& 
šdex_v®ue
),

27 * 
¬g
, cÚ¡ 
R—dO±iÚs
& 
İtiÚs
);

	@util/arena.cc

5 
	~"ut/¬’a.h
"

7 
Çme¥aû
 
	gËv–db
 {

9 cÚ¡ 
	gkBlockSize
 = 4096;

11 
	gA»Ç
::
A»Ç
()

12 : 
®loc_±r_
(
nuÎ±r
), 
®loc_by‹s_»maššg_
(0), 
memÜy_u§ge_
(0) {}

14 
	gA»Ç
::~
A»Ç
() {

15 
size_t
 
i
 = 0; 
	gi
 < 
	gblocks_
.
size
(); i++) {

16 
	gd–‘e
[] 
	gblocks_
[
i
];

20 * 
	gA»Ç
::
AÎoÿ‹F®lback
(
size_t
 
by‹s
) {

21 ià(
by‹s
 > 
kBlockSize
 / 4) {

24 * 
»suÉ
 = 
AÎoÿ‹NewBlock
(
by‹s
);

25  
	g»suÉ
;

29 
	g®loc_±r_
 = 
AÎoÿ‹NewBlock
(
kBlockSize
);

30 
	g®loc_by‹s_»maššg_
 = 
kBlockSize
;

32 * 
	g»suÉ
 = 
®loc_±r_
;

33 
	g®loc_±r_
 +ğ
by‹s
;

34 
	g®loc_by‹s_»maššg_
 -ğ
by‹s
;

35  
	g»suÉ
;

38 * 
	gA»Ç
::
AÎoÿ‹AligÃd
(
size_t
 
by‹s
) {

39 cÚ¡ 
®ign
 = ((*) > 8) ? (*) : 8;

40 
¡©ic_as£¹
((
®ign
 & (align - 1)) == 0,

42 
size_t
 
	gcu¼’t_mod
 = 
»š‹½»t_ÿ¡
<
ušŒ_t
>(
®loc_±r_
è& (
®ign
 - 1);

43 
size_t
 
	g¦İ
 = (
cu¼’t_mod
 =ğ0 ? 0 : 
®ign
 - current_mod);

44 
size_t
 
	gÃeded
 = 
by‹s
 + 
¦İ
;

45 * 
	g»suÉ
;

46 ià(
	gÃeded
 <ğ
®loc_by‹s_»maššg_
) {

47 
»suÉ
 = 
®loc_±r_
 + 
¦İ
;

48 
	g®loc_±r_
 +ğ
Ãeded
;

49 
	g®loc_by‹s_»maššg_
 -ğ
Ãeded
;

52 
	g»suÉ
 = 
AÎoÿ‹F®lback
(
by‹s
);

54 
as£¹
((
»š‹½»t_ÿ¡
<
ušŒ_t
>(
»suÉ
è& (
®ign
 - 1)) == 0);

55  
	g»suÉ
;

58 * 
	gA»Ç
::
AÎoÿ‹NewBlock
(
size_t
 
block_by‹s
) {

59 * 
»suÉ
 = 
Ãw
 [
block_by‹s
];

60 
	gblocks_
.
push_back
(
»suÉ
);

61 
	gmemÜy_u§ge_
.
ãtch_add
(
block_by‹s
 + (*),

62 
¡d
::
memÜy_Üd”_»Ïxed
);

63  
	g»suÉ
;

	@util/arena.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_ARENA_H_


6 
	#STORAGE_LEVELDB_UTIL_ARENA_H_


	)

8 
	~<©omic
>

9 
	~<ÿs£¹
>

10 
	~<c¡ddef
>

11 
	~<c¡dšt
>

12 
	~<veùÜ
>

14 
Çme¥aû
 
	gËv–db
 {

16 şas 
	cA»Ç
 {

17 
	gpublic
:

18 
A»Ç
();

20 
A»Ç
(cÚ¡ A»Ç&èğ
d–‘e
;

21 
	gA»Ç
& 
	gİ”©Ü
=(cÚ¡ 
A»Ç
&èğ
d–‘e
;

23 ~
A»Ç
();

26 * 
AÎoÿ‹
(
size_t
 
by‹s
);

29 * 
AÎoÿ‹AligÃd
(
size_t
 
by‹s
);

33 
size_t
 
MemÜyU§ge
() const {

34  
	gmemÜy_u§ge_
.
lßd
(
¡d
::
memÜy_Üd”_»Ïxed
);

37 
	g´iv©e
:

38 * 
AÎoÿ‹F®lback
(
size_t
 
by‹s
);

39 * 
AÎoÿ‹NewBlock
(
size_t
 
block_by‹s
);

42 * 
	g®loc_±r_
;

43 
size_t
 
	g®loc_by‹s_»maššg_
;

46 
	g¡d
::
veùÜ
<*> 
blocks_
;

52 
	g¡d
::
©omic
<
size_t
> 
memÜy_u§ge_
;

55 
šlše
 * 
	gA»Ç
::
	$AÎoÿ‹
(
size_t
 
by‹s
) {

59 
	`as£¹
(
by‹s
 > 0);

60 ià(
by‹s
 <ğ
®loc_by‹s_»maššg_
) {

61 * 
»suÉ
 = 
®loc_±r_
;

62 
®loc_±r_
 +ğ
by‹s
;

63 
®loc_by‹s_»maššg_
 -ğ
by‹s
;

64  
»suÉ
;

66  
	`AÎoÿ‹F®lback
(
by‹s
);

67 
	}
}

	@util/arena_test.cc

5 
	~"ut/¬’a.h
"

7 
	~"ut/¿ndom.h
"

8 
	~"ut/‹¡h¬Ãss.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 şas 
	cA»ÇTe¡
 {};

14 
	$TEST
(
A»ÇTe¡
, 
Em±y
è{ 
A»Ç
 
¬’a
; 
	}
}

16 
	$TEST
(
A»ÇTe¡
, 
Sim¶e
) {

17 
¡d
::
veùÜ
<¡d::
·œ
<
size_t
, *> > 
®loÿ‹d
;

18 
A»Ç
 
¬’a
;

19 cÚ¡ 
N
 = 100000;

20 
size_t
 
by‹s
 = 0;

21 
Rªdom
 
	`ºd
(301);

22 
i
 = 0; i < 
N
; i++) {

23 
size_t
 
s
;

24 ià(
i
 % (
N
 / 10) == 0) {

25 
s
 = 
i
;

27 
s
 = 
ºd
.
	`OÃIn
(4000)

28 ? 
ºd
.
	`UnifÜm
(6000)

29 : (
ºd
.
	`OÃIn
(10è?„nd.
	`UnifÜm
(100) :„nd.Uniform(20));

31 ià(
s
 == 0) {

33 
s
 = 1;

35 * 
r
;

36 ià(
ºd
.
	`OÃIn
(10)) {

37 
r
 = 
¬’a
.
	`AÎoÿ‹AligÃd
(
s
);

39 
r
 = 
¬’a
.
	`AÎoÿ‹
(
s
);

42 
size_t
 
b
 = 0; b < 
s
; b++) {

44 
r
[
b
] = 
i
 % 256;

46 
by‹s
 +ğ
s
;

47 
®loÿ‹d
.
	`push_back
(
¡d
::
	`make_·œ
(
s
, 
r
));

48 
	`ASSERT_GE
(
¬’a
.
	`MemÜyU§ge
(), 
by‹s
);

49 ià(
i
 > 
N
 / 10) {

50 
	`ASSERT_LE
(
¬’a
.
	`MemÜyU§ge
(), 
by‹s
 * 1.10);

53 
size_t
 
i
 = 0; i < 
®loÿ‹d
.
	`size
(); i++) {

54 
size_t
 
num_by‹s
 = 
®loÿ‹d
[
i
].
fœ¡
;

55 cÚ¡ * 
p
 = 
®loÿ‹d
[
i
].
£cÚd
;

56 
size_t
 
b
 = 0; b < 
num_by‹s
; b++) {

58 
	`ASSERT_EQ
((
p
[
b
]è& 0xff, 
i
 % 256);

61 
	}
}

65 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/bloom.cc

5 
	~"Ëv–db/f‹r_pŞicy.h
"

7 
	~"Ëv–db/¦iû.h
"

8 
	~"ut/hash.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 
	gÇme¥aû
 {

13 
ušt32_t
 
BloomHash
(cÚ¡ 
Sliû
& 
key
) {

14  
Hash
(
key
.
d©a
(), key.
size
(), 0xbc9f1d34);

17 şas 
	cBloomF‹rPŞicy
 : 
public
 
F‹rPŞicy
 {

18 
public
:

19 
ex¶ic™
 
BloomF‹rPŞicy
(
b™s_³r_key
è: 
b™s_³r_key_
(bits_per_key) {

21 
k_
 = 
¡©ic_ÿ¡
<
size_t
>(
b™s_³r_key
 * 0.69);

22 ià(
	gk_
 < 1) k_ = 1;

23 ià(
	gk_
 > 30) k_ = 30;

26 
vœtu®
 cÚ¡ * 
Name
() const {  "leveldb.BuiltinBloomFilter2"; }

28 
vœtu®
 
C»©eF‹r
(cÚ¡ 
Sliû
* 
keys
, 
n
, 
¡d
::
¡ršg
* 
d¡
) const {

30 
size_t
 
b™s
 = 
n
 * 
b™s_³r_key_
;

34 ià(
	gb™s
 < 64) bits = 64;

36 
size_t
 
	gby‹s
 = (
b™s
 + 7) / 8;

37 
	gb™s
 = 
by‹s
 * 8;

39 cÚ¡ 
size_t
 
	gš™_size
 = 
d¡
->
size
();

40 
	gd¡
->
»size
(
š™_size
 + 
by‹s
, 0);

41 
	gd¡
->
push_back
(
¡©ic_ÿ¡
<>(
k_
));

42 * 
	g¬¿y
 = &(*
d¡
)[
š™_size
];

43 
	gi
 = 0; i < 
	gn
; i++) {

46 
ušt32_t
 
	gh
 = 
BloomHash
(
keys
[
i
]);

47 cÚ¡ 
ušt32_t
 
	gd–
 = (
h
 >> 17) | (h << 15);

48 
size_t
 
	gj
 = 0; j < 
	gk_
; j++) {

49 cÚ¡ 
ušt32_t
 
	gb™pos
 = 
h
 % 
b™s
;

50 
	g¬¿y
[
b™pos
 / 8] |= (1 << (bitpos % 8));

51 
	gh
 +ğ
d–
;

56 
vœtu®
 
boŞ
 
KeyMayM©ch
(cÚ¡ 
Sliû
& 
key
, cÚ¡ Sliû& 
bloom_f‹r
) const {

57 cÚ¡ 
size_t
 
	gËn
 = 
bloom_f‹r
.
size
();

58 ià(
	gËn
 < 2è 
	gçl£
;

60 cÚ¡ * 
	g¬¿y
 = 
bloom_f‹r
.
d©a
();

61 cÚ¡ 
size_t
 
	gb™s
 = (
Ën
 - 1) * 8;

65 cÚ¡ 
size_t
 
	gk
 = 
¬¿y
[
Ën
 - 1];

66 ià(
	gk
 > 30) {

69  
	gŒue
;

72 
ušt32_t
 
	gh
 = 
BloomHash
(
key
);

73 cÚ¡ 
ušt32_t
 
	gd–
 = (
h
 >> 17) | (h << 15);

74 
size_t
 
	gj
 = 0; j < 
	gk
; j++) {

75 cÚ¡ 
ušt32_t
 
	gb™pos
 = 
h
 % 
b™s
;

76 ià((
	g¬¿y
[
b™pos
 / 8] & (1 << (
	gb™pos
 % 8))è=ğ0è 
çl£
;

77 
	gh
 +ğ
d–
;

79  
	gŒue
;

82 
	g´iv©e
:

83 
size_t
 
b™s_³r_key_
;

84 
size_t
 
	gk_
;

88 cÚ¡ 
F‹rPŞicy
* 
	$NewBloomF‹rPŞicy
(
b™s_³r_key
) {

89  
Ãw
 
	`BloomF‹rPŞicy
(
b™s_³r_key
);

90 
	}
}

	@util/bloom_test.cc

5 
	~"Ëv–db/f‹r_pŞicy.h
"

7 
	~"ut/codšg.h
"

8 
	~"ut/loggšg.h
"

9 
	~"ut/‹¡h¬Ãss.h
"

10 
	~"ut/‹¡ut.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 cÚ¡ 
	gkV”bo£
 = 1;

16 
Sliû
 
Key
(
i
, * 
bufãr
) {

17 
EncodeFixed32
(
bufãr
, 
i
);

18  
Sliû
(
bufãr
, (
ušt32_t
));

21 şas 
	cBloomTe¡
 {

22 
	gpublic
:

23 
BloomTe¡
(è: 
pŞicy_
(
NewBloomF‹rPŞicy
(10)) {}

25 ~
BloomTe¡
(è{ 
d–‘e
 
pŞicy_
; }

27 
Re£t
() {

28 
	gkeys_
.
ş—r
();

29 
	gf‹r_
.
ş—r
();

32 
Add
(cÚ¡ 
Sliû
& 
s
è{ 
	gkeys_
.
push_back
(s.
ToSŒšg
()); }

34 
Bud
() {

35 
	g¡d
::
veùÜ
<
Sliû
> 
key_¦iûs
;

36 
size_t
 
	gi
 = 0; i < 
	gkeys_
.
size
(); i++) {

37 
	gkey_¦iûs
.
push_back
(
Sliû
(
keys_
[
i
]));

39 
	gf‹r_
.
ş—r
();

40 
	gpŞicy_
->
C»©eF‹r
(&
key_¦iûs
[0], 
¡©ic_ÿ¡
<>(key_¦iûs.
size
()),

41 &
f‹r_
);

42 
	gkeys_
.
ş—r
();

43 ià(
	gkV”bo£
 >ğ2è
DumpF‹r
();

46 
size_t
 
F‹rSize
(ècÚ¡ {  
	gf‹r_
.
size
(); }

48 
DumpF‹r
() {

49 
årštf
(
¡d”r
, "F(");

50 
size_t
 
	gi
 = 0; i + 1 < 
	gf‹r_
.
size
(); i++) {

51 cÚ¡ 
	gc
 = 
¡©ic_ÿ¡
<>(
f‹r_
[
i
]);

52 
	gj
 = 0; j < 8; j++) {

53 
årštf
(
¡d”r
, "%c", (
c
 & (1 << 
j
)) ? '1' : '.');

56 
årštf
(
¡d”r
, ")\n");

59 
boŞ
 
M©ches
(cÚ¡ 
Sliû
& 
s
) {

60 ià(!
	gkeys_
.
em±y
()) {

61 
Bud
();

63  
	gpŞicy_
->
KeyMayM©ch
(
s
, 
f‹r_
);

66 
F®£Pos™iveR©e
() {

67 
	gbufãr
[()];

68 
	g»suÉ
 = 0;

69 
	gi
 = 0; i < 10000; i++) {

70 ià(
M©ches
(
Key
(
i
 + 1000000000, 
bufãr
))) {

71 
	g»suÉ
++;

74  
	g»suÉ
 / 10000.0;

77 
	g´iv©e
:

78 cÚ¡ 
F‹rPŞicy
* 
pŞicy_
;

79 
	g¡d
::
¡ršg
 
f‹r_
;

80 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
keys_
;

83 
	$TEST
(
BloomTe¡
, 
Em±yF‹r
) {

84 
	`ASSERT_TRUE
(!
	`M©ches
("hello"));

85 
	`ASSERT_TRUE
(!
	`M©ches
("world"));

86 
	}
}

88 
	$TEST
(
BloomTe¡
, 
Sm®l
) {

89 
	`Add
("hello");

90 
	`Add
("world");

91 
	`ASSERT_TRUE
(
	`M©ches
("hello"));

92 
	`ASSERT_TRUE
(
	`M©ches
("world"));

93 
	`ASSERT_TRUE
(!
	`M©ches
("x"));

94 
	`ASSERT_TRUE
(!
	`M©ches
("foo"));

95 
	}
}

97 
	$NextL’gth
(
Ëngth
) {

98 ià(
Ëngth
 < 10) {

99 
Ëngth
 += 1;

100 } ià(
Ëngth
 < 100) {

101 
Ëngth
 += 10;

102 } ià(
Ëngth
 < 1000) {

103 
Ëngth
 += 100;

105 
Ëngth
 += 1000;

107  
Ëngth
;

108 
	}
}

110 
	$TEST
(
BloomTe¡
, 
V¬yšgL’gths
) {

111 
bufãr
[()];

114 
medioüe_f‹rs
 = 0;

115 
good_f‹rs
 = 0;

117 
Ëngth
 = 1;†’gth <ğ10000;†’gth = 
	`NextL’gth
(length)) {

118 
	`Re£t
();

119 
i
 = 0; i < 
Ëngth
; i++) {

120 
	`Add
(
	`Key
(
i
, 
bufãr
));

122 
	`Bud
();

124 
	`ASSERT_LE
(
	`F‹rSize
(), 
¡©ic_ÿ¡
<
size_t
>((
Ëngth
 * 10 / 8) + 40))

125 << 
Ëngth
;

128 
i
 = 0; i < 
Ëngth
; i++) {

129 
	`ASSERT_TRUE
(
	`M©ches
(
	`Key
(
i
, 
bufãr
)))

130 << "L’gth " << 
Ëngth
 << "; key " << 
i
;

134 
¿‹
 = 
	`F®£Pos™iveR©e
();

135 ià(
kV”bo£
 >= 1) {

136 
	`årštf
(
¡d”r
, "False…ositives: %5.2f%% @†ength = %6d ; bytes = %6d\n",

137 
¿‹
 * 100.0, 
Ëngth
, 
¡©ic_ÿ¡
<>(
	`F‹rSize
()));

139 
	`ASSERT_LE
(
¿‹
, 0.02);

140 ià(
¿‹
 > 0.0125)

141 
medioüe_f‹rs
++;

143 
good_f‹rs
++;

145 ià(
kV”bo£
 >= 1) {

146 
	`årštf
(
¡d”r
, "F‹rs: %d good, %d medioüe\n", 
good_f‹rs
,

147 
medioüe_f‹rs
);

149 
	`ASSERT_LE
(
medioüe_f‹rs
, 
good_f‹rs
 / 5);

150 
	}
}

156 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/cache.cc

5 
	~<as£¹.h
>

6 
	~<¡dio.h
>

7 
	~<¡dlib.h
>

9 
	~"Ëv–db/ÿche.h
"

10 
	~"pÜt/pÜt.h
"

11 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

12 
	~"ut/hash.h
"

13 
	~"ut/mu‹xlock.h
"

15 
Çme¥aû
 
	gËv–db
 {

17 
	gCache
::~
Cache
() {}

19 
Çme¥aû
 {

42 
	sLRUHªdË
 {

43 * 
v®ue
;

44 (*
	gd–‘”
)(cÚ¡ 
	gSliû
&, * 
	gv®ue
);

45 
LRUHªdË
* 
	gÃxt_hash
;

46 
LRUHªdË
* 
	gÃxt
;

47 
LRUHªdË
* 
	g´ev
;

48 
size_t
 
	gch¬ge
;

49 
size_t
 
	gkey_Ëngth
;

50 
boŞ
 
	gš_ÿche
;

51 
ušt32_t
 
	g»fs
;

52 
ušt32_t
 
	ghash
;

53 
	gkey_d©a
[1];

55 
Sliû
 
key
() const {

58 
as£¹
(
Ãxt
 !ğ
this
);

60  
Sliû
(
key_d©a
, 
key_Ëngth
);

69 şas 
	cHªdËTabË
 {

70 
	gpublic
:

71 
HªdËTabË
(è: 
Ëngth_
(0), 
–ems_
(0), 
li¡_
(
nuÎ±r
è{ 
Resize
(); }

72 ~
HªdËTabË
(è{ 
	gd–‘e
[] 
	gli¡_
; }

74 
LRUHªdË
* 
Lookup
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
) {

75  *
FšdPoš‹r
(
key
, 
hash
);

78 
LRUHªdË
* 
In£¹
(LRUHªdË* 
h
) {

79 
LRUHªdË
** 
	g±r
 = 
FšdPoš‹r
(
h
->
key
(), h->
hash
);

80 
LRUHªdË
* 
	gŞd
 = *
±r
;

81 
	gh
->
	gÃxt_hash
 = (
Şd
 =ğ
nuÎ±r
 ?‚uÎ±¸: old->
Ãxt_hash
);

82 *
	g±r
 = 
h
;

83 ià(
	gŞd
 =ğ
nuÎ±r
) {

84 ++
–ems_
;

85 ià(
	g–ems_
 > 
	gËngth_
) {

88 
Resize
();

91  
	gŞd
;

94 
LRUHªdË
* 
Remove
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
) {

95 
LRUHªdË
** 
	g±r
 = 
FšdPoš‹r
(
key
, 
hash
);

96 
LRUHªdË
* 
	g»suÉ
 = *
±r
;

97 ià(
	g»suÉ
 !ğ
nuÎ±r
) {

98 *
±r
 = 
»suÉ
->
Ãxt_hash
;

99 --
	g–ems_
;

101  
	g»suÉ
;

104 
	g´iv©e
:

107 
ušt32_t
 
Ëngth_
;

108 
ušt32_t
 
	g–ems_
;

109 
LRUHªdË
** 
	gli¡_
;

114 
LRUHªdË
** 
FšdPoš‹r
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
) {

115 
LRUHªdË
** 
	g±r
 = &
li¡_
[
hash
 & (
Ëngth_
 - 1)];

116 *
	g±r
 !ğ
nuÎ±r
 && ((*
±r
)->
hash
 !ğhash || 
key
 != (*ptr)->key())) {

117 
±r
 = &(*±r)->
Ãxt_hash
;

119  
	g±r
;

122 
Resize
() {

123 
ušt32_t
 
	gÃw_Ëngth
 = 4;

124 
	gÃw_Ëngth
 < 
	g–ems_
) {

125 
	gÃw_Ëngth
 *= 2;

127 
LRUHªdË
** 
	gÃw_li¡
 = 
Ãw
 LRUHªdË*[
Ãw_Ëngth
];

128 
mem£t
(
Ãw_li¡
, 0, Òew_li¡[0]è* 
Ãw_Ëngth
);

129 
ušt32_t
 
	gcouÁ
 = 0;

130 
ušt32_t
 
	gi
 = 0; i < 
	gËngth_
; i++) {

131 
LRUHªdË
* 
	gh
 = 
li¡_
[
i
];

132 
	gh
 !ğ
nuÎ±r
) {

133 
LRUHªdË
* 
Ãxt
 = 
h
->
Ãxt_hash
;

134 
ušt32_t
 
	ghash
 = 
h
->
hash
;

135 
LRUHªdË
** 
	g±r
 = &
Ãw_li¡
[
hash
 & (
Ãw_Ëngth
 - 1)];

136 
	gh
->
	gÃxt_hash
 = *
±r
;

137 *
	g±r
 = 
h
;

138 
	gh
 = 
Ãxt
;

139 
	gcouÁ
++;

142 
as£¹
(
–ems_
 =ğ
couÁ
);

143 
	gd–‘e
[] 
	gli¡_
;

144 
	gli¡_
 = 
Ãw_li¡
;

145 
	gËngth_
 = 
Ãw_Ëngth
;

150 şas 
	cLRUCache
 {

151 
	gpublic
:

152 
LRUCache
();

153 ~
LRUCache
();

156 
S‘C­ac™y
(
size_t
 
ÿ·c™y
è{ 
	gÿ·c™y_
 = capacity; }

159 
	gCache
::
HªdË
* 
In£¹
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
, * 
v®ue
,

160 
size_t
 
ch¬ge
,

161 (*
d–‘”
)(cÚ¡ 
Sliû
& 
key
, * 
v®ue
));

162 
	gCache
::
HªdË
* 
Lookup
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
);

163 
R–—£
(
Cache
::
HªdË
* 
hªdË
);

164 
E¿£
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
);

165 
PruÃ
();

166 
size_t
 
TÙ®Ch¬ge
() const {

167 
Mu‹xLock
 
l
(&
mu‹x_
);

168  
	gu§ge_
;

171 
	g´iv©e
:

172 
LRU_Remove
(
LRUHªdË
* 
e
);

173 
LRU_Aµ’d
(
LRUHªdË
* 
li¡
, LRUHªdË* 
e
);

174 
Ref
(
LRUHªdË
* 
e
);

175 
UÄef
(
LRUHªdË
* 
e
);

176 
boŞ
 
FšishE¿£
(
LRUHªdË
* 
e
è
EXCLUSIVE_LOCKS_REQUIRED
(
mu‹x_
);

179 
size_t
 
	gÿ·c™y_
;

182 
mubË
 
	gpÜt
::
Mu‹x
 
mu‹x_
;

183 
size_t
 
u§ge_
 
GUARDED_BY
(
mu‹x_
);

188 
LRUHªdË
 
Ìu_
 
GUARDED_BY
(
mu‹x_
);

192 
LRUHªdË
 
š_u£_
 
GUARDED_BY
(
mu‹x_
);

194 
HªdËTabË
 
bË_
 
GUARDED_BY
(
mu‹x_
);

197 
	gLRUCache
::
LRUCache
(è: 
ÿ·c™y_
(0), 
u§ge_
(0) {

199 
	gÌu_
.
	gÃxt
 = &
Ìu_
;

200 
	gÌu_
.
	g´ev
 = &
Ìu_
;

201 
	gš_u£_
.
	gÃxt
 = &
š_u£_
;

202 
	gš_u£_
.
	g´ev
 = &
š_u£_
;

205 
	gLRUCache
::~
LRUCache
() {

206 
as£¹
(
š_u£_
.
Ãxt
 == &in_use_);

207 
LRUHªdË
* 
	ge
 = 
Ìu_
.
Ãxt
;ƒ != &lru_;) {

208 
LRUHªdË
* 
	gÃxt
 = 
e
->
Ãxt
;

209 
as£¹
(
e
->
š_ÿche
);

210 
	ge
->
	gš_ÿche
 = 
çl£
;

211 
as£¹
(
e
->
»fs
 == 1);

212 
UÄef
(
e
);

213 
	ge
 = 
Ãxt
;

217 
	gLRUCache
::
Ref
(
LRUHªdË
* 
e
) {

218 ià(
e
->
»fs
 =ğ1 &&ƒ->
š_ÿche
) {

219 
LRU_Remove
(
e
);

220 
LRU_Aµ’d
(&
š_u£_
, 
e
);

222 
	ge
->
	g»fs
++;

225 
	gLRUCache
::
UÄef
(
LRUHªdË
* 
e
) {

226 
as£¹
(
e
->
»fs
 > 0);

227 
	ge
->
	g»fs
--;

228 ià(
	ge
->
	g»fs
 == 0) {

229 
as£¹
(!
e
->
š_ÿche
);

230 (*
	ge
->
	gd–‘”
)Ó->
key
(),ƒ->
	gv®ue
);

231 
ä“
(
e
);

232 } ià(
	ge
->
	gš_ÿche
 &&ƒ->
	g»fs
 == 1) {

234 
LRU_Remove
(
e
);

235 
LRU_Aµ’d
(&
Ìu_
, 
e
);

239 
	gLRUCache
::
LRU_Remove
(
LRUHªdË
* 
e
) {

240 
e
->
Ãxt
->
´ev
 =ƒ->prev;

241 
	ge
->
	g´ev
->
	gÃxt
 = 
e
->
Ãxt
;

244 
	gLRUCache
::
LRU_Aµ’d
(
LRUHªdË
* 
li¡
, LRUHªdË* 
e
) {

246 
	ge
->
	gÃxt
 = 
li¡
;

247 
	ge
->
	g´ev
 = 
li¡
->
´ev
;

248 
	ge
->
	g´ev
->
	gÃxt
 = 
e
;

249 
	ge
->
	gÃxt
->
	g´ev
 = 
e
;

252 
	gCache
::
HªdË
* 
LRUCache
::
Lookup
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
) {

253 
Mu‹xLock
 
l
(&
mu‹x_
);

254 
LRUHªdË
* 
	ge
 = 
bË_
.
Lookup
(
key
, 
hash
);

255 ià(
	ge
 !ğ
nuÎ±r
) {

256 
Ref
(
e
);

258  
	g»š‹½»t_ÿ¡
<
	gCache
::
HªdË
*>(
e
);

261 
	gLRUCache
::
R–—£
(
Cache
::
HªdË
* 
hªdË
) {

262 
Mu‹xLock
 
l
(&
mu‹x_
);

263 
UÄef
(
»š‹½»t_ÿ¡
<
LRUHªdË
*>(
hªdË
));

266 
	gCache
::
HªdË
* 
LRUCache
::
In£¹
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
, * 
v®ue
,

267 
size_t
 
ch¬ge
,

268 (*
d–‘”
)(cÚ¡ 
Sliû
& 
key
,

269 * 
v®ue
)) {

270 
Mu‹xLock
 
l
(&
mu‹x_
);

272 
LRUHªdË
* 
	ge
 =

273 
»š‹½»t_ÿ¡
<
LRUHªdË
*>(
m®loc
((LRUHªdËè- 1 + 
key
.
size
()));

274 
	ge
->
	gv®ue
 = 
v®ue
;

275 
	ge
->
	gd–‘”
 = 
d–‘”
;

276 
	ge
->
	gch¬ge
 = 
ch¬ge
;

277 
	ge
->
	gkey_Ëngth
 = 
key
.
size
();

278 
	ge
->
	ghash
 = 
hash
;

279 
	ge
->
	gš_ÿche
 = 
çl£
;

280 
	ge
->
	g»fs
 = 1;

281 
memıy
(
e
->
key_d©a
, 
key
.
d©a
(), key.
size
());

283 ià(
	gÿ·c™y_
 > 0) {

284 
	ge
->
	g»fs
++;

285 
	ge
->
	gš_ÿche
 = 
Œue
;

286 
LRU_Aµ’d
(&
š_u£_
, 
e
);

287 
	gu§ge_
 +ğ
ch¬ge
;

288 
FšishE¿£
(
bË_
.
In£¹
(
e
));

291 
	ge
->
	gÃxt
 = 
nuÎ±r
;

293 
	gu§ge_
 > 
	gÿ·c™y_
 && 
	gÌu_
.
	gÃxt
 !ğ&
Ìu_
) {

294 
LRUHªdË
* 
Şd
 = 
Ìu_
.
Ãxt
;

295 
as£¹
(
Şd
->
»fs
 == 1);

296 
boŞ
 
	g”a£d
 = 
FšishE¿£
(
bË_
.
Remove
(
Şd
->
key
(), old->
hash
));

297 ià(!
	g”a£d
) {

298 
as£¹
(
”a£d
);

302  
	g»š‹½»t_ÿ¡
<
	gCache
::
HªdË
*>(
e
);

307 
boŞ
 
	gLRUCache
::
FšishE¿£
(
LRUHªdË
* 
e
) {

308 ià(
e
 !ğ
nuÎ±r
) {

309 
as£¹
(
e
->
š_ÿche
);

310 
LRU_Remove
(
e
);

311 
	ge
->
	gš_ÿche
 = 
çl£
;

312 
	gu§ge_
 -ğ
e
->
ch¬ge
;

313 
UÄef
(
e
);

315  
	ge
 !ğ
nuÎ±r
;

318 
	gLRUCache
::
E¿£
(cÚ¡ 
Sliû
& 
key
, 
ušt32_t
 
hash
) {

319 
Mu‹xLock
 
l
(&
mu‹x_
);

320 
FšishE¿£
(
bË_
.
Remove
(
key
, 
hash
));

323 
	gLRUCache
::
PruÃ
() {

324 
Mu‹xLock
 
l
(&
mu‹x_
);

325 
	gÌu_
.
	gÃxt
 !ğ&
Ìu_
) {

326 
LRUHªdË
* 
e
 = 
Ìu_
.
Ãxt
;

327 
as£¹
(
e
->
»fs
 == 1);

328 
boŞ
 
	g”a£d
 = 
FšishE¿£
(
bË_
.
Remove
(
e
->
key
(),ƒ->
hash
));

329 ià(!
	g”a£d
) {

330 
as£¹
(
”a£d
);

335 cÚ¡ 
	gkNumSh¬dB™s
 = 4;

336 cÚ¡ 
	gkNumSh¬ds
 = 1 << 
kNumSh¬dB™s
;

338 şas 
	cSh¬dedLRUCache
 : 
public
 
Cache
 {

339 
´iv©e
:

340 
LRUCache
 
sh¬d_
[
kNumSh¬ds
];

341 
	gpÜt
::
Mu‹x
 
id_mu‹x_
;

342 
ušt64_t
 
	gÏ¡_id_
;

344 
šlše
 
ušt32_t
 
HashSliû
(cÚ¡ 
Sliû
& 
s
) {

345  
Hash
(
s
.
d©a
(), s.
size
(), 0);

348 
ušt32_t
 
Sh¬d
(ušt32_ˆ
hash
è{  
	ghash
 >> (32 - 
	gkNumSh¬dB™s
); }

350 
	gpublic
:

351 
ex¶ic™
 
Sh¬dedLRUCache
(
size_t
 
ÿ·c™y
è: 
Ï¡_id_
(0) {

352 cÚ¡ 
size_t
 
³r_sh¬d
 = (
ÿ·c™y
 + (
kNumSh¬ds
 - 1)) / kNumShards;

353 
	gs
 = 0; s < 
	gkNumSh¬ds
; s++) {

354 
	gsh¬d_
[
s
].
S‘C­ac™y
(
³r_sh¬d
);

357 
	gvœtu®
 ~
Sh¬dedLRUCache
() {}

358 
vœtu®
 
HªdË
* 
In£¹
(cÚ¡ 
Sliû
& 
key
, * 
v®ue
, 
size_t
 
ch¬ge
,

359 (*
d–‘”
)(cÚ¡ 
Sliû
& 
key
, * 
v®ue
)) {

360 cÚ¡ 
ušt32_t
 
	ghash
 = 
HashSliû
(
key
);

361  
	gsh¬d_
[
Sh¬d
(
hash
)].
In£¹
(
key
, hash, 
v®ue
, 
ch¬ge
, 
d–‘”
);

363 
vœtu®
 
HªdË
* 
Lookup
(cÚ¡ 
Sliû
& 
key
) {

364 cÚ¡ 
ušt32_t
 
	ghash
 = 
HashSliû
(
key
);

365  
	gsh¬d_
[
Sh¬d
(
hash
)].
Lookup
(
key
, hash);

367 
vœtu®
 
R–—£
(
HªdË
* 
hªdË
) {

368 
LRUHªdË
* 
	gh
 = 
»š‹½»t_ÿ¡
<LRUHªdË*>(
hªdË
);

369 
	gsh¬d_
[
Sh¬d
(
h
->
hash
)].
R–—£
(
hªdË
);

371 
vœtu®
 
E¿£
(cÚ¡ 
Sliû
& 
key
) {

372 cÚ¡ 
ušt32_t
 
	ghash
 = 
HashSliû
(
key
);

373 
	gsh¬d_
[
Sh¬d
(
hash
)].
E¿£
(
key
, hash);

375 
vœtu®
 * 
V®ue
(
HªdË
* 
hªdË
) {

376  
	g»š‹½»t_ÿ¡
<
	gLRUHªdË
*>(
	ghªdË
)->
	gv®ue
;

378 
vœtu®
 
ušt64_t
 
NewId
() {

379 
Mu‹xLock
 
l
(&
id_mu‹x_
);

380  ++(
	gÏ¡_id_
);

382 
vœtu®
 
PruÃ
() {

383 
	gs
 = 0; s < 
	gkNumSh¬ds
; s++) {

384 
	gsh¬d_
[
s
].
PruÃ
();

387 
vœtu®
 
size_t
 
TÙ®Ch¬ge
() const {

388 
size_t
 
	gtÙ®
 = 0;

389 
	gs
 = 0; s < 
	gkNumSh¬ds
; s++) {

390 
	gtÙ®
 +ğ
sh¬d_
[
s
].
TÙ®Ch¬ge
();

392  
	gtÙ®
;

398 
Cache
* 
	$NewLRUCache
(
size_t
 
ÿ·c™y
è{  
Ãw
 
	`Sh¬dedLRUCache
(ÿ·c™y); 
	}
}

	@util/cache_test.cc

5 
	~"Ëv–db/ÿche.h
"

7 
	~<veùÜ
>

8 
	~"ut/codšg.h
"

9 
	~"ut/‹¡h¬Ãss.h
"

11 
Çme¥aû
 
	gËv–db
 {

14 
	g¡d
::
¡ršg
 
EncodeKey
(
k
) {

15 
¡d
::
¡ršg
 
»suÉ
;

16 
PutFixed32
(&
»suÉ
, 
k
);

17  
	g»suÉ
;

19 
DecodeKey
(cÚ¡ 
Sliû
& 
k
) {

20 
as£¹
(
k
.
size
() == 4);

21  
DecodeFixed32
(
k
.
d©a
());

23 * 
EncodeV®ue
(
ušŒ_t
 
v
è{  
	g»š‹½»t_ÿ¡
<*>(
	gv
); }

24 
DecodeV®ue
(* 
v
è{  
	g»š‹½»t_ÿ¡
<
	gušŒ_t
>(
	gv
); }

26 şas 
	cCacheTe¡
 {

27 
	gpublic
:

28 
D–‘”
(cÚ¡ 
Sliû
& 
key
, * 
v
) {

29 
	gcu¼’t_
->
	gd–‘ed_keys_
.
push_back
(
DecodeKey
(
key
));

30 
	gcu¼’t_
->
	gd–‘ed_v®ues_
.
push_back
(
DecodeV®ue
(
v
));

33 cÚ¡ 
	gkCacheSize
 = 1000;

34 
	g¡d
::
veùÜ
<> 
d–‘ed_keys_
;

35 
	g¡d
::
veùÜ
<> 
d–‘ed_v®ues_
;

36 
Cache
* 
	gÿche_
;

38 
CacheTe¡
(è: 
ÿche_
(
NewLRUCache
(
kCacheSize
)è{ 
cu¼’t_
 = 
this
; }

40 ~
CacheTe¡
(è{ 
d–‘e
 
	gÿche_
; }

42 
Lookup
(
key
) {

43 
	gCache
::
HªdË
* 
hªdË
 = 
ÿche_
->
Lookup
(
EncodeKey
(
key
));

44 cÚ¡ 
	gr
 = (
hªdË
 =ğ
nuÎ±r
è? -1 : 
DecodeV®ue
(
ÿche_
->
V®ue
(handle));

45 ià(
	ghªdË
 !ğ
nuÎ±r
) {

46 
ÿche_
->
R–—£
(
hªdË
);

48  
	gr
;

51 
In£¹
(
key
, 
v®ue
, 
ch¬ge
 = 1) {

52 
ÿche_
->
R–—£
(ÿche_->
In£¹
(
EncodeKey
(
key
), 
EncodeV®ue
(
v®ue
), 
ch¬ge
,

53 &
CacheTe¡
::
D–‘”
));

56 
	gCache
::
HªdË
* 
In£¹AndR‘uºHªdË
(
key
, 
v®ue
, 
ch¬ge
 = 1) {

57  
ÿche_
->
In£¹
(
EncodeKey
(
key
), 
EncodeV®ue
(
v®ue
), 
ch¬ge
,

58 &
CacheTe¡
::
D–‘”
);

61 
E¿£
(
key
è{ 
	gÿche_
->E¿£(
EncodeKey
(key)); }

63 
CacheTe¡
* 
	gcu¼’t_
;

65 
CacheTe¡
* 
	gCacheTe¡
::
cu¼’t_
;

67 
	$TEST
(
CacheTe¡
, 
H™AndMiss
) {

68 
	`ASSERT_EQ
(-1, 
	`Lookup
(100));

70 
	`In£¹
(100, 101);

71 
	`ASSERT_EQ
(101, 
	`Lookup
(100));

72 
	`ASSERT_EQ
(-1, 
	`Lookup
(200));

73 
	`ASSERT_EQ
(-1, 
	`Lookup
(300));

75 
	`In£¹
(200, 201);

76 
	`ASSERT_EQ
(101, 
	`Lookup
(100));

77 
	`ASSERT_EQ
(201, 
	`Lookup
(200));

78 
	`ASSERT_EQ
(-1, 
	`Lookup
(300));

80 
	`In£¹
(100, 102);

81 
	`ASSERT_EQ
(102, 
	`Lookup
(100));

82 
	`ASSERT_EQ
(201, 
	`Lookup
(200));

83 
	`ASSERT_EQ
(-1, 
	`Lookup
(300));

85 
	`ASSERT_EQ
(1, 
d–‘ed_keys_
.
	`size
());

86 
	`ASSERT_EQ
(100, 
d–‘ed_keys_
[0]);

87 
	`ASSERT_EQ
(101, 
d–‘ed_v®ues_
[0]);

88 
	}
}

90 
	$TEST
(
CacheTe¡
, 
E¿£
) {

91 
	`E¿£
(200);

92 
	`ASSERT_EQ
(0, 
d–‘ed_keys_
.
	`size
());

94 
	`In£¹
(100, 101);

95 
	`In£¹
(200, 201);

96 
	`E¿£
(100);

97 
	`ASSERT_EQ
(-1, 
	`Lookup
(100));

98 
	`ASSERT_EQ
(201, 
	`Lookup
(200));

99 
	`ASSERT_EQ
(1, 
d–‘ed_keys_
.
	`size
());

100 
	`ASSERT_EQ
(100, 
d–‘ed_keys_
[0]);

101 
	`ASSERT_EQ
(101, 
d–‘ed_v®ues_
[0]);

103 
	`E¿£
(100);

104 
	`ASSERT_EQ
(-1, 
	`Lookup
(100));

105 
	`ASSERT_EQ
(201, 
	`Lookup
(200));

106 
	`ASSERT_EQ
(1, 
d–‘ed_keys_
.
	`size
());

107 
	}
}

109 
	$TEST
(
CacheTe¡
, 
EÁr›sA»PšÃd
) {

110 
	`In£¹
(100, 101);

111 
Cache
::
HªdË
* 
h1
 = 
ÿche_
->
	`Lookup
(
	`EncodeKey
(100));

112 
	`ASSERT_EQ
(101, 
	`DecodeV®ue
(
ÿche_
->
	`V®ue
(
h1
)));

114 
	`In£¹
(100, 102);

115 
Cache
::
HªdË
* 
h2
 = 
ÿche_
->
	`Lookup
(
	`EncodeKey
(100));

116 
	`ASSERT_EQ
(102, 
	`DecodeV®ue
(
ÿche_
->
	`V®ue
(
h2
)));

117 
	`ASSERT_EQ
(0, 
d–‘ed_keys_
.
	`size
());

119 
ÿche_
->
	`R–—£
(
h1
);

120 
	`ASSERT_EQ
(1, 
d–‘ed_keys_
.
	`size
());

121 
	`ASSERT_EQ
(100, 
d–‘ed_keys_
[0]);

122 
	`ASSERT_EQ
(101, 
d–‘ed_v®ues_
[0]);

124 
	`E¿£
(100);

125 
	`ASSERT_EQ
(-1, 
	`Lookup
(100));

126 
	`ASSERT_EQ
(1, 
d–‘ed_keys_
.
	`size
());

128 
ÿche_
->
	`R–—£
(
h2
);

129 
	`ASSERT_EQ
(2, 
d–‘ed_keys_
.
	`size
());

130 
	`ASSERT_EQ
(100, 
d–‘ed_keys_
[1]);

131 
	`ASSERT_EQ
(102, 
d–‘ed_v®ues_
[1]);

132 
	}
}

134 
	$TEST
(
CacheTe¡
, 
EviùiÚPŞicy
) {

135 
	`In£¹
(100, 101);

136 
	`In£¹
(200, 201);

137 
	`In£¹
(300, 301);

138 
Cache
::
HªdË
* 
h
 = 
ÿche_
->
	`Lookup
(
	`EncodeKey
(300));

142 
i
 = 0; i < 
kCacheSize
 + 100; i++) {

143 
	`In£¹
(1000 + 
i
, 2000 + i);

144 
	`ASSERT_EQ
(2000 + 
i
, 
	`Lookup
(1000 + i));

145 
	`ASSERT_EQ
(101, 
	`Lookup
(100));

147 
	`ASSERT_EQ
(101, 
	`Lookup
(100));

148 
	`ASSERT_EQ
(-1, 
	`Lookup
(200));

149 
	`ASSERT_EQ
(301, 
	`Lookup
(300));

150 
ÿche_
->
	`R–—£
(
h
);

151 
	}
}

153 
	$TEST
(
CacheTe¡
, 
U£ExûedsCacheSize
) {

155 
¡d
::
veùÜ
<
Cache
::
HªdË
*> 
h
;

156 
i
 = 0; i < 
kCacheSize
 + 100; i++) {

157 
h
.
	`push_back
(
	`In£¹AndR‘uºHªdË
(1000 + 
i
, 2000 + i));

161 
i
 = 0; i < 
h
.
	`size
(); i++) {

162 
	`ASSERT_EQ
(2000 + 
i
, 
	`Lookup
(1000 + i));

165 
i
 = 0; i < 
h
.
	`size
(); i++) {

166 
ÿche_
->
	`R–—£
(
h
[
i
]);

168 
	}
}

170 
	$TEST
(
CacheTe¡
, 
H—vyEÁr›s
) {

174 cÚ¡ 
kLight
 = 1;

175 cÚ¡ 
kH—vy
 = 10;

176 
added
 = 0;

177 
šdex
 = 0;

178 
added
 < 2 * 
kCacheSize
) {

179 cÚ¡ 
weight
 = (
šdex
 & 1è? 
kLight
 : 
kH—vy
;

180 
	`In£¹
(
šdex
, 1000 + index, 
weight
);

181 
added
 +ğ
weight
;

182 
šdex
++;

185 
ÿched_weight
 = 0;

186 
i
 = 0; i < 
šdex
; i++) {

187 cÚ¡ 
weight
 = (
i
 & 1 ? 
kLight
 : 
kH—vy
);

188 
r
 = 
	`Lookup
(
i
);

189 ià(
r
 >= 0) {

190 
ÿched_weight
 +ğ
weight
;

191 
	`ASSERT_EQ
(1000 + 
i
, 
r
);

194 
	`ASSERT_LE
(
ÿched_weight
, 
kCacheSize
 + kCacheSize / 10);

195 
	}
}

197 
	$TEST
(
CacheTe¡
, 
NewId
) {

198 
ušt64_t
 
a
 = 
ÿche_
->
	`NewId
();

199 
ušt64_t
 
b
 = 
ÿche_
->
	`NewId
();

200 
	`ASSERT_NE
(
a
, 
b
);

201 
	}
}

203 
	$TEST
(
CacheTe¡
, 
PruÃ
) {

204 
	`In£¹
(1, 100);

205 
	`In£¹
(2, 200);

207 
Cache
::
HªdË
* 
hªdË
 = 
ÿche_
->
	`Lookup
(
	`EncodeKey
(1));

208 
	`ASSERT_TRUE
(
hªdË
);

209 
ÿche_
->
	`PruÃ
();

210 
ÿche_
->
	`R–—£
(
hªdË
);

212 
	`ASSERT_EQ
(100, 
	`Lookup
(1));

213 
	`ASSERT_EQ
(-1, 
	`Lookup
(2));

214 
	}
}

216 
	$TEST
(
CacheTe¡
, 
Z”oSizeCache
) {

217 
d–‘e
 
ÿche_
;

218 
ÿche_
 = 
	`NewLRUCache
(0);

220 
	`In£¹
(1, 100);

221 
	`ASSERT_EQ
(-1, 
	`Lookup
(1));

222 
	}
}

226 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/coding.cc

5 
	~"ut/codšg.h
"

7 
Çme¥aû
 
	gËv–db
 {

9 
EncodeFixed32
(* 
d¡
, 
ušt32_t
 
v®ue
) {

10 ià(
	gpÜt
::
kL™eEndŸn
) {

11 
memıy
(
d¡
, &
v®ue
, (value));

13 
	gd¡
[0] = 
v®ue
 & 0xff;

14 
	gd¡
[1] = (
v®ue
 >> 8) & 0xff;

15 
	gd¡
[2] = (
v®ue
 >> 16) & 0xff;

16 
	gd¡
[3] = (
v®ue
 >> 24) & 0xff;

20 
EncodeFixed64
(* 
d¡
, 
ušt64_t
 
v®ue
) {

21 ià(
	gpÜt
::
kL™eEndŸn
) {

22 
memıy
(
d¡
, &
v®ue
, (value));

24 
	gd¡
[0] = 
v®ue
 & 0xff;

25 
	gd¡
[1] = (
v®ue
 >> 8) & 0xff;

26 
	gd¡
[2] = (
v®ue
 >> 16) & 0xff;

27 
	gd¡
[3] = (
v®ue
 >> 24) & 0xff;

28 
	gd¡
[4] = (
v®ue
 >> 32) & 0xff;

29 
	gd¡
[5] = (
v®ue
 >> 40) & 0xff;

30 
	gd¡
[6] = (
v®ue
 >> 48) & 0xff;

31 
	gd¡
[7] = (
v®ue
 >> 56) & 0xff;

35 
PutFixed32
(
¡d
::
¡ršg
* 
d¡
, 
ušt32_t
 
v®ue
) {

36 
	gbuf
[(
v®ue
)];

37 
EncodeFixed32
(
buf
, 
v®ue
);

38 
	gd¡
->
­³nd
(
buf
, (buf));

41 
PutFixed64
(
¡d
::
¡ršg
* 
d¡
, 
ušt64_t
 
v®ue
) {

42 
	gbuf
[(
v®ue
)];

43 
EncodeFixed64
(
buf
, 
v®ue
);

44 
	gd¡
->
­³nd
(
buf
, (buf));

47 * 
EncodeV¬št32
(* 
d¡
, 
ušt32_t
 
v
) {

49 * 
	g±r
 = 
»š‹½»t_ÿ¡
<*>(
d¡
);

50 cÚ¡ 
	gB
 = 128;

51 ià(
	gv
 < (1 << 7)) {

52 *(
	g±r
++èğ
v
;

53 } ià(
	gv
 < (1 << 14)) {

54 *(
	g±r
++èğ
v
 | 
B
;

55 *(
	g±r
++èğ
v
 >> 7;

56 } ià(
	gv
 < (1 << 21)) {

57 *(
	g±r
++èğ
v
 | 
B
;

58 *(
	g±r
++èğ(
v
 >> 7è| 
B
;

59 *(
	g±r
++èğ
v
 >> 14;

60 } ià(
	gv
 < (1 << 28)) {

61 *(
	g±r
++èğ
v
 | 
B
;

62 *(
	g±r
++èğ(
v
 >> 7è| 
B
;

63 *(
	g±r
++èğ(
v
 >> 14è| 
B
;

64 *(
	g±r
++èğ
v
 >> 21;

66 *(
	g±r
++èğ
v
 | 
B
;

67 *(
	g±r
++èğ(
v
 >> 7è| 
B
;

68 *(
	g±r
++èğ(
v
 >> 14è| 
B
;

69 *(
	g±r
++èğ(
v
 >> 21è| 
B
;

70 *(
	g±r
++èğ
v
 >> 28;

72  
	g»š‹½»t_ÿ¡
<*>(
	g±r
);

75 
PutV¬št32
(
¡d
::
¡ršg
* 
d¡
, 
ušt32_t
 
v
) {

76 
	gbuf
[5];

77 * 
	g±r
 = 
EncodeV¬št32
(
buf
, 
v
);

78 
	gd¡
->
­³nd
(
buf
, 
±r
 - buf);

81 * 
EncodeV¬št64
(* 
d¡
, 
ušt64_t
 
v
) {

82 cÚ¡ 
	gB
 = 128;

83 * 
	g±r
 = 
»š‹½»t_ÿ¡
<*>(
d¡
);

84 
	gv
 >ğ
B
) {

85 *(
±r
++èğ
v
 | 
B
;

86 
	gv
 >>= 7;

88 *(
	g±r
++èğ
¡©ic_ÿ¡
<>(
v
);

89  
	g»š‹½»t_ÿ¡
<*>(
	g±r
);

92 
PutV¬št64
(
¡d
::
¡ršg
* 
d¡
, 
ušt64_t
 
v
) {

93 
	gbuf
[10];

94 * 
	g±r
 = 
EncodeV¬št64
(
buf
, 
v
);

95 
	gd¡
->
­³nd
(
buf
, 
±r
 - buf);

98 
PutL’gthP»fixedSliû
(
¡d
::
¡ršg
* 
d¡
, cÚ¡ 
Sliû
& 
v®ue
) {

99 
PutV¬št32
(
d¡
, 
v®ue
.
size
());

100 
	gd¡
->
­³nd
(
v®ue
.
d©a
(), v®ue.
size
());

103 
V¬štL’gth
(
ušt64_t
 
v
) {

104 
	gËn
 = 1;

105 
	gv
 >= 128) {

106 
v
 >>= 7;

107 
	gËn
++;

109  
	gËn
;

112 cÚ¡ * 
G‘V¬št32PŒF®lback
(cÚ¡ * 
p
, cÚ¡ * 
lim™
,

113 
ušt32_t
* 
v®ue
) {

114 
ušt32_t
 
	g»suÉ
 = 0;

115 
ušt32_t
 
	gshiá
 = 0; shiá <ğ28 && 
p
 < 
lim™
; shift += 7) {

116 
ušt32_t
 
by‹
 = *(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
));

117 
	gp
++;

118 ià(
	gby‹
 & 128) {

120 
	g»suÉ
 |ğ((
by‹
 & 127è<< 
shiá
);

122 
	g»suÉ
 |ğ(
by‹
 << 
shiá
);

123 *
	gv®ue
 = 
»suÉ
;

124  
	g»š‹½»t_ÿ¡
<cÚ¡ *>(
	gp
);

127  
	gnuÎ±r
;

130 
boŞ
 
G‘V¬št32
(
Sliû
* 
šput
, 
ušt32_t
* 
v®ue
) {

131 cÚ¡ * 
	gp
 = 
šput
->
d©a
();

132 cÚ¡ * 
	glim™
 = 
p
 + 
šput
->
size
();

133 cÚ¡ * 
	gq
 = 
G‘V¬št32PŒ
(
p
, 
lim™
, 
v®ue
);

134 ià(
	gq
 =ğ
nuÎ±r
) {

135  
çl£
;

137 *
	gšput
 = 
Sliû
(
q
, 
lim™
 - q);

138  
	gŒue
;

142 cÚ¡ * 
G‘V¬št64PŒ
(cÚ¡ * 
p
, cÚ¡ * 
lim™
, 
ušt64_t
* 
v®ue
) {

143 
ušt64_t
 
	g»suÉ
 = 0;

144 
ušt32_t
 
	gshiá
 = 0; shiá <ğ63 && 
p
 < 
lim™
; shift += 7) {

145 
ušt64_t
 
by‹
 = *(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
));

146 
	gp
++;

147 ià(
	gby‹
 & 128) {

149 
	g»suÉ
 |ğ((
by‹
 & 127è<< 
shiá
);

151 
	g»suÉ
 |ğ(
by‹
 << 
shiá
);

152 *
	gv®ue
 = 
»suÉ
;

153  
	g»š‹½»t_ÿ¡
<cÚ¡ *>(
	gp
);

156  
	gnuÎ±r
;

159 
boŞ
 
G‘V¬št64
(
Sliû
* 
šput
, 
ušt64_t
* 
v®ue
) {

160 cÚ¡ * 
	gp
 = 
šput
->
d©a
();

161 cÚ¡ * 
	glim™
 = 
p
 + 
šput
->
size
();

162 cÚ¡ * 
	gq
 = 
G‘V¬št64PŒ
(
p
, 
lim™
, 
v®ue
);

163 ià(
	gq
 =ğ
nuÎ±r
) {

164  
çl£
;

166 *
	gšput
 = 
Sliû
(
q
, 
lim™
 - q);

167  
	gŒue
;

171 cÚ¡ * 
G‘L’gthP»fixedSliû
(cÚ¡ * 
p
, cÚ¡ * 
lim™
,

172 
Sliû
* 
»suÉ
) {

173 
ušt32_t
 
	gËn
;

174 
	gp
 = 
G‘V¬št32PŒ
(
p
, 
lim™
, &
Ën
);

175 ià(
	gp
 =ğ
nuÎ±r
) ‚ullptr;

176 ià(
	gp
 + 
	gËn
 > 
	glim™
è 
	gnuÎ±r
;

177 *
	g»suÉ
 = 
Sliû
(
p
, 
Ën
);

178  
	gp
 + 
	gËn
;

181 
boŞ
 
G‘L’gthP»fixedSliû
(
Sliû
* 
šput
, Sliû* 
»suÉ
) {

182 
ušt32_t
 
	gËn
;

183 ià(
G‘V¬št32
(
šput
, &
Ën
è&& 
	gšput
->
size
() >=†en) {

184 *
»suÉ
 = 
Sliû
(
šput
->
d©a
(), 
Ën
);

185 
	gšput
->
»move_´efix
(
Ën
);

186  
	gŒue
;

188  
	gçl£
;

	@util/coding.h

10 #iâdeà
STORAGE_LEVELDB_UTIL_CODING_H_


11 
	#STORAGE_LEVELDB_UTIL_CODING_H_


	)

13 
	~<¡dšt.h
>

14 
	~<¡ršg.h
>

16 
	~<¡ršg
>

18 
	~"Ëv–db/¦iû.h
"

19 
	~"pÜt/pÜt.h
"

21 
Çme¥aû
 
	gËv–db
 {

24 
PutFixed32
(
¡d
::
¡ršg
* 
d¡
, 
ušt32_t
 
v®ue
);

25 
PutFixed64
(
¡d
::
¡ršg
* 
d¡
, 
ušt64_t
 
v®ue
);

26 
PutV¬št32
(
¡d
::
¡ršg
* 
d¡
, 
ušt32_t
 
v®ue
);

27 
PutV¬št64
(
¡d
::
¡ršg
* 
d¡
, 
ušt64_t
 
v®ue
);

28 
PutL’gthP»fixedSliû
(
¡d
::
¡ršg
* 
d¡
, cÚ¡ 
Sliû
& 
v®ue
);

32 
boŞ
 
G‘V¬št32
(
Sliû
* 
šput
, 
ušt32_t
* 
v®ue
);

33 
boŞ
 
G‘V¬št64
(
Sliû
* 
šput
, 
ušt64_t
* 
v®ue
);

34 
boŞ
 
G‘L’gthP»fixedSliû
(
Sliû
* 
šput
, Sliû* 
»suÉ
);

40 cÚ¡ * 
G‘V¬št32PŒ
(cÚ¡ * 
p
, cÚ¡ * 
lim™
, 
ušt32_t
* 
v
);

41 cÚ¡ * 
G‘V¬št64PŒ
(cÚ¡ * 
p
, cÚ¡ * 
lim™
, 
ušt64_t
* 
v
);

44 
V¬štL’gth
(
ušt64_t
 
v
);

48 
EncodeFixed32
(* 
d¡
, 
ušt32_t
 
v®ue
);

49 
EncodeFixed64
(* 
d¡
, 
ušt64_t
 
v®ue
);

54 * 
EncodeV¬št32
(* 
d¡
, 
ušt32_t
 
v®ue
);

55 * 
EncodeV¬št64
(* 
d¡
, 
ušt64_t
 
v®ue
);

60 
šlše
 
ušt32_t
 
DecodeFixed32
(cÚ¡ * 
±r
) {

61 ià(
	gpÜt
::
kL™eEndŸn
) {

63 
ušt32_t
 
»suÉ
;

64 
memıy
(&
»suÉ
, 
±r
, (result));

65  
	g»suÉ
;

67  ((
	g¡©ic_ÿ¡
<
	gušt32_t
>(¡©ic_ÿ¡<>(
	g±r
[0]))) |

68 (
	g¡©ic_ÿ¡
<
	gušt32_t
>(¡©ic_ÿ¡<>(
	g±r
[1])) << 8) |

69 (
	g¡©ic_ÿ¡
<
	gušt32_t
>(¡©ic_ÿ¡<>(
	g±r
[2])) << 16) |

70 (
	g¡©ic_ÿ¡
<
	gušt32_t
>(¡©ic_ÿ¡<>(
	g±r
[3])) << 24));

74 
šlše
 
ušt64_t
 
DecodeFixed64
(cÚ¡ * 
±r
) {

75 ià(
	gpÜt
::
kL™eEndŸn
) {

77 
ušt64_t
 
»suÉ
;

78 
memıy
(&
»suÉ
, 
±r
, (result));

79  
	g»suÉ
;

81 
ušt64_t
 
	glo
 = 
DecodeFixed32
(
±r
);

82 
ušt64_t
 
	ghi
 = 
DecodeFixed32
(
±r
 + 4);

83  (
	ghi
 << 32è| 
	glo
;

88 cÚ¡ * 
G‘V¬št32PŒF®lback
(cÚ¡ * 
p
, cÚ¡ * 
lim™
,

89 
ušt32_t
* 
v®ue
);

90 
šlše
 cÚ¡ * 
G‘V¬št32PŒ
(cÚ¡ * 
p
, cÚ¡ * 
lim™
,

91 
ušt32_t
* 
v®ue
) {

92 ià(
	gp
 < 
	glim™
) {

93 
ušt32_t
 
	g»suÉ
 = *(
»š‹½»t_ÿ¡
<cÚ¡ *>(
p
));

94 ià((
	g»suÉ
 & 128) == 0) {

95 *
v®ue
 = 
»suÉ
;

96  
	gp
 + 1;

99  
G‘V¬št32PŒF®lback
(
p
, 
lim™
, 
v®ue
);

	@util/coding_test.cc

5 
	~<veùÜ
>

7 
	~"ut/codšg.h
"

8 
	~"ut/‹¡h¬Ãss.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 şas 
	cCodšg
 {};

14 
	$TEST
(
Codšg
, 
Fixed32
) {

15 
¡d
::
¡ršg
 
s
;

16 
ušt32_t
 
v
 = 0; v < 100000; v++) {

17 
	`PutFixed32
(&
s
, 
v
);

20 cÚ¡ * 
p
 = 
s
.
	`d©a
();

21 
ušt32_t
 
v
 = 0; v < 100000; v++) {

22 
ušt32_t
 
aùu®
 = 
	`DecodeFixed32
(
p
);

23 
	`ASSERT_EQ
(
v
, 
aùu®
);

24 
p
 +ğ(
ušt32_t
);

26 
	}
}

28 
	$TEST
(
Codšg
, 
Fixed64
) {

29 
¡d
::
¡ršg
 
s
;

30 
pow”
 = 0;…ower <= 63;…ower++) {

31 
ušt64_t
 
v
 = 
¡©ic_ÿ¡
<ušt64_t>(1è<< 
pow”
;

32 
	`PutFixed64
(&
s
, 
v
 - 1);

33 
	`PutFixed64
(&
s
, 
v
 + 0);

34 
	`PutFixed64
(&
s
, 
v
 + 1);

37 cÚ¡ * 
p
 = 
s
.
	`d©a
();

38 
pow”
 = 0;…ower <= 63;…ower++) {

39 
ušt64_t
 
v
 = 
¡©ic_ÿ¡
<ušt64_t>(1è<< 
pow”
;

40 
ušt64_t
 
aùu®
;

41 
aùu®
 = 
	`DecodeFixed64
(
p
);

42 
	`ASSERT_EQ
(
v
 - 1, 
aùu®
);

43 
p
 +ğ(
ušt64_t
);

45 
aùu®
 = 
	`DecodeFixed64
(
p
);

46 
	`ASSERT_EQ
(
v
 + 0, 
aùu®
);

47 
p
 +ğ(
ušt64_t
);

49 
aùu®
 = 
	`DecodeFixed64
(
p
);

50 
	`ASSERT_EQ
(
v
 + 1, 
aùu®
);

51 
p
 +ğ(
ušt64_t
);

53 
	}
}

56 
	$TEST
(
Codšg
, 
EncodšgOuut
) {

57 
¡d
::
¡ršg
 
d¡
;

58 
	`PutFixed32
(&
d¡
, 0x04030201);

59 
	`ASSERT_EQ
(4, 
d¡
.
	`size
());

60 
	`ASSERT_EQ
(0x01, 
¡©ic_ÿ¡
<>(
d¡
[0]));

61 
	`ASSERT_EQ
(0x02, 
¡©ic_ÿ¡
<>(
d¡
[1]));

62 
	`ASSERT_EQ
(0x03, 
¡©ic_ÿ¡
<>(
d¡
[2]));

63 
	`ASSERT_EQ
(0x04, 
¡©ic_ÿ¡
<>(
d¡
[3]));

65 
d¡
.
	`ş—r
();

66 
	`PutFixed64
(&
d¡
, 0x0807060504030201ull);

67 
	`ASSERT_EQ
(8, 
d¡
.
	`size
());

68 
	`ASSERT_EQ
(0x01, 
¡©ic_ÿ¡
<>(
d¡
[0]));

69 
	`ASSERT_EQ
(0x02, 
¡©ic_ÿ¡
<>(
d¡
[1]));

70 
	`ASSERT_EQ
(0x03, 
¡©ic_ÿ¡
<>(
d¡
[2]));

71 
	`ASSERT_EQ
(0x04, 
¡©ic_ÿ¡
<>(
d¡
[3]));

72 
	`ASSERT_EQ
(0x05, 
¡©ic_ÿ¡
<>(
d¡
[4]));

73 
	`ASSERT_EQ
(0x06, 
¡©ic_ÿ¡
<>(
d¡
[5]));

74 
	`ASSERT_EQ
(0x07, 
¡©ic_ÿ¡
<>(
d¡
[6]));

75 
	`ASSERT_EQ
(0x08, 
¡©ic_ÿ¡
<>(
d¡
[7]));

76 
	}
}

78 
	$TEST
(
Codšg
, 
V¬št32
) {

79 
¡d
::
¡ršg
 
s
;

80 
ušt32_t
 
i
 = 0; i < (32 * 32); i++) {

81 
ušt32_t
 
v
 = (
i
 / 32) << (i % 32);

82 
	`PutV¬št32
(&
s
, 
v
);

85 cÚ¡ * 
p
 = 
s
.
	`d©a
();

86 cÚ¡ * 
lim™
 = 
p
 + 
s
.
	`size
();

87 
ušt32_t
 
i
 = 0; i < (32 * 32); i++) {

88 
ušt32_t
 
ex³ùed
 = (
i
 / 32) << (i % 32);

89 
ušt32_t
 
aùu®
;

90 cÚ¡ * 
¡¬t
 = 
p
;

91 
p
 = 
	`G‘V¬št32PŒ
Õ, 
lim™
, &
aùu®
);

92 
	`ASSERT_TRUE
(
p
 !ğ
nuÎ±r
);

93 
	`ASSERT_EQ
(
ex³ùed
, 
aùu®
);

94 
	`ASSERT_EQ
(
	`V¬štL’gth
(
aùu®
), 
p
 - 
¡¬t
);

96 
	`ASSERT_EQ
(
p
, 
s
.
	`d©a
(è+ s.
	`size
());

97 
	}
}

99 
	$TEST
(
Codšg
, 
V¬št64
) {

101 
¡d
::
veùÜ
<
ušt64_t
> 
v®ues
;

103 
v®ues
.
	`push_back
(0);

104 
v®ues
.
	`push_back
(100);

105 
v®ues
.
	`push_back
(~
¡©ic_ÿ¡
<
ušt64_t
>(0));

106 
v®ues
.
	`push_back
(~
¡©ic_ÿ¡
<
ušt64_t
>(0) - 1);

107 
ušt32_t
 
k
 = 0; k < 64; k++) {

109 cÚ¡ 
ušt64_t
 
pow”
 = 1uÎ << 
k
;

110 
v®ues
.
	`push_back
(
pow”
);

111 
v®ues
.
	`push_back
(
pow”
 - 1);

112 
v®ues
.
	`push_back
(
pow”
 + 1);

115 
¡d
::
¡ršg
 
s
;

116 
size_t
 
i
 = 0; i < 
v®ues
.
	`size
(); i++) {

117 
	`PutV¬št64
(&
s
, 
v®ues
[
i
]);

120 cÚ¡ * 
p
 = 
s
.
	`d©a
();

121 cÚ¡ * 
lim™
 = 
p
 + 
s
.
	`size
();

122 
size_t
 
i
 = 0; i < 
v®ues
.
	`size
(); i++) {

123 
	`ASSERT_TRUE
(
p
 < 
lim™
);

124 
ušt64_t
 
aùu®
;

125 cÚ¡ * 
¡¬t
 = 
p
;

126 
p
 = 
	`G‘V¬št64PŒ
Õ, 
lim™
, &
aùu®
);

127 
	`ASSERT_TRUE
(
p
 !ğ
nuÎ±r
);

128 
	`ASSERT_EQ
(
v®ues
[
i
], 
aùu®
);

129 
	`ASSERT_EQ
(
	`V¬štL’gth
(
aùu®
), 
p
 - 
¡¬t
);

131 
	`ASSERT_EQ
(
p
, 
lim™
);

132 
	}
}

134 
	$TEST
(
Codšg
, 
V¬št32Ov”æow
) {

135 
ušt32_t
 
»suÉ
;

136 
¡d
::
¡ršg
 
	`šput
("\x81\x82\x83\x84\x85\x11");

137 
	`ASSERT_TRUE
(
	`G‘V¬št32PŒ
(
šput
.
	`d©a
(), iÅut.d©a(è+ iÅut.
	`size
(),

138 &
»suÉ
è=ğ
nuÎ±r
);

139 
	}
}

141 
	$TEST
(
Codšg
, 
V¬št32TrunÿtiÚ
) {

142 
ušt32_t
 
Ïrge_v®ue
 = (1u << 31) + 100;

143 
¡d
::
¡ršg
 
s
;

144 
	`PutV¬št32
(&
s
, 
Ïrge_v®ue
);

145 
ušt32_t
 
»suÉ
;

146 
size_t
 
Ën
 = 0;†’ < 
s
.
	`size
() - 1;†en++) {

147 
	`ASSERT_TRUE
(
	`G‘V¬št32PŒ
(
s
.
	`d©a
(), s.d©a(è+ 
Ën
, &
»suÉ
è=ğ
nuÎ±r
);

149 
	`ASSERT_TRUE
(
	`G‘V¬št32PŒ
(
s
.
	`d©a
(), s.d©a(è+ s.
	`size
(), &
»suÉ
) !=

150 
nuÎ±r
);

151 
	`ASSERT_EQ
(
Ïrge_v®ue
, 
»suÉ
);

152 
	}
}

154 
	$TEST
(
Codšg
, 
V¬št64Ov”æow
) {

155 
ušt64_t
 
»suÉ
;

156 
¡d
::
¡ršg
 
	`šput
("\x81\x82\x83\x84\x85\x81\x82\x83\x84\x85\x11");

157 
	`ASSERT_TRUE
(
	`G‘V¬št64PŒ
(
šput
.
	`d©a
(), iÅut.d©a(è+ iÅut.
	`size
(),

158 &
»suÉ
è=ğ
nuÎ±r
);

159 
	}
}

161 
	$TEST
(
Codšg
, 
V¬št64TrunÿtiÚ
) {

162 
ušt64_t
 
Ïrge_v®ue
 = (1ull << 63) + 100ull;

163 
¡d
::
¡ršg
 
s
;

164 
	`PutV¬št64
(&
s
, 
Ïrge_v®ue
);

165 
ušt64_t
 
»suÉ
;

166 
size_t
 
Ën
 = 0;†’ < 
s
.
	`size
() - 1;†en++) {

167 
	`ASSERT_TRUE
(
	`G‘V¬št64PŒ
(
s
.
	`d©a
(), s.d©a(è+ 
Ën
, &
»suÉ
è=ğ
nuÎ±r
);

169 
	`ASSERT_TRUE
(
	`G‘V¬št64PŒ
(
s
.
	`d©a
(), s.d©a(è+ s.
	`size
(), &
»suÉ
) !=

170 
nuÎ±r
);

171 
	`ASSERT_EQ
(
Ïrge_v®ue
, 
»suÉ
);

172 
	}
}

174 
	$TEST
(
Codšg
, 
SŒšgs
) {

175 
¡d
::
¡ršg
 
s
;

176 
	`PutL’gthP»fixedSliû
(&
s
, 
	`Sliû
(""));

177 
	`PutL’gthP»fixedSliû
(&
s
, 
	`Sliû
("foo"));

178 
	`PutL’gthP»fixedSliû
(&
s
, 
	`Sliû
("bar"));

179 
	`PutL’gthP»fixedSliû
(&
s
, 
	`Sliû
(
¡d
::
	`¡ršg
(200, 'x')));

181 
Sliû
 
	`šput
(
s
);

182 
Sliû
 
v
;

183 
	`ASSERT_TRUE
(
	`G‘L’gthP»fixedSliû
(&
šput
, &
v
));

184 
	`ASSERT_EQ
("", 
v
.
	`ToSŒšg
());

185 
	`ASSERT_TRUE
(
	`G‘L’gthP»fixedSliû
(&
šput
, &
v
));

186 
	`ASSERT_EQ
("foo", 
v
.
	`ToSŒšg
());

187 
	`ASSERT_TRUE
(
	`G‘L’gthP»fixedSliû
(&
šput
, &
v
));

188 
	`ASSERT_EQ
("b¬", 
v
.
	`ToSŒšg
());

189 
	`ASSERT_TRUE
(
	`G‘L’gthP»fixedSliû
(&
šput
, &
v
));

190 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
(200, 'x'), 
v
.
	`ToSŒšg
());

191 
	`ASSERT_EQ
("", 
šput
.
	`ToSŒšg
());

192 
	}
}

196 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/comparator.cc

5 
	~<®gÜ™hm
>

6 
	~<c¡dšt
>

7 
	~<¡ršg
>

9 
	~"Ëv–db/com·¿tÜ.h
"

10 
	~"Ëv–db/¦iû.h
"

11 
	~"ut/loggšg.h
"

12 
	~"ut/no_de¡ruùÜ.h
"

14 
Çme¥aû
 
	gËv–db
 {

16 
	gCom·¿tÜ
::~
Com·¿tÜ
() {}

18 
Çme¥aû
 {

19 şas 
	cBy‹wi£Com·¿tÜIm¶
 : 
public
 
Com·¿tÜ
 {

20 
public
:

21 
By‹wi£Com·¿tÜIm¶
() {}

23 
vœtu®
 cÚ¡ * 
Name
() const {  "leveldb.BytewiseComparator"; }

25 
vœtu®
 
Com·»
(cÚ¡ 
Sliû
& 
a
, cÚ¡ Sliû& 
b
) const {

26  
	ga
.
com·»
(
b
);

29 
vœtu®
 
FšdShÜ‹¡S•¬©Ü
(
¡d
::
¡ršg
* 
¡¬t
,

30 cÚ¡ 
Sliû
& 
lim™
) const {

32 
size_t
 
	gmš_Ëngth
 = 
¡d
::
mš
(
¡¬t
->
size
(), 
lim™
.size());

33 
size_t
 
	gdiff_šdex
 = 0;

34 (
	gdiff_šdex
 < 
	gmš_Ëngth
) &&

35 ((*
	g¡¬t
)[
diff_šdex
] =ğ
lim™
[diff_index])) {

36 
diff_šdex
++;

39 ià(
	gdiff_šdex
 >ğ
mš_Ëngth
) {

42 
ušt8_t
 
diff_by‹
 = 
¡©ic_ÿ¡
<ušt8_t>((*
¡¬t
)[
diff_šdex
]);

43 ià(
	gdiff_by‹
 < 
	g¡©ic_ÿ¡
<
	gušt8_t
>(0xff) &&

44 
	gdiff_by‹
 + 1 < 
	g¡©ic_ÿ¡
<
	gušt8_t
>(
	glim™
[
diff_šdex
])) {

45 (*
	g¡¬t
)[
diff_šdex
]++;

46 
	g¡¬t
->
»size
(
diff_šdex
 + 1);

47 
as£¹
(
Com·»
(*
¡¬t
, 
lim™
) < 0);

52 
vœtu®
 
FšdShÜtSucûssÜ
(
¡d
::
¡ršg
* 
key
) const {

54 
size_t
 
n
 = 
key
->
size
();

55 
size_t
 
	gi
 = 0; i < 
	gn
; i++) {

56 cÚ¡ 
ušt8_t
 
	gby‹
 = (*
key
)[
i
];

57 ià(
	gby‹
 !ğ
¡©ic_ÿ¡
<
ušt8_t
>(0xff)) {

58 (*
key
)[
i
] = 
by‹
 + 1;

59 
	gkey
->
»size
(
i
 + 1);

68 cÚ¡ 
Com·¿tÜ
* 
	$By‹wi£Com·¿tÜ
() {

69 
NoDe¡ruùÜ
<
By‹wi£Com·¿tÜIm¶
> 
sšgËtÚ
;

70  
sšgËtÚ
.
	`g‘
();

71 
	}
}

	@util/crc32c.cc

7 
	~"ut/üc32c.h
"

9 
	~<¡ddef.h
>

10 
	~<¡dšt.h
>

12 
	~"pÜt/pÜt.h
"

13 
	~"ut/codšg.h
"

15 
Çme¥aû
 
	gËv–db
 {

16 
Çme¥aû
 
	güc32c
 {

18 
	gÇme¥aû
 {

20 cÚ¡ 
ušt32_t
 
	gkBy‹Ex‹nsiÚTabË
[256] = {

65 cÚ¡ 
ušt32_t
 
	gkSŒideEx‹nsiÚTabË0
[256] = {

110 cÚ¡ 
ušt32_t
 
	gkSŒideEx‹nsiÚTabË1
[256] = {

155 cÚ¡ 
ušt32_t
 
	gkSŒideEx‹nsiÚTabË2
[256] = {

200 cÚ¡ 
ušt32_t
 
	gkSŒideEx‹nsiÚTabË3
[256] = {

246 
cÚ¡ex´
 cÚ¡ 
ušt32_t
 
	gkCRC32XÜ
 = 
¡©ic_ÿ¡
<uint32_t>(0xffffffffU);

249 
šlše
 
ušt32_t
 
R—dUšt32LE
(cÚ¡ 
ušt8_t
* 
bufãr
) {

250  
DecodeFixed32
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
bufãr
));

256 
	g‹m¶©e
 <
	gN
>

257 
cÚ¡ex´
 
šlše
 cÚ¡ 
ušt8_t
* 
RoundUp
(cÚ¡ ušt8_t* 
poš‹r
) {

258  
	g»š‹½»t_ÿ¡
<
	gušt8_t
*>(

259 (
	g»š‹½»t_ÿ¡
<
	gušŒ_t
>(
	gpoš‹r
è+ (
	gN
 - 1)) &

260 ~
	g¡©ic_ÿ¡
<
	gušŒ_t
>(
	gN
 - 1));

267 
boŞ
 
CªAcûË¿‹CRC32C
() {

269 cÚ¡ 
	gkTe¡CRCBufãr
[] = "TestCRCBuffer";

270 cÚ¡ 
	gkBufSize
 = (
kTe¡CRCBufãr
) - 1;

271 cÚ¡ 
ušt32_t
 
	gkTe¡CRCV®ue
 = 0xdcbc59fa;

273  
	gpÜt
::
AcûË¿‹dCRC32C
(0, 
kTe¡CRCBufãr
, 
kBufSize
è=ğ
kTe¡CRCV®ue
;

276 
ušt32_t
 
Ex‹nd
(ušt32_ˆ
üc
, cÚ¡ * 
d©a
, 
size_t
 
n
) {

277 
boŞ
 
	gacûË¿‹
 = 
CªAcûË¿‹CRC32C
();

278 ià(
	gacûË¿‹
) {

279  
	gpÜt
::
AcûË¿‹dCRC32C
(
üc
, 
d©a
, 
n
);

282 cÚ¡ 
ušt8_t
* 
	gp
 = 
»š‹½»t_ÿ¡
<cÚ¡ ušt8_t*>(
d©a
);

283 cÚ¡ 
ušt8_t
* 
	ge
 = 
p
 + 
n
;

284 
ušt32_t
 
	gl
 = 
üc
 ^ 
kCRC32XÜ
;

287 
	#STEP1
 \

289 
c
 = (
l
 & 0xffè^ *
p
++; \

290 
l
 = 
kBy‹Ex‹nsiÚTabË
[
c
] ^ (l >> 8); \

291 } 0)

	)

294 
	#STEP4
(
s
) \

296 
üc
##
s
 = 
	`R—dUšt32LE
(
p
 + s * 4è^ 
kSŒideEx‹nsiÚTabË3
[crc##s & 0xff] ^ \

297 
kSŒideEx‹nsiÚTabË2
[(
üc
##
s
 >> 8) & 0xff] ^ \

298 
kSŒideEx‹nsiÚTabË1
[(
üc
##
s
 >> 16) & 0xff] ^ \

299 
kSŒideEx‹nsiÚTabË0
[
üc
##
s
 >> 24]; \

300 } 0)

	)

303 
	#STEP16
 \

305 
	`STEP4
(0); \

306 
	`STEP4
(1); \

307 
	`STEP4
(2); \

308 
	`STEP4
(3); \

309 
p
 += 16; \

310 } 0)

	)

313 
	#STEP4W
(
w
) \

315 
w
 ^ğ
l
; \

316 
size_t
 
i
 = 0; i < 4; ++i) { \

317 
w
 = (w >> 8è^ 
kBy‹Ex‹nsiÚTabË
[w & 0xff]; \

319 
l
 = 
w
; \

320 } 0)

	)

324 cÚ¡ 
ušt8_t
* 
	gx
 = 
RoundUp
<4>(
p
);

325 ià(
	gx
 <ğ
e
) {

327 
p
 !ğ
x
) {

328 
STEP1
;

332 ià((
	ge
 - 
	gp
) >= 16) {

334 
ušt32_t
 
üc0
 = 
R—dUšt32LE
(
p
 + 0 * 4è^ 
l
;

335 
ušt32_t
 
	güc1
 = 
R—dUšt32LE
(
p
 + 1 * 4);

336 
ušt32_t
 
	güc2
 = 
R—dUšt32LE
(
p
 + 2 * 4);

337 
ušt32_t
 
	güc3
 = 
R—dUšt32LE
(
p
 + 3 * 4);

338 
	gp
 += 16;

345 (
	ge
 - 
	gp
) >= 16) {

346 
STEP16
;

350 (
	ge
 - 
	gp
) >= 4) {

351 
STEP4
(0);

352 
ušt32_t
 
	gtmp
 = 
üc0
;

353 
	güc0
 = 
üc1
;

354 
	güc1
 = 
üc2
;

355 
	güc2
 = 
üc3
;

356 
	güc3
 = 
tmp
;

357 
	gp
 += 4;

361 
	gl
 = 0;

362 
STEP4W
(
üc0
);

363 
STEP4W
(
üc1
);

364 
STEP4W
(
üc2
);

365 
STEP4W
(
üc3
);

369 
	gp
 !ğ
e
) {

370 
STEP1
;

372 #undeà
STEP4W


373 #undeà
STEP16


374 #undeà
STEP4


375 #undeà
STEP1


376  
	gl
 ^ 
	gkCRC32XÜ
;

	@util/crc32c.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_CRC32C_H_


6 
	#STORAGE_LEVELDB_UTIL_CRC32C_H_


	)

8 
	~<¡ddef.h
>

9 
	~<¡dšt.h
>

11 
Çme¥aû
 
	gËv–db
 {

12 
Çme¥aû
 
	güc32c
 {

17 
ušt32_t
 
Ex‹nd
(ušt32_ˆ
š™_üc
, cÚ¡ * 
d©a
, 
size_t
 
n
);

20 
šlše
 
ušt32_t
 
V®ue
(cÚ¡ * 
d©a
, 
size_t
 
n
è{  
Ex‹nd
(0, data,‚); }

22 cÚ¡ 
ušt32_t
 
	gkMaskD–
 = 0xa282ead8ul;

29 
šlše
 
ušt32_t
 
Mask
(ušt32_ˆ
üc
) {

31  ((
	güc
 >> 15è| (üø<< 17)è+ 
	gkMaskD–
;

35 
šlše
 
ušt32_t
 
Unmask
(ušt32_ˆ
masked_üc
) {

36 
ušt32_t
 
	grÙ
 = 
masked_üc
 - 
kMaskD–
;

37  ((
	grÙ
 >> 17) | (rot << 15));

	@util/crc32c_test.cc

5 
	~"ut/üc32c.h
"

6 
	~"ut/‹¡h¬Ãss.h
"

8 
Çme¥aû
 
	gËv–db
 {

9 
Çme¥aû
 
	güc32c
 {

11 şas 
	cCRC
 {};

13 
TEST
(
CRC
, 
Snd¬dResuÉs
) {

15 
	gbuf
[32];

17 
mem£t
(
buf
, 0, (buf));

18 
ASSERT_EQ
(0x8a9136¯, 
V®ue
(
buf
, (buf)));

20 
mem£t
(
buf
, 0xff, (buf));

21 
ASSERT_EQ
(0x62a8ab43, 
V®ue
(
buf
, (buf)));

23 
	gi
 = 0; i < 32; i++) {

24 
	gbuf
[
i
] = i;

26 
ASSERT_EQ
(0x46dd794e, 
V®ue
(
buf
, (buf)));

28 
	gi
 = 0; i < 32; i++) {

29 
	gbuf
[
i
] = 31 - i;

31 
ASSERT_EQ
(0x113fdb5c, 
V®ue
(
buf
, (buf)));

33 
	gd©a
[48] = {

39 
ASSERT_EQ
(0xd9963a56, 
V®ue
(
»š‹½»t_ÿ¡
<*>(
d©a
), (data)));

42 
TEST
(
CRC
, 
V®ues
è{ 
ASSERT_NE
(
V®ue
("a", 1), Value("foo", 3)); }

44 
TEST
(
CRC
, 
Ex‹nd
) {

45 
ASSERT_EQ
(
V®ue
("h–lØwÜld", 11), 
Ex‹nd
(Value("hello ", 6), "world", 5));

48 
TEST
(
CRC
, 
Mask
) {

49 
ušt32_t
 
	güc
 = 
V®ue
("foo", 3);

50 
ASSERT_NE
(
üc
, 
Mask
(crc));

51 
ASSERT_NE
(
üc
, 
Mask
(Mask(crc)));

52 
ASSERT_EQ
(
üc
, 
Unmask
(
Mask
(crc)));

53 
ASSERT_EQ
(
üc
, 
Unmask
(Unmask(
Mask
(Mask(crc)))));

59 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/env.cc

5 
	~"Ëv–db/’v.h
"

7 
Çme¥aû
 
	gËv–db
 {

9 
	gEnv
::~
Env
() {}

11 
Stus
 
Env
::
NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
Wr™abËFe
** 
»suÉ
) {

12  
	gStus
::
NÙSuµÜ‹d
("NewAµ’dabËFe", 
âame
);

15 
	gSequ’tŸlFe
::~
Sequ’tŸlFe
() {}

17 
RªdomAcûssFe
::~RandomAccessFile() {}

19 
Wr™abËFe
::~WritableFile() {}

21 
Logg”
::~Logger() {}

23 
FeLock
::~FileLock() {}

25 
Log
(
Logg”
* 
šfo_log
, cÚ¡ * 
fÜm©
, ...) {

26 ià(
	gšfo_log
 !ğ
nuÎ±r
) {

27 
va_li¡
 
­
;

28 
va_¡¬t
(
­
, 
fÜm©
);

29 
	gšfo_log
->
Logv
(
fÜm©
, 
­
);

30 
va_’d
(
­
);

34 
Stus
 
DoWr™eSŒšgToFe
(
Env
* 
’v
, cÚ¡ 
Sliû
& 
d©a
,

35 cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
boŞ
 
should_sync
) {

36 
Wr™abËFe
* 
	gfe
;

37 
Stus
 
	gs
 = 
’v
->
NewWr™abËFe
(
âame
, &
fe
);

38 ià(!
	gs
.
ok
()) {

39  
	gs
;

41 
	gs
 = 
fe
->
Aµ’d
(
d©a
);

42 ià(
	gs
.
ok
(è&& 
	gshould_sync
) {

43 
	gs
 = 
fe
->
Sync
();

45 ià(
	gs
.
ok
()) {

46 
	gs
 = 
fe
->
Clo£
();

48 
d–‘e
 
	gfe
;

49 ià(!
	gs
.
ok
()) {

50 
	g’v
->
D–‘eFe
(
âame
);

52  
	gs
;

55 
Stus
 
Wr™eSŒšgToFe
(
Env
* 
’v
, cÚ¡ 
Sliû
& 
d©a
,

56 cÚ¡ 
¡d
::
¡ršg
& 
âame
) {

57  
DoWr™eSŒšgToFe
(
’v
, 
d©a
, 
âame
, 
çl£
);

60 
Stus
 
Wr™eSŒšgToFeSync
(
Env
* 
’v
, cÚ¡ 
Sliû
& 
d©a
,

61 cÚ¡ 
¡d
::
¡ršg
& 
âame
) {

62  
DoWr™eSŒšgToFe
(
’v
, 
d©a
, 
âame
, 
Œue
);

65 
Stus
 
R—dFeToSŒšg
(
Env
* 
’v
, cÚ¡ 
¡d
::
¡ršg
& 
âame
, std::¡ršg* 
d©a
) {

66 
d©a
->
ş—r
();

67 
Sequ’tŸlFe
* 
	gfe
;

68 
Stus
 
	gs
 = 
’v
->
NewSequ’tŸlFe
(
âame
, &
fe
);

69 ià(!
	gs
.
ok
()) {

70  
	gs
;

72 cÚ¡ 
	gkBufãrSize
 = 8192;

73 * 
	g¥aû
 = 
Ãw
 [
kBufãrSize
];

74 
	gŒue
) {

75 
Sliû
 
	gäagm’t
;

76 
	gs
 = 
fe
->
R—d
(
kBufãrSize
, &
äagm’t
, 
¥aû
);

77 ià(!
	gs
.
ok
()) {

80 
	gd©a
->
­³nd
(
äagm’t
.
d©a
(), f¿gm’t.
size
());

81 ià(
	gäagm’t
.
em±y
()) {

85 
	gd–‘e
[] 
	g¥aû
;

86 
d–‘e
 
	gfe
;

87  
	gs
;

90 
	gEnvW¿µ”
::~
EnvW¿µ”
() {}

	@util/env_posix.cc

5 
	~<dœ’t.h
>

6 
	~<fú.h
>

7 
	~<±h»ad.h
>

8 
	~<sys/mmª.h
>

9 
	~<sys/»sourû.h
>

10 
	~<sys/¡©.h
>

11 
	~<sys/time.h
>

12 
	~<sys/ty³s.h
>

13 
	~<uni¡d.h
>

15 
	~<©omic
>

16 
	~<û¼no
>

17 
	~<c¡ddef
>

18 
	~<c¡dšt
>

19 
	~<c¡dio
>

20 
	~<c¡dlib
>

21 
	~<c¡ršg
>

22 
	~<lim™s
>

23 
	~<queue
>

24 
	~<£t
>

25 
	~<¡ršg
>

26 
	~<th»ad
>

27 
	~<ty³_Œa™s
>

28 
	~<ut™y
>

30 
	~"Ëv–db/’v.h
"

31 
	~"Ëv–db/¦iû.h
"

32 
	~"Ëv–db/¡©us.h
"

33 
	~"pÜt/pÜt.h
"

34 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

35 
	~"ut/’v_posix_‹¡_h–³r.h
"

36 
	~"ut/posix_logg”.h
"

38 
Çme¥aû
 
	gËv–db
 {

40 
	gÇme¥aû
 {

43 
	gg_İ’_»ad_Úly_fe_lim™
 = -1;

46 
cÚ¡ex´
 cÚ¡ 
	gkDeçuÉMm­Lim™
 = ((*) >= 8) ? 1000 : 0;

49 
	gg_mm­_lim™
 = 
kDeçuÉMm­Lim™
;

51 
cÚ¡ex´
 cÚ¡ 
size_t
 
	gkWr™abËFeBufãrSize
 = 65536;

53 
Stus
 
PosixE¼Ü
(cÚ¡ 
¡d
::
¡ršg
& 
cÚ‹xt
, 
”rÜ_numb”
) {

54 ià(
	g”rÜ_numb”
 =ğ
ENOENT
) {

55  
Stus
::
NÙFound
(
cÚ‹xt
, 
¡d
::
¡»¼Ü
(
”rÜ_numb”
));

57  
	gStus
::
IOE¼Ü
(
cÚ‹xt
, 
¡d
::
¡»¼Ü
(
”rÜ_numb”
));

65 şas 
	cLim™”
 {

66 
	gpublic
:

68 
Lim™”
(
max_acquœes
è: 
acquœes_®lowed_
(max_acquires) {}

70 
Lim™”
(cÚ¡ Lim™”&èğ
d–‘e
;

71 
Lim™”
 
	gİ”©Ü
=(cÚ¡ Lim™”&èğ
d–‘e
;

75 
boŞ
 
Acquœe
() {

76 
	gŞd_acquœes_®lowed
 =

77 
acquœes_®lowed_
.
ãtch_sub
(1, 
¡d
::
memÜy_Üd”_»Ïxed
);

79 ià(
	gŞd_acquœes_®lowed
 > 0è 
	gŒue
;

81 
	gacquœes_®lowed_
.
ãtch_add
(1, 
¡d
::
memÜy_Üd”_»Ïxed
);

82  
	gçl£
;

87 
R–—£
(è{ 
	gacquœes_®lowed_
.
ãtch_add
(1, 
¡d
::
memÜy_Üd”_»Ïxed
); }

89 
	g´iv©e
:

94 
¡d
::
©omic
<> 
acquœes_®lowed_
;

101 şas 
	cPosixSequ’tŸlFe
 
	gfš®
 : 
public
 
Sequ’tŸlFe
 {

102 
public
:

103 
PosixSequ’tŸlFe
(
¡d
::
¡ršg
 
f’ame
, 
fd
)

104 : 
fd_
(
fd
), 
f’ame_
(
f’ame
) {}

105 ~
PosixSequ’tŸlFe
(è
	gov”ride
 { 
şo£
(
fd_
); }

107 
Stus
 
R—d
(
size_t
 
n
, 
Sliû
* 
»suÉ
, * 
sü©ch
è
	gov”ride
 {

108 
Stus
 
	g¡©us
;

109 
	gŒue
) {

110 ::
ssize_t
 
»ad_size
 = ::
»ad
(
fd_
, 
sü©ch
, 
n
);

111 ià(
	g»ad_size
 < 0) {

112 ià(
	g”ºo
 =ğ
EINTR
) {

115 
	g¡©us
 = 
PosixE¼Ü
(
f’ame_
, 
”ºo
);

118 *
	g»suÉ
 = 
Sliû
(
sü©ch
, 
»ad_size
);

121  
	g¡©us
;

124 
Stus
 
Sk
(
ušt64_t
 
n
è
	gov”ride
 {

125 ià(::
l£ek
(
fd_
, 
n
, 
SEEK_CUR
è=ğ
¡©ic_ÿ¡
<
off_t
>(-1)) {

126  
PosixE¼Ü
(
f’ame_
, 
”ºo
);

128  
	gStus
::
OK
();

131 
	g´iv©e
:

132 cÚ¡ 
fd_
;

133 cÚ¡ 
	g¡d
::
¡ršg
 
f’ame_
;

141 şas 
	cPosixRªdomAcûssFe
 
	gfš®
 : 
public
 
RªdomAcûssFe
 {

142 
public
:

145 
PosixRªdomAcûssFe
(
¡d
::
¡ršg
 
f’ame
, 
fd
, 
Lim™”
* 
fd_lim™”
)

146 : 
has_³rmª’t_fd_
(
fd_lim™”
->
Acquœe
()),

147 
fd_
(
has_³rmª’t_fd_
 ? 
fd
 : -1),

148 
fd_lim™”_
(
fd_lim™”
),

149 
f’ame_
(
¡d
::
move
(
f’ame
)) {

150 ià(!
has_³rmª’t_fd_
) {

151 
as£¹
(
fd_
 == -1);

152 ::
şo£
(
fd
);

156 ~
PosixRªdomAcûssFe
(è
	gov”ride
 {

157 ià(
	ghas_³rmª’t_fd_
) {

158 
as£¹
(
fd_
 != -1);

159 ::
şo£
(
fd_
);

160 
	gfd_lim™”_
->
R–—£
();

164 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

165 * 
sü©ch
ècÚ¡ 
	gov”ride
 {

166 
	gfd
 = 
fd_
;

167 ià(!
	ghas_³rmª’t_fd_
) {

168 
	gfd
 = ::
İ’
(
f’ame_
.
c_¡r
(), 
O_RDONLY
);

169 ià(
	gfd
 < 0) {

170  
PosixE¼Ü
(
f’ame_
, 
”ºo
);

174 
as£¹
(
fd
 != -1);

176 
Stus
 
	g¡©us
;

177 
ssize_t
 
	g»ad_size
 = ::
´—d
(
fd
, 
sü©ch
, 
n
, 
¡©ic_ÿ¡
<
off_t
>(
off£t
));

178 *
	g»suÉ
 = 
Sliû
(
sü©ch
, (
»ad_size
 < 0) ? 0 :„ead_size);

179 ià(
	g»ad_size
 < 0) {

181 
	g¡©us
 = 
PosixE¼Ü
(
f’ame_
, 
”ºo
);

183 ià(!
	ghas_³rmª’t_fd_
) {

185 
as£¹
(
fd
 !ğ
fd_
);

186 ::
şo£
(
fd
);

188  
	g¡©us
;

191 
	g´iv©e
:

192 cÚ¡ 
boŞ
 
has_³rmª’t_fd_
;

193 cÚ¡ 
	gfd_
;

194 
Lim™”
* cÚ¡ 
	gfd_lim™”_
;

195 cÚ¡ 
	g¡d
::
¡ršg
 
f’ame_
;

203 şas 
	cPosixMm­R—dabËFe
 
	gfš®
 : 
public
 
RªdomAcûssFe
 {

204 
public
:

212 
PosixMm­R—dabËFe
(
¡d
::
¡ršg
 
f’ame
, * 
mm­_ba£
, 
size_t
 
Ëngth
,

213 
Lim™”
* 
mm­_lim™”
)

214 : 
mm­_ba£_
(
mm­_ba£
),

215 
Ëngth_
(
Ëngth
),

216 
mm­_lim™”_
(
mm­_lim™”
),

217 
f’ame_
(
¡d
::
move
(
f’ame
)) {}

219 ~
PosixMm­R—dabËFe
(è
ov”ride
 {

220 ::
munm­
(
¡©ic_ÿ¡
<*>(
mm­_ba£_
), 
Ëngth_
);

221 
	gmm­_lim™”_
->
R–—£
();

224 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

225 * 
sü©ch
ècÚ¡ 
	gov”ride
 {

226 ià(
	goff£t
 + 
	gn
 > 
	gËngth_
) {

227 *
	g»suÉ
 = 
Sliû
();

228  
PosixE¼Ü
(
f’ame_
, 
EINVAL
);

231 *
	g»suÉ
 = 
Sliû
(
mm­_ba£_
 + 
off£t
, 
n
);

232  
	gStus
::
OK
();

235 
	g´iv©e
:

236 * cÚ¡ 
mm­_ba£_
;

237 cÚ¡ 
size_t
 
	gËngth_
;

238 
Lim™”
* cÚ¡ 
	gmm­_lim™”_
;

239 cÚ¡ 
	g¡d
::
¡ršg
 
f’ame_
;

242 şas 
	cPosixWr™abËFe
 
	gfš®
 : 
public
 
Wr™abËFe
 {

243 
public
:

244 
PosixWr™abËFe
(
¡d
::
¡ršg
 
f’ame
, 
fd
)

245 : 
pos_
(0),

246 
fd_
(
fd
),

247 
is_mªiã¡_
(
IsMªiã¡
(
f’ame
)),

248 
f’ame_
(
¡d
::
move
(
f’ame
)),

249 
dœÇme_
(
DœÇme
(
f’ame_
)) {}

251 ~
PosixWr™abËFe
(è
	gov”ride
 {

252 ià(
	gfd_
 >= 0) {

254 
Clo£
();

258 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
è
	gov”ride
 {

259 
size_t
 
	gwr™e_size
 = 
d©a
.
size
();

260 cÚ¡ * 
	gwr™e_d©a
 = 
d©a
.data();

263 
size_t
 
	gcİy_size
 = 
¡d
::
mš
(
wr™e_size
, 
kWr™abËFeBufãrSize
 - 
pos_
);

264 
	g¡d
::
memıy
(
buf_
 + 
pos_
, 
wr™e_d©a
, 
cİy_size
);

265 
	gwr™e_d©a
 +ğ
cİy_size
;

266 
	gwr™e_size
 -ğ
cİy_size
;

267 
	gpos_
 +ğ
cİy_size
;

268 ià(
	gwr™e_size
 == 0) {

269  
Stus
::
OK
();

273 
Stus
 
	g¡©us
 = 
FlushBufãr
();

274 ià(!
	g¡©us
.
ok
()) {

275  
	g¡©us
;

279 ià(
	gwr™e_size
 < 
	gkWr™abËFeBufãrSize
) {

280 
	g¡d
::
memıy
(
buf_
, 
wr™e_d©a
, 
wr™e_size
);

281 
	gpos_
 = 
wr™e_size
;

282  
	gStus
::
OK
();

284  
Wr™eUnbufã»d
(
wr™e_d©a
, 
wr™e_size
);

287 
Stus
 
Clo£
(è
	gov”ride
 {

288 
Stus
 
	g¡©us
 = 
FlushBufãr
();

289 cÚ¡ 
	gşo£_»suÉ
 = ::
şo£
(
fd_
);

290 ià(
	gşo£_»suÉ
 < 0 && 
	g¡©us
.
ok
()) {

291 
	g¡©us
 = 
PosixE¼Ü
(
f’ame_
, 
”ºo
);

293 
	gfd_
 = -1;

294  
	g¡©us
;

297 
Stus
 
Flush
(è
	gov”ride
 {  
FlushBufãr
(); }

299 
Stus
 
Sync
(è
	gov”ride
 {

305 
Stus
 
	g¡©us
 = 
SyncDœIfMªiã¡
();

306 ià(!
	g¡©us
.
ok
()) {

307  
	g¡©us
;

310 
	g¡©us
 = 
FlushBufãr
();

311 ià(!
	g¡©us
.
ok
()) {

312  
	g¡©us
;

315  
SyncFd
(
fd_
, 
f’ame_
);

318 
	g´iv©e
:

319 
Stus
 
FlushBufãr
() {

320 
Stus
 
¡©us
 = 
Wr™eUnbufã»d
(
buf_
, 
pos_
);

321 
	gpos_
 = 0;

322  
	g¡©us
;

325 
Stus
 
Wr™eUnbufã»d
(cÚ¡ * 
d©a
, 
size_t
 
size
) {

326 
	gsize
 > 0) {

327 
ssize_t
 
	gwr™e_»suÉ
 = ::
wr™e
(
fd_
, 
d©a
, 
size
);

328 ià(
	gwr™e_»suÉ
 < 0) {

329 ià(
	g”ºo
 =ğ
EINTR
) {

332  
PosixE¼Ü
(
f’ame_
, 
”ºo
);

334 
	gd©a
 +ğ
wr™e_»suÉ
;

335 
	gsize
 -ğ
wr™e_»suÉ
;

337  
	gStus
::
OK
();

340 
Stus
 
SyncDœIfMªiã¡
() {

341 
Stus
 
	g¡©us
;

342 ià(!
	gis_mªiã¡_
) {

343  
	g¡©us
;

346 
	gfd
 = ::
İ’
(
dœÇme_
.
c_¡r
(), 
O_RDONLY
);

347 ià(
	gfd
 < 0) {

348 
	g¡©us
 = 
PosixE¼Ü
(
dœÇme_
, 
”ºo
);

350 
	g¡©us
 = 
SyncFd
(
fd
, 
dœÇme_
);

351 ::
şo£
(
fd
);

353  
	g¡©us
;

362 
Stus
 
SyncFd
(
fd
, cÚ¡ 
¡d
::
¡ršg
& 
fd_·th
) {

363 #ià
HAVE_FULLFSYNC


368 ià(::
fú
(
fd
, 
F_FULLFSYNC
) == 0) {

369  
Stus
::
OK
();

373 #ià
HAVE_FDATASYNC


374 
boŞ
 
	gsync_sucûss
 = ::
fd©async
(
fd
) == 0;

376 
boŞ
 
	gsync_sucûss
 = ::
fsync
(
fd
) == 0;

379 ià(
	gsync_sucûss
) {

380  
	gStus
::
OK
();

382  
PosixE¼Ü
(
fd_·th
, 
”ºo
);

388 
	g¡d
::
¡ršg
 
DœÇme
(cÚ¡ 
¡d
::¡ršg& 
f’ame
) {

389 
¡d
::
¡ršg
::
size_ty³
 
£·¿tÜ_pos
 = 
f’ame
.
rfšd
('/');

390 ià(
	g£·¿tÜ_pos
 =ğ
¡d
::
¡ršg
::
Åos
) {

391  
¡d
::
¡ršg
(".");

395 
as£¹
(
f’ame
.
fšd
('/', 
£·¿tÜ_pos
 + 1è=ğ
¡d
::
¡ršg
::
Åos
);

397  
	gf’ame
.
sub¡r
(0, 
£·¿tÜ_pos
);

404 
Sliû
 
Ba£Çme
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
) {

405 
¡d
::
¡ršg
::
size_ty³
 
£·¿tÜ_pos
 = 
f’ame
.
rfšd
('/');

406 ià(
	g£·¿tÜ_pos
 =ğ
¡d
::
¡ršg
::
Åos
) {

407  
Sliû
(
f’ame
);

411 
as£¹
(
f’ame
.
fšd
('/', 
£·¿tÜ_pos
 + 1è=ğ
¡d
::
¡ršg
::
Åos
);

413  
Sliû
(
f’ame
.
d©a
(è+ 
£·¿tÜ_pos
 + 1,

414 
f’ame
.
Ëngth
(è- 
£·¿tÜ_pos
 - 1);

418 
boŞ
 
IsMªiã¡
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
) {

419  
Ba£Çme
(
f’ame
).
¡¬ts_w™h
("MANIFEST");

423 
	gbuf_
[
kWr™abËFeBufãrSize
];

424 
size_t
 
	gpos_
;

425 
	gfd_
;

427 cÚ¡ 
boŞ
 
	gis_mªiã¡_
;

428 cÚ¡ 
	g¡d
::
¡ršg
 
f’ame_
;

429 cÚ¡ 
	g¡d
::
¡ršg
 
dœÇme_
;

432 
LockOrUÆock
(
fd
, 
boŞ
 
lock
) {

433 
	g”ºo
 = 0;

434 ::
æock
 
fe_lock_šfo
;

435 
	g¡d
::
mem£t
(&
fe_lock_šfo
, 0, (file_lock_info));

436 
	gfe_lock_šfo
.
	gl_ty³
 = (
lock
 ? 
F_WRLCK
 : 
F_UNLCK
);

437 
	gfe_lock_šfo
.
	gl_wh’û
 = 
SEEK_SET
;

438 
	gfe_lock_šfo
.
	gl_¡¬t
 = 0;

439 
	gfe_lock_šfo
.
	gl_Ën
 = 0;

440  ::
fú
(
fd
, 
F_SETLK
, &
fe_lock_šfo
);

444 şas 
	cPosixFeLock
 : 
public
 
FeLock
 {

445 
public
:

446 
PosixFeLock
(
fd
, 
¡d
::
¡ršg
 
f’ame
)

447 : 
fd_
(
fd
), 
f’ame_
(
¡d
::
move
(
f’ame
)) {}

449 
fd
(ècÚ¡ {  
fd_
; }

450 cÚ¡ 
	g¡d
::
¡ršg
& 
f’ame
(ècÚ¡ {  
f’ame_
; }

452 
	g´iv©e
:

453 cÚ¡ 
fd_
;

454 cÚ¡ 
	g¡d
::
¡ršg
 
f’ame_
;

464 şas 
	cPosixLockTabË
 {

465 
	gpublic
:

466 
boŞ
 
In£¹
(cÚ¡ 
¡d
::
¡ršg
& 
âame
è
LOCKS_EXCLUDED
(
mu_
) {

467 
mu_
.
Lock
();

468 
boŞ
 
	gsucûeded
 = 
locked_fes_
.
š£¹
(
âame
).
£cÚd
;

469 
	gmu_
.
UÆock
();

470  
	gsucûeded
;

472 
Remove
(cÚ¡ 
¡d
::
¡ršg
& 
âame
è
LOCKS_EXCLUDED
(
mu_
) {

473 
mu_
.
Lock
();

474 
	glocked_fes_
.
”a£
(
âame
);

475 
	gmu_
.
UÆock
();

478 
	g´iv©e
:

479 
pÜt
::
Mu‹x
 
mu_
;

480 
	g¡d
::
£t
<
¡d
::
¡ršg
> 
locked_fes_
 
GUARDED_BY
(
mu_
);

483 şas 
	cPosixEnv
 : 
public
 
Env
 {

484 
public
:

485 
PosixEnv
();

486 ~
PosixEnv
(è
	gov”ride
 {

487 
	gmsg
[] = "PosixEnv singleton destroyed. Unsupported behavior!\n";

488 
	g¡d
::
fwr™e
(
msg
, 1, (msg), 
¡d”r
);

489 
	g¡d
::
abÜt
();

492 
Stus
 
NewSequ’tŸlFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
,

493 
Sequ’tŸlFe
** 
»suÉ
è
	gov”ride
 {

494 
	gfd
 = ::
İ’
(
f’ame
.
c_¡r
(), 
O_RDONLY
);

495 ià(
	gfd
 < 0) {

496 *
	g»suÉ
 = 
nuÎ±r
;

497  
PosixE¼Ü
(
f’ame
, 
”ºo
);

500 *
	g»suÉ
 = 
Ãw
 
PosixSequ’tŸlFe
(
f’ame
, 
fd
);

501  
	gStus
::
OK
();

504 
Stus
 
NewRªdomAcûssFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
,

505 
RªdomAcûssFe
** 
»suÉ
è
	gov”ride
 {

506 *
	g»suÉ
 = 
nuÎ±r
;

507 
	gfd
 = ::
İ’
(
f’ame
.
c_¡r
(), 
O_RDONLY
);

508 ià(
	gfd
 < 0) {

509  
PosixE¼Ü
(
f’ame
, 
”ºo
);

512 ià(!
	gmm­_lim™”_
.
Acquœe
()) {

513 *
	g»suÉ
 = 
Ãw
 
PosixRªdomAcûssFe
(
f’ame
, 
fd
, &
fd_lim™”_
);

514  
	gStus
::
OK
();

517 
ušt64_t
 
	gfe_size
;

518 
Stus
 
	g¡©us
 = 
G‘FeSize
(
f’ame
, &
fe_size
);

519 ià(
	g¡©us
.
ok
()) {

520 * 
	gmm­_ba£
 =

521 ::
mm­
Ğ
nuÎ±r
, 
fe_size
, 
PROT_READ
, 
MAP_SHARED
, 
fd
, 0);

522 ià(
	gmm­_ba£
 !ğ
MAP_FAILED
) {

523 *
»suÉ
 = 
Ãw
 
PosixMm­R—dabËFe
(
f’ame
,

524 
»š‹½»t_ÿ¡
<*>(
mm­_ba£
),

525 
fe_size
, &
mm­_lim™”_
);

527 
	g¡©us
 = 
PosixE¼Ü
(
f’ame
, 
”ºo
);

530 ::
şo£
(
fd
);

531 ià(!
	g¡©us
.
ok
()) {

532 
	gmm­_lim™”_
.
R–—£
();

534  
	g¡©us
;

537 
Stus
 
NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
,

538 
Wr™abËFe
** 
»suÉ
è
	gov”ride
 {

539 
	gfd
 = ::
İ’
(
f’ame
.
c_¡r
(), 
O_TRUNC
 | 
O_WRONLY
 | 
O_CREAT
, 0644);

540 ià(
	gfd
 < 0) {

541 *
	g»suÉ
 = 
nuÎ±r
;

542  
PosixE¼Ü
(
f’ame
, 
”ºo
);

545 *
	g»suÉ
 = 
Ãw
 
PosixWr™abËFe
(
f’ame
, 
fd
);

546  
	gStus
::
OK
();

549 
Stus
 
NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
,

550 
Wr™abËFe
** 
»suÉ
è
	gov”ride
 {

551 
	gfd
 = ::
İ’
(
f’ame
.
c_¡r
(), 
O_APPEND
 | 
O_WRONLY
 | 
O_CREAT
, 0644);

552 ià(
	gfd
 < 0) {

553 *
	g»suÉ
 = 
nuÎ±r
;

554  
PosixE¼Ü
(
f’ame
, 
”ºo
);

557 *
	g»suÉ
 = 
Ãw
 
PosixWr™abËFe
(
f’ame
, 
fd
);

558  
	gStus
::
OK
();

561 
boŞ
 
FeExi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
è
ov”ride
 {

562  ::
acûss
(
f’ame
.
c_¡r
(), 
F_OK
) == 0;

565 
Stus
 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
dœeùÜy_·th
,

566 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
»suÉ
è
ov”ride
 {

567 
»suÉ
->
ş—r
();

568 ::
DIR
* 
dœ
 = ::
İ’dœ
(
dœeùÜy_·th
.
c_¡r
());

569 ià(
	gdœ
 =ğ
nuÎ±r
) {

570  
PosixE¼Ü
(
dœeùÜy_·th
, 
”ºo
);

572 ::
dœ’t
* 
’Œy
;

573 (
	g’Œy
 = ::
»addœ
(
dœ
)è!ğ
nuÎ±r
) {

574 
»suÉ
->
em¶aû_back
(
’Œy
->
d_Çme
);

576 ::
şo£dœ
(
dœ
);

577  
	gStus
::
OK
();

580 
Stus
 
D–‘eFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
è
ov”ride
 {

581 ià(::
uÆšk
(
f’ame
.
c_¡r
()) != 0) {

582  
PosixE¼Ü
(
f’ame
, 
”ºo
);

584  
	gStus
::
OK
();

587 
Stus
 
C»©eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
dœÇme
è
ov”ride
 {

588 ià(::
mkdœ
(
dœÇme
.
c_¡r
(), 0755) != 0) {

589  
PosixE¼Ü
(
dœÇme
, 
”ºo
);

591  
	gStus
::
OK
();

594 
Stus
 
D–‘eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
dœÇme
è
ov”ride
 {

595 ià(::
rmdœ
(
dœÇme
.
c_¡r
()) != 0) {

596  
PosixE¼Ü
(
dœÇme
, 
”ºo
);

598  
	gStus
::
OK
();

601 
Stus
 
G‘FeSize
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
ušt64_t
* 
size
è
	gov”ride
 {

602 ::
¡©
 
fe_¡©
;

603 ià(::
¡©
(
f’ame
.
c_¡r
(), &
fe_¡©
) != 0) {

604 *
size
 = 0;

605  
PosixE¼Ü
(
f’ame
, 
”ºo
);

607 *
	gsize
 = 
fe_¡©
.
¡_size
;

608  
	gStus
::
OK
();

611 
Stus
 
R’ameFe
(cÚ¡ 
¡d
::
¡ršg
& 
äom
, cÚ¡ std::¡ršg& 
to
è
ov”ride
 {

612 ià(
¡d
::
»Çme
(
äom
.
c_¡r
(), 
to
.c_str()) != 0) {

613  
PosixE¼Ü
(
äom
, 
”ºo
);

615  
	gStus
::
OK
();

618 
Stus
 
LockFe
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
FeLock
** 
lock
è
	gov”ride
 {

619 *
	glock
 = 
nuÎ±r
;

621 
	gfd
 = ::
İ’
(
f’ame
.
c_¡r
(), 
O_RDWR
 | 
O_CREAT
, 0644);

622 ià(
	gfd
 < 0) {

623  
PosixE¼Ü
(
f’ame
, 
”ºo
);

626 ià(!
	glocks_
.
In£¹
(
f’ame
)) {

627 ::
şo£
(
fd
);

628  
	gStus
::
IOE¼Ü
("lock " + 
f’ame
, "already held by…rocess");

631 ià(
LockOrUÆock
(
fd
, 
Œue
) == -1) {

632 
lock_”ºo
 = 
”ºo
;

633 ::
şo£
(
fd
);

634 
	glocks_
.
Remove
(
f’ame
);

635  
PosixE¼Ü
("lock " + 
f’ame
, 
lock_”ºo
);

638 *
	glock
 = 
Ãw
 
PosixFeLock
(
fd
, 
f’ame
);

639  
	gStus
::
OK
();

642 
Stus
 
UÆockFe
(
FeLock
* 
lock
è
	gov”ride
 {

643 
PosixFeLock
* 
	gposix_fe_lock
 = 
¡©ic_ÿ¡
<PosixFeLock*>(
lock
);

644 ià(
LockOrUÆock
(
posix_fe_lock
->
fd
(), 
çl£
) == -1) {

645  
PosixE¼Ü
("uÆock " + 
posix_fe_lock
->
f’ame
(), 
”ºo
);

647 
	glocks_
.
Remove
(
posix_fe_lock
->
f’ame
());

648 ::
şo£
(
posix_fe_lock
->
fd
());

649 
d–‘e
 
	gposix_fe_lock
;

650  
	gStus
::
OK
();

653 
ScheduË
((*
background_wÜk_funùiÚ
)(* 
background_wÜk_¬g
),

654 * 
background_wÜk_¬g
è
	gov”ride
;

656 
S¹Th»ad
((*
th»ad_maš
)(* 
th»ad_maš_¬g
),

657 * 
th»ad_maš_¬g
è
	gov”ride
;

659 
Stus
 
G‘Te¡DœeùÜy
(
¡d
::
¡ršg
* 
»suÉ
è
ov”ride
 {

660 cÚ¡ * 
’v
 = 
¡d
::
g‘’v
("TEST_TMPDIR");

661 ià(
	g’v
 &&ƒnv[0] != '\0') {

662 *
»suÉ
 = 
’v
;

664 
	gbuf
[100];

665 
	g¡d
::
¢´štf
(
buf
, (buf), "/tmp/leveldbtest-%d",

666 
¡©ic_ÿ¡
<>(::
g‘euid
()));

667 *
	g»suÉ
 = 
buf
;

671 
C»©eDœ
(*
»suÉ
);

673  
	gStus
::
OK
();

676 
Stus
 
NewLogg”
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
Logg”
** 
»suÉ
è
	gov”ride
 {

677 
	g¡d
::
FILE
* 
å
 = 
¡d
::
fİ’
(
f’ame
.
c_¡r
(), "w");

678 ià(
	gå
 =ğ
nuÎ±r
) {

679 *
»suÉ
 = 
nuÎ±r
;

680  
PosixE¼Ü
(
f’ame
, 
”ºo
);

682 *
	g»suÉ
 = 
Ãw
 
PosixLogg”
(
å
);

683  
	gStus
::
OK
();

687 
ušt64_t
 
NowMiüos
(è
	gov”ride
 {

688 
cÚ¡ex´
 
ušt64_t
 
	gkU£cÚdsP”SecÚd
 = 1000000;

689 ::
timev®
 
tv
;

690 ::
g‘timeofday
(&
tv
, 
nuÎ±r
);

691  
	g¡©ic_ÿ¡
<
	gušt64_t
>(
	gtv
.
	gtv_£c
è* 
	gkU£cÚdsP”SecÚd
 +v.
	gtv_u£c
;

694 
SË•FÜMiüo£cÚds
(
miüos
è
	gov”ride
 { ::
u¦“p
(micros); }

696 
	g´iv©e
:

697 
BackgroundTh»adMaš
();

699 
BackgroundTh»adEÁryPošt
(
PosixEnv
* 
’v
) {

700 
	g’v
->
BackgroundTh»adMaš
();

709 
	sBackgroundWÜkI‹m
 {

710 
ex¶ic™
 
BackgroundWÜkI‹m
((*
funùiÚ
)(* 
¬g
), *‡rg)

711 : 
funùiÚ
(funùiÚ), 
¬g
(arg) {}

713 (*cÚ¡ 
	gfunùiÚ
)(*);

714 * cÚ¡ 
	g¬g
;

717 
	gpÜt
::
Mu‹x
 
background_wÜk_mu‹x_
;

718 
	gpÜt
::
CÚdV¬
 
background_wÜk_cv_
 
GUARDED_BY
(
background_wÜk_mu‹x_
);

719 
boŞ
 
¡¬‹d_background_th»ad_
 
GUARDED_BY
(
background_wÜk_mu‹x_
);

721 
	g¡d
::
queue
<
BackgroundWÜkI‹m
> 
background_wÜk_queue_


722 
GUARDED_BY
(
background_wÜk_mu‹x_
);

724 
PosixLockTabË
 
	glocks_
;

725 
Lim™”
 
	gmm­_lim™”_
;

726 
Lim™”
 
	gfd_lim™”_
;

730 
MaxMm­s
(è{  
	gg_mm­_lim™
; }

733 
MaxO³nFes
() {

734 ià(
	gg_İ’_»ad_Úly_fe_lim™
 >= 0) {

735  
g_İ’_»ad_Úly_fe_lim™
;

737 ::
¾im™
 
¾im
;

738 ià(::
g‘¾im™
(
RLIMIT_NOFILE
, &
¾im
)) {

740 
	gg_İ’_»ad_Úly_fe_lim™
 = 50;

741 } ià(
	g¾im
.
	g¾im_cur
 =ğ
RLIM_INFINITY
) {

742 
g_İ’_»ad_Úly_fe_lim™
 = 
¡d
::
num”ic_lim™s
<>::
max
();

745 
	gg_İ’_»ad_Úly_fe_lim™
 = 
¾im
.
¾im_cur
 / 5;

747  
	gg_İ’_»ad_Úly_fe_lim™
;

752 
	gPosixEnv
::
	$PosixEnv
()

753 : 
	`background_wÜk_cv_
(&
background_wÜk_mu‹x_
),

754 
	`¡¬‹d_background_th»ad_
(
çl£
),

755 
	`mm­_lim™”_
(
	`MaxMm­s
()),

756 
	`fd_lim™”_
(
	$MaxO³nFes
()è{
	}
}

758 
	gPosixEnv
::
	$ScheduË
(

759 (*
background_wÜk_funùiÚ
)(* 
background_wÜk_¬g
),

760 * 
background_wÜk_¬g
) {

761 
background_wÜk_mu‹x_
.
	`Lock
();

764 ià(!
¡¬‹d_background_th»ad_
) {

765 
¡¬‹d_background_th»ad_
 = 
Œue
;

766 
¡d
::
th»ad
 
	`background_th»ad
(
PosixEnv
::
BackgroundTh»adEÁryPošt
, 
this
);

767 
background_th»ad
.
	`d‘ach
();

771 ià(
background_wÜk_queue_
.
	`em±y
()) {

772 
background_wÜk_cv_
.
	`SigÇl
();

775 
background_wÜk_queue_
.
	`em¶aû
(
background_wÜk_funùiÚ
, 
background_wÜk_¬g
);

776 
background_wÜk_mu‹x_
.
	`UÆock
();

777 
	}
}

779 
	gPosixEnv
::
	$BackgroundTh»adMaš
() {

780 
Œue
) {

781 
background_wÜk_mu‹x_
.
	`Lock
();

784 
background_wÜk_queue_
.
	`em±y
()) {

785 
background_wÜk_cv_
.
	`Wa™
();

788 
	`as£¹
(!
background_wÜk_queue_
.
	`em±y
());

789 autØ
background_wÜk_funùiÚ
 = 
background_wÜk_queue_
.
	`äÚt
().
funùiÚ
;

790 * 
background_wÜk_¬g
 = 
background_wÜk_queue_
.
	`äÚt
().
¬g
;

791 
background_wÜk_queue_
.
	`pİ
();

793 
background_wÜk_mu‹x_
.
	`UÆock
();

794 
	`background_wÜk_funùiÚ
(
background_wÜk_¬g
);

796 
	}
}

798 
	gÇme¥aû
 {

812 
	g‹m¶©e
 <
ty³Çme
 
	gEnvTy³
>

813 şas 
	cSšgËtÚEnv
 {

814 
	gpublic
:

815 
SšgËtÚEnv
() {

816 #ià!
defšed
(
NDEBUG
)

817 
’v_š™Ÿlized_
.
¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”
::
memÜy_Üd”_»Ïxed
);

819 
¡©ic_as£¹
((
’v_¡Üage_
è>ğ(
EnvTy³
),

821 
¡©ic_as£¹
(
®ignof
(
deşty³
(
’v_¡Üage_
)è>ğ®ignof(
EnvTy³
),

823 
Ãw
 (&
’v_¡Üage_
è
EnvTy³
();

825 ~
SšgËtÚEnv
() = ;

827 
SšgËtÚEnv
(cÚ¡ SšgËtÚEnv&èğ
d–‘e
;

828 
	gSšgËtÚEnv
& 
	gİ”©Ü
=(cÚ¡ 
SšgËtÚEnv
&èğ
d–‘e
;

830 
Env
* 
’v
(è{  
	g»š‹½»t_ÿ¡
<
	gEnv
*>(&
	g’v_¡Üage_
); }

832 
As£¹EnvNÙIn™Ÿlized
() {

833 #ià!
defšed
(
NDEBUG
)

834 
as£¹
(!
’v_š™Ÿlized_
.
lßd
(
¡d
::
memÜy_Üd”
::
memÜy_Üd”_»Ïxed
));

838 
	g´iv©e
:

839 
ty³Çme
 
¡d
::
®igÃd_¡Üage
<(
EnvTy³
), 
®ignof
(EnvTy³)>::
ty³


840 
’v_¡Üage_
;

841 #ià!
defšed
(
NDEBUG
)

842 
	g¡d
::
©omic
<
boŞ
> 
’v_š™Ÿlized_
;

846 #ià!
defšed
(
NDEBUG
)

847 
	g‹m¶©e
 <
ty³Çme
 
	gEnvTy³
>

848 
	g¡d
::
©omic
<
boŞ
> 
SšgËtÚEnv
<
EnvTy³
>::
’v_š™Ÿlized_
;

851 
usšg
 
	gPosixDeçuÉEnv
 = 
SšgËtÚEnv
<
PosixEnv
>;

855 
	gPosixEnv
::
	$S¹Th»ad
((*
th»ad_maš
)(* 
th»ad_maš_¬g
),

856 * 
th»ad_maš_¬g
) {

857 
¡d
::
th»ad
 
	`Ãw_th»ad
(
th»ad_maš
, 
th»ad_maš_¬g
);

858 
Ãw_th»ad
.
	`d‘ach
();

859 
	}
}

861 
	gEnvPosixTe¡H–³r
::
	$S‘R—dOÆyFDLim™
(
lim™
) {

862 
PosixDeçuÉEnv
::
	`As£¹EnvNÙIn™Ÿlized
();

863 
g_İ’_»ad_Úly_fe_lim™
 = 
lim™
;

864 
	}
}

866 
	gEnvPosixTe¡H–³r
::
	$S‘R—dOÆyMM­Lim™
(
lim™
) {

867 
PosixDeçuÉEnv
::
	`As£¹EnvNÙIn™Ÿlized
();

868 
g_mm­_lim™
 = 
lim™
;

869 
	}
}

871 
Env
* 
	gEnv
::
	$DeçuÉ
() {

872 
PosixDeçuÉEnv
 
’v_cÚš”
;

873  
’v_cÚš”
.
	`’v
();

874 
	}
}

	@util/env_posix_test.cc

5 
	~"Ëv–db/’v.h
"

6 
	~"pÜt/pÜt.h
"

7 
	~"ut/’v_posix_‹¡_h–³r.h
"

8 
	~"ut/‹¡h¬Ãss.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 cÚ¡ 
	gkR—dOÆyFeLim™
 = 4;

13 cÚ¡ 
	gkMM­Lim™
 = 4;

15 şas 
	cEnvPosixTe¡
 {

16 
	gpublic
:

17 
S‘FeLim™s
(
»ad_Úly_fe_lim™
, 
mm­_lim™
) {

18 
	gEnvPosixTe¡H–³r
::
S‘R—dOÆyFDLim™
(
»ad_Úly_fe_lim™
);

19 
	gEnvPosixTe¡H–³r
::
S‘R—dOÆyMM­Lim™
(
mm­_lim™
);

22 
EnvPosixTe¡
(è: 
’v_
(
Env
::
DeçuÉ
()) {}

24 
Env
* 
’v_
;

27 
	$TEST
(
EnvPosixTe¡
, 
Te¡O³nOnR—d
) {

29 
¡d
::
¡ršg
 
‹¡_dœ
;

30 
	`ASSERT_OK
(
’v_
->
	`G‘Te¡DœeùÜy
(&
‹¡_dœ
));

31 
¡d
::
¡ršg
 
‹¡_fe
 = 
‹¡_dœ
 + "/open_on_read.txt";

33 
FILE
* 
f
 = 
	`fİ’
(
‹¡_fe
.
	`c_¡r
(), "w");

34 
	`ASSERT_TRUE
(
f
 !ğ
nuÎ±r
);

35 cÚ¡ 
kFeD©a
[] = "abcdefghijklmnopqrstuvwxyz";

36 
	`åuts
(
kFeD©a
, 
f
);

37 
	`fşo£
(
f
);

41 cÚ¡ 
kNumFes
 = 
kR—dOÆyFeLim™
 + 
kMM­Lim™
 + 5;

42 
Ëv–db
::
RªdomAcûssFe
* 
fes
[
kNumFes
] = {0};

43 
i
 = 0; i < 
kNumFes
; i++) {

44 
	`ASSERT_OK
(
’v_
->
	`NewRªdomAcûssFe
(
‹¡_fe
, &
fes
[
i
]));

46 
sü©ch
;

47 
Sliû
 
»ad_»suÉ
;

48 
i
 = 0; i < 
kNumFes
; i++) {

49 
	`ASSERT_OK
(
fes
[
i
]->
	`R—d
(i, 1, &
»ad_»suÉ
, &
sü©ch
));

50 
	`ASSERT_EQ
(
kFeD©a
[
i
], 
»ad_»suÉ
[0]);

52 
i
 = 0; i < 
kNumFes
; i++) {

53 
d–‘e
 
fes
[
i
];

55 
	`ASSERT_OK
(
’v_
->
	`D–‘eFe
(
‹¡_fe
));

56 
	}
}

60 
	$maš
(
¬gc
, ** 
¬gv
) {

62 
Ëv–db
::
EnvPosixTe¡
::
	`S‘FeLim™s
Öev–db::
kR—dOÆyFeLim™
,

63 
Ëv–db
::
kMM­Lim™
);

64  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
();

65 
	}
}

	@util/env_posix_test_helper.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_ENV_POSIX_TEST_HELPER_H_


6 
	#STORAGE_LEVELDB_UTIL_ENV_POSIX_TEST_HELPER_H_


	)

8 
Çme¥aû
 
	gËv–db
 {

10 
şass
 
	gEnvPosixTe¡
;

13 şas 
	cEnvPosixTe¡H–³r
 {

14 
	g´iv©e
:

15 
ä›nd
 
şass
 
EnvPosixTe¡
;

19 
S‘R—dOÆyFDLim™
(
lim™
);

23 
S‘R—dOÆyMM­Lim™
(
lim™
);

	@util/env_test.cc

5 
	~"Ëv–db/’v.h
"

7 
	~<®gÜ™hm
>

8 
	~<©omic
>

10 
	~"pÜt/pÜt.h
"

11 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

12 
	~"ut/mu‹xlock.h
"

13 
	~"ut/‹¡h¬Ãss.h
"

14 
	~"ut/‹¡ut.h
"

16 
Çme¥aû
 
	gËv–db
 {

18 cÚ¡ 
	gkD–ayMiüos
 = 100000;

20 şas 
	cEnvTe¡
 {

21 
	gpublic
:

22 
EnvTe¡
(è: 
’v_
(
Env
::
DeçuÉ
()) {}

24 
Env
* 
’v_
;

27 
	gÇme¥aû
 {

29 
S‘AtomicBoŞ
(* 
©omic_boŞ_±r
) {

30 
	g¡d
::
©omic
<
boŞ
>* 
©omic_boŞ
 =

31 
»š‹½»t_ÿ¡
<
¡d
::
©omic
<
boŞ
>*>(
©omic_boŞ_±r
);

32 
	g©omic_boŞ
->
¡Üe
(
Œue
, 
¡d
::
memÜy_Üd”_»Ïxed
);

37 
	$TEST
(
EnvTe¡
, 
R—dWr™e
) {

38 
Rªdom
 
	`ºd
(
‹¡
::
	`RªdomS“d
());

41 
¡d
::
¡ršg
 
‹¡_dœ
;

42 
	`ASSERT_OK
(
’v_
->
	`G‘Te¡DœeùÜy
(&
‹¡_dœ
));

43 
¡d
::
¡ršg
 
‹¡_fe_Çme
 = 
‹¡_dœ
 + "/open_on_read.txt";

44 
Wr™abËFe
* 
wr™abË_fe
;

45 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
(
‹¡_fe_Çme
, &
wr™abË_fe
));

48 cÚ¡ 
size_t
 
kD©aSize
 = 10 * 1048576;

49 
¡d
::
¡ršg
 
d©a
;

50 
d©a
.
	`size
(è< 
kD©aSize
) {

51 
Ën
 = 
ºd
.
	`Skewed
(18);

52 
¡d
::
¡ršg
 
r
;

53 
‹¡
::
	`RªdomSŒšg
(&
ºd
, 
Ën
, &
r
);

54 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
(
r
));

55 
d©a
 +ğ
r
;

56 ià(
ºd
.
	`OÃIn
(10)) {

57 
	`ASSERT_OK
(
wr™abË_fe
->
	`Flush
());

60 
	`ASSERT_OK
(
wr™abË_fe
->
	`Sync
());

61 
	`ASSERT_OK
(
wr™abË_fe
->
	`Clo£
());

62 
d–‘e
 
wr™abË_fe
;

65 
Sequ’tŸlFe
* 
£qu’tŸl_fe
;

66 
	`ASSERT_OK
(
’v_
->
	`NewSequ’tŸlFe
(
‹¡_fe_Çme
, &
£qu’tŸl_fe
));

67 
¡d
::
¡ršg
 
»ad_»suÉ
;

68 
¡d
::
¡ršg
 
sü©ch
;

69 
»ad_»suÉ
.
	`size
(è< 
d©a
.size()) {

70 
Ën
 = 
¡d
::
mš
<>(
ºd
.
	`Skewed
(18), 
d©a
.
	`size
(è- 
»ad_»suÉ
.size());

71 
sü©ch
.
	`»size
(
¡d
::
	`max
(
Ën
, 1));

72 
Sliû
 
»ad
;

73 
	`ASSERT_OK
(
£qu’tŸl_fe
->
	`R—d
(
Ën
, &
»ad
, &
sü©ch
[0]));

74 ià(
Ën
 > 0) {

75 
	`ASSERT_GT
(
»ad
.
	`size
(), 0);

77 
	`ASSERT_LE
(
»ad
.
	`size
(), 
Ën
);

78 
»ad_»suÉ
.
	`­³nd
(
»ad
.
	`d©a
(),„—d.
	`size
());

80 
	`ASSERT_EQ
(
»ad_»suÉ
, 
d©a
);

81 
d–‘e
 
£qu’tŸl_fe
;

82 
	}
}

84 
	$TEST
(
EnvTe¡
, 
RunImmedŸ‹ly
) {

85 
¡d
::
©omic
<
boŞ
> 
	`ÿÎed
(
çl£
);

86 
’v_
->
	`ScheduË
(&
S‘AtomicBoŞ
, &
ÿÎed
);

87 
’v_
->
	`SË•FÜMiüo£cÚds
(
kD–ayMiüos
);

88 
	`ASSERT_TRUE
(
ÿÎed
.
	`lßd
(
¡d
::
memÜy_Üd”_»Ïxed
));

89 
	}
}

91 
	$TEST
(
EnvTe¡
, 
RunMªy
) {

92 
¡d
::
©omic
<> 
	`Ï¡_id
(0);

94 
	sC®lback
 {

95 
¡d
::
©omic
<>* cÚ¡ 
Ï¡_id_±r_
;

96 cÚ¡ 
id_
;

98 
	`C®lback
(
¡d
::
©omic
<>* 
Ï¡_id_±r
, 
id
)

99 : 
	`Ï¡_id_±r_
(
Ï¡_id_±r
), 
	`id_
(
id
) {}

101 
	`Run
(* 
¬g
) {

102 
C®lback
* 
ÿÎback
 = 
»š‹½»t_ÿ¡
<C®lback*>(
¬g
);

103 
cu¼’t_id
 = 
ÿÎback
->
Ï¡_id_±r_
->
	`lßd
(
¡d
::
memÜy_Üd”_»Ïxed
);

104 
	`ASSERT_EQ
(
ÿÎback
->
id_
 - 1, 
cu¼’t_id
);

105 
ÿÎback
->
Ï¡_id_±r_
->
	`¡Üe
(ÿÎback->
id_
, 
¡d
::
memÜy_Üd”_»Ïxed
);

109 
C®lback
 
	`ÿÎback1
(&
Ï¡_id
, 1);

110 
C®lback
 
	`ÿÎback2
(&
Ï¡_id
, 2);

111 
C®lback
 
	`ÿÎback3
(&
Ï¡_id
, 3);

112 
C®lback
 
	`ÿÎback4
(&
Ï¡_id
, 4);

113 
’v_
->
	`ScheduË
(&
C®lback
::
Run
, &
ÿÎback1
);

114 
’v_
->
	`ScheduË
(&
C®lback
::
Run
, &
ÿÎback2
);

115 
’v_
->
	`ScheduË
(&
C®lback
::
Run
, &
ÿÎback3
);

116 
’v_
->
	`ScheduË
(&
C®lback
::
Run
, &
ÿÎback4
);

118 
’v_
->
	`SË•FÜMiüo£cÚds
(
kD–ayMiüos
);

119 
	`ASSERT_EQ
(4, 
Ï¡_id
.
	`lßd
(
¡d
::
memÜy_Üd”_»Ïxed
));

120 
	}
}

122 
	sS‹
 {

123 
	gpÜt
::
Mu‹x
 
mu
;

124 
v®
 
GUARDED_BY
(
mu
);

125 
num_ruÂšg
 
GUARDED_BY
(
mu
);

127 
S‹
(
v®
, 
num_ruÂšg
) : val(val),‚um_running(num_running) {}

130 
	$Th»adBody
(* 
¬g
) {

131 
S‹
* 
s
 = 
»š‹½»t_ÿ¡
<S‹*>(
¬g
);

132 
s
->
mu
.
	`Lock
();

133 
s
->
v®
 += 1;

134 
s
->
num_ruÂšg
 -= 1;

135 
s
->
mu
.
	`UÆock
();

136 
	}
}

138 
	$TEST
(
EnvTe¡
, 
S¹Th»ad
) {

139 
S‹
 
	`¡©e
(0, 3);

140 
i
 = 0; i < 3; i++) {

141 
’v_
->
	`S¹Th»ad
(&
Th»adBody
, &
¡©e
);

143 
Œue
) {

144 
¡©e
.
mu
.
	`Lock
();

145 
num
 = 
¡©e
.
num_ruÂšg
;

146 
¡©e
.
mu
.
	`UÆock
();

147 ià(
num
 == 0) {

150 
’v_
->
	`SË•FÜMiüo£cÚds
(
kD–ayMiüos
);

153 
Mu‹xLock
 
	`l
(&
¡©e
.
mu
);

154 
	`ASSERT_EQ
(
¡©e
.
v®
, 3);

155 
	}
}

157 
	$TEST
(
EnvTe¡
, 
Te¡O³nNÚExi¡’tFe
) {

159 
¡d
::
¡ršg
 
‹¡_dœ
;

160 
	`ASSERT_OK
(
’v_
->
	`G‘Te¡DœeùÜy
(&
‹¡_dœ
));

162 
¡d
::
¡ršg
 
nÚ_exi¡’t_fe
 = 
‹¡_dœ
 + "/non_existent_file";

163 
	`ASSERT_TRUE
(!
’v_
->
	`FeExi¡s
(
nÚ_exi¡’t_fe
));

165 
RªdomAcûssFe
* 
¿ndom_acûss_fe
;

166 
Stus
 
¡©us
 =

167 
’v_
->
	`NewRªdomAcûssFe
(
nÚ_exi¡’t_fe
, &
¿ndom_acûss_fe
);

168 
	`ASSERT_TRUE
(
¡©us
.
	`IsNÙFound
());

170 
Sequ’tŸlFe
* 
£qu’tŸl_fe
;

171 
¡©us
 = 
’v_
->
	`NewSequ’tŸlFe
(
nÚ_exi¡’t_fe
, &
£qu’tŸl_fe
);

172 
	`ASSERT_TRUE
(
¡©us
.
	`IsNÙFound
());

173 
	}
}

175 
	$TEST
(
EnvTe¡
, 
Reİ’Wr™abËFe
) {

176 
¡d
::
¡ršg
 
‹¡_dœ
;

177 
	`ASSERT_OK
(
’v_
->
	`G‘Te¡DœeùÜy
(&
‹¡_dœ
));

178 
¡d
::
¡ršg
 
‹¡_fe_Çme
 = 
‹¡_dœ
 + "/reopen_writable_file.txt";

179 
’v_
->
	`D–‘eFe
(
‹¡_fe_Çme
);

181 
Wr™abËFe
* 
wr™abË_fe
;

182 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
(
‹¡_fe_Çme
, &
wr™abË_fe
));

183 
¡d
::
¡ršg
 
	`d©a
("hello world!");

184 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
(
d©a
));

185 
	`ASSERT_OK
(
wr™abË_fe
->
	`Clo£
());

186 
d–‘e
 
wr™abË_fe
;

188 
	`ASSERT_OK
(
’v_
->
	`NewWr™abËFe
(
‹¡_fe_Çme
, &
wr™abË_fe
));

189 
d©a
 = "42";

190 
	`ASSERT_OK
(
wr™abË_fe
->
	`Aµ’d
(
d©a
));

191 
	`ASSERT_OK
(
wr™abË_fe
->
	`Clo£
());

192 
d–‘e
 
wr™abË_fe
;

194 
	`ASSERT_OK
(
	`R—dFeToSŒšg
(
’v_
, 
‹¡_fe_Çme
, &
d©a
));

195 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
("42"), 
d©a
);

196 
’v_
->
	`D–‘eFe
(
‹¡_fe_Çme
);

197 
	}
}

199 
	$TEST
(
EnvTe¡
, 
Reİ’Aµ’dabËFe
) {

200 
¡d
::
¡ršg
 
‹¡_dœ
;

201 
	`ASSERT_OK
(
’v_
->
	`G‘Te¡DœeùÜy
(&
‹¡_dœ
));

202 
¡d
::
¡ršg
 
‹¡_fe_Çme
 = 
‹¡_dœ
 + "/reopen_appendable_file.txt";

203 
’v_
->
	`D–‘eFe
(
‹¡_fe_Çme
);

205 
Wr™abËFe
* 
­³ndabË_fe
;

206 
	`ASSERT_OK
(
’v_
->
	`NewAµ’dabËFe
(
‹¡_fe_Çme
, &
­³ndabË_fe
));

207 
¡d
::
¡ršg
 
	`d©a
("hello world!");

208 
	`ASSERT_OK
(
­³ndabË_fe
->
	`Aµ’d
(
d©a
));

209 
	`ASSERT_OK
(
­³ndabË_fe
->
	`Clo£
());

210 
d–‘e
 
­³ndabË_fe
;

212 
	`ASSERT_OK
(
’v_
->
	`NewAµ’dabËFe
(
‹¡_fe_Çme
, &
­³ndabË_fe
));

213 
d©a
 = "42";

214 
	`ASSERT_OK
(
­³ndabË_fe
->
	`Aµ’d
(
d©a
));

215 
	`ASSERT_OK
(
­³ndabË_fe
->
	`Clo£
());

216 
d–‘e
 
­³ndabË_fe
;

218 
	`ASSERT_OK
(
	`R—dFeToSŒšg
(
’v_
, 
‹¡_fe_Çme
, &
d©a
));

219 
	`ASSERT_EQ
(
¡d
::
	`¡ršg
("h–lØwÜld!42"), 
d©a
);

220 
’v_
->
	`D–‘eFe
(
‹¡_fe_Çme
);

221 
	}
}

225 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/env_windows.cc

7 #iâdeà
NOMINMAX


8 
	#NOMINMAX


	)

10 
	~<wšdows.h
>

12 
	~<®gÜ™hm
>

13 
	~<©omic
>

14 
	~<chrÚo
>

15 
	~<cÚd™iÚ_v¬ŸbË
>

16 
	~<deque
>

17 
	~<memÜy
>

18 
	~<mu‹x
>

19 
	~<s¡»am
>

20 
	~<¡ršg
>

21 
	~<veùÜ
>

23 
	~"Ëv–db/’v.h
"

24 
	~"Ëv–db/¦iû.h
"

25 
	~"pÜt/pÜt.h
"

26 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

27 
	~"ut/’v_wšdows_‹¡_h–³r.h
"

28 
	~"ut/loggšg.h
"

29 
	~"ut/mu‹xlock.h
"

30 
	~"ut/wšdows_logg”.h
"

32 #ià
defšed
(
D–‘eFe
)

33 #undeà
D–‘eFe


36 
Çme¥aû
 
	gËv–db
 {

38 
	gÇme¥aû
 {

40 
cÚ¡ex´
 cÚ¡ 
size_t
 
	gkWr™abËFeBufãrSize
 = 65536;

43 
cÚ¡ex´
 
	gkDeçuÉMm­Lim™
 = (*) >= 8 ? 1000 : 0;

46 
	gg_mm­_lim™
 = 
kDeçuÉMm­Lim™
;

48 
	g¡d
::
¡ršg
 
G‘WšdowsE¼ÜMes§ge
(
DWORD
 
”rÜ_code
) {

49 
¡d
::
¡ršg
 
mes§ge
;

50 * 
	g”rÜ_‹xt
 = 
nuÎ±r
;

52 
size_t
 
	g”rÜ_‹xt_size
 = ::
FÜm©Mes§geA
(

53 
FORMAT_MESSAGE_FROM_SYSTEM
 | 
FORMAT_MESSAGE_ALLOCATE_BUFFER
 |

54 
FORMAT_MESSAGE_IGNORE_INSERTS
,

55 
nuÎ±r
, 
”rÜ_code
, 
MAKELANGID
(
LANG_NEUTRAL
, 
SUBLANG_DEFAULT
),

56 
»š‹½»t_ÿ¡
<*>(&
”rÜ_‹xt
), 0, 
nuÎ±r
);

57 ià(!
	g”rÜ_‹xt
) {

58  
	gmes§ge
;

60 
	gmes§ge
.
assign
(
”rÜ_‹xt
, 
”rÜ_‹xt_size
);

61 ::
LoÿlF»e
(
”rÜ_‹xt
);

62  
	gmes§ge
;

65 
Stus
 
WšdowsE¼Ü
(cÚ¡ 
¡d
::
¡ršg
& 
cÚ‹xt
, 
DWORD
 
”rÜ_code
) {

66 ià(
	g”rÜ_code
 =ğ
ERROR_FILE_NOT_FOUND
 || 
”rÜ_code
 =ğ
ERROR_PATH_NOT_FOUND
)

67  
Stus
::
NÙFound
(
cÚ‹xt
, 
G‘WšdowsE¼ÜMes§ge
(
”rÜ_code
));

68  
	gStus
::
IOE¼Ü
(
cÚ‹xt
, 
G‘WšdowsE¼ÜMes§ge
(
”rÜ_code
));

71 şas 
	cScİedHªdË
 {

72 
	gpublic
:

73 
ScİedHªdË
(
HANDLE
 
hªdË
è: 
hªdË_
(handle) {}

74 
ScİedHªdË
(ScİedHªdË&& 
Ùh”
è
nÛxû±
 : 
hªdË_
(Ùh”.
R–—£
()) {}

75 ~
ScİedHªdË
(è{ 
Clo£
(); }

77 
	gScİedHªdË
& 
	gİ”©Ü
=(
ScİedHªdË
&& 
rhs
è
nÛxû±
 {

78 ià(
this
 !ğ&
rhs
è
hªdË_
 =„hs.
R–—£
();

79  *
	gthis
;

82 
boŞ
 
Clo£
() {

83 ià(!
is_v®id
()) {

84  
	gŒue
;

86 
HANDLE
 
	gh
 = 
hªdË_
;

87 
	ghªdË_
 = 
INVALID_HANDLE_VALUE
;

88  ::
Clo£HªdË
(
h
);

91 
boŞ
 
is_v®id
() const {

92  
	ghªdË_
 !ğ
INVALID_HANDLE_VALUE
 && 
hªdË_
 !ğ
nuÎ±r
;

95 
HANDLE
 
g‘
(ècÚ¡ {  
	ghªdË_
; }

97 
HANDLE
 
R–—£
() {

98 
HANDLE
 
	gh
 = 
hªdË_
;

99 
	ghªdË_
 = 
INVALID_HANDLE_VALUE
;

100  
	gh
;

103 
	g´iv©e
:

104 
HANDLE
 
hªdË_
;

111 şas 
	cLim™”
 {

112 
	gpublic
:

114 
Lim™”
(
max_acquœes
è: 
acquœes_®lowed_
(max_acquires) {}

116 
Lim™”
(cÚ¡ Lim™”&èğ
d–‘e
;

117 
Lim™”
 
	gİ”©Ü
=(cÚ¡ Lim™”&èğ
d–‘e
;

121 
boŞ
 
Acquœe
() {

122 
	gŞd_acquœes_®lowed
 =

123 
acquœes_®lowed_
.
ãtch_sub
(1, 
¡d
::
memÜy_Üd”_»Ïxed
);

125 ià(
	gŞd_acquœes_®lowed
 > 0è 
	gŒue
;

127 
	gacquœes_®lowed_
.
ãtch_add
(1, 
¡d
::
memÜy_Üd”_»Ïxed
);

128  
	gçl£
;

133 
R–—£
(è{ 
	gacquœes_®lowed_
.
ãtch_add
(1, 
¡d
::
memÜy_Üd”_»Ïxed
); }

135 
	g´iv©e
:

140 
¡d
::
©omic
<> 
acquœes_®lowed_
;

143 şas 
	cWšdowsSequ’tŸlFe
 : 
public
 
Sequ’tŸlFe
 {

144 
public
:

145 
WšdowsSequ’tŸlFe
(
¡d
::
¡ršg
 
âame
, 
ScİedHªdË
 
fe
)

146 : 
f’ame_
(
âame
), 
fe_
(
¡d
::
move
(
fe
)) {}

147 ~
WšdowsSequ’tŸlFe
(è
ov”ride
 {}

149 
Stus
 
R—d
(
size_t
 
n
, 
Sliû
* 
»suÉ
, * 
sü©ch
è
	gov”ride
 {

150 
Stus
 
	gs
;

151 
DWORD
 
	gby‹s_»ad
;

155 
as£¹
(
n
 <ğ
¡d
::
num”ic_lim™s
<
DWORD
>::
max
());

156 ià(!::
R—dFe
(
fe_
.
g‘
(), 
sü©ch
, 
¡©ic_ÿ¡
<
DWORD
>(
n
), &
by‹s_»ad
,

157 
nuÎ±r
)) {

158 
	gs
 = 
WšdowsE¼Ü
(
f’ame_
, ::
G‘La¡E¼Ü
());

160 *
	g»suÉ
 = 
Sliû
(
sü©ch
, 
by‹s_»ad
);

162  
	gs
;

165 
Stus
 
Sk
(
ušt64_t
 
n
è
	gov”ride
 {

166 
LARGE_INTEGER
 
	gdi¡ªû
;

167 
	gdi¡ªû
.
	gQuadP¬t
 = 
n
;

168 ià(!::
S‘FePoš‹rEx
(
fe_
.
g‘
(), 
di¡ªû
, 
nuÎ±r
, 
FILE_CURRENT
)) {

169  
WšdowsE¼Ü
(
f’ame_
, ::
G‘La¡E¼Ü
());

171  
	gStus
::
OK
();

174 
	g´iv©e
:

175 
¡d
::
¡ršg
 
f’ame_
;

176 
ScİedHªdË
 
	gfe_
;

179 şas 
	cWšdowsRªdomAcûssFe
 : 
public
 
RªdomAcûssFe
 {

180 
public
:

181 
WšdowsRªdomAcûssFe
(
¡d
::
¡ršg
 
âame
, 
ScİedHªdË
 
hªdË
)

182 : 
f’ame_
(
âame
), 
hªdË_
(
¡d
::
move
(
hªdË
)) {}

184 ~
WšdowsRªdomAcûssFe
(è
ov”ride
 = ;

186 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

187 * 
sü©ch
ècÚ¡ 
	gov”ride
 {

188 
DWORD
 
	gby‹s_»ad
 = 0;

189 
OVERLAPPED
 
	gov”Ïµed
 = {0};

191 
	gov”Ïµed
.
	gOff£tHigh
 = 
¡©ic_ÿ¡
<
DWORD
>(
off£t
 >> 32);

192 
	gov”Ïµed
.
	gOff£t
 = 
¡©ic_ÿ¡
<
DWORD
>(
off£t
);

193 ià(!::
R—dFe
(
hªdË_
.
g‘
(), 
sü©ch
, 
¡©ic_ÿ¡
<
DWORD
>(
n
), &
by‹s_»ad
,

194 &
ov”Ïµed
)) {

195 
DWORD
 
	g”rÜ_code
 = ::
G‘La¡E¼Ü
();

196 ià(
	g”rÜ_code
 !ğ
ERROR_HANDLE_EOF
) {

197 *
»suÉ
 = 
Sliû
(
sü©ch
, 0);

198  
	gStus
::
IOE¼Ü
(
f’ame_
, 
G‘WšdowsE¼ÜMes§ge
(
”rÜ_code
));

202 *
	g»suÉ
 = 
Sliû
(
sü©ch
, 
by‹s_»ad
);

203  
	gStus
::
OK
();

206 
	g´iv©e
:

207 
¡d
::
¡ršg
 
f’ame_
;

208 
ScİedHªdË
 
	ghªdË_
;

211 şas 
	cWšdowsMm­R—dabËFe
 : 
public
 
RªdomAcûssFe
 {

212 
public
:

214 
WšdowsMm­R—dabËFe
(
¡d
::
¡ršg
 
âame
, * 
ba£
, 
size_t
 
Ëngth
,

215 
Lim™”
* 
lim™”
)

216 : 
f’ame_
(
¡d
::
move
(
âame
)),

217 
mm­³d_»giÚ_
(
ba£
),

218 
Ëngth_
(
Ëngth
),

219 
lim™”_
(
lim™”
) {}

221 ~
WšdowsMm­R—dabËFe
(è
	gov”ride
 {

222 ::
Unm­V›wOfFe
(
mm­³d_»giÚ_
);

223 
	glim™”_
->
R–—£
();

226 
Stus
 
R—d
(
ušt64_t
 
off£t
, 
size_t
 
n
, 
Sliû
* 
»suÉ
,

227 * 
sü©ch
ècÚ¡ 
	gov”ride
 {

228 
Stus
 
	gs
;

229 ià(
	goff£t
 + 
	gn
 > 
	gËngth_
) {

230 *
	g»suÉ
 = 
Sliû
();

231 
	gs
 = 
WšdowsE¼Ü
(
f’ame_
, 
ERROR_INVALID_PARAMETER
);

233 *
	g»suÉ
 = 
Sliû
(
»š‹½»t_ÿ¡
<*>(
mm­³d_»giÚ_
è+ 
off£t
, 
n
);

235  
	gs
;

238 
	g´iv©e
:

239 
¡d
::
¡ršg
 
f’ame_
;

240 * 
	gmm­³d_»giÚ_
;

241 
size_t
 
	gËngth_
;

242 
Lim™”
* 
	glim™”_
;

245 şas 
	cWšdowsWr™abËFe
 : 
public
 
Wr™abËFe
 {

246 
public
:

247 
WšdowsWr™abËFe
(
¡d
::
¡ršg
 
âame
, 
ScİedHªdË
 
hªdË
)

248 : 
f’ame_
(
¡d
::
move
(
âame
)), 
hªdË_
(¡d::move(
hªdË
)), 
pos_
(0) {}

250 ~
WšdowsWr™abËFe
(è
	gov”ride
 = ;

252 
Stus
 
Aµ’d
(cÚ¡ 
Sliû
& 
d©a
è
	gov”ride
 {

253 
size_t
 
	gn
 = 
d©a
.
size
();

254 cÚ¡ * 
	gp
 = 
d©a
.data();

257 
size_t
 
	gcİy
 = 
¡d
::
mš
(
n
, 
kWr™abËFeBufãrSize
 - 
pos_
);

258 
memıy
(
buf_
 + 
pos_
, 
p
, 
cİy
);

259 
	gp
 +ğ
cİy
;

260 
	gn
 -ğ
cİy
;

261 
	gpos_
 +ğ
cİy
;

262 ià(
	gn
 == 0) {

263  
Stus
::
OK
();

267 
Stus
 
	gs
 = 
FlushBufã»d
();

268 ià(!
	gs
.
ok
()) {

269  
	gs
;

273 ià(
	gn
 < 
	gkWr™abËFeBufãrSize
) {

274 
memıy
(
buf_
, 
p
, 
n
);

275 
	gpos_
 = 
n
;

276  
	gStus
::
OK
();

278  
Wr™eRaw
(
p
, 
n
);

281 
Stus
 
Clo£
(è
	gov”ride
 {

282 
Stus
 
	g»suÉ
 = 
FlushBufã»d
();

283 ià(!
	ghªdË_
.
Clo£
(è&& 
	g»suÉ
.
ok
()) {

284 
	g»suÉ
 = 
WšdowsE¼Ü
(
f’ame_
, ::
G‘La¡E¼Ü
());

286  
	g»suÉ
;

289 
Stus
 
Flush
(è
	gov”ride
 {  
FlushBufã»d
(); }

291 
Stus
 
Sync
(è
	gov”ride
 {

294  
FlushBufã»d
();

297 
	g´iv©e
:

298 
Stus
 
FlushBufã»d
() {

299 
Stus
 
s
 = 
Wr™eRaw
(
buf_
, 
pos_
);

300 
	gpos_
 = 0;

301  
	gs
;

304 
Stus
 
Wr™eRaw
(cÚ¡ * 
p
, 
size_t
 
n
) {

305 
DWORD
 
	gby‹s_wr™‹n
;

306 ià(!::
Wr™eFe
(
hªdË_
.
g‘
(), 
p
, 
¡©ic_ÿ¡
<
DWORD
>(
n
), &
by‹s_wr™‹n
,

307 
nuÎ±r
)) {

308  
	gStus
::
IOE¼Ü
(
f’ame_
,

309 
G‘WšdowsE¼ÜMes§ge
(::
G‘La¡E¼Ü
()));

311  
	gStus
::
OK
();

315 cÚ¡ 
	g¡d
::
¡ršg
 
f’ame_
;

316 
ScİedHªdË
 
	ghªdË_
;

317 
	gbuf_
[
kWr™abËFeBufãrSize
];

318 
size_t
 
	gpos_
;

324 
boŞ
 
LockOrUÆock
(
HANDLE
 
hªdË
, boŞ 
lock
) {

325 ià(
	glock
) {

326  ::
LockFe
(
hªdË
,

328  
MAXDWORD
,

329  
MAXDWORD
);

331  ::
UÆockFe
(
hªdË
,

333  
MAXDWORD
,

334  
MAXDWORD
);

338 şas 
	cWšdowsFeLock
 : 
public
 
FeLock
 {

339 
public
:

340 
WšdowsFeLock
(
ScİedHªdË
 
hªdË
, 
¡d
::
¡ršg
 
Çme
)

341 : 
hªdË_
(
¡d
::
move
(
hªdË
)), 
Çme_
(¡d::move(
Çme
)) {}

343 
ScİedHªdË
& 
hªdË
(è{  
hªdË_
; }

344 cÚ¡ 
	g¡d
::
¡ršg
& 
Çme
(ècÚ¡ {  
Çme_
; }

346 
	g´iv©e
:

347 
ScİedHªdË
 
hªdË_
;

348 
	g¡d
::
¡ršg
 
Çme_
;

351 şas 
	cWšdowsEnv
 : 
public
 
Env
 {

352 
public
:

353 
WšdowsEnv
();

354 ~
WšdowsEnv
(è
	gov”ride
 {

355 
	gmsg
[] = "Destroying Env::Default()\n";

356 
fwr™e
(
msg
, 1, (msg), 
¡d”r
);

357 
abÜt
();

360 
Stus
 
NewSequ’tŸlFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

361 
Sequ’tŸlFe
** 
»suÉ
è
	gov”ride
 {

362 *
	g»suÉ
 = 
nuÎ±r
;

363 
DWORD
 
	gdesœed_acûss
 = 
GENERIC_READ
;

364 
DWORD
 
	gsh¬e_mode
 = 
FILE_SHARE_READ
;

365 
ScİedHªdË
 
	ghªdË
 =

366 ::
C»©eFeA
(
âame
.
c_¡r
(), 
desœed_acûss
, 
sh¬e_mode
, 
nuÎ±r
,

367 
OPEN_EXISTING
, 
FILE_ATTRIBUTE_NORMAL
, 
nuÎ±r
);

368 ià(!
	ghªdË
.
is_v®id
()) {

369  
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

371 *
	g»suÉ
 = 
Ãw
 
WšdowsSequ’tŸlFe
(
âame
, 
¡d
::
move
(
hªdË
));

372  
	gStus
::
OK
();

375 
Stus
 
NewRªdomAcûssFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

376 
RªdomAcûssFe
** 
»suÉ
è
	gov”ride
 {

377 *
	g»suÉ
 = 
nuÎ±r
;

378 
DWORD
 
	gdesœed_acûss
 = 
GENERIC_READ
;

379 
DWORD
 
	gsh¬e_mode
 = 
FILE_SHARE_READ
;

380 
DWORD
 
	gfe_æags
 = 
FILE_ATTRIBUTE_READONLY
;

382 
ScİedHªdË
 
	ghªdË
 =

383 ::
C»©eFeA
(
âame
.
c_¡r
(), 
desœed_acûss
, 
sh¬e_mode
, 
nuÎ±r
,

384 
OPEN_EXISTING
, 
fe_æags
, 
nuÎ±r
);

385 ià(!
	ghªdË
.
is_v®id
()) {

386  
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

388 ià(!
	gmm­_lim™”_
.
Acquœe
()) {

389 *
	g»suÉ
 = 
Ãw
 
WšdowsRªdomAcûssFe
(
âame
, 
¡d
::
move
(
hªdË
));

390  
	gStus
::
OK
();

393 
LARGE_INTEGER
 
	gfe_size
;

394 ià(!::
G‘FeSizeEx
(
hªdË
.
g‘
(), &
fe_size
)) {

395  
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

398 
ScİedHªdË
 
	gm­pšg
 =

399 ::
C»©eFeM­pšgA
(
hªdË
.
g‘
(),

400  
nuÎ±r
, 
PAGE_READONLY
,

402  0, 
nuÎ±r
);

403 ià(
	gm­pšg
.
is_v®id
()) {

404 * 
	gba£
 = 
M­V›wOfFe
(
m­pšg
.
g‘
(), 
FILE_MAP_READ
, 0, 0, 0);

405 ià(
	gba£
) {

406 *
	g»suÉ
 = 
Ãw
 
WšdowsMm­R—dabËFe
(

407 
âame
, 
ba£
, 
¡©ic_ÿ¡
<
size_t
>(
fe_size
.
QuadP¬t
),

408 &
mm­_lim™”_
);

409  
	gStus
::
OK
();

412 
Stus
 
	gs
 = 
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

414 ià(!
	gs
.
ok
()) {

415 
	gmm­_lim™”_
.
R–—£
();

417  
	gs
;

420 
Stus
 
NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

421 
Wr™abËFe
** 
»suÉ
è
	gov”ride
 {

422 
DWORD
 
	gdesœed_acûss
 = 
GENERIC_WRITE
;

423 
DWORD
 
	gsh¬e_mode
 = 0;

425 
ScİedHªdË
 
	ghªdË
 =

426 ::
C»©eFeA
(
âame
.
c_¡r
(), 
desœed_acûss
, 
sh¬e_mode
, 
nuÎ±r
,

427 
CREATE_ALWAYS
, 
FILE_ATTRIBUTE_NORMAL
, 
nuÎ±r
);

428 ià(!
	ghªdË
.
is_v®id
()) {

429 *
	g»suÉ
 = 
nuÎ±r
;

430  
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

433 *
	g»suÉ
 = 
Ãw
 
WšdowsWr™abËFe
(
âame
, 
¡d
::
move
(
hªdË
));

434  
	gStus
::
OK
();

437 
Stus
 
NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

438 
Wr™abËFe
** 
»suÉ
è
	gov”ride
 {

439 
ScİedHªdË
 
	ghªdË
 =

440 ::
C»©eFeA
(
âame
.
c_¡r
(), 
FILE_APPEND_DATA
, 0, 
nuÎ±r
, 
OPEN_ALWAYS
,

441 
FILE_ATTRIBUTE_NORMAL
, 
nuÎ±r
);

442 ià(!
	ghªdË
.
is_v®id
()) {

443 *
	g»suÉ
 = 
nuÎ±r
;

444  
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

447 *
	g»suÉ
 = 
Ãw
 
WšdowsWr™abËFe
(
âame
, 
¡d
::
move
(
hªdË
));

448  
	gStus
::
OK
();

451 
boŞ
 
FeExi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
âame
è
ov”ride
 {

452  
G‘FeA‰ribu‹sA
(
âame
.
c_¡r
()è!ğ
INVALID_FILE_ATTRIBUTES
;

455 
Stus
 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
dœ
,

456 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
»suÉ
è
ov”ride
 {

457 cÚ¡ 
¡d
::
¡ršg
 
fšd_·‰”n
 = 
dœ
 + "\\*";

458 
WIN32_FIND_DATAA
 
	gfšd_d©a
;

459 
HANDLE
 
	gdœ_hªdË
 = ::
FšdFœ¡FeA
(
fšd_·‰”n
.
c_¡r
(), &
fšd_d©a
);

460 ià(
	gdœ_hªdË
 =ğ
INVALID_HANDLE_VALUE
) {

461 
DWORD
 
Ï¡_”rÜ
 = ::
G‘La¡E¼Ü
();

462 ià(
	gÏ¡_”rÜ
 =ğ
ERROR_FILE_NOT_FOUND
) {

463  
Stus
::
OK
();

465  
WšdowsE¼Ü
(
dœ
, 
Ï¡_”rÜ
);

468 
	gba£_Çme
[
_MAX_FNAME
];

469 
	gext
[
_MAX_EXT
];

471 ià(!
_¥l™·th_s
(
fšd_d©a
.
cFeName
, 
nuÎ±r
, 0,‚uÎ±r, 0, 
ba£_Çme
,

472 
ARRAYSIZE
(
ba£_Çme
), 
ext
, ARRAYSIZE(ext))) {

473 
	g»suÉ
->
em¶aû_back
(
¡d
::
¡ršg
(
ba£_Çme
è+ 
ext
);

475 } ::
FšdNextFeA
(
dœ_hªdË
, &
fšd_d©a
));

476 
DWORD
 
	gÏ¡_”rÜ
 = ::
G‘La¡E¼Ü
();

477 ::
FšdClo£
(
dœ_hªdË
);

478 ià(
	gÏ¡_”rÜ
 !ğ
ERROR_NO_MORE_FILES
) {

479  
WšdowsE¼Ü
(
dœ
, 
Ï¡_”rÜ
);

481  
	gStus
::
OK
();

484 
Stus
 
D–‘eFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
è
ov”ride
 {

485 ià(!::
D–‘eFeA
(
âame
.
c_¡r
())) {

486  
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

488  
	gStus
::
OK
();

491 
Stus
 
C»©eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
Çme
è
ov”ride
 {

492 ià(!::
C»©eDœeùÜyA
(
Çme
.
c_¡r
(), 
nuÎ±r
)) {

493  
WšdowsE¼Ü
(
Çme
, ::
G‘La¡E¼Ü
());

495  
	gStus
::
OK
();

498 
Stus
 
D–‘eDœ
(cÚ¡ 
¡d
::
¡ršg
& 
Çme
è
ov”ride
 {

499 ià(!::
RemoveDœeùÜyA
(
Çme
.
c_¡r
())) {

500  
WšdowsE¼Ü
(
Çme
, ::
G‘La¡E¼Ü
());

502  
	gStus
::
OK
();

505 
Stus
 
G‘FeSize
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
ušt64_t
* 
size
è
	gov”ride
 {

506 
WIN32_FILE_ATTRIBUTE_DATA
 
	g©Œs
;

507 ià(!::
G‘FeA‰ribu‹sExA
(
âame
.
c_¡r
(), 
G‘FeExInfoSnd¬d
, &
©Œs
)) {

508  
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

510 
ULARGE_INTEGER
 
	gfe_size
;

511 
	gfe_size
.
	gHighP¬t
 = 
©Œs
.
nFeSizeHigh
;

512 
	gfe_size
.
	gLowP¬t
 = 
©Œs
.
nFeSizeLow
;

513 *
	gsize
 = 
fe_size
.
QuadP¬t
;

514  
	gStus
::
OK
();

517 
Stus
 
R’ameFe
(cÚ¡ 
¡d
::
¡ršg
& 
¤c
,

518 cÚ¡ 
¡d
::
¡ršg
& 
rg‘
è
ov”ride
 {

521 ià(::
MoveFeA
(
¤c
.
c_¡r
(), 
rg‘
.c_str())) {

522  
	gStus
::
OK
();

524 
DWORD
 
	gmove_”rÜ
 = ::
G‘La¡E¼Ü
();

530 ià(::
R•ÏûFeA
(
rg‘
.
c_¡r
(), 
¤c
.c_¡r(), 
nuÎ±r
,

531 
REPLACEFILE_IGNORE_MERGE_ERRORS
, 
nuÎ±r
,‚ullptr)) {

532  
	gStus
::
OK
();

534 
DWORD
 
	g»¶aû_”rÜ
 = ::
G‘La¡E¼Ü
();

538 ià(
	g»¶aû_”rÜ
 =ğ
ERROR_FILE_NOT_FOUND
 ||

539 
»¶aû_”rÜ
 =ğ
ERROR_PATH_NOT_FOUND
) {

540  
WšdowsE¼Ü
(
¤c
, 
move_”rÜ
);

542  
WšdowsE¼Ü
(
¤c
, 
»¶aû_”rÜ
);

546 
Stus
 
LockFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
, 
FeLock
** 
lock
è
	gov”ride
 {

547 *
	glock
 = 
nuÎ±r
;

548 
Stus
 
	g»suÉ
;

549 
ScİedHªdË
 
	ghªdË
 = ::
C»©eFeA
(

550 
âame
.
c_¡r
(), 
GENERIC_READ
 | 
GENERIC_WRITE
, 
FILE_SHARE_READ
,

551  
nuÎ±r
, 
OPEN_ALWAYS
, 
FILE_ATTRIBUTE_NORMAL
,

552 
nuÎ±r
);

553 ià(!
	ghªdË
.
is_v®id
()) {

554 
	g»suÉ
 = 
WšdowsE¼Ü
(
âame
, ::
G‘La¡E¼Ü
());

555 } ià(!
LockOrUÆock
(
hªdË
.
g‘
(), 
Œue
)) {

556 
	g»suÉ
 = 
WšdowsE¼Ü
("lock " + 
âame
, ::
G‘La¡E¼Ü
());

558 *
	glock
 = 
Ãw
 
WšdowsFeLock
(
¡d
::
move
(
hªdË
), std::move(
âame
));

560  
	g»suÉ
;

563 
Stus
 
UÆockFe
(
FeLock
* 
lock
è
	gov”ride
 {

564 
	g¡d
::
unique_±r
<
WšdowsFeLock
> 
my_lock
(

565 
»š‹½»t_ÿ¡
<
WšdowsFeLock
*>(
lock
));

566 
Stus
 
	g»suÉ
;

567 ià(!
LockOrUÆock
(
my_lock
->
hªdË
().
g‘
(), 
çl£
)) {

568 
	g»suÉ
 = 
WšdowsE¼Ü
("uÆock", ::
G‘La¡E¼Ü
());

570  
	g»suÉ
;

573 
ScheduË
((*
funùiÚ
)(*), * 
¬g
è
	gov”ride
;

575 
S¹Th»ad
((*
funùiÚ
)(* 
¬g
), *‡rgè
	gov”ride
 {

576 
	g¡d
::
th»ad
 
t
(
funùiÚ
, 
¬g
);

577 
	gt
.
d‘ach
();

580 
Stus
 
G‘Te¡DœeùÜy
(
¡d
::
¡ršg
* 
»suÉ
è
ov”ride
 {

581 cÚ¡ * 
’v
 = 
g‘’v
("TEST_TMPDIR");

582 ià(
	g’v
 &&ƒnv[0] != '\0') {

583 *
»suÉ
 = 
’v
;

584  
	gStus
::
OK
();

587 
	gtmp_·th
[
MAX_PATH
];

588 ià(!
G‘TempP©hA
(
ARRAYSIZE
(
tmp_·th
),mp_path)) {

589  
WšdowsE¼Ü
("G‘TempP©h", ::
G‘La¡E¼Ü
());

591 
	g¡d
::
¡ršg¡»am
 
ss
;

592 
	gss
 << 
	gtmp_·th
 << "Ëv–db‹¡-" << 
	g¡d
::
this_th»ad
::
g‘_id
();

593 *
	g»suÉ
 = 
ss
.
¡r
();

596 
C»©eDœ
(*
»suÉ
);

597  
	gStus
::
OK
();

600 
Stus
 
NewLogg”
(cÚ¡ 
¡d
::
¡ršg
& 
f’ame
, 
Logg”
** 
»suÉ
è
	gov”ride
 {

601 
	g¡d
::
FILE
* 
å
 = 
¡d
::
fİ’
(
f’ame
.
c_¡r
(), "w");

602 ià(
	gå
 =ğ
nuÎ±r
) {

603 *
»suÉ
 = 
nuÎ±r
;

604  
WšdowsE¼Ü
("NewLogg”", ::
G‘La¡E¼Ü
());

606 *
	g»suÉ
 = 
Ãw
 
WšdowsLogg”
(
å
);

607  
	gStus
::
OK
();

611 
ušt64_t
 
NowMiüos
(è
	gov”ride
 {

615 
FILETIME
 
	gá
;

616 ::
G‘Sy¡emTimeAsFeTime
(&
á
);

619 
ušt64_t
 
	gnum_ticks
 =

620 (
¡©ic_ÿ¡
<
ušt64_t
>(
á
.
dwHighD©eTime
è<< 32è+ ft.
dwLowD©eTime
;

621  
	gnum_ticks
 / 10;

624 
SË•FÜMiüo£cÚds
(
miüos
è
	gov”ride
 {

625 
	g¡d
::
this_th»ad
::
¦“p_fÜ
(
¡d
::
chrÚo
::
miüo£cÚds
(
miüos
));

628 
	g´iv©e
:

630 
	sBGI‹m
 {

631 * 
¬g
;

632 (*
	gfunùiÚ
)(*);

636 
BGTh»ad
();

638 
	g¡d
::
mu‹x
 
mu_
;

639 
	g¡d
::
cÚd™iÚ_v¬ŸbË
 
bgsigÇl_
;

640 
boŞ
 
	g¡¬‹d_bgth»ad_
;

641 
	g¡d
::
deque
<
BGI‹m
> 
queue_
;

642 
Lim™”
 
	gmm­_lim™”_
;

646 
MaxMm­s
() {

647 ià(
	gg_mm­_lim™
 >= 0) {

648  
g_mm­_lim™
;

651 
	gg_mm­_lim™
 = (*) >= 8 ? 1000 : 0;

652  
	gg_mm­_lim™
;

655 
	gWšdowsEnv
::
WšdowsEnv
()

656 : 
¡¬‹d_bgth»ad_
(
çl£
), 
mm­_lim™”_
(
MaxMm­s
()) {}

658 
	gWšdowsEnv
::
ScheduË
((*
funùiÚ
)(*), * 
¬g
) {

659 
	g¡d
::
lock_gu¬d
<
¡d
::
mu‹x
> 
gu¬d
(
mu_
);

662 ià(!
	g¡¬‹d_bgth»ad_
) {

663 
	g¡¬‹d_bgth»ad_
 = 
Œue
;

664 
	g¡d
::
th»ad
 
t
(&
WšdowsEnv
::
BGTh»ad
, 
this
);

665 
	gt
.
d‘ach
();

670 ià(
	gqueue_
.
em±y
()) {

671 
	gbgsigÇl_
.
nÙify_Úe
();

675 
	gqueue_
.
push_back
(
BGI‹m
());

676 
	gqueue_
.
back
().
	gfunùiÚ
 = 
funùiÚ
;

677 
	gqueue_
.
back
().
	g¬g
 = 
¬g
;

680 
	gWšdowsEnv
::
BGTh»ad
() {

681 
Œue
) {

683 
¡d
::
unique_lock
<¡d::
mu‹x
> 
lk
(
mu_
);

684 
	gbgsigÇl_
.
wa™
(
lk
, [
this
] {  !
queue_
.
em±y
(); });

686 (*
	gfunùiÚ
)(*èğ
queue_
.
äÚt
().
funùiÚ
;

687 * 
	g¬g
 = 
queue_
.
äÚt
().
¬g
;

688 
	gqueue_
.
pİ_äÚt
();

690 
	glk
.
uÆock
();

691 (*
	gfunùiÚ
)(
	g¬g
);

697 
	g¡d
::
Úû_æag
 
Úû
;

698 
Env
* 
	gdeçuÉ_’v
;

699 
	$In™DeçuÉEnv
(è{ 
deçuÉ_’v
 = 
Ãw
 
	`WšdowsEnv
(); 
	}
}

701 
	gEnvWšdowsTe¡H–³r
::
	$S‘R—dOÆyMM­Lim™
(
lim™
) {

702 
	`as£¹
(
deçuÉ_’v
 =ğ
nuÎ±r
);

703 
g_mm­_lim™
 = 
lim™
;

704 
	}
}

706 
Env
* 
	gEnv
::
	$DeçuÉ
() {

707 
¡d
::
	`ÿÎ_Úû
(
Úû
, 
In™DeçuÉEnv
);

708  
deçuÉ_’v
;

709 
	}
}

	@util/env_windows_test.cc

5 
	~"Ëv–db/’v.h
"

7 
	~"pÜt/pÜt.h
"

8 
	~"ut/’v_wšdows_‹¡_h–³r.h
"

9 
	~"ut/‹¡h¬Ãss.h
"

11 
Çme¥aû
 
	gËv–db
 {

13 cÚ¡ 
	gkMM­Lim™
 = 4;

15 şas 
	cEnvWšdowsTe¡
 {

16 
	gpublic
:

17 
S‘FeLim™s
(
mm­_lim™
) {

18 
EnvWšdowsTe¡H–³r
::
S‘R—dOÆyMM­Lim™
(
mm­_lim™
);

21 
EnvWšdowsTe¡
(è: 
’v_
(
Env
::
DeçuÉ
()) {}

23 
Env
* 
’v_
;

26 
	$TEST
(
EnvWšdowsTe¡
, 
Te¡O³nOnR—d
) {

28 
¡d
::
¡ršg
 
‹¡_dœ
;

29 
	`ASSERT_OK
(
’v_
->
	`G‘Te¡DœeùÜy
(&
‹¡_dœ
));

30 
¡d
::
¡ršg
 
‹¡_fe
 = 
‹¡_dœ
 + "/open_on_read.txt";

32 
FILE
* 
f
 = 
	`fİ’
(
‹¡_fe
.
	`c_¡r
(), "w");

33 
	`ASSERT_TRUE
(
f
 !ğ
nuÎ±r
);

34 cÚ¡ 
kFeD©a
[] = "abcdefghijklmnopqrstuvwxyz";

35 
	`åuts
(
kFeD©a
, 
f
);

36 
	`fşo£
(
f
);

41 cÚ¡ 
kNumFes
 = 
kMM­Lim™
 + 5;

42 
Ëv–db
::
RªdomAcûssFe
* 
fes
[
kNumFes
] = {0};

43 
i
 = 0; i < 
kNumFes
; i++) {

44 
	`ASSERT_OK
(
’v_
->
	`NewRªdomAcûssFe
(
‹¡_fe
, &
fes
[
i
]));

46 
sü©ch
;

47 
Sliû
 
»ad_»suÉ
;

48 
i
 = 0; i < 
kNumFes
; i++) {

49 
	`ASSERT_OK
(
fes
[
i
]->
	`R—d
(i, 1, &
»ad_»suÉ
, &
sü©ch
));

50 
	`ASSERT_EQ
(
kFeD©a
[
i
], 
»ad_»suÉ
[0]);

52 
i
 = 0; i < 
kNumFes
; i++) {

53 
d–‘e
 
fes
[
i
];

55 
	`ASSERT_OK
(
’v_
->
	`D–‘eFe
(
‹¡_fe
));

56 
	}
}

60 
	$maš
(
¬gc
, ** 
¬gv
) {

62 
Ëv–db
::
EnvWšdowsTe¡
::
	`S‘FeLim™s
Öev–db::
kMM­Lim™
);

63  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
();

64 
	}
}

	@util/env_windows_test_helper.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_ENV_WINDOWS_TEST_HELPER_H_


6 
	#STORAGE_LEVELDB_UTIL_ENV_WINDOWS_TEST_HELPER_H_


	)

8 
Çme¥aû
 
	gËv–db
 {

10 
şass
 
	gEnvWšdowsTe¡
;

13 şas 
	cEnvWšdowsTe¡H–³r
 {

14 
	g´iv©e
:

15 
ä›nd
 
şass
 
CÜru±iÚTe¡
;

16 
ä›nd
 
şass
 
	gEnvWšdowsTe¡
;

20 
S‘R—dOÆyMM­Lim™
(
lim™
);

	@util/filter_policy.cc

5 
	~"Ëv–db/f‹r_pŞicy.h
"

7 
Çme¥aû
 
	gËv–db
 {

9 
	gF‹rPŞicy
::~
F‹rPŞicy
() {}

	@util/hash.cc

5 
	~"ut/hash.h
"

7 
	~<¡ršg.h
>

9 
	~"ut/codšg.h
"

14 #iâdeà
FALLTHROUGH_INTENDED


15 
	#FALLTHROUGH_INTENDED
 \

17 } 0)

	)

20 
Çme¥aû
 
	gËv–db
 {

22 
ušt32_t
 
Hash
(cÚ¡ * 
d©a
, 
size_t
 
n
, ušt32_ˆ
£ed
) {

24 cÚ¡ 
ušt32_t
 
	gm
 = 0xc6a4a793;

25 cÚ¡ 
ušt32_t
 
	gr
 = 24;

26 cÚ¡ * 
	glim™
 = 
d©a
 + 
n
;

27 
ušt32_t
 
	gh
 = 
£ed
 ^ (
n
 * 
m
);

30 
	gd©a
 + 4 <ğ
lim™
) {

31 
ušt32_t
 
w
 = 
DecodeFixed32
(
d©a
);

32 
	gd©a
 += 4;

33 
	gh
 +ğ
w
;

34 
	gh
 *ğ
m
;

35 
	gh
 ^ğ(
h
 >> 16);

39 
	glim™
 - 
	gd©a
) {

41 
h
 +ğ
¡©ic_ÿ¡
<>(
d©a
[2]) << 16;

42 
	gFALLTHROUGH_INTENDED
;

44 
h
 +ğ
¡©ic_ÿ¡
<>(
d©a
[1]) << 8;

45 
	gFALLTHROUGH_INTENDED
;

47 
h
 +ğ
¡©ic_ÿ¡
<>(
d©a
[0]);

48 
	gh
 *ğ
m
;

49 
	gh
 ^ğ(
h
 >> 
r
);

52  
	gh
;

	@util/hash.h

7 #iâdeà
STORAGE_LEVELDB_UTIL_HASH_H_


8 
	#STORAGE_LEVELDB_UTIL_HASH_H_


	)

10 
	~<¡ddef.h
>

11 
	~<¡dšt.h
>

13 
Çme¥aû
 
	gËv–db
 {

15 
ušt32_t
 
Hash
(cÚ¡ * 
d©a
, 
size_t
 
n
, ušt32_ˆ
£ed
);

	@util/hash_test.cc

5 
	~"ut/hash.h
"

6 
	~"ut/‹¡h¬Ãss.h
"

8 
Çme¥aû
 
	gËv–db
 {

10 şas 
	cHASH
 {};

12 
	$TEST
(
HASH
, 
SigÃdUnsigÃdIssue
) {

13 cÚ¡ 
d©a1
[1] = {0x62};

14 cÚ¡ 
d©a2
[2] = {0xc3, 0x97};

15 cÚ¡ 
d©a3
[3] = {0xe2, 0x99, 0xa5};

16 cÚ¡ 
d©a4
[4] = {0xe1, 0x80, 0xb9, 0x32};

17 cÚ¡ 
d©a5
[48] = {

24 
	`ASSERT_EQ
(
	`Hash
(0, 0, 0xbc9f1d34), 0xbc9f1d34);

25 
	`ASSERT_EQ
(

26 
	`Hash
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
d©a1
), (data1), 0xbc9f1d34),

28 
	`ASSERT_EQ
(

29 
	`Hash
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
d©a2
), (data2), 0xbc9f1d34),

31 
	`ASSERT_EQ
(

32 
	`Hash
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
d©a3
), (data3), 0xbc9f1d34),

34 
	`ASSERT_EQ
(

35 
	`Hash
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
d©a4
), (data4), 0xbc9f1d34),

37 
	`ASSERT_EQ
(

38 
	`Hash
(
»š‹½»t_ÿ¡
<cÚ¡ *>(
d©a5
), (data5), 0x12345678),

40 
	}
}

44 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/histogram.cc

5 
	~"ut/hi¡og¿m.h
"

7 
	~<m©h.h
>

8 
	~<¡dio.h
>

10 
	~"pÜt/pÜt.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 cÚ¡ 
	gHi¡og¿m
::
kBuck‘Lim™
[
kNumBuck‘s
] = {

171 
	gHi¡og¿m
::
CË¬
() {

172 
mš_
 = 
kBuck‘Lim™
[
kNumBuck‘s
 - 1];

173 
	gmax_
 = 0;

174 
	gnum_
 = 0;

175 
	gsum_
 = 0;

176 
	gsum_squ¬es_
 = 0;

177 
	gi
 = 0; i < 
	gkNumBuck‘s
; i++) {

178 
	gbuck‘s_
[
i
] = 0;

182 
	gHi¡og¿m
::
Add
(
v®ue
) {

184 
b
 = 0;

185 
	gb
 < 
	gkNumBuck‘s
 - 1 && 
	gkBuck‘Lim™
[
b
] <ğ
v®ue
) {

186 
b
++;

188 
	gbuck‘s_
[
b
] += 1.0;

189 ià(
	gmš_
 > 
	gv®ue
èmš_ = 
v®ue
;

190 ià(
	gmax_
 < 
	gv®ue
èmax_ = 
v®ue
;

191 
	gnum_
++;

192 
	gsum_
 +ğ
v®ue
;

193 
	gsum_squ¬es_
 +ğ(
v®ue
 * value);

196 
	gHi¡og¿m
::
M”ge
(cÚ¡ 
Hi¡og¿m
& 
Ùh”
) {

197 ià(
Ùh”
.
mš_
 < min_) min_ = other.min_;

198 ià(
	gÙh”
.
	gmax_
 > max_èmax_ = 
Ùh”
.
max_
;

199 
	gnum_
 +ğ
Ùh”
.
num_
;

200 
	gsum_
 +ğ
Ùh”
.
sum_
;

201 
	gsum_squ¬es_
 +ğ
Ùh”
.
sum_squ¬es_
;

202 
	gb
 = 0; b < 
	gkNumBuck‘s
; b++) {

203 
	gbuck‘s_
[
b
] +ğ
Ùh”
.
buck‘s_
[b];

207 
	gHi¡og¿m
::
MedŸn
(ècÚ¡ {  
P”ûÁe
(50.0); }

209 
	gHi¡og¿m
::
P”ûÁe
(
p
) const {

210 
th»shŞd
 = 
num_
 * (
p
 / 100.0);

211 
	gsum
 = 0;

212 
	gb
 = 0; b < 
	gkNumBuck‘s
; b++) {

213 
	gsum
 +ğ
buck‘s_
[
b
];

214 ià(
	gsum
 >ğ
th»shŞd
) {

216 
Ëá_pošt
 = (
b
 =ğ0è? 0 : 
kBuck‘Lim™
[b - 1];

217 
	gright_pošt
 = 
kBuck‘Lim™
[
b
];

218 
	gËá_sum
 = 
sum
 - 
buck‘s_
[
b
];

219 
	gright_sum
 = 
sum
;

220 
	gpos
 = (
th»shŞd
 - 
Ëá_sum
è/ (
right_sum
 -†eft_sum);

221 
	gr
 = 
Ëá_pošt
 + (
right_pošt
 -†eá_poštè* 
pos
;

222 ià(
	gr
 < 
	gmš_
è¸ğ
mš_
;

223 ià(
	gr
 > 
	gmax_
è¸ğ
max_
;

224  
	gr
;

227  
	gmax_
;

230 
	gHi¡og¿m
::
Av”age
() const {

231 ià(
num_
 == 0.0)  0;

232  
	gsum_
 / 
	gnum_
;

235 
	gHi¡og¿m
::
Snd¬dDevŸtiÚ
() const {

236 ià(
num_
 == 0.0)  0;

237 
	gv¬Ÿnû
 = (
sum_squ¬es_
 * 
num_
 - 
sum_
 * sum_) / (num_ *‚um_);

238  
sq¹
(
v¬Ÿnû
);

241 
	g¡d
::
¡ršg
 
Hi¡og¿m
::
ToSŒšg
() const {

242 
¡d
::
¡ršg
 
r
;

243 
	gbuf
[200];

244 
¢´štf
(
buf
, (buf), "CouÁ: %.0à Av”age: %.4à StdDev: %.2f\n", 
num_
,

245 
Av”age
(), 
Snd¬dDevŸtiÚ
());

246 
	gr
.
­³nd
(
buf
);

247 
¢´štf
(
buf
, (buf), "Min: %.4f Median: %.4f Max: %.4f\n",

248 (
num_
 =ğ0.0 ? 0.0 : 
mš_
), 
MedŸn
(), 
max_
);

249 
	gr
.
­³nd
(
buf
);

250 
	gr
.
­³nd
("------------------------------------------------------\n");

251 cÚ¡ 
	gmuÉ
 = 100.0 / 
num_
;

252 
	gsum
 = 0;

253 
	gb
 = 0; b < 
	gkNumBuck‘s
; b++) {

254 ià(
	gbuck‘s_
[
b
] <= 0.0) ;

255 
	gsum
 +ğ
buck‘s_
[
b
];

256 
¢´štf
(
buf
, (buf), "[ %7.0f, %7.0f ) %7.0f %7.3f%% %7.3f%% ",

257 ((
b
 =ğ0è? 0.0 : 
kBuck‘Lim™
[b - 1]),

258 
kBuck‘Lim™
[
b
],

259 
buck‘s_
[
b
],

260 
muÉ
 * 
buck‘s_
[
b
],

261 
muÉ
 * 
sum
);

262 
	gr
.
­³nd
(
buf
);

265 
	gm¬ks
 = 
¡©ic_ÿ¡
<>(20 * (
buck‘s_
[
b
] / 
num_
) + 0.5);

266 
	gr
.
­³nd
(
m¬ks
, '#');

267 
	gr
.
push_back
('\n');

269  
	gr
;

	@util/histogram.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_HISTOGRAM_H_


6 
	#STORAGE_LEVELDB_UTIL_HISTOGRAM_H_


	)

8 
	~<¡ršg
>

10 
Çme¥aû
 
	gËv–db
 {

12 şas 
	cHi¡og¿m
 {

13 
	gpublic
:

14 
Hi¡og¿m
() {}

15 ~
Hi¡og¿m
() {}

17 
CË¬
();

18 
Add
(
v®ue
);

19 
M”ge
(cÚ¡ 
Hi¡og¿m
& 
Ùh”
);

21 
	g¡d
::
¡ršg
 
ToSŒšg
() const;

23 
	g´iv©e
:

24 ’um { 
kNumBuck‘s
 = 154 };

26 
MedŸn
() const;

27 
P”ûÁe
(
p
) const;

28 
Av”age
() const;

29 
Snd¬dDevŸtiÚ
() const;

31 cÚ¡ 
	gkBuck‘Lim™
[
kNumBuck‘s
];

33 
	gmš_
;

34 
	gmax_
;

35 
	gnum_
;

36 
	gsum_
;

37 
	gsum_squ¬es_
;

39 
	gbuck‘s_
[
kNumBuck‘s
];

	@util/logging.cc

5 
	~"ut/loggšg.h
"

7 
	~<”ºo.h
>

8 
	~<¡d¬g.h
>

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

12 
	~<lim™s
>

14 
	~"Ëv–db/’v.h
"

15 
	~"Ëv–db/¦iû.h
"

17 
Çme¥aû
 
	gËv–db
 {

19 
Aµ’dNumb”To
(
¡d
::
¡ršg
* 
¡r
, 
ušt64_t
 
num
) {

20 
	gbuf
[30];

21 
¢´štf
(
buf
, (buf), "%Îu", ()
num
);

22 
	g¡r
->
­³nd
(
buf
);

25 
Aµ’dEsÿ³dSŒšgTo
(
¡d
::
¡ršg
* 
¡r
, cÚ¡ 
Sliû
& 
v®ue
) {

26 
size_t
 
	gi
 = 0; i < 
	gv®ue
.
size
(); i++) {

27 
	gc
 = 
v®ue
[
i
];

28 ià(
	gc
 >ğ' ' && 
c
 <= '~') {

29 
¡r
->
push_back
(
c
);

31 
	gbuf
[10];

32 
¢´štf
(
buf
, (buf), "\\x%02x",

33 
¡©ic_ÿ¡
<>(
c
) & 0xff);

34 
	g¡r
->
­³nd
(
buf
);

39 
	g¡d
::
¡ršg
 
Numb”ToSŒšg
(
ušt64_t
 
num
) {

40 
¡d
::
¡ršg
 
r
;

41 
Aµ’dNumb”To
(&
r
, 
num
);

42  
	gr
;

45 
	g¡d
::
¡ršg
 
Esÿ³SŒšg
(cÚ¡ 
Sliû
& 
v®ue
) {

46 
¡d
::
¡ršg
 
r
;

47 
Aµ’dEsÿ³dSŒšgTo
(&
r
, 
v®ue
);

48  
	gr
;

51 
boŞ
 
CÚsumeDecim®Numb”
(
Sliû
* 
š
, 
ušt64_t
* 
v®
) {

53 
cÚ¡ex´
 cÚ¡ 
ušt64_t
 
	gkMaxUšt64
 = 
¡d
::
num”ic_lim™s
<ušt64_t>::
max
();

54 
cÚ¡ex´
 cÚ¡ 
	gkLa¡Dig™OfMaxUšt64
 =

55 '0' + 
¡©ic_ÿ¡
<>(
kMaxUšt64
 % 10);

57 
ušt64_t
 
	gv®ue
 = 0;

60 cÚ¡ * 
	g¡¬t
 =

61 
»š‹½»t_ÿ¡
<cÚ¡ *>(
š
->
d©a
());

63 cÚ¡ * 
	g’d
 = 
¡¬t
 + 
š
->
size
();

64 cÚ¡ * 
	gcu¼’t
 = 
¡¬t
;

65 ; 
	gcu¼’t
 !ğ
’d
; ++current) {

66 cÚ¡ 
	gch
 = *
cu¼’t
;

67 ià(
	gch
 < '0' || ch > '9') ;

71 ià(
	gv®ue
 > 
	gkMaxUšt64
 / 10 ||

72 (
	gv®ue
 =ğ
kMaxUšt64
 / 10 && 
ch
 > 
kLa¡Dig™OfMaxUšt64
)) {

73  
çl£
;

76 
	gv®ue
 = (
v®ue
 * 10è+ (
ch
 - '0');

79 *
	gv®
 = 
v®ue
;

80 cÚ¡ 
size_t
 
	gdig™s_cÚsumed
 = 
cu¼’t
 - 
¡¬t
;

81 
	gš
->
»move_´efix
(
dig™s_cÚsumed
);

82  
	gdig™s_cÚsumed
 != 0;

	@util/logging.h

8 #iâdeà
STORAGE_LEVELDB_UTIL_LOGGING_H_


9 
	#STORAGE_LEVELDB_UTIL_LOGGING_H_


	)

11 
	~<¡dšt.h
>

12 
	~<¡dio.h
>

14 
	~<¡ršg
>

16 
	~"pÜt/pÜt.h
"

18 
Çme¥aû
 
	gËv–db
 {

20 
şass
 
	gSliû
;

21 
şass
 
	gWr™abËFe
;

24 
Aµ’dNumb”To
(
¡d
::
¡ršg
* 
¡r
, 
ušt64_t
 
num
);

28 
Aµ’dEsÿ³dSŒšgTo
(
¡d
::
¡ršg
* 
¡r
, cÚ¡ 
Sliû
& 
v®ue
);

31 
	g¡d
::
¡ršg
 
Numb”ToSŒšg
(
ušt64_t
 
num
);

35 
	g¡d
::
¡ršg
 
Esÿ³SŒšg
(cÚ¡ 
Sliû
& 
v®ue
);

41 
boŞ
 
CÚsumeDecim®Numb”
(
Sliû
* 
š
, 
ušt64_t
* 
v®
);

	@util/logging_test.cc

5 
	~<lim™s
>

6 
	~<¡ršg
>

8 
	~"Ëv–db/¦iû.h
"

9 
	~"ut/loggšg.h
"

10 
	~"ut/‹¡h¬Ãss.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 şas 
	cLoggšg
 {};

16 
	$TEST
(
Loggšg
, 
Numb”ToSŒšg
) {

17 
	`ASSERT_EQ
("0", 
	`Numb”ToSŒšg
(0));

18 
	`ASSERT_EQ
("1", 
	`Numb”ToSŒšg
(1));

19 
	`ASSERT_EQ
("9", 
	`Numb”ToSŒšg
(9));

21 
	`ASSERT_EQ
("10", 
	`Numb”ToSŒšg
(10));

22 
	`ASSERT_EQ
("11", 
	`Numb”ToSŒšg
(11));

23 
	`ASSERT_EQ
("19", 
	`Numb”ToSŒšg
(19));

24 
	`ASSERT_EQ
("99", 
	`Numb”ToSŒšg
(99));

26 
	`ASSERT_EQ
("100", 
	`Numb”ToSŒšg
(100));

27 
	`ASSERT_EQ
("109", 
	`Numb”ToSŒšg
(109));

28 
	`ASSERT_EQ
("190", 
	`Numb”ToSŒšg
(190));

29 
	`ASSERT_EQ
("123", 
	`Numb”ToSŒšg
(123));

30 
	`ASSERT_EQ
("12345678", 
	`Numb”ToSŒšg
(12345678));

32 
	`¡©ic_as£¹
(
¡d
::
num”ic_lim™s
<
ušt64_t
>::
	`max
() == 18446744073709551615U,

34 
	`ASSERT_EQ
("18446744073709551000", 
	`Numb”ToSŒšg
(18446744073709551000U));

35 
	`ASSERT_EQ
("18446744073709551600", 
	`Numb”ToSŒšg
(18446744073709551600U));

36 
	`ASSERT_EQ
("18446744073709551610", 
	`Numb”ToSŒšg
(18446744073709551610U));

37 
	`ASSERT_EQ
("18446744073709551614", 
	`Numb”ToSŒšg
(18446744073709551614U));

38 
	`ASSERT_EQ
("18446744073709551615", 
	`Numb”ToSŒšg
(18446744073709551615U));

39 
	}
}

41 
CÚsumeDecim®Numb”RoundŒTe¡
(
ušt64_t
 
numb”
,

42 cÚ¡ 
¡d
::
¡ršg
& 
·ddšg
 = "") {

43 
¡d
::
¡ršg
 
decim®_numb”
 = 
Numb”ToSŒšg
(
numb”
);

44 
	g¡d
::
¡ršg
 
šput_¡ršg
 = 
decim®_numb”
 + 
·ddšg
;

45 
Sliû
 
šput
(
šput_¡ršg
);

46 
Sliû
 
	gouut
 = 
šput
;

47 
ušt64_t
 
	g»suÉ
;

48 
ASSERT_TRUE
(
CÚsumeDecim®Numb”
(&
ouut
, &
»suÉ
));

49 
ASSERT_EQ
(
numb”
, 
»suÉ
);

50 
ASSERT_EQ
(
decim®_numb”
.
size
(), 
ouut
.
d©a
(è- 
šput
.data());

51 
ASSERT_EQ
(
·ddšg
.
size
(), 
ouut
.size());

54 
	$TEST
(
Loggšg
, 
CÚsumeDecim®Numb”RoundŒ
) {

55 
	`CÚsumeDecim®Numb”RoundŒTe¡
(0);

56 
	`CÚsumeDecim®Numb”RoundŒTe¡
(1);

57 
	`CÚsumeDecim®Numb”RoundŒTe¡
(9);

59 
	`CÚsumeDecim®Numb”RoundŒTe¡
(10);

60 
	`CÚsumeDecim®Numb”RoundŒTe¡
(11);

61 
	`CÚsumeDecim®Numb”RoundŒTe¡
(19);

62 
	`CÚsumeDecim®Numb”RoundŒTe¡
(99);

64 
	`CÚsumeDecim®Numb”RoundŒTe¡
(100);

65 
	`CÚsumeDecim®Numb”RoundŒTe¡
(109);

66 
	`CÚsumeDecim®Numb”RoundŒTe¡
(190);

67 
	`CÚsumeDecim®Numb”RoundŒTe¡
(123);

68 
	`ASSERT_EQ
("12345678", 
	`Numb”ToSŒšg
(12345678));

70 
ušt64_t
 
i
 = 0; i < 100; ++i) {

71 
ušt64_t
 
Ïrge_numb”
 = 
¡d
::
num”ic_lim™s
<ušt64_t>::
	`max
(è- 
i
;

72 
	`CÚsumeDecim®Numb”RoundŒTe¡
(
Ïrge_numb”
);

74 
	}
}

76 
	$TEST
(
Loggšg
, 
CÚsumeDecim®Numb”RoundŒW™hPaddšg
) {

77 
	`CÚsumeDecim®Numb”RoundŒTe¡
(0, " ");

78 
	`CÚsumeDecim®Numb”RoundŒTe¡
(1, "abc");

79 
	`CÚsumeDecim®Numb”RoundŒTe¡
(9, "x");

81 
	`CÚsumeDecim®Numb”RoundŒTe¡
(10, "_");

82 
	`CÚsumeDecim®Numb”RoundŒTe¡
(11, 
¡d
::
	`¡ršg
("\0\0\0", 3));

83 
	`CÚsumeDecim®Numb”RoundŒTe¡
(19, "abc");

84 
	`CÚsumeDecim®Numb”RoundŒTe¡
(99, "padding");

86 
	`CÚsumeDecim®Numb”RoundŒTe¡
(100, " ");

88 
ušt64_t
 
i
 = 0; i < 100; ++i) {

89 
ušt64_t
 
Ïrge_numb”
 = 
¡d
::
num”ic_lim™s
<ušt64_t>::
	`max
(è- 
i
;

90 
	`CÚsumeDecim®Numb”RoundŒTe¡
(
Ïrge_numb”
, "pad");

92 
	}
}

94 
	$CÚsumeDecim®Numb”Ov”æowTe¡
(cÚ¡ 
¡d
::
¡ršg
& 
šput_¡ršg
) {

95 
Sliû
 
	`šput
(
šput_¡ršg
);

96 
Sliû
 
ouut
 = 
šput
;

97 
ušt64_t
 
»suÉ
;

98 
	`ASSERT_EQ
(
çl£
, 
	`CÚsumeDecim®Numb”
(&
ouut
, &
»suÉ
));

99 
	}
}

101 
	$TEST
(
Loggšg
, 
CÚsumeDecim®Numb”Ov”æow
) {

102 
	`¡©ic_as£¹
(
¡d
::
num”ic_lim™s
<
ušt64_t
>::
	`max
() == 18446744073709551615U,

104 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551616");

105 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551617");

106 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551618");

107 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551619");

108 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551620");

109 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551621");

110 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551622");

111 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551623");

112 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551624");

113 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551625");

114 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551626");

116 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("18446744073709551700");

118 
	`CÚsumeDecim®Numb”Ov”æowTe¡
("99999999999999999999");

119 
	}
}

121 
	$CÚsumeDecim®Numb”NoDig™sTe¡
(cÚ¡ 
¡d
::
¡ršg
& 
šput_¡ršg
) {

122 
Sliû
 
	`šput
(
šput_¡ršg
);

123 
Sliû
 
ouut
 = 
šput
;

124 
ušt64_t
 
»suÉ
;

125 
	`ASSERT_EQ
(
çl£
, 
	`CÚsumeDecim®Numb”
(&
ouut
, &
»suÉ
));

126 
	`ASSERT_EQ
(
šput
.
	`d©a
(), 
ouut
.data());

127 
	`ASSERT_EQ
(
šput
.
	`size
(), 
ouut
.size());

128 
	}
}

130 
	$TEST
(
Loggšg
, 
CÚsumeDecim®Numb”NoDig™s
) {

131 
	`CÚsumeDecim®Numb”NoDig™sTe¡
("");

132 
	`CÚsumeDecim®Numb”NoDig™sTe¡
(" ");

133 
	`CÚsumeDecim®Numb”NoDig™sTe¡
("a");

134 
	`CÚsumeDecim®Numb”NoDig™sTe¡
(" 123");

135 
	`CÚsumeDecim®Numb”NoDig™sTe¡
("a123");

136 
	`CÚsumeDecim®Numb”NoDig™sTe¡
(
¡d
::
	`¡ršg
("\000123", 4));

137 
	`CÚsumeDecim®Numb”NoDig™sTe¡
(
¡d
::
	`¡ršg
("\177123", 4));

138 
	`CÚsumeDecim®Numb”NoDig™sTe¡
(
¡d
::
	`¡ršg
("\377123", 4));

139 
	}
}

143 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/mutexlock.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_MUTEXLOCK_H_


6 
	#STORAGE_LEVELDB_UTIL_MUTEXLOCK_H_


	)

8 
	~"pÜt/pÜt.h
"

9 
	~"pÜt/th»ad_ªnÙ©iÚs.h
"

11 
Çme¥aû
 
	gËv–db
 {

23 şas 
	cSCOPED_LOCKABLE
 
	gMu‹xLock
 {

24 
	gpublic
:

25 
ex¶ic™
 
Mu‹xLock
(
pÜt
::
Mu‹x
* 
mu
è
EXCLUSIVE_LOCK_FUNCTION
(muè: 
mu_
(mu) {

26 
this
->
mu_
->
Lock
();

28 ~
Mu‹xLock
(è
UNLOCK_FUNCTION
(è{ 
	gthis
->
	gmu_
->
UÆock
(); }

30 
Mu‹xLock
(cÚ¡ Mu‹xLock&èğ
d–‘e
;

31 
	gMu‹xLock
& 
	gİ”©Ü
=(cÚ¡ 
Mu‹xLock
&èğ
d–‘e
;

33 
	g´iv©e
:

34 
pÜt
::
Mu‹x
* cÚ¡ 
mu_
;

	@util/no_destructor.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_NO_DESTRUCTOR_H_


6 
	#STORAGE_LEVELDB_UTIL_NO_DESTRUCTOR_H_


	)

8 
	~<ty³_Œa™s
>

9 
	~<ut™y
>

11 
Çme¥aû
 
	gËv–db
 {

16 
	g‹m¶©e
 <
ty³Çme
 
	gIn¡ªûTy³
>

17 şas 
	cNoDe¡ruùÜ
 {

18 
	gpublic
:

19 
‹m¶©e
 <
ty³Çme
... 
CÚ¡ruùÜArgTy³s
>

20 
ex¶ic™
 
NoDe¡ruùÜ
(
CÚ¡ruùÜArgTy³s
&&... 
cÚ¡ruùÜ_¬gs
) {

21 
¡©ic_as£¹
((
š¡ªû_¡Üage_
è>ğ(
In¡ªûTy³
),

23 
¡©ic_as£¹
(

24 
®ignof
(
deşty³
(
š¡ªû_¡Üage_
)è>ğ®ignof(
In¡ªûTy³
),

26 
Ãw
 (&
š¡ªû_¡Üage_
)

27 
In¡ªûTy³
(
¡d
::
fÜw¬d
<
CÚ¡ruùÜArgTy³s
>(
cÚ¡ruùÜ_¬gs
)...);

30 ~
NoDe¡ruùÜ
() = ;

32 
NoDe¡ruùÜ
(cÚ¡ NoDe¡ruùÜ&èğ
d–‘e
;

33 
	gNoDe¡ruùÜ
& 
	gİ”©Ü
=(cÚ¡ 
NoDe¡ruùÜ
&èğ
d–‘e
;

35 
In¡ªûTy³
* 
g‘
() {

36  
	g»š‹½»t_ÿ¡
<
	gIn¡ªûTy³
*>(&
	gš¡ªû_¡Üage_
);

39 
	g´iv©e
:

40 
ty³Çme
 
¡d
::
®igÃd_¡Üage
<(
In¡ªûTy³
),

41 
®ignof
(
In¡ªûTy³
)>::
ty³
 
š¡ªû_¡Üage_
;

	@util/no_destructor_test.cc

5 
	~<c¡dšt
>

6 
	~<c¡dlib
>

7 
	~<ut™y
>

9 
	~"ut/no_de¡ruùÜ.h
"

10 
	~"ut/‹¡h¬Ãss.h
"

12 
Çme¥aû
 
	gËv–db
 {

14 
	gÇme¥aû
 {

16 
	sDoNÙDe¡ruù
 {

17 
	gpublic
:

18 
DoNÙDe¡ruù
(
ušt32_t
 
a
, 
ušt64_t
 
b
) :‡(a), b(b) {}

19 ~
DoNÙDe¡ruù
(è{ 
	g¡d
::
abÜt
(); }

22 
ušt32_t
 
	ga
;

23 
ušt64_t
 
	gb
;

26 
cÚ¡ex´
 cÚ¡ 
ušt32_t
 
	gkGŞd’A
 = 0xdeadbeef;

27 
cÚ¡ex´
 cÚ¡ 
ušt64_t
 
	gkGŞd’B
 = 0xaabbccddeeffaabb;

31 şas 
	cNoDe¡ruùÜTe¡
 {};

33 
	$TEST
(
NoDe¡ruùÜTe¡
, 
SckIn¡ªû
) {

34 
NoDe¡ruùÜ
<
DoNÙDe¡ruù
> 
	`š¡ªû
(
kGŞd’A
, 
kGŞd’B
);

35 
	`ASSERT_EQ
(
kGŞd’A
, 
š¡ªû
.
	`g‘
()->
a
);

36 
	`ASSERT_EQ
(
kGŞd’B
, 
š¡ªû
.
	`g‘
()->
b
);

37 
	}
}

39 
	$TEST
(
NoDe¡ruùÜTe¡
, 
SticIn¡ªû
) {

40 
NoDe¡ruùÜ
<
DoNÙDe¡ruù
> 
	`š¡ªû
(
kGŞd’A
, 
kGŞd’B
);

41 
	`ASSERT_EQ
(
kGŞd’A
, 
š¡ªû
.
	`g‘
()->
a
);

42 
	`ASSERT_EQ
(
kGŞd’B
, 
š¡ªû
.
	`g‘
()->
b
);

43 
	}
}

47 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/options.cc

5 
	~"Ëv–db/İtiÚs.h
"

7 
	~"Ëv–db/com·¿tÜ.h
"

8 
	~"Ëv–db/’v.h
"

10 
Çme¥aû
 
	gËv–db
 {

12 
	gO±iÚs
::
O±iÚs
(è: 
com·¿tÜ
(
By‹wi£Com·¿tÜ
()), 
’v
(
Env
::
DeçuÉ
()) {}

	@util/posix_logger.h

8 #iâdeà
STORAGE_LEVELDB_UTIL_POSIX_LOGGER_H_


9 
	#STORAGE_LEVELDB_UTIL_POSIX_LOGGER_H_


	)

11 
	~<sys/time.h
>

13 
	~<ÿs£¹
>

14 
	~<c¡d¬g
>

15 
	~<c¡dio
>

16 
	~<ùime
>

17 
	~<s¡»am
>

18 
	~<th»ad
>

20 
	~"Ëv–db/’v.h
"

22 
Çme¥aû
 
	gËv–db
 {

24 şas 
	cPosixLogg”
 
	gfš®
 : 
public
 
Logg”
 {

25 
public
:

29 
ex¶ic™
 
PosixLogg”
(
¡d
::
FILE
* 
å
è: 
å_
(åè{ 
as£¹
(å !ğ
nuÎ±r
); }

31 ~
PosixLogg”
(è
	gov”ride
 { 
	g¡d
::
fşo£
(
å_
); }

33 
Logv
(cÚ¡ * 
fÜm©
, 
va_li¡
 
¬gum’ts
è
	gov”ride
 {

35 ::
timev®
 
now_timev®
;

36 ::
g‘timeofday
(&
now_timev®
, 
nuÎ±r
);

37 cÚ¡ 
	g¡d
::
time_t
 
now_£cÚds
 = 
now_timev®
.
tv_£c
;

38 
	g¡d
::
tm
 
now_compÚ’ts
;

39 ::
loÿÉime_r
(&
now_£cÚds
, &
now_compÚ’ts
);

42 
cÚ¡ex´
 cÚ¡ 
	gkMaxTh»adIdSize
 = 32;

43 
	g¡d
::
o¡ršg¡»am
 
th»ad_¡»am
;

44 
	gth»ad_¡»am
 << 
	g¡d
::
this_th»ad
::
g‘_id
();

45 
	g¡d
::
¡ršg
 
th»ad_id
 = 
th»ad_¡»am
.
¡r
();

46 ià(
	gth»ad_id
.
size
(è> 
	gkMaxTh»adIdSize
) {

47 
	gth»ad_id
.
»size
(
kMaxTh»adIdSize
);

52 
cÚ¡ex´
 cÚ¡ 
	gkSckBufãrSize
 = 512;

53 
	g¡ack_bufãr
[
kSckBufãrSize
];

54 
¡©ic_as£¹
((
¡ack_bufãr
è=ğ
¡©ic_ÿ¡
<
size_t
>(
kSckBufãrSize
),

57 
	gdyÇmic_bufãr_size
 = 0;

58 
	g™”©iÚ
 = 0; iteration < 2; ++iteration) {

59 cÚ¡ 
	gbufãr_size
 =

60 (
™”©iÚ
 =ğ0è? 
kSckBufãrSize
 : 
dyÇmic_bufãr_size
;

61 * cÚ¡ 
	gbufãr
 =

62 (
™”©iÚ
 =ğ0è? 
¡ack_bufãr
 : 
Ãw
 [
dyÇmic_bufãr_size
];

65 
	gbufãr_off£t
 = 
¢´štf
(

66 
bufãr
, 
bufãr_size
, "%04d/%02d/%02d-%02d:%02d:%02d.%06d %s ",

67 
now_compÚ’ts
.
tm_y—r
 + 1900,‚ow_compÚ’ts.
tm_mÚ
 + 1,

68 
now_compÚ’ts
.
tm_mday
,‚ow_compÚ’ts.
tm_hour
,‚ow_compÚ’ts.
tm_mš
,

69 
now_compÚ’ts
.
tm_£c
, 
¡©ic_ÿ¡
<>(
now_timev®
.
tv_u£c
),

70 
th»ad_id
.
c_¡r
());

75 
as£¹
(
bufãr_off£t
 <ğ28 + 
kMaxTh»adIdSize
);

76 
¡©ic_as£¹
(28 + 
kMaxTh»adIdSize
 < 
kSckBufãrSize
,

78 
as£¹
(
bufãr_off£t
 < 
bufãr_size
);

81 
	g¡d
::
va_li¡
 
¬gum’ts_cİy
;

82 
va_cİy
(
¬gum’ts_cİy
, 
¬gum’ts
);

83 
	gbufãr_off£t
 +=

84 
¡d
::
v¢´štf
(
bufãr
 + 
bufãr_off£t
, 
bufãr_size
 - buffer_offset,

85 
fÜm©
, 
¬gum’ts_cİy
);

86 
va_’d
(
¬gum’ts_cİy
);

90 ià(
	gbufãr_off£t
 >ğ
bufãr_size
 - 1) {

92 ià(
™”©iÚ
 == 0) {

96 
dyÇmic_bufãr_size
 = 
bufãr_off£t
 + 2;

103 
as£¹
(
çl£
);

104 
	gbufãr_off£t
 = 
bufãr_size
 - 1;

108 ià(
	gbufãr
[
bufãr_off£t
 - 1] != '\n') {

109 
bufãr
[
bufãr_off£t
] = '\n';

110 ++
	gbufãr_off£t
;

113 
as£¹
(
bufãr_off£t
 <ğ
bufãr_size
);

114 
	g¡d
::
fwr™e
(
bufãr
, 1, 
bufãr_off£t
, 
å_
);

115 
	g¡d
::
fæush
(
å_
);

117 ià(
	g™”©iÚ
 != 0) {

118 
d–‘e
[] 
bufãr
;

124 
	g´iv©e
:

125 
¡d
::
FILE
* cÚ¡ 
å_
;

	@util/random.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_RANDOM_H_


6 
	#STORAGE_LEVELDB_UTIL_RANDOM_H_


	)

8 
	~<¡dšt.h
>

10 
Çme¥aû
 
	gËv–db
 {

15 şas 
	cRªdom
 {

16 
	g´iv©e
:

17 
ušt32_t
 
£ed_
;

19 
	gpublic
:

20 
ex¶ic™
 
Rªdom
(
ušt32_t
 
s
è: 
£ed_
(s & 0x7fffffffu) {

22 ià(
£ed_
 == 0 || seed_ == 2147483647L) {

23 
£ed_
 = 1;

26 
ušt32_t
 
Next
() {

27 cÚ¡ 
ušt32_t
 
	gM
 = 2147483647L;

28 cÚ¡ 
ušt64_t
 
	gA
 = 16807;

35 
ušt64_t
 
	g´oduù
 = 
£ed_
 * 
A
;

38 
	g£ed_
 = 
¡©ic_ÿ¡
<
ušt32_t
>((
´oduù
 >> 31è+ (´oduù & 
M
));

42 ià(
	g£ed_
 > 
	gM
) {

43 
	g£ed_
 -ğ
M
;

45  
	g£ed_
;

49 
ušt32_t
 
UnifÜm
(
n
è{  
Next
(è% 
	gn
; }

53 
boŞ
 
OÃIn
(
n
è{  (
Next
(è% 
	gn
) == 0; }

58 
ušt32_t
 
Skewed
(
max_log
è{  
UnifÜm
(1 << Uniform(max_log + 1)); }

	@util/status.cc

5 
	~"Ëv–db/¡©us.h
"

7 
	~<¡dio.h
>

9 
	~"pÜt/pÜt.h
"

11 
Çme¥aû
 
	gËv–db
 {

13 cÚ¡ * 
	gStus
::
CİyS‹
(cÚ¡ * 
¡©e
) {

14 
ušt32_t
 
size
;

15 
memıy
(&
size
, 
¡©e
, (size));

16 * 
	g»suÉ
 = 
Ãw
 [
size
 + 5];

17 
memıy
(
»suÉ
, 
¡©e
, 
size
 + 5);

18  
	g»suÉ
;

21 
	gStus
::
Stus
(
Code
 
code
, cÚ¡ 
Sliû
& 
msg
, cÚ¡ Sliû& 
msg2
) {

22 
as£¹
(
code
 !ğ
kOk
);

23 cÚ¡ 
ušt32_t
 
	gËn1
 = 
msg
.
size
();

24 cÚ¡ 
ušt32_t
 
	gËn2
 = 
msg2
.
size
();

25 cÚ¡ 
ušt32_t
 
	gsize
 = 
Ën1
 + (
Ën2
 ? (2 +†en2) : 0);

26 * 
	g»suÉ
 = 
Ãw
 [
size
 + 5];

27 
memıy
(
»suÉ
, &
size
, (size));

28 
	g»suÉ
[4] = 
¡©ic_ÿ¡
<>(
code
);

29 
memıy
(
»suÉ
 + 5, 
msg
.
d©a
(), 
Ën1
);

30 ià(
	gËn2
) {

31 
	g»suÉ
[5 + 
Ën1
] = ':';

32 
	g»suÉ
[6 + 
Ën1
] = ' ';

33 
memıy
(
»suÉ
 + 7 + 
Ën1
, 
msg2
.
d©a
(), 
Ën2
);

35 
	g¡©e_
 = 
»suÉ
;

38 
	g¡d
::
¡ršg
 
Stus
::
ToSŒšg
() const {

39 ià(
¡©e_
 =ğ
nuÎ±r
) {

42 
	gtmp
[30];

43 cÚ¡ * 
	gty³
;

44 
code
()) {

45 
	gkOk
:

46 
ty³
 = "OK";

48 
	gkNÙFound
:

49 
ty³
 = "NotFound: ";

51 
	gkCÜru±iÚ
:

52 
ty³
 = "Corruption: ";

54 
	gkNÙSuµÜ‹d
:

55 
ty³
 = "Not implemented: ";

57 
	gkInv®idArgum’t
:

58 
ty³
 = "Invalid‡rgument: ";

60 
	gkIOE¼Ü
:

61 
ty³
 = "IOƒrror: ";

64 
¢´štf
(
tmp
, (tmp),

65 "UnknowÀcode(%d): ", 
¡©ic_ÿ¡
<>(
code
()));

66 
	gty³
 = 
tmp
;

69 
	g¡d
::
¡ršg
 
»suÉ
(
ty³
);

70 
ušt32_t
 
	gËngth
;

71 
memıy
(&
Ëngth
, 
¡©e_
, (length));

72 
	g»suÉ
.
­³nd
(
¡©e_
 + 5, 
Ëngth
);

73  
	g»suÉ
;

	@util/status_test.cc

5 
	~<ut™y
>

7 
	~"Ëv–db/¦iû.h
"

8 
	~"Ëv–db/¡©us.h
"

9 
	~"ut/‹¡h¬Ãss.h
"

11 
Çme¥aû
 
	gËv–db
 {

13 
TEST
(
Stus
, 
MoveCÚ¡ruùÜ
) {

15 
Stus
 
	gok
 = Stus::
OK
();

16 
Stus
 
	gok2
 = 
¡d
::
move
(
ok
);

18 
ASSERT_TRUE
(
ok2
.
ok
());

22 
Stus
 
	g¡©us
 = Stus::
NÙFound
("custom NotFound status message");

23 
Stus
 
	g¡©us2
 = 
¡d
::
move
(
¡©us
);

25 
ASSERT_TRUE
(
¡©us2
.
IsNÙFound
());

26 
ASSERT_EQ
("NÙFound: cu¡om NÙFound stu mes§ge", 
¡©us2
.
ToSŒšg
());

30 
Stus
 
	g£lf_moved
 = Stus::
IOE¼Ü
("custom IOError status message");

33 
	gStus
& 
	g£lf_moved_»ã»nû
 = 
£lf_moved
;

34 
	g£lf_moved_»ã»nû
 = 
¡d
::
move
(
£lf_moved
);

40 
	$maš
(
¬gc
, ** 
¬gv
è{  
Ëv–db
::
‹¡
::
	`RunAÎTe¡s
(); 
	}
}

	@util/testharness.cc

5 
	~"ut/‹¡h¬Ãss.h
"

7 
	~<¡dlib.h
>

8 
	~<sys/¡©.h
>

9 
	~<sys/ty³s.h
>

11 
	~<¡ršg
>

12 
	~<veùÜ
>

14 
	~"Ëv–db/’v.h
"

16 
Çme¥aû
 
	gËv–db
 {

17 
Çme¥aû
 
	g‹¡
 {

19 
	gÇme¥aû
 {

20 
	sTe¡
 {

21 cÚ¡ * 
	gba£
;

22 cÚ¡ * 
	gÇme
;

23 (*
	gfunc
)();

25 
	g¡d
::
veùÜ
<
Te¡
>* 
‹¡s
;

28 
boŞ
 
Regi¡”Te¡
(cÚ¡ * 
ba£
, cÚ¡ * 
Çme
, (*
func
)()) {

29 ià(
	g‹¡s
 =ğ
nuÎ±r
) {

30 
‹¡s
 = 
Ãw
 
¡d
::
veùÜ
<
Te¡
>;

32 
Te¡
 
	gt
;

33 
	gt
.
	gba£
 = 
ba£
;

34 
	gt
.
	gÇme
 = 
Çme
;

35 
	gt
.
	gfunc
 = 
func
;

36 
	g‹¡s
->
push_back
(
t
);

37  
	gŒue
;

40 
RunAÎTe¡s
() {

41 cÚ¡ * 
	gm©ch”
 = 
g‘’v
("LEVELDB_TESTS");

43 
	gnum
 = 0;

44 ià(
	g‹¡s
 !ğ
nuÎ±r
) {

45 
size_t
 
i
 = 0; 
	gi
 < 
	g‹¡s
->
size
(); i++) {

46 cÚ¡ 
	gTe¡
& 
	gt
 = (*
‹¡s
)[
i
];

47 ià(
	gm©ch”
 !ğ
nuÎ±r
) {

48 
¡d
::
¡ršg
 
Çme
 = 
t
.
ba£
;

49 
	gÇme
.
push_back
('.');

50 
	gÇme
.
­³nd
(
t
.
Çme
);

51 ià(
¡r¡r
(
Çme
.
c_¡r
(), 
m©ch”
è=ğ
nuÎ±r
) {

55 
årštf
(
¡d”r
, "===ğTe¡ %s.%s\n", 
t
.
ba£
,.
Çme
);

56 (*
	gt
.
	gfunc
)();

57 ++
	gnum
;

60 
årštf
(
¡d”r
, "===ğPASSED %de¡s\n", 
num
);

64 
	g¡d
::
¡ršg
 
TmpDœ
() {

65 
¡d
::
¡ršg
 
dœ
;

66 
Stus
 
	gs
 = 
Env
::
DeçuÉ
()->
G‘Te¡DœeùÜy
(&
dœ
);

67 
ASSERT_TRUE
(
s
.
ok
()è<< 
	gs
.
ToSŒšg
();

68  
	gdœ
;

71 
RªdomS“d
() {

72 cÚ¡ * 
	g’v
 = 
g‘’v
("TEST_RANDOM_SEED");

73 
	g»suÉ
 = (
’v
 !ğ
nuÎ±r
 ? 
©oi
(env) : 301);

74 ià(
	g»suÉ
 <= 0) {

75 
»suÉ
 = 301;

77  
	g»suÉ
;

	@util/testharness.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_TESTHARNESS_H_


6 
	#STORAGE_LEVELDB_UTIL_TESTHARNESS_H_


	)

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

11 
	~<s¡»am
>

13 
	~"Ëv–db/¡©us.h
"

15 
Çme¥aû
 
	gËv–db
 {

16 
Çme¥aû
 
	g‹¡
 {

30 
RunAÎTe¡s
();

33 
	g¡d
::
¡ršg
 
TmpDœ
();

38 
RªdomS“d
();

42 şas 
	cTe¡”
 {

43 
	g´iv©e
:

44 
boŞ
 
ok_
;

45 cÚ¡ * 
	gâame_
;

46 
	glše_
;

47 
	g¡d
::
¡ršg¡»am
 
ss_
;

49 
	gpublic
:

50 
Te¡”
(cÚ¡ * 
f
, 
l
è: 
ok_
(
Œue
), 
âame_
(f), 
lše_
(l) {}

52 ~
Te¡”
() {

53 ià(!
	gok_
) {

54 
årštf
(
¡d”r
, "%s:%d:%s\n", 
âame_
, 
lše_
, 
ss_
.
¡r
().
c_¡r
());

55 
ex™
(1);

59 
	gTe¡”
& 
Is
(
boŞ
 
b
, cÚ¡ * 
msg
) {

60 ià(!
	gb
) {

61 
	gss_
 << " As£¹iÚ fau» " << 
	gmsg
;

62 
	gok_
 = 
çl£
;

64  *
	gthis
;

67 
	gTe¡”
& 
IsOk
(cÚ¡ 
Stus
& 
s
) {

68 ià(!
	gs
.
ok
()) {

69 
	gss_
 << " " << 
	gs
.
ToSŒšg
();

70 
	gok_
 = 
çl£
;

72  *
	gthis
;

75 
	#BINARY_OP
(
Çme
, 
İ
) \

76 
‹m¶©e
 <
şass
 
X
, cÏs 
Y
> \

77 
Te¡”
& 
	`Çme
(cÚ¡ 
X
& 
x
, cÚ¡ 
Y
& 
y
) { \

78 ià(!(
x
 
İ
 
y
)) { \

79 
ss_
 << " faed: " << 
x
 << (" " #İ " "è<< 
y
; \

80 
ok_
 = 
çl£
; \

82  *
this
; \

83 }

	)

85 
BINARY_OP
(
IsEq
, ==)

86 
BINARY_OP
(
IsNe
, !=)

87 
BINARY_OP
(
IsGe
, >=)

88 
BINARY_OP
(
IsGt
, >)

89 
BINARY_OP
(
IsLe
, <=)

90 
BINARY_OP
(
IsLt
, <)

91 #undeà
BINARY_OP


94 
	g‹m¶©e
 <
şass
 
	gV
>

95 
	gTe¡”
& 
	gİ”©Ü
<<(cÚ¡ 
	gV
& 
	gv®ue
) {

96 ià(!
	gok_
) {

97 
	gss_
 << " " << 
	gv®ue
;

99  *
	gthis
;

103 
	#ASSERT_TRUE
(
c
è::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`Is
((c), #c)

	)

104 
	#ASSERT_OK
(
s
è::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`IsOk
((s))

	)

105 
	#ASSERT_EQ
(
a
, 
b
) \

106 ::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`IsEq
((
a
), (
b
))

	)

107 
	#ASSERT_NE
(
a
, 
b
) \

108 ::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`IsNe
((
a
), (
b
))

	)

109 
	#ASSERT_GE
(
a
, 
b
) \

110 ::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`IsGe
((
a
), (
b
))

	)

111 
	#ASSERT_GT
(
a
, 
b
) \

112 ::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`IsGt
((
a
), (
b
))

	)

113 
	#ASSERT_LE
(
a
, 
b
) \

114 ::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`IsLe
((
a
), (
b
))

	)

115 
	#ASSERT_LT
(
a
, 
b
) \

116 ::
Ëv–db
::
‹¡
::
	`Te¡”
(
__FILE__
, 
__LINE__
).
	`IsLt
((
a
), (
b
))

	)

118 
	#TCONCAT
(
a
, 
b
è
	`TCONCAT1
×, b)

	)

119 
	#TCONCAT1
(
a
, 
b
èa##
	)
b

121 
	#TEST
(
ba£
, 
Çme
) \

122 
şass
 
	`TCONCAT
(
_Te¡_
, 
Çme
è: 
public
 
ba£
 { \

123 
public
: \

124 
	`_Run
(); \

125 
	`_RunIt
() { \

126 
	`TCONCAT
(
_Te¡_
, 
Çme
è
t
; \

127 
t
.
	`_Run
(); \

130 
boŞ
 
	`TCONCAT
(
_Te¡_ignÜed_
, 
Çme
èğ::
Ëv–db
::
‹¡
::
	`Regi¡”Te¡
( \

131 #ba£, #Çme, &
	`TCONCAT
(
_Te¡_
, 
Çme
)::
_RunIt
); \

132 
	`TCONCAT
(
_Te¡_
, 
Çme
)::
	`_Run
()

	)

136 
boŞ
 
Regi¡”Te¡
(cÚ¡ * 
ba£
, cÚ¡ * 
Çme
, (*
func
)());

	@util/testutil.cc

5 
	~"ut/‹¡ut.h
"

7 
	~"ut/¿ndom.h
"

9 
Çme¥aû
 
	gËv–db
 {

10 
Çme¥aû
 
	g‹¡
 {

12 
Sliû
 
RªdomSŒšg
(
Rªdom
* 
ºd
, 
Ën
, 
¡d
::
¡ršg
* 
d¡
) {

13 
d¡
->
»size
(
Ën
);

14 
	gi
 = 0; i < 
	gËn
; i++) {

15 (*
	gd¡
)[
i
] = 
¡©ic_ÿ¡
<>(' ' + 
ºd
->
UnifÜm
(95));

17  
Sliû
(*
d¡
);

20 
	g¡d
::
¡ršg
 
RªdomKey
(
Rªdom
* 
ºd
, 
Ën
) {

23 cÚ¡ 
	gkTe¡Ch¬s
[] = {'\0', '\1', 'a', 'b', 'c',

25 
	g¡d
::
¡ršg
 
»suÉ
;

26 
	gi
 = 0; i < 
	gËn
; i++) {

27 
	g»suÉ
 +ğ
kTe¡Ch¬s
[
ºd
->
UnifÜm
((kTestChars))];

29  
	g»suÉ
;

32 
Sliû
 
Com´essibËSŒšg
(
Rªdom
* 
ºd
, 
com´es£d_äaùiÚ
, 
size_t
 
Ën
,

33 
¡d
::
¡ršg
* 
d¡
) {

34 
¿w
 = 
¡©ic_ÿ¡
<>(
Ën
 * 
com´es£d_äaùiÚ
);

35 ià(
	g¿w
 < 1)„aw = 1;

36 
	g¡d
::
¡ršg
 
¿w_d©a
;

37 
RªdomSŒšg
(
ºd
, 
¿w
, &
¿w_d©a
);

40 
	gd¡
->
ş—r
();

41 
	gd¡
->
size
(è< 
	gËn
) {

42 
	gd¡
->
­³nd
(
¿w_d©a
);

44 
	gd¡
->
»size
(
Ën
);

45  
Sliû
(*
d¡
);

	@util/testutil.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_TESTUTIL_H_


6 
	#STORAGE_LEVELDB_UTIL_TESTUTIL_H_


	)

8 
	~"h–³rs/mem’v/mem’v.h
"

9 
	~"Ëv–db/’v.h
"

10 
	~"Ëv–db/¦iû.h
"

11 
	~"ut/¿ndom.h
"

13 
Çme¥aû
 
	gËv–db
 {

14 
Çme¥aû
 
	g‹¡
 {

18 
Sliû
 
RªdomSŒšg
(
Rªdom
* 
ºd
, 
Ën
, 
¡d
::
¡ršg
* 
d¡
);

22 
	g¡d
::
¡ršg
 
RªdomKey
(
Rªdom
* 
ºd
, 
Ën
);

27 
Sliû
 
Com´essibËSŒšg
(
Rªdom
* 
ºd
, 
com´es£d_äaùiÚ
, 
size_t
 
Ën
,

28 
¡d
::
¡ršg
* 
d¡
);

31 şas 
	cE¼ÜEnv
 : 
public
 
EnvW¿µ”
 {

32 
public
:

33 
boŞ
 
wr™abË_fe_”rÜ_
;

34 
	gnum_wr™abË_fe_”rÜs_
;

36 
E¼ÜEnv
()

37 : 
EnvW¿µ”
(
NewMemEnv
(
Env
::
DeçuÉ
())),

38 
wr™abË_fe_”rÜ_
(
çl£
),

39 
num_wr™abË_fe_”rÜs_
(0) {}

40 ~
E¼ÜEnv
(è
	gov”ride
 { 
d–‘e
 
rg‘
(); }

42 
Stus
 
NewWr™abËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

43 
Wr™abËFe
** 
»suÉ
è
	gov”ride
 {

44 ià(
	gwr™abË_fe_”rÜ_
) {

45 ++
	gnum_wr™abË_fe_”rÜs_
;

46 *
	g»suÉ
 = 
nuÎ±r
;

47  
	gStus
::
IOE¼Ü
(
âame
, "fakeƒrror");

49  
rg‘
()->
NewWr™abËFe
(
âame
, 
»suÉ
);

52 
Stus
 
NewAµ’dabËFe
(cÚ¡ 
¡d
::
¡ršg
& 
âame
,

53 
Wr™abËFe
** 
»suÉ
è
	gov”ride
 {

54 ià(
	gwr™abË_fe_”rÜ_
) {

55 ++
	gnum_wr™abË_fe_”rÜs_
;

56 *
	g»suÉ
 = 
nuÎ±r
;

57  
	gStus
::
IOE¼Ü
(
âame
, "fakeƒrror");

59  
rg‘
()->
NewAµ’dabËFe
(
âame
, 
»suÉ
);

	@util/windows_logger.h

7 #iâdeà
STORAGE_LEVELDB_UTIL_WINDOWS_LOGGER_H_


8 
	#STORAGE_LEVELDB_UTIL_WINDOWS_LOGGER_H_


	)

10 
	~<ÿs£¹
>

11 
	~<c¡d¬g
>

12 
	~<c¡dio
>

13 
	~<ùime
>

14 
	~<s¡»am
>

15 
	~<th»ad
>

17 
	~"Ëv–db/’v.h
"

19 
Çme¥aû
 
	gËv–db
 {

21 şas 
	cWšdowsLogg”
 
	gfš®
 : 
public
 
Logg”
 {

22 
public
:

26 
ex¶ic™
 
WšdowsLogg”
(
¡d
::
FILE
* 
å
è: 
å_
(åè{ 
as£¹
(å !ğ
nuÎ±r
); }

28 ~
WšdowsLogg”
(è
	gov”ride
 { 
	g¡d
::
fşo£
(
å_
); }

30 
Logv
(cÚ¡ * 
fÜm©
, 
va_li¡
 
¬gum’ts
è
	gov”ride
 {

32 
SYSTEMTIME
 
	gnow_compÚ’ts
;

33 ::
G‘LoÿlTime
(&
now_compÚ’ts
);

36 
cÚ¡ex´
 cÚ¡ 
	gkMaxTh»adIdSize
 = 32;

37 
	g¡d
::
o¡ršg¡»am
 
th»ad_¡»am
;

38 
	gth»ad_¡»am
 << 
	g¡d
::
this_th»ad
::
g‘_id
();

39 
	g¡d
::
¡ršg
 
th»ad_id
 = 
th»ad_¡»am
.
¡r
();

40 ià(
	gth»ad_id
.
size
(è> 
	gkMaxTh»adIdSize
) {

41 
	gth»ad_id
.
»size
(
kMaxTh»adIdSize
);

46 
cÚ¡ex´
 cÚ¡ 
	gkSckBufãrSize
 = 512;

47 
	g¡ack_bufãr
[
kSckBufãrSize
];

48 
¡©ic_as£¹
((
¡ack_bufãr
è=ğ
¡©ic_ÿ¡
<
size_t
>(
kSckBufãrSize
),

51 
	gdyÇmic_bufãr_size
 = 0;

52 
	g™”©iÚ
 = 0; iteration < 2; ++iteration) {

53 cÚ¡ 
	gbufãr_size
 =

54 (
™”©iÚ
 =ğ0è? 
kSckBufãrSize
 : 
dyÇmic_bufãr_size
;

55 * cÚ¡ 
	gbufãr
 =

56 (
™”©iÚ
 =ğ0è? 
¡ack_bufãr
 : 
Ãw
 [
dyÇmic_bufãr_size
];

59 
	gbufãr_off£t
 = 
¢´štf
(

60 
bufãr
, 
bufãr_size
, "%04d/%02d/%02d-%02d:%02d:%02d.%06d %s ",

61 
now_compÚ’ts
.
wY—r
,‚ow_compÚ’ts.
wMÚth
,‚ow_compÚ’ts.
wDay
,

62 
now_compÚ’ts
.
wHour
,‚ow_compÚ’ts.
wMšu‹
,‚ow_compÚ’ts.
wSecÚd
,

63 
¡©ic_ÿ¡
<>(
now_compÚ’ts
.
wMli£cÚds
 * 1000),

64 
th»ad_id
.
c_¡r
());

69 
as£¹
(
bufãr_off£t
 <ğ28 + 
kMaxTh»adIdSize
);

70 
¡©ic_as£¹
(28 + 
kMaxTh»adIdSize
 < 
kSckBufãrSize
,

72 
as£¹
(
bufãr_off£t
 < 
bufãr_size
);

75 
	g¡d
::
va_li¡
 
¬gum’ts_cİy
;

76 
va_cİy
(
¬gum’ts_cİy
, 
¬gum’ts
);

77 
	gbufãr_off£t
 +=

78 
¡d
::
v¢´štf
(
bufãr
 + 
bufãr_off£t
, 
bufãr_size
 - buffer_offset,

79 
fÜm©
, 
¬gum’ts_cİy
);

80 
va_’d
(
¬gum’ts_cİy
);

84 ià(
	gbufãr_off£t
 >ğ
bufãr_size
 - 1) {

86 ià(
™”©iÚ
 == 0) {

90 
dyÇmic_bufãr_size
 = 
bufãr_off£t
 + 2;

97 
as£¹
(
çl£
);

98 
	gbufãr_off£t
 = 
bufãr_size
 - 1;

102 ià(
	gbufãr
[
bufãr_off£t
 - 1] != '\n') {

103 
bufãr
[
bufãr_off£t
] = '\n';

104 ++
	gbufãr_off£t
;

107 
as£¹
(
bufãr_off£t
 <ğ
bufãr_size
);

108 
	g¡d
::
fwr™e
(
bufãr
, 1, 
bufãr_off£t
, 
å_
);

109 
	g¡d
::
fæush
(
å_
);

111 ià(
	g™”©iÚ
 != 0) {

112 
d–‘e
[] 
bufãr
;

118 
	g´iv©e
:

119 
¡d
::
FILE
* cÚ¡ 
å_
;

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


91 #ià
defšed
 
__ılu¥lus


92 
	#as£¹
(
ex´
) \

93 (
¡©ic_ÿ¡
 <
boŞ
> (
ex´
) \

95 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

96 #–ià!
defšed
 
__GNUC__
 || defšed 
__STRICT_ANSI__


97 
	#as£¹
(
ex´
) \

98 ((
ex´
) \

99 ? 
	`__ASSERT_VOID_CAST
 (0) \

100 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

107 
	#as£¹
(
ex´
) \

108 ((è ((
ex´
è? 1 : 0), 
	`__ex‹nsiÚ__
 ({ \

109 ià(
ex´
) \

112 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
); \

113 
	}
}))

	)

116 #ifdef 
__USE_GNU


117 
	#as£¹_³¼Ü
(
”ºum
) \

118 (!(
”ºum
) \

119 ? 
	`__ASSERT_VOID_CAST
 (0) \

120 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

128 #ià
defšed
 
__ılu¥lus
 ? 
__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

129 
	#__ASSERT_FUNCTION
 
__ex‹nsiÚ__
 
__PRETTY_FUNCTION__


	)

131 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

132 
	#__ASSERT_FUNCTION
 
__func__


	)

134 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

141 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


142 #undeà
¡©ic_as£¹


143 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

108 
__exùy³
 (
i§Êum
);

109 
__exùy³
 (
i§Íha
);

110 
__exùy³
 (
isúŒl
);

111 
__exùy³
 (
isdig™
);

112 
__exùy³
 (
i¦ow”
);

113 
__exùy³
 (
isg¿ph
);

114 
__exùy³
 (
i¥ršt
);

115 
__exùy³
 (
i¥unù
);

116 
__exùy³
 (
is¥aû
);

117 
__exùy³
 (
isuµ”
);

118 
__exùy³
 (
isxdig™
);

122 
	$tŞow”
 (
__c
è
__THROW
;

125 
	$touµ”
 (
__c
è
__THROW
;

129 #ifdef 
__USE_ISOC99


130 
	`__exùy³
 (
isbÏnk
);

133 #ifdeà
__USE_GNU


135 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

138 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


142 
	$i§scii
 (
__c
è
__THROW
;

146 
	$tßscii
 (
__c
è
__THROW
;

150 
	`__exùy³
 (
_touµ”
);

151 
	`__exùy³
 (
_tŞow”
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

156 (
__ex‹nsiÚ__
 \

157 ({ 
__»s
; \

158 ià( (
c
) > 1) \

160 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

166 
__»s
 = 
f
 
¬gs
; \

169 
__»s
 = (
a
)[(è(
c
)]; \

170 
__»s
; 
	}
}))

	)

172 #ià!
defšed
 
__NO_CTYPE


173 #ifdeà
__isùy³_f


174 
	$__isùy³_f
 (
®num
)

175 
	$__isùy³_f
 (
®pha
)

176 
	$__isùy³_f
 (
úŒl
)

177 
	$__isùy³_f
 (
dig™
)

178 
	$__isùy³_f
 (
low”
)

179 
	$__isùy³_f
 (
g¿ph
)

180 
	$__isùy³_f
 (
´št
)

181 
	$__isùy³_f
 (
punù
)

182 
	$__isùy³_f
 (
¥aû
)

183 
	$__isùy³_f
 (
uµ”
)

184 
	$__isùy³_f
 (
xdig™
)

185 #ifdeà
__USE_ISOC99


186 
	$__isùy³_f
 (
bÏnk
)

188 #–ià
defšed
 
__isùy³


189 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

190 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

191 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

192 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

193 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

194 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

195 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

196 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

197 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

198 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

199 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

200 #ifdeà
__USE_ISOC99


201 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

205 #ifdeà
__USE_EXTERN_INLINES


206 
__ex‹º_šlše
 

207 
	`__NTH
 (
	$tŞow”
 (
__c
))

209  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

210 
	}
}

212 
__ex‹º_šlše
 

213 
__NTH
 (
	$touµ”
 (
__c
))

215  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

216 
	}
}

219 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


220 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

221 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

224 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


225 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

226 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

228 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

229 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

235 #ifdeà
__USE_XOPEN2K8


237 
	~<b™s/ty³s/loÿË_t.h
>

241 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

242 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

244 
	#__exùy³_l
(
Çme
) \

245 
	`Çme
 (, 
loÿË_t
è
__THROW


	)

251 
__exùy³_l
 (
i§Êum_l
);

252 
__exùy³_l
 (
i§Íha_l
);

253 
__exùy³_l
 (
isúŒl_l
);

254 
__exùy³_l
 (
isdig™_l
);

255 
__exùy³_l
 (
i¦ow”_l
);

256 
__exùy³_l
 (
isg¿ph_l
);

257 
__exùy³_l
 (
i¥ršt_l
);

258 
__exùy³_l
 (
i¥unù_l
);

259 
__exùy³_l
 (
is¥aû_l
);

260 
__exùy³_l
 (
isuµ”_l
);

261 
__exùy³_l
 (
isxdig™_l
);

263 
__exùy³_l
 (
isbÏnk_l
);

267 
	$__tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

268 
	$tŞow”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

271 
	$__touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

272 
	$touµ”_l
 (
__c
, 
loÿË_t
 
__l
è
__THROW
;

274 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


275 
	#__tŞow”_l
(
c
, 
loÿË
) \

276 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

277 
	#__touµ”_l
(
c
, 
loÿË
) \

278 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

279 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

280 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

284 #iâdeà
__NO_CTYPE


285 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

286 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

287 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

288 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

289 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

290 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

291 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

292 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

293 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

294 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

295 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

297 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

299 #ifdeà
__USE_MISC


300 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

301 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

304 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

305 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

306 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

307 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

308 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

309 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

310 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

311 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

312 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

313 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

314 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

316 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

318 #ifdeà
__USE_MISC


319 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

320 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

327 
__END_DECLS


	@/usr/include/dirent.h

22 #iâdef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdeà
__USE_XOPEN


32 #iâdeà
__šo_t_defšed


33 #iâdeà
__USE_FILE_OFFSET64


34 
__šo_t
 
	tšo_t
;

36 
__šo64_t
 
	tšo_t
;

38 
	#__šo_t_defšed


	)

40 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


41 
__šo64_t
 
	tšo64_t
;

42 
	#__šo64_t_defšed


	)

61 
	~<b™s/dœ’t.h
>

63 #ià
defšed
 
__USE_MISC
 && !defšed 
d_f’o


64 
	#d_šo
 
d_f’o


	)

81 #ifdeà
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

86 #ifdeà
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

95 #ifdeà
__USE_MISC


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

121 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

127 
__dœ¡»am
 
	tDIR
;

134 
DIR
 *
	$İ’dœ
 (cÚ¡ *
__Çme
è
	`__nÚnuÎ
 ((1));

136 #ifdeà
__USE_XOPEN2K8


141 
DIR
 *
	`fdİ’dœ
 (
__fd
);

149 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

161 #iâdeà
__USE_FILE_OFFSET64


162 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

164 #ifdeà
__REDIRECT


165 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

166 
	`__nÚnuÎ
 ((1));

168 
	#»addœ
 
»addœ64


	)

172 #ifdeà
__USE_LARGEFILE64


173 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

176 #ifdeà
__USE_POSIX


182 #iâdeà
__USE_FILE_OFFSET64


183 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

184 
dœ’t
 *
__»¡riù
 
__’Œy
,

185 
dœ’t
 **
__»¡riù
 
__»suÉ
)

186 
	`__nÚnuÎ
 ((1, 2, 3)è
__©Œibu‹_d•»ÿ‹d__
;

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
»addœ_r
,

190 (
DIR
 *
__»¡riù
 
__dœp
,

191 
dœ’t
 *
__»¡riù
 
__’Œy
,

192 
dœ’t
 **
__»¡riù
 
__»suÉ
),

193 
»addœ64_r
)

194 
	`__nÚnuÎ
 ((1, 2, 3)è
__©Œibu‹_d•»ÿ‹d__
;

196 
	#»addœ_r
 
»addœ64_r


	)

200 #ifdeà
__USE_LARGEFILE64


201 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

202 
dœ’t64
 *
__»¡riù
 
__’Œy
,

203 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

204 
	`__nÚnuÎ
 ((1, 2, 3)è
__©Œibu‹_d•»ÿ‹d__
;

209 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


212 
	~<b™s/ty³s.h
>

215 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 #ifdeà
__USE_XOPEN2K8


224 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

226 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


227 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

230 #ifdeà
__USE_MISC


231 #iâdeà
MAXNAMLEN


233 
	~<b™s/posix1_lim.h
>

236 #ifdeà
NAME_MAX


237 
	#MAXNAMLEN
 
NAME_MAX


	)

239 
	#MAXNAMLEN
 255

	)

244 
	#__Ãed_size_t


	)

245 
	~<¡ddef.h
>

254 #iâdeà
__USE_FILE_OFFSET64


255 
	$sÿndœ
 (cÚ¡ *
__»¡riù
 
__dœ
,

256 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

257 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

258 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

259 cÚ¡ 
dœ’t
 **))

260 
	`__nÚnuÎ
 ((1, 2));

262 #ifdeà
__REDIRECT


263 
	`__REDIRECT
 (
sÿndœ
,

264 (cÚ¡ *
__»¡riù
 
__dœ
,

265 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

266 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

267 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

268 cÚ¡ 
dœ’t
 **)),

269 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

271 
	#sÿndœ
 
sÿndœ64


	)

275 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


278 
	$sÿndœ64
 (cÚ¡ *
__»¡riù
 
__dœ
,

279 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

280 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

281 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

282 cÚ¡ 
dœ’t64
 **))

283 
	`__nÚnuÎ
 ((1, 2));

286 #ifdeà
__USE_GNU


292 #iâdeà
__USE_FILE_OFFSET64


293 
	$sÿndœ©
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

294 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

295 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

296 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

297 cÚ¡ 
dœ’t
 **))

298 
	`__nÚnuÎ
 ((2, 3));

300 #ifdeà
__REDIRECT


301 
	`__REDIRECT
 (
sÿndœ©
,

302 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

303 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

304 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

305 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

306 cÚ¡ 
dœ’t
 **)),

307 
sÿndœ©64
è
	`__nÚnuÎ
 ((2, 3));

309 
	#sÿndœ©
 
sÿndœ©64


	)

315 
	$sÿndœ©64
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

316 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

317 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

318 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

319 cÚ¡ 
dœ’t64
 **))

320 
	`__nÚnuÎ
 ((2, 3));

324 #iâdeà
__USE_FILE_OFFSET64


325 
	$®phasÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

326 cÚ¡ 
dœ’t
 **
__e2
)

327 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

329 #ifdeà
__REDIRECT


330 
	`__REDIRECT_NTH
 (
®phasÜt
,

331 (cÚ¡ 
dœ’t
 **
__e1
,

332 cÚ¡ 
dœ’t
 **
__e2
),

333 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 
	#®phasÜt
 
®phasÜt64


	)

339 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


340 
	$®phasÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

341 cÚ¡ 
dœ’t64
 **
__e2
)

342 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

347 #ifdeà
__USE_MISC


352 #iâdeà
__USE_FILE_OFFSET64


353 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

354 
size_t
 
__nby‹s
,

355 
__off_t
 *
__»¡riù
 
__ba£p
)

356 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

358 #ifdeà
__REDIRECT


359 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

360 (
__fd
, *
__»¡riù
 
__buf
,

361 
size_t
 
__nby‹s
,

362 
__off64_t
 *
__»¡riù
 
__ba£p
),

363 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

365 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

369 #ifdeà
__USE_LARGEFILE64


370 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

371 
size_t
 
__nby‹s
,

372 
__off64_t
 *
__»¡riù
 
__ba£p
)

373 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

377 #ifdeà
__USE_GNU


379 #iâdeà
__USE_FILE_OFFSET64


380 
	$v”siÚsÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

381 cÚ¡ 
dœ’t
 **
__e2
)

382 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

384 #ifdeà
__REDIRECT


385 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

386 (cÚ¡ 
dœ’t
 **
__e1
,

387 cÚ¡ 
dœ’t
 **
__e2
),

388 
v”siÚsÜt64
)

389 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

391 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

395 #ifdeà
__USE_LARGEFILE64


396 
	$v”siÚsÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

397 cÚ¡ 
dœ’t64
 **
__e2
)

398 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

402 
__END_DECLS


	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


23 
	#_ERRNO_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/”ºo.h
>

32 #iâdeà
__ASSEMBLER__


34 
__BEGIN_DECLS


37 *
	$__”ºo_loÿtiÚ
 (è
__THROW
 
__©Œibu‹_cÚ¡__
;

38 
	#”ºo
 (*
	`__”ºo_loÿtiÚ
 ())

	)

40 #ifdeà
__USE_GNU


45 *
´og¿m_švoÿtiÚ_Çme
;

46 *
´og¿m_švoÿtiÚ_shÜt_Çme
;

50 #iâdeà
__”rÜ_t_defšed


51 
	#__”rÜ_t_defšed
 1

	)

52 
	t”rÜ_t
;

57 
__END_DECLS


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

39 #ifdeà
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oæag
) \

41 (((
oæag
è& 
O_CREAT
è!ğ0 || ((oæagè& 
__O_TMPFILE
è=ğ__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oæag
è(((oæagè& 
O_CREAT
è!ğ0)

	)

49 #iâdeà
__mode_t_defšed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_defšed


	)

54 #iâdeà
__off_t_defšed


55 #iâdeà
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

68 #iâdeà
__pid_t_defšed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_defšed


	)

74 #ifdeà
__USE_XOPEN2K8


75 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

77 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


78 
	~<b™s/¡©.h
>

80 
	#S_IFMT
 
__S_IFMT


	)

81 
	#S_IFDIR
 
__S_IFDIR


	)

82 
	#S_IFCHR
 
__S_IFCHR


	)

83 
	#S_IFBLK
 
__S_IFBLK


	)

84 
	#S_IFREG
 
__S_IFREG


	)

85 #ifdeà
__S_IFIFO


86 
	#S_IFIFO
 
__S_IFIFO


	)

88 #ifdeà
__S_IFLNK


89 
	#S_IFLNK
 
__S_IFLNK


	)

91 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


92 
	#S_IFSOCK
 
__S_IFSOCK


	)

97 
	#S_ISUID
 
__S_ISUID


	)

98 
	#S_ISGID
 
__S_ISGID


	)

100 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


102 
	#S_ISVTX
 
__S_ISVTX


	)

105 
	#S_IRUSR
 
__S_IREAD


	)

106 
	#S_IWUSR
 
__S_IWRITE


	)

107 
	#S_IXUSR
 
__S_IEXEC


	)

109 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

111 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

112 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

113 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

115 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

117 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

118 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

119 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

121 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

124 #ifdef 
__USE_MISC


125 #iâdeà
R_OK


128 
	#R_OK
 4

	)

129 
	#W_OK
 2

	)

130 
	#X_OK
 1

	)

131 
	#F_OK
 0

	)

136 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


137 
	#SEEK_SET
 0

	)

138 
	#SEEK_CUR
 1

	)

139 
	#SEEK_END
 2

	)

147 
fú
 (
__fd
, 
__cmd
, ...);

156 #iâdeà
__USE_FILE_OFFSET64


157 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__REDIRECT


160 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

161 
	`__nÚnuÎ
 ((1));

163 
	#İ’
 
İ’64


	)

166 #ifdeà
__USE_LARGEFILE64


167 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

170 #ifdeà
__USE_ATFILE


180 #iâdeà
__USE_FILE_OFFSET64


181 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

184 #ifdeà
__REDIRECT


185 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

186 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

188 
	#İ’©
 
İ’©64


	)

191 #ifdeà
__USE_LARGEFILE64


192 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

193 
	`__nÚnuÎ
 ((2));

202 #iâdeà
__USE_FILE_OFFSET64


203 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ifdeà
__REDIRECT


206 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

207 
ü—t64
è
	`__nÚnuÎ
 ((1));

209 
	#ü—t
 
ü—t64


	)

212 #ifdeà
__USE_LARGEFILE64


213 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

216 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

217 && !
defšed
 
__USE_POSIX
))

226 
	#F_ULOCK
 0

	)

227 
	#F_LOCK
 1

	)

228 
	#F_TLOCK
 2

	)

229 
	#F_TEST
 3

	)

231 #iâdeà
__USE_FILE_OFFSET64


232 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

234 #ifdeà
__REDIRECT


235 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

237 
	#lockf
 
lockf64


	)

240 #ifdeà
__USE_LARGEFILE64


241 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

245 #ifdeà
__USE_XOPEN2K


248 #iâdeà
__USE_FILE_OFFSET64


249 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

250 
__advi£
è
__THROW
;

252 #ifdeà
__REDIRECT_NTH


253 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

254 
__off64_t
 
__Ën
, 
__advi£
),

255 
posix_çdvi£64
);

257 
	#posix_çdvi£
 
posix_çdvi£64


	)

260 #ifdeà
__USE_LARGEFILE64


261 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

262 
__advi£
è
__THROW
;

270 #iâdeà
__USE_FILE_OFFSET64


271 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

273 #ifdeà
__REDIRECT


274 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

275 
__off64_t
 
__Ën
),

276 
posix_çÎoÿ‹64
);

278 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

281 #ifdeà
__USE_LARGEFILE64


282 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

288 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

289 && 
defšed
 
__va_¬g_·ck_Ën


290 
	~<b™s/fú2.h
>

293 
__END_DECLS


	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 #ià
defšed
 
log
 && defšed 
__GNUC__


30 #w¬nšg 
A
 
maüo
 
ÿÎed
 
log
 
was
 
®»ady
 
defšed
 
wh’
 <
m©h
.
h
> wa 
šşuded
.

31 #w¬nšg 
This
 
wl
 
ÿu£
 
comp©iÚ
 
´obËms
.

34 
	g__BEGIN_DECLS


37 
	~<b™s/ty³s.h
>

40 
	~<b™s/m©h-veùÜ.h
>

43 
	~<b™s/æßŠ.h
>

47 #ià
__GNUC_PREREQ
 (3, 3)

48 
	#HUGE_VAL
 (
	`__butš_huge_v®
 ())

	)

55 
	#HUGE_VAL
 1e10000

	)

57 #ifdeà
__USE_ISOC99


58 #ià
__GNUC_PREREQ
 (3, 3)

59 
	#HUGE_VALF
 (
	`__butš_huge_v®f
 ())

	)

60 
	#HUGE_VALL
 (
	`__butš_huge_v®l
 ())

	)

62 
	#HUGE_VALF
 1e10000f

	)

63 
	#HUGE_VALL
 1e10000L

	)

66 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

67 
	#HUGE_VAL_F16
 (
	`__butš_huge_v®f16
 ())

	)

69 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

70 
	#HUGE_VAL_F32
 (
	`__butš_huge_v®f32
 ())

	)

72 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

73 
	#HUGE_VAL_F64
 (
	`__butš_huge_v®f64
 ())

	)

75 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

76 
	#HUGE_VAL_F128
 (
	`__butš_huge_v®f128
 ())

	)

78 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

79 
	#HUGE_VAL_F32X
 (
	`__butš_huge_v®f32x
 ())

	)

81 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

82 
	#HUGE_VAL_F64X
 (
	`__butš_huge_v®f64x
 ())

	)

84 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

85 
	#HUGE_VAL_F128X
 (
	`__butš_huge_v®f128x
 ())

	)

88 #ifdeà
__USE_ISOC99


90 #ià
__GNUC_PREREQ
 (3, 3)

91 
	#INFINITY
 (
	`__butš_šff
 ())

	)

93 
	#INFINITY
 
HUGE_VALF


	)

97 #ià
__GNUC_PREREQ
 (3, 3)

98 
	#NAN
 (
	`__butš_Çnf
 (""))

	)

103 
	#NAN
 (0.0à/ 0.0f)

	)

107 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

109 #ià
__GNUC_PREREQ
 (3, 3)

110 
	#SNANF
 (
	`__butš_Çnsf
 (""))

	)

111 
	#SNAN
 (
	`__butš_Çns
 (""))

	)

112 
	#SNANL
 (
	`__butš_Çn¦
 (""))

	)

115 #ià
__HAVE_FLOAT16
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

116 
	#SNANF16
 (
	`__butš_Çnsf16
 (""))

	)

118 #ià
__HAVE_FLOAT32
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

119 
	#SNANF32
 (
	`__butš_Çnsf32
 (""))

	)

121 #ià
__HAVE_FLOAT64
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

122 
	#SNANF64
 (
	`__butš_Çnsf64
 (""))

	)

124 #ià
__HAVE_FLOAT128
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

125 
	#SNANF128
 (
	`__butš_Çnsf128
 (""))

	)

127 #ià
__HAVE_FLOAT32X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

128 
	#SNANF32X
 (
	`__butš_Çnsf32x
 (""))

	)

130 #ià
__HAVE_FLOAT64X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

131 
	#SNANF64X
 (
	`__butš_Çnsf64x
 (""))

	)

133 #ià
__HAVE_FLOAT128X
 && 
__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
	#SNANF128X
 (
	`__butš_Çnsf128x
 (""))

	)

138 
	~<b™s/æt-ev®-m‘hod.h
>

140 #ifdeà
__USE_ISOC99


148 #ià
__GLIBC_FLT_EVAL_METHOD
 == 0 || __GLIBC_FLT_EVAL_METHOD == 16

149 
	tæßt_t
;

150 
	tdoubË_t
;

151 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 1

152 
	tæßt_t
;

153 
	tdoubË_t
;

154 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 2

155 
	tæßt_t
;

156 
	tdoubË_t
;

157 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 32

158 
_Flßt32
 
	tæßt_t
;

159 
	tdoubË_t
;

160 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 33

161 
_Flßt32x
 
	tæßt_t
;

162 
_Flßt32x
 
	tdoubË_t
;

163 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 64

164 
_Flßt64
 
	tæßt_t
;

165 
_Flßt64
 
	tdoubË_t
;

166 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 65

167 
_Flßt64x
 
	tæßt_t
;

168 
_Flßt64x
 
	tdoubË_t
;

169 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 128

170 
_Flßt128
 
	tæßt_t
;

171 
_Flßt128
 
	tdoubË_t
;

172 #–ià
__GLIBC_FLT_EVAL_METHOD
 == 129

173 
_Flßt128x
 
	tæßt_t
;

174 
_Flßt128x
 
	tdoubË_t
;

190 
	~<b™s/å-logb.h
>

191 #ifdeà
__USE_ISOC99


192 #ià
__FP_LOGB0_IS_MIN


193 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

195 
	#FP_ILOGB0
 (-2147483647)

	)

197 #ià
__FP_LOGBNAN_IS_MIN


198 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

200 
	#FP_ILOGBNAN
 2147483647

	)

203 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

204 #ià
__WORDSIZE
 == 32

205 
	#__FP_LONG_MAX
 0x7fffffffL

	)

207 
	#__FP_LONG_MAX
 0x7fffffffffffffffL

	)

209 #ià
__FP_LOGB0_IS_MIN


210 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
 - 1)

	)

212 
	#FP_LLOGB0
 (-
__FP_LONG_MAX
)

	)

214 #ià
__FP_LOGBNAN_IS_MIN


215 
	#FP_LLOGBNAN
 (-
__FP_LONG_MAX
 - 1)

	)

217 
	#FP_LLOGBNAN
 
__FP_LONG_MAX


	)

233 
	~<b™s/å-ç¡.h
>

235 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

239 
	mFP_INT_UPWARD
 =

240 
	#FP_INT_UPWARD
 0

	)

241 
FP_INT_UPWARD
,

242 
	mFP_INT_DOWNWARD
 =

243 
	#FP_INT_DOWNWARD
 1

	)

244 
FP_INT_DOWNWARD
,

245 
	mFP_INT_TOWARDZERO
 =

246 
	#FP_INT_TOWARDZERO
 2

	)

247 
FP_INT_TOWARDZERO
,

248 
	mFP_INT_TONEARESTFROMZERO
 =

249 
	#FP_INT_TONEARESTFROMZERO
 3

	)

250 
FP_INT_TONEARESTFROMZERO
,

251 
	mFP_INT_TONEAREST
 =

252 
	#FP_INT_TONEAREST
 4

	)

253 
FP_INT_TONEAREST
,

262 
	#__SIMD_DECL
(
funùiÚ
è
	`__CONCAT
 (
__DECL_SIMD_
, funùiÚ)

	)

264 
	#__MATHCALL_VEC
(
funùiÚ
, 
suffix
, 
¬gs
) \

265 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

266 
	`__MATHCALL
 (
funùiÚ
, 
suffix
, 
¬gs
)

	)

268 
	#__MATHDECL_VEC
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

269 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funùiÚ
, 
suffix
)) \

270 
	`__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
)

	)

272 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

273 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

274 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

275 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

276 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

277 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

278 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

279 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

280 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

281 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

282 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

283 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

285 
	#_MdoubË_
 

	)

286 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

287 
	#__MATH_DECLARING_DOUBLE
 1

	)

288 
	#__MATH_DECLARING_FLOATN
 0

	)

289 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

290 
	~<b™s/m©hÿÎs.h
>

291 #undeà
_MdoubË_


292 #undeà
__MATH_PRECNAME


293 #undeà
__MATH_DECLARING_DOUBLE


294 #undeà
__MATH_DECLARING_FLOATN


296 #ifdeà
__USE_ISOC99


302 
	#_MdoubË_
 

	)

303 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

304 
	#__MATH_DECLARING_DOUBLE
 0

	)

305 
	#__MATH_DECLARING_FLOATN
 0

	)

306 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

307 
	~<b™s/m©hÿÎs.h
>

308 #undeà
_MdoubË_


309 #undeà
__MATH_PRECNAME


310 #undeà
__MATH_DECLARING_DOUBLE


311 #undeà
__MATH_DECLARING_FLOATN


313 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

314 || 
defšed
 
__LDBL_COMPAT
 \

315 || 
defšed
 
_LIBC_TEST


316 #ifdeà
__LDBL_COMPAT


318 #ifdeà
__USE_ISOC99


319 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

320 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

321 #ifdeà
__REDIRECT_NTH


322 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

323 
__Ædbl_Ãx‰ow¬df
)

324 
	`__©Œibu‹__
 ((
__cÚ¡__
));

325 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

326 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

327 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

328 (
__x
, 
__y
),

329 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

333 #undeà
__MATHDECL_1


334 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

335 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

336 
¬gs
, 
®Ÿs
)

	)

337 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

338 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

344 
	#_MdoubË_
 

	)

345 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

346 
	#__MATH_DECLARING_DOUBLE
 0

	)

347 
	#__MATH_DECLARING_FLOATN
 0

	)

348 
	#__MATH_DECLARE_LDOUBLE
 1

	)

349 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

350 
	~<b™s/m©hÿÎs.h
>

351 #undeà
_MdoubË_


352 #undeà
__MATH_PRECNAME


353 #undeà
__MATH_DECLARING_DOUBLE


354 #undeà
__MATH_DECLARING_FLOATN


363 #ià
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)

364 
	#_MdoubË_
 
_Flßt16


	)

365 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f16
##
	)
r

366 
	#__MATH_DECLARING_DOUBLE
 0

	)

367 
	#__MATH_DECLARING_FLOATN
 1

	)

368 #ià
__HAVE_DISTINCT_FLOAT16


369 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

371 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

372 
	~<b™s/m©hÿÎs.h
>

374 #undeà
_MdoubË_


375 #undeà
__MATH_PRECNAME


376 #undeà
__MATH_DECLARING_DOUBLE


377 #undeà
__MATH_DECLARING_FLOATN


380 #ià
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)

381 
	#_MdoubË_
 
_Flßt32


	)

382 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32
##
	)
r

383 
	#__MATH_DECLARING_DOUBLE
 0

	)

384 
	#__MATH_DECLARING_FLOATN
 1

	)

385 #ià
__HAVE_DISTINCT_FLOAT32


386 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

388 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

389 
	~<b™s/m©hÿÎs.h
>

391 #undeà
_MdoubË_


392 #undeà
__MATH_PRECNAME


393 #undeà
__MATH_DECLARING_DOUBLE


394 #undeà
__MATH_DECLARING_FLOATN


397 #ià
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)

398 
	#_MdoubË_
 
_Flßt64


	)

399 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64
##
	)
r

400 
	#__MATH_DECLARING_DOUBLE
 0

	)

401 
	#__MATH_DECLARING_FLOATN
 1

	)

402 #ià
__HAVE_DISTINCT_FLOAT64


403 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

405 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

406 
	~<b™s/m©hÿÎs.h
>

408 #undeà
_MdoubË_


409 #undeà
__MATH_PRECNAME


410 #undeà
__MATH_DECLARING_DOUBLE


411 #undeà
__MATH_DECLARING_FLOATN


414 #ià
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)

415 
	#_MdoubË_
 
_Flßt128


	)

416 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128
##
	)
r

417 
	#__MATH_DECLARING_DOUBLE
 0

	)

418 
	#__MATH_DECLARING_FLOATN
 1

	)

419 #ià
__HAVE_DISTINCT_FLOAT128


420 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

422 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

423 
	~<b™s/m©hÿÎs.h
>

425 #undeà
_MdoubË_


426 #undeà
__MATH_PRECNAME


427 #undeà
__MATH_DECLARING_DOUBLE


428 #undeà
__MATH_DECLARING_FLOATN


431 #ià
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)

432 
	#_MdoubË_
 
_Flßt32x


	)

433 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f32x
##
	)
r

434 
	#__MATH_DECLARING_DOUBLE
 0

	)

435 
	#__MATH_DECLARING_FLOATN
 1

	)

436 #ià
__HAVE_DISTINCT_FLOAT32X


437 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

439 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

440 
	~<b™s/m©hÿÎs.h
>

442 #undeà
_MdoubË_


443 #undeà
__MATH_PRECNAME


444 #undeà
__MATH_DECLARING_DOUBLE


445 #undeà
__MATH_DECLARING_FLOATN


448 #ià
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)

449 
	#_MdoubË_
 
_Flßt64x


	)

450 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f64x
##
	)
r

451 
	#__MATH_DECLARING_DOUBLE
 0

	)

452 
	#__MATH_DECLARING_FLOATN
 1

	)

453 #ià
__HAVE_DISTINCT_FLOAT64X


454 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

456 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

457 
	~<b™s/m©hÿÎs.h
>

459 #undeà
_MdoubË_


460 #undeà
__MATH_PRECNAME


461 #undeà
__MATH_DECLARING_DOUBLE


462 #undeà
__MATH_DECLARING_FLOATN


465 #ià
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)

466 
	#_MdoubË_
 
_Flßt128x


	)

467 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f128x
##
	)
r

468 
	#__MATH_DECLARING_DOUBLE
 0

	)

469 
	#__MATH_DECLARING_FLOATN
 1

	)

470 #ià
__HAVE_DISTINCT_FLOAT128X


471 
	~<b™s/m©hÿÎs-h–³r-funùiÚs.h
>

473 #ià
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

474 
	~<b™s/m©hÿÎs.h
>

476 #undeà
_MdoubË_


477 #undeà
__MATH_PRECNAME


478 #undeà
__MATH_DECLARING_DOUBLE


479 #undeà
__MATH_DECLARING_FLOATN


482 #undeà
__MATHDECL_1


483 #undeà
__MATHDECL


484 #undeà
__MATHCALL


487 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


489 
signgam
;

492 #ià(
__HAVE_DISTINCT_FLOAT16
 \

493 || 
__HAVE_DISTINCT_FLOAT32
 \

494 || 
__HAVE_DISTINCT_FLOAT64
 \

495 || 
__HAVE_DISTINCT_FLOAT32X
 \

496 || 
__HAVE_DISTINCT_FLOAT64X
 \

497 || 
__HAVE_DISTINCT_FLOAT128X
)

510 #ifdeà
__NO_LONG_DOUBLE_MATH


511 #ià
__HAVE_DISTINCT_FLOAT128


514 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

515 ( (
TG_ARG
è=ğ (è? 
FUNC
 ## 
f
 
ARGS
 : FUNC ARGS)

	)

516 #–ià
__HAVE_DISTINCT_FLOAT128


517 #ià
__HAVE_GENERIC_SELECTION


518 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT32


519 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
è
_Flßt32
: FUNC ## 
f
 ARGS,

	)

521 
	#__MATH_TG_F32
(
FUNC
, 
ARGS
)

	)

523 #ià
__HAVE_FLOATN_NOT_TYPEDEF
 && 
__HAVE_FLOAT64X


524 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


525 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
l
 ARGS,

	)

527 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
è
_Flßt64x
: FUNC ## 
f128
 ARGS,

	)

530 
	#__MATH_TG_F64X
(
FUNC
, 
ARGS
)

	)

532 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

533 
	`_G’”ic
 ((
TG_ARG
), \

534 : 
FUNC
 ## 
f
 
ARGS
, \

535 
	`__MATH_TG_F32
 (
FUNC
, 
ARGS
) \

536 : 
FUNC
 
ARGS
, \

537 : 
FUNC
 ## 
l
 
ARGS
, \

538 
	`__MATH_TG_F64X
 (
FUNC
, 
ARGS
) \

539 
_Flßt128
: 
FUNC
 ## 
f128
 
ARGS
)

	)

541 #ià
__HAVE_FLOATN_NOT_TYPEDEF


544 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

545 
__butš_choo£_ex´
 \

546 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

547 
FUNC
 ## 
f
 
ARGS
, \

548 
__butš_choo£_ex´
 \

549 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

550 
FUNC
 
ARGS
, \

551 
__butš_choo£_ex´
 \

552 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
TG_ARG
), ), \

553 
FUNC
 ## 
l
 
ARGS
, \

554 
FUNC
 ## 
f128
 
ARGS
)))

	)

557 
	#__MATH_TG
(
TG_ARG
, 
FUNC
, 
ARGS
) \

558 ( (
TG_ARG
) ==  () \

559 ? 
FUNC
 ## 
f
 
ARGS
 \

560 :  (
TG_ARG
) ==  () \

561 ? 
FUNC
 
ARGS
 \

562 : 
FUNC
 ## 
l
 
ARGS
)

	)

566 #ifdeà
__USE_ISOC99


571 
FP_NAN
 =

572 
	#FP_NAN
 0

	)

573 
FP_NAN
,

574 
FP_INFINITE
 =

575 
	#FP_INFINITE
 1

	)

576 
FP_INFINITE
,

577 
FP_ZERO
 =

578 
	#FP_ZERO
 2

	)

579 
FP_ZERO
,

580 
FP_SUBNORMAL
 =

581 
	#FP_SUBNORMAL
 3

	)

582 
FP_SUBNORMAL
,

583 
FP_NORMAL
 =

584 
	#FP_NORMAL
 4

	)

585 
FP_NORMAL


593 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__
 \

594 && (!
defšed
 
__OPTIMIZE_SIZE__
 || defšed 
__ılu¥lus
)

601 
	#åşassify
(
x
è
	`__butš_åşassify
 (
FP_NAN
, 
FP_INFINITE
, \

602 
FP_NORMAL
, 
FP_SUBNORMAL
, 
FP_ZERO
, 
x
)

	)

604 
	#åşassify
(
x
è
	`__MATH_TG
 ((x), 
__åşassify
, (x))

	)

608 #ià
	`__GNUC_PREREQ
 (6,0)

609 
	#signb™
(
x
è
	`__butš_signb™
 (x)

	)

610 #–ià
defšed
 
__ılu¥lus


618 
	#signb™
(
x
è
	`__butš_signb™l
 (x)

	)

619 #–ià
	`__GNUC_PREREQ
 (4,0)

620 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__butš_signb™
, (x))

	)

622 
	#signb™
(
x
è
	`__MATH_TG
 ((x), 
__signb™
, (x))

	)

626 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


627 
	#isfš™e
(
x
è
	`__butš_isfš™e
 (x)

	)

629 
	#isfš™e
(
x
è
	`__MATH_TG
 ((x), 
__fš™e
, (x))

	)

633 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


634 
	#i¢Üm®
(
x
è
	`__butš_i¢Üm®
 (x)

	)

636 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

641 #ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


642 
	#i¢ª
(
x
è
	`__butš_i¢ª
 (x)

	)

644 
	#i¢ª
(
x
è
	`__MATH_TG
 ((x), 
__i¢ª
, (x))

	)

648 #ià
__HAVE_DISTINCT_FLOAT128
 && !
	`__GNUC_PREREQ
 (7,0) \

649 && !
defšed
 
__SUPPORT_SNAN__
 && !defšed 
__ılu¥lus


655 
	#isšf
(
x
) \

656 (
	`__butš_ty³s_com·tibË_p
 (
	`__ty³of
 (
x
), 
_Flßt128
) \

657 ? 
	`__isšff128
 (
x
è: 
	`__butš_isšf_sign
 (x))

	)

658 #–ià
	`__GNUC_PREREQ
 (4,4è&& !
defšed
 
__SUPPORT_SNAN__


659 
	#isšf
(
x
è
	`__butš_isšf_sign
 (x)

	)

661 
	#isšf
(
x
è
	`__MATH_TG
 ((x), 
__isšf
, (x))

	)

665 
	#MATH_ERRNO
 1

	)

666 
	#MATH_ERREXCEPT
 2

	)

673 #ifdeà
__FAST_MATH__


674 
	#m©h_”rhªdlšg
 0

	)

675 #–ià
defšed
 
__NO_MATH_ERRNO__


676 
	#m©h_”rhªdlšg
 (
MATH_ERREXCEPT
)

	)

678 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

683 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

684 
	~<b™s/isÿnÚiÿl.h
>

687 #iâdeà
__ılu¥lus


688 
	#issigÇlšg
(
x
è
	`__MATH_TG
 ((x), 
__issigÇlšg
, (x))

	)

697 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšgf
 (__val); }

698 
šlše
 
	`issigÇlšg
 (
__v®
è{  
	`__issigÇlšg
 (__val); }

699 
šlše
 

700 
	`issigÇlšg
 (
__v®
)

702 #ifdeà
__NO_LONG_DOUBLE_MATH


703  
	`__issigÇlšg
 (
__v®
);

705  
	`__issigÇlšgl
 (
__v®
);

708 #ià
__HAVE_DISTINCT_FLOAT128


709 
šlše
 
	`issigÇlšg
 (
_Flßt128
 
__v®
è{  
	`__issigÇlšgf128
 (__val); }

711 
	}
}

715 
	#issubnÜm®
(
x
è(
	`åşassify
 (xè=ğ
FP_SUBNORMAL
)

	)

718 #iâdeà
__ılu¥lus


719 #ifdeà
__SUPPORT_SNAN__


720 
	#isz”o
(
x
è(
	`åşassify
 (xè=ğ
FP_ZERO
)

	)

722 
	#isz”o
(
x
è(((
	`__ty³of
 (x)è(x)è=ğ0)

	)

726 #ifdeà
__SUPPORT_SNAN__


727 
šlše
 

728 
isz”o
 (
__v®
)

730  
__åşassifyf
 (
__v®
è=ğ
FP_ZERO
;

732 
šlše
 

733 
isz”o
 (
__v®
)

735  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

737 
šlše
 

738 
isz”o
 (
__v®
)

740 #ifdeà
__NO_LONG_DOUBLE_MATH


741  
__åşassify
 (
__v®
è=ğ
FP_ZERO
;

743  
__åşassifyl
 (
__v®
è=ğ
FP_ZERO
;

746 #ià
__HAVE_DISTINCT_FLOAT128


747 
šlše
 

748 
isz”o
 (
_Flßt128
 
__v®
)

750  
__åşassifyf128
 (
__v®
è=ğ
FP_ZERO
;

754 
‹m¶©e
 <
şass
 
__T
> 
šlše
 
boŞ


755 
isz”o
 (
__T
 
__v®
)

757  
__v®
 == 0;

764 #ifdeà
__USE_XOPEN


766 
	#MAXFLOAT
 3.40282347e+38F

	)

771 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


772 
	#M_E
 2.7182818284590452354

	)

773 
	#M_LOG2E
 1.4426950408889634074

	)

774 
	#M_LOG10E
 0.43429448190325182765

	)

775 
	#M_LN2
 0.69314718055994530942

	)

776 
	#M_LN10
 2.30258509299404568402

	)

777 
	#M_PI
 3.14159265358979323846

	)

778 
	#M_PI_2
 1.57079632679489661923

	)

779 
	#M_PI_4
 0.78539816339744830962

	)

780 
	#M_1_PI
 0.31830988618379067154

	)

781 
	#M_2_PI
 0.63661977236758134308

	)

782 
	#M_2_SQRTPI
 1.12837916709551257390

	)

783 
	#M_SQRT2
 1.41421356237309504880

	)

784 
	#M_SQRT1_2
 0.70710678118654752440

	)

790 #ifdeà
__USE_GNU


791 
	#M_El
 2.718281828459045235360287471352662498L

	)

792 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

793 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

794 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

795 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

796 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

797 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

798 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

799 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

800 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

801 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

802 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

803 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

806 #ià
__HAVE_FLOAT16
 && 
defšed
 
__USE_GNU


807 
	#M_Ef16
 
	`__f16
 (2.718281828459045235360287471352662498è

	)

808 
	#M_LOG2Ef16
 
	`__f16
 (1.442695040888963407359924681001892137è

	)

809 
	#M_LOG10Ef16
 
	`__f16
 (0.434294481903251827651128918916605082è

	)

810 
	#M_LN2f16
 
	`__f16
 (0.693147180559945309417232121458176568è

	)

811 
	#M_LN10f16
 
	`__f16
 (2.302585092994045684017991454684364208è

	)

812 
	#M_PIf16
 
	`__f16
 (3.141592653589793238462643383279502884è

	)

813 
	#M_PI_2f16
 
	`__f16
 (1.570796326794896619231321691639751442è

	)

814 
	#M_PI_4f16
 
	`__f16
 (0.785398163397448309615660845819875721è

	)

815 
	#M_1_PIf16
 
	`__f16
 (0.318309886183790671537767526745028724è

	)

816 
	#M_2_PIf16
 
	`__f16
 (0.636619772367581343075535053490057448è

	)

817 
	#M_2_SQRTPIf16
 
	`__f16
 (1.128379167095512573896158903121545172è

	)

818 
	#M_SQRT2f16
 
	`__f16
 (1.414213562373095048801688724209698079è

	)

819 
	#M_SQRT1_2f16
 
	`__f16
 (0.707106781186547524400844362104849039è

	)

822 #ià
__HAVE_FLOAT32
 && 
defšed
 
__USE_GNU


823 
	#M_Ef32
 
	`__f32
 (2.718281828459045235360287471352662498è

	)

824 
	#M_LOG2Ef32
 
	`__f32
 (1.442695040888963407359924681001892137è

	)

825 
	#M_LOG10Ef32
 
	`__f32
 (0.434294481903251827651128918916605082è

	)

826 
	#M_LN2f32
 
	`__f32
 (0.693147180559945309417232121458176568è

	)

827 
	#M_LN10f32
 
	`__f32
 (2.302585092994045684017991454684364208è

	)

828 
	#M_PIf32
 
	`__f32
 (3.141592653589793238462643383279502884è

	)

829 
	#M_PI_2f32
 
	`__f32
 (1.570796326794896619231321691639751442è

	)

830 
	#M_PI_4f32
 
	`__f32
 (0.785398163397448309615660845819875721è

	)

831 
	#M_1_PIf32
 
	`__f32
 (0.318309886183790671537767526745028724è

	)

832 
	#M_2_PIf32
 
	`__f32
 (0.636619772367581343075535053490057448è

	)

833 
	#M_2_SQRTPIf32
 
	`__f32
 (1.128379167095512573896158903121545172è

	)

834 
	#M_SQRT2f32
 
	`__f32
 (1.414213562373095048801688724209698079è

	)

835 
	#M_SQRT1_2f32
 
	`__f32
 (0.707106781186547524400844362104849039è

	)

838 #ià
__HAVE_FLOAT64
 && 
defšed
 
__USE_GNU


839 
	#M_Ef64
 
	`__f64
 (2.718281828459045235360287471352662498è

	)

840 
	#M_LOG2Ef64
 
	`__f64
 (1.442695040888963407359924681001892137è

	)

841 
	#M_LOG10Ef64
 
	`__f64
 (0.434294481903251827651128918916605082è

	)

842 
	#M_LN2f64
 
	`__f64
 (0.693147180559945309417232121458176568è

	)

843 
	#M_LN10f64
 
	`__f64
 (2.302585092994045684017991454684364208è

	)

844 
	#M_PIf64
 
	`__f64
 (3.141592653589793238462643383279502884è

	)

845 
	#M_PI_2f64
 
	`__f64
 (1.570796326794896619231321691639751442è

	)

846 
	#M_PI_4f64
 
	`__f64
 (0.785398163397448309615660845819875721è

	)

847 
	#M_1_PIf64
 
	`__f64
 (0.318309886183790671537767526745028724è

	)

848 
	#M_2_PIf64
 
	`__f64
 (0.636619772367581343075535053490057448è

	)

849 
	#M_2_SQRTPIf64
 
	`__f64
 (1.128379167095512573896158903121545172è

	)

850 
	#M_SQRT2f64
 
	`__f64
 (1.414213562373095048801688724209698079è

	)

851 
	#M_SQRT1_2f64
 
	`__f64
 (0.707106781186547524400844362104849039è

	)

854 #ià
__HAVE_FLOAT128
 && 
defšed
 
__USE_GNU


855 
	#M_Ef128
 
	`__f128
 (2.718281828459045235360287471352662498è

	)

856 
	#M_LOG2Ef128
 
	`__f128
 (1.442695040888963407359924681001892137è

	)

857 
	#M_LOG10Ef128
 
	`__f128
 (0.434294481903251827651128918916605082è

	)

858 
	#M_LN2f128
 
	`__f128
 (0.693147180559945309417232121458176568è

	)

859 
	#M_LN10f128
 
	`__f128
 (2.302585092994045684017991454684364208è

	)

860 
	#M_PIf128
 
	`__f128
 (3.141592653589793238462643383279502884è

	)

861 
	#M_PI_2f128
 
	`__f128
 (1.570796326794896619231321691639751442è

	)

862 
	#M_PI_4f128
 
	`__f128
 (0.785398163397448309615660845819875721è

	)

863 
	#M_1_PIf128
 
	`__f128
 (0.318309886183790671537767526745028724è

	)

864 
	#M_2_PIf128
 
	`__f128
 (0.636619772367581343075535053490057448è

	)

865 
	#M_2_SQRTPIf128
 
	`__f128
 (1.128379167095512573896158903121545172è

	)

866 
	#M_SQRT2f128
 
	`__f128
 (1.414213562373095048801688724209698079è

	)

867 
	#M_SQRT1_2f128
 
	`__f128
 (0.707106781186547524400844362104849039è

	)

870 #ià
__HAVE_FLOAT32X
 && 
defšed
 
__USE_GNU


871 
	#M_Ef32x
 
	`__f32x
 (2.718281828459045235360287471352662498è

	)

872 
	#M_LOG2Ef32x
 
	`__f32x
 (1.442695040888963407359924681001892137è

	)

873 
	#M_LOG10Ef32x
 
	`__f32x
 (0.434294481903251827651128918916605082è

	)

874 
	#M_LN2f32x
 
	`__f32x
 (0.693147180559945309417232121458176568è

	)

875 
	#M_LN10f32x
 
	`__f32x
 (2.302585092994045684017991454684364208è

	)

876 
	#M_PIf32x
 
	`__f32x
 (3.141592653589793238462643383279502884è

	)

877 
	#M_PI_2f32x
 
	`__f32x
 (1.570796326794896619231321691639751442è

	)

878 
	#M_PI_4f32x
 
	`__f32x
 (0.785398163397448309615660845819875721è

	)

879 
	#M_1_PIf32x
 
	`__f32x
 (0.318309886183790671537767526745028724è

	)

880 
	#M_2_PIf32x
 
	`__f32x
 (0.636619772367581343075535053490057448è

	)

881 
	#M_2_SQRTPIf32x
 
	`__f32x
 (1.128379167095512573896158903121545172è

	)

882 
	#M_SQRT2f32x
 
	`__f32x
 (1.414213562373095048801688724209698079è

	)

883 
	#M_SQRT1_2f32x
 
	`__f32x
 (0.707106781186547524400844362104849039è

	)

886 #ià
__HAVE_FLOAT64X
 && 
defšed
 
__USE_GNU


887 
	#M_Ef64x
 
	`__f64x
 (2.718281828459045235360287471352662498è

	)

888 
	#M_LOG2Ef64x
 
	`__f64x
 (1.442695040888963407359924681001892137è

	)

889 
	#M_LOG10Ef64x
 
	`__f64x
 (0.434294481903251827651128918916605082è

	)

890 
	#M_LN2f64x
 
	`__f64x
 (0.693147180559945309417232121458176568è

	)

891 
	#M_LN10f64x
 
	`__f64x
 (2.302585092994045684017991454684364208è

	)

892 
	#M_PIf64x
 
	`__f64x
 (3.141592653589793238462643383279502884è

	)

893 
	#M_PI_2f64x
 
	`__f64x
 (1.570796326794896619231321691639751442è

	)

894 
	#M_PI_4f64x
 
	`__f64x
 (0.785398163397448309615660845819875721è

	)

895 
	#M_1_PIf64x
 
	`__f64x
 (0.318309886183790671537767526745028724è

	)

896 
	#M_2_PIf64x
 
	`__f64x
 (0.636619772367581343075535053490057448è

	)

897 
	#M_2_SQRTPIf64x
 
	`__f64x
 (1.128379167095512573896158903121545172è

	)

898 
	#M_SQRT2f64x
 
	`__f64x
 (1.414213562373095048801688724209698079è

	)

899 
	#M_SQRT1_2f64x
 
	`__f64x
 (0.707106781186547524400844362104849039è

	)

902 #ià
__HAVE_FLOAT128X
 && 
defšed
 
__USE_GNU


909 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


910 
	#__NO_MATH_INLINES
 1

	)

913 #ifdeà
__USE_ISOC99


914 #ià
__GNUC_PREREQ
 (3, 1)

921 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

922 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

923 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

924 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

925 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

926 
	#isunÜd”ed
(
x
, 
y
è
	`__butš_isunÜd”ed
(x, y)

	)

928 
	#isg»©”
(
x
, 
y
) \

929 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

930 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; }))

	)

931 
	#isg»©”equ®
(
x
, 
y
) \

932 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

933 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

934 
	#i¦ess
(
x
, 
y
) \

935 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

936 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

937 
	#i¦es£qu®
(
x
, 
y
) \

938 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

939 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

940 
	#i¦essg»©”
(
x
, 
y
) \

941 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__x
 = (x); __ty³of__ (
y
è
__y
 = (y); \

942 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x !ğ__y; }))

	)

944 
	#isunÜd”ed
(
x
, 
y
) \

945 (
	`__ex‹nsiÚ__
 ({ 
	`__ty³of__
 (
x
è
__u
 = (x); __ty³of__ (
y
è
__v
 = (y); \

946 
__u
 !ğ
__v
 && (__u !ğ__u || __v !ğ__v); }))

	)

951 #ifdeà
__USE_EXTERN_INLINES


952 
	~<b™s/m©hšlše.h
>

957 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

960 
	#_MdoubË_
 

	)

961 
	#__MATH_DECLARING_DOUBLE
 1

	)

962 
	#__MATH_DECLARING_FLOATN
 0

	)

963 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

964 
funùiÚ
 ## 
»’Œªt


	)

965 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

966 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

967 
	~<b™s/m©h-fš™e.h
>

968 #undeà
_MdoubË_


969 #undeà
__MATH_DECLARING_DOUBLE


970 #undeà
__MATH_DECLARING_FLOATN


971 #undeà
__REDIRFROM_X


972 #undeà
__REDIRTO_X


976 #ifdeà
__USE_ISOC99


979 
	#_MdoubË_
 

	)

980 
	#__MATH_DECLARING_DOUBLE
 0

	)

981 
	#__MATH_DECLARING_FLOATN
 0

	)

982 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

983 
funùiÚ
 ## 
f
 ## 
»’Œªt


	)

984 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

985 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

986 
	~<b™s/m©h-fš™e.h
>

987 #undeà
_MdoubË_


988 #undeà
__MATH_DECLARING_DOUBLE


989 #undeà
__MATH_DECLARING_FLOATN


990 #undeà
__REDIRFROM_X


991 #undeà
__REDIRTO_X


994 #ifdeà
__MATH_DECLARE_LDOUBLE


995 
	#_MdoubË_
 

	)

996 
	#__MATH_DECLARING_DOUBLE
 0

	)

997 
	#__MATH_DECLARING_FLOATN
 0

	)

998 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

999 
funùiÚ
 ## 
l
 ## 
»’Œªt


	)

1000 #ifdeà
__NO_LONG_DOUBLE_MATH


1001 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1002 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1004 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1005 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1007 
	~<b™s/m©h-fš™e.h
>

1008 #undeà
_MdoubË_


1009 #undeà
__MATH_DECLARING_DOUBLE


1010 #undeà
__MATH_DECLARING_FLOATN


1011 #undeà
__REDIRFROM_X


1012 #undeà
__REDIRTO_X


1019 #ià(
__HAVE_DISTINCT_FLOAT16
 || (
__HAVE_FLOAT16
 && !
defšed
 
_LIBC
)) \

1020 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1021 
	#_MdoubË_
 
_Flßt16


	)

1022 
	#__MATH_DECLARING_DOUBLE
 0

	)

1023 
	#__MATH_DECLARING_FLOATN
 1

	)

1024 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1025 
funùiÚ
 ## 
f16
 ## 
»’Œªt


	)

1026 #ià
__HAVE_DISTINCT_FLOAT16


1027 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1028 
__
 ## 
funùiÚ
 ## 
f16
 ## 
»’Œªt
 ## 
_fš™e


	)

1032 
	~<b™s/m©h-fš™e.h
>

1033 #undeà
_MdoubË_


1034 #undeà
__MATH_DECLARING_DOUBLE


1035 #undeà
__MATH_DECLARING_FLOATN


1036 #undeà
__REDIRFROM_X


1037 #undeà
__REDIRTO_X


1040 #ià(
__HAVE_DISTINCT_FLOAT32
 || (
__HAVE_FLOAT32
 && !
defšed
 
_LIBC
)) \

1041 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1042 
	#_MdoubË_
 
_Flßt32


	)

1043 
	#__MATH_DECLARING_DOUBLE
 0

	)

1044 
	#__MATH_DECLARING_FLOATN
 1

	)

1045 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1046 
funùiÚ
 ## 
f32
 ## 
»’Œªt


	)

1047 #ià
__HAVE_DISTINCT_FLOAT32


1048 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1049 
__
 ## 
funùiÚ
 ## 
f32
 ## 
»’Œªt
 ## 
_fš™e


	)

1051 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1052 
__
 ## 
funùiÚ
 ## 
f
 ## 
»’Œªt
 ## 
_fš™e


	)

1054 
	~<b™s/m©h-fš™e.h
>

1055 #undeà
_MdoubË_


1056 #undeà
__MATH_DECLARING_DOUBLE


1057 #undeà
__MATH_DECLARING_FLOATN


1058 #undeà
__REDIRFROM_X


1059 #undeà
__REDIRTO_X


1062 #ià(
__HAVE_DISTINCT_FLOAT64
 || (
__HAVE_FLOAT64
 && !
defšed
 
_LIBC
)) \

1063 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1064 
	#_MdoubË_
 
_Flßt64


	)

1065 
	#__MATH_DECLARING_DOUBLE
 0

	)

1066 
	#__MATH_DECLARING_FLOATN
 1

	)

1067 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1068 
funùiÚ
 ## 
f64
 ## 
»’Œªt


	)

1069 #ià
__HAVE_DISTINCT_FLOAT64


1070 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1071 
__
 ## 
funùiÚ
 ## 
f64
 ## 
»’Œªt
 ## 
_fš™e


	)

1073 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1074 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1076 
	~<b™s/m©h-fš™e.h
>

1077 #undeà
_MdoubË_


1078 #undeà
__MATH_DECLARING_DOUBLE


1079 #undeà
__MATH_DECLARING_FLOATN


1080 #undeà
__REDIRFROM_X


1081 #undeà
__REDIRTO_X


1084 #ià(
__HAVE_DISTINCT_FLOAT128
 || (
__HAVE_FLOAT128
 && !
defšed
 
_LIBC
)) \

1085 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1086 
	#_MdoubË_
 
_Flßt128


	)

1087 
	#__MATH_DECLARING_DOUBLE
 0

	)

1088 
	#__MATH_DECLARING_FLOATN
 1

	)

1089 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1090 
funùiÚ
 ## 
f128
 ## 
»’Œªt


	)

1091 #ià
__HAVE_DISTINCT_FLOAT128


1092 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1093 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1095 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1096 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1098 
	~<b™s/m©h-fš™e.h
>

1099 #undeà
_MdoubË_


1100 #undeà
__MATH_DECLARING_DOUBLE


1101 #undeà
__MATH_DECLARING_FLOATN


1102 #undeà
__REDIRFROM_X


1103 #undeà
__REDIRTO_X


1106 #ià(
__HAVE_DISTINCT_FLOAT32X
 || (
__HAVE_FLOAT32X
 && !
defšed
 
_LIBC
)) \

1107 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1108 
	#_MdoubË_
 
_Flßt32x


	)

1109 
	#__MATH_DECLARING_DOUBLE
 0

	)

1110 
	#__MATH_DECLARING_FLOATN
 1

	)

1111 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1112 
funùiÚ
 ## 
f32x
 ## 
»’Œªt


	)

1113 #ià
__HAVE_DISTINCT_FLOAT32X


1114 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1115 
__
 ## 
funùiÚ
 ## 
f32x
 ## 
»’Œªt
 ## 
_fš™e


	)

1117 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1118 
__
 ## 
funùiÚ
 ## 
»’Œªt
 ## 
_fš™e


	)

1120 
	~<b™s/m©h-fš™e.h
>

1121 #undeà
_MdoubË_


1122 #undeà
__MATH_DECLARING_DOUBLE


1123 #undeà
__MATH_DECLARING_FLOATN


1124 #undeà
__REDIRFROM_X


1125 #undeà
__REDIRTO_X


1128 #ià(
__HAVE_DISTINCT_FLOAT64X
 || (
__HAVE_FLOAT64X
 && !
defšed
 
_LIBC
)) \

1129 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1130 
	#_MdoubË_
 
_Flßt64x


	)

1131 
	#__MATH_DECLARING_DOUBLE
 0

	)

1132 
	#__MATH_DECLARING_FLOATN
 1

	)

1133 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1134 
funùiÚ
 ## 
f64x
 ## 
»’Œªt


	)

1135 #ià
__HAVE_DISTINCT_FLOAT64X


1136 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1137 
__
 ## 
funùiÚ
 ## 
f64x
 ## 
»’Œªt
 ## 
_fš™e


	)

1138 #–ià
__HAVE_FLOAT64X_LONG_DOUBLE


1139 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1140 
__
 ## 
funùiÚ
 ## 
l
 ## 
»’Œªt
 ## 
_fš™e


	)

1142 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1143 
__
 ## 
funùiÚ
 ## 
f128
 ## 
»’Œªt
 ## 
_fš™e


	)

1145 
	~<b™s/m©h-fš™e.h
>

1146 #undeà
_MdoubË_


1147 #undeà
__MATH_DECLARING_DOUBLE


1148 #undeà
__MATH_DECLARING_FLOATN


1149 #undeà
__REDIRFROM_X


1150 #undeà
__REDIRTO_X


1153 #ià(
__HAVE_DISTINCT_FLOAT128X
 || (
__HAVE_FLOAT128X
 && !
defšed
 
_LIBC
)) \

1154 && 
	$__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

1155 
	#_MdoubË_
 
_Flßt128x


	)

1156 
	#__MATH_DECLARING_DOUBLE
 0

	)

1157 
	#__MATH_DECLARING_FLOATN
 1

	)

1158 
	#__REDIRFROM_X
(
funùiÚ
, 
»’Œªt
) \

1159 
funùiÚ
 ## 
f128x
 ## 
»’Œªt


	)

1160 #ià
__HAVE_DISTINCT_FLOAT128X


1161 
	#__REDIRTO_X
(
funùiÚ
, 
»’Œªt
) \

1162 
__
 ## 
funùiÚ
 ## 
f128x
 ## 
»’Œªt
 ## 
_fš™e


	)

1166 
	~<b™s/m©h-fš™e.h
>

1167 #undeà
_MdoubË_


1168 #undeà
__MATH_DECLARING_DOUBLE


1169 #undeà
__MATH_DECLARING_FLOATN


1170 #undeà
__REDIRFROM_X


1171 #undeà
__REDIRTO_X


1176 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

1179 #ià
__FLT_EVAL_METHOD__
 == 2 || __FLT_EVAL_METHOD__ > 64

1180 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0L)

	)

1181 #–ià
__FLT_EVAL_METHOD__
 == 1 || __FLT_EVAL_METHOD__ > 32

1182 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0)

	)

1183 #–ià
__FLT_EVAL_METHOD__
 == 0 || __FLT_EVAL_METHOD__ == 32

1184 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (yè+ 0.0f)

	)

1186 
	#__MATH_EVAL_FMT2
(
x
, 
y
è((xè+ (y))

	)

1191 #ià!
defšed
 
__ılu¥lus
 || (__ılu¥lu < 201103L && !defšed 
__GNUC__
)

1192 
	#i£qsig
(
x
, 
y
) \

1193 
	`__MATH_TG
 (
	`__MATH_EVAL_FMT2
 (
x
, 
y
), 
__i£qsig
, ((x), (y)))

	)

1206 
‹m¶©e
<
ty³Çme
> 
__i£qsig_ty³
;

1208 
‹m¶©e
<> 
__i£qsig_ty³
<>

1210 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1212  
	`__i£qsigf
 (
__x
, 
__y
);

1216 
‹m¶©e
<> 
__i£qsig_ty³
<>

1218 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1220  
	`__i£qsig
 (
__x
, 
__y
);

1224 
‹m¶©e
<> 
__i£qsig_ty³
<>

1226 
	`__ÿÎ
 (
__x
, 
__y
è
	`throw
 ()

1228 #iâdeà
__NO_LONG_DOUBLE_MATH


1229  
	`__i£qsigl
 (
__x
, 
__y
);

1231  
	`__i£qsig
 (
__x
, 
__y
);

1236 #ià
__HAVE_DISTINCT_FLOAT128


1237 
‹m¶©e
<> 
__i£qsig_ty³
<
_Flßt128
>

1239 
	`__ÿÎ
 (
_Flßt128
 
__x
, _Flßt128 
__y
è
	`throw
 ()

1241  
	`__i£qsigf128
 (
__x
, 
__y
);

1246 
‹m¶©e
<
ty³Çme
 
_T1
,y³Çm
_T2
>

1247 
šlše
 

1248 
	`i£qsig
 (
_T1
 
__x
, 
_T2
 
__y
è
	`throw
 ()

1250 #ià
__ılu¥lus
 >= 201103L

1251 
	`deşty³
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1253 
	`__ty³of
 (
	t__MATH_EVAL_FMT2
 (
	t__x
, 
	t__y
)è
	t_T3
;

1255  
__i£qsig_ty³
<
_T3
>::
	`__ÿÎ
 (
__x
, 
__y
);

1258 
	}
}

1263 
__END_DECLS


	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

29 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

35 
	mPTHREAD_CREATE_JOINABLE
,

36 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

37 
	mPTHREAD_CREATE_DETACHED


38 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

45 
	mPTHREAD_MUTEX_TIMED_NP
,

46 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

47 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

48 
	mPTHREAD_MUTEX_ADAPTIVE_NP


49 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


51 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

52 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

53 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

54 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


56 #ifdeà
__USE_GNU


58 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


63 #ifdeà
__USE_XOPEN2K


67 
	mPTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

69 
	mPTHREAD_MUTEX_ROBUST
,

70 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


75 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


79 
	mPTHREAD_PRIO_NONE
,

80 
	mPTHREAD_PRIO_INHERIT
,

81 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_PREV


87 
	#PTHREAD_MUTEX_INITIALIZER
 \

88 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

89 #ifdeà
__USE_GNU


90 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

91 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

92 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

93 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

94 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

95 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

99 
	#PTHREAD_MUTEX_INITIALIZER
 \

100 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

101 #ifdeà
__USE_GNU


102 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

104 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

106 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

107 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


117 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

120 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


126 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


127 #ià
__WORDSIZE
 == 64

128 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

133 
	#PTHREAD_RWLOCK_INITIALIZER
 \

134 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

135 #ifdeà
__USE_GNU


136 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

138 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, \

139 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

141 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


142 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

143 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

144 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

146 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

147 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

148 0 } }

	)

158 
	mPTHREAD_INHERIT_SCHED
,

159 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

160 
	mPTHREAD_EXPLICIT_SCHED


161 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

168 
	mPTHREAD_SCOPE_SYSTEM
,

169 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

170 
	mPTHREAD_SCOPE_PROCESS


171 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

178 
	mPTHREAD_PROCESS_PRIVATE
,

179 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

180 
	mPTHREAD_PROCESS_SHARED


181 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

187 
	#PTHREAD_COND_INITIALIZER
 { { {0}, {0}, {0, 0}, {0, 0}, 0, 0, {0, 0} } }

	)

191 
	s_±h»ad_ş—nup_bufãr


193 (*
	m__routše
) (*);

194 *
	m__¬g
;

195 
	m__ÿnûÉy³
;

196 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

202 
	mPTHREAD_CANCEL_ENABLE
,

203 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

204 
	mPTHREAD_CANCEL_DISABLE


205 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

209 
	mPTHREAD_CANCEL_DEFERRED
,

210 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

211 
	mPTHREAD_CANCEL_ASYNCHRONOUS


212 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

214 
	#PTHREAD_CANCELED
 ((*è-1)

	)

218 
	#PTHREAD_ONCE_INIT
 0

	)

221 #ifdeà
__USE_XOPEN2K


225 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

229 
__BEGIN_DECLS


234 
	$±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

235 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

236 *(*
__¡¬t_routše
) (*),

237 *
__»¡riù
 
__¬g
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 3));

243 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

251 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

253 #ifdeà
__USE_GNU


256 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

264 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

265 cÚ¡ 
time¥ec
 *
__ab¡ime
);

272 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

276 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

279 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

280 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

288 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

291 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

292 
__THROW
 
	`__nÚnuÎ
 ((1));

295 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

296 *
__d‘ach¡©e
)

297 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

300 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

301 
__d‘ach¡©e
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

306 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

307 
size_t
 *
__gu¬dsize
)

308 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

311 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

312 
size_t
 
__gu¬dsize
)

313 
__THROW
 
	`__nÚnuÎ
 ((1));

317 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

318 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

319 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

322 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

323 cÚ¡ 
sched_·¿m
 *
__»¡riù


324 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

327 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


328 
__©Œ
, *
__»¡riù
 
__pŞicy
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

333 
__THROW
 
	`__nÚnuÎ
 ((1));

336 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


337 
__©Œ
, *
__»¡riù
 
__šh”™
)

338 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

341 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

342 
__šh”™
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

347 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

348 *
__»¡riù
 
__scİe
)

349 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

352 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

356 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


357 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

358 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

364 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

365 *
__¡ackaddr
)

366 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

369 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


370 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

371 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

376 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

377 
size_t
 
__¡acksize
)

378 
__THROW
 
	`__nÚnuÎ
 ((1));

380 #ifdeà
__USE_XOPEN2K


382 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

383 **
__»¡riù
 
__¡ackaddr
,

384 
size_t
 *
__»¡riù
 
__¡acksize
)

385 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

390 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

391 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

394 #ifdeà
__USE_GNU


397 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

398 
size_t
 
__ıu£tsize
,

399 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

400 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

404 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

405 
size_t
 
__ıu£tsize
,

406 
ıu_£t_t
 *
__ıu£t
)

407 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

410 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

411 
__THROW
 
	`__nÚnuÎ
 ((1));

415 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

416 
__THROW
 
	`__nÚnuÎ
 ((1));

421 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

422 
__THROW
 
	`__nÚnuÎ
 ((2));

430 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

431 cÚ¡ 
sched_·¿m
 *
__·¿m
)

432 
__THROW
 
	`__nÚnuÎ
 ((3));

435 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

436 *
__»¡riù
 
__pŞicy
,

437 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

438 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

441 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

442 
__THROW
;

445 #ifdeà
__USE_GNU


447 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

448 
size_t
 
__buæ’
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

452 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

453 
__THROW
 
	`__nÚnuÎ
 ((2));

457 #ifdeà
__USE_UNIX98


459 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

462 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

465 #ifdeà
__USE_GNU


470 
	$±h»ad_y›ld
 (è
__THROW
;

475 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

476 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

477 
__THROW
 
	`__nÚnuÎ
 ((3));

480 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

481 
ıu_£t_t
 *
__ıu£t
)

482 
__THROW
 
	`__nÚnuÎ
 ((3));

495 
	$±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

496 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

507 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

511 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

514 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

519 
	`±h»ad_‹¡ÿnûl
 ();

528 
__jmp_buf
 
__ÿnûl_jmp_buf
;

529 
__mask_was_§ved
;

530 } 
__ÿnûl_jmp_buf
[1];

531 *
__·d
[4];

532 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

535 #iâdeà
__ş—nup_fù_©Œibu‹


536 
	#__ş—nup_fù_©Œibu‹


	)

541 
	s__±h»ad_ş—nup_äame


543 (*
__ÿnûl_routše
) (*);

544 *
__ÿnûl_¬g
;

545 
__do_™
;

546 
__ÿnûl_ty³
;

549 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


550 #ifdeà
__ılu¥lus


552 şas 
	c__±h»ad_ş—nup_şass


554 (*
__ÿnûl_routše
) (*);

555 *
__ÿnûl_¬g
;

556 
__do_™
;

557 
__ÿnûl_ty³
;

559 
public
:

560 
	$__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

561 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

562 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

563 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

564 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

565 &
__ÿnûl_ty³
); 
	}
}

566 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

576 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

578 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

582 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

583 
__şäame
.
	`__£tdo™
 (
execu‹
); \

584 } 0)

	)

586 #ifdeà
__USE_GNU


590 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

592 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

593 
__şäame
.
	`__deãr
 ()

	)

598 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

599 
__şäame
.
	`__»¡Üe
 (); \

600 
__şäame
.
	`__£tdo™
 (
execu‹
); \

601 } 0)

	)

608 
__ex‹º_šlše
 

609 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

611 ià(
__äame
->
__do_™
)

612 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

613 
	}
}

622 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

624 
__±h»ad_ş—nup_äame
 
__şäame
 \

625 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

626 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

627 .
__do_™
 = 1 };

	)

631 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

632 
__şäame
.
__do_™
 = (
execu‹
); \

633 } 0)

	)

635 #ifdeà
__USE_GNU


639 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

641 
__±h»ad_ş—nup_äame
 
__şäame
 \

642 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

643 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

644 .
__do_™
 = 1 }; \

645 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

646 &
__şäame
.
__ÿnûl_ty³
)

	)

651 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

652 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

653 
__şäame
.
__do_™
 = (
execu‹
); \

654 } 0)

	)

665 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

667 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

668 (*
__ÿnûl_routše
è(*èğ(
routše
); \

669 *
__ÿnûl_¬g
 = (
¬g
); \

670 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

671 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

672 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

674 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

675 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

679 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

680 dØ{

	)

681 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

682 
__ş—nup_fù_©Œibu‹
;

686 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

689 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 ià(
execu‹
) \

691 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

692 } 0)

	)

693 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

694 
__ş—nup_fù_©Œibu‹
;

696 #ifdeà
__USE_GNU


700 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

702 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

703 (*
__ÿnûl_routše
è(*èğ(
routše
); \

704 *
__ÿnûl_¬g
 = (
¬g
); \

705 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

706 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

707 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

709 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

710 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

714 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

715 dØ{

	)

716 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

717 
__ş—nup_fù_©Œibu‹
;

722 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

725 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

726 ià(
execu‹
) \

727 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

728 
	}
} 0)

	)

729 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

730 
__ş—nup_fù_©Œibu‹
;

734 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

735 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

736 #iâdeà
SHARED


737 
	`__©Œibu‹__
 ((
__w—k__
))

743 
__jmp_buf_g
;

744 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

750 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

751 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

752 
__THROW
 
	`__nÚnuÎ
 ((1));

755 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

756 
__THROW
 
	`__nÚnuÎ
 ((1));

759 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

760 
__THROWNL
 
	`__nÚnuÎ
 ((1));

763 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

764 
__THROWNL
 
	`__nÚnuÎ
 ((1));

766 #ifdeà
__USE_XOPEN2K


768 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

769 cÚ¡ 
time¥ec
 *
__»¡riù


770 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

774 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

775 
__THROWNL
 
	`__nÚnuÎ
 ((1));

779 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

780 
__»¡riù
 
__mu‹x
,

781 *
__»¡riù
 
__´ioûšg
)

782 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

786 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

787 
__´ioûšg
,

788 *
__»¡riù
 
__Şd_ûšg
)

789 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

792 #ifdeà
__USE_XOPEN2K8


794 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

795 
__THROW
 
	`__nÚnuÎ
 ((1));

796 #ifdeà
__USE_GNU


797 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

798 
__THROW
 
	`__nÚnuÎ
 ((1));

807 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

811 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

812 
__THROW
 
	`__nÚnuÎ
 ((1));

815 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

816 
__»¡riù
 
__©Œ
,

817 *
__»¡riù
 
__psh¬ed
)

818 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

821 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

822 
__psh¬ed
)

823 
__THROW
 
	`__nÚnuÎ
 ((1));

825 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


827 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


828 
__©Œ
, *
__»¡riù
 
__kšd
)

829 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

834 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

835 
__THROW
 
	`__nÚnuÎ
 ((1));

839 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

840 
__»¡riù
 
__©Œ
,

841 *
__»¡riù
 
__´ÙocŞ
)

842 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

846 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

847 
__´ÙocŞ
)

848 
__THROW
 
	`__nÚnuÎ
 ((1));

851 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

852 
__»¡riù
 
__©Œ
,

853 *
__»¡riù
 
__´ioûšg
)

854 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

857 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

858 
__´ioûšg
)

859 
__THROW
 
	`__nÚnuÎ
 ((1));

861 #ifdeà
__USE_XOPEN2K


863 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

864 *
__robu¡Ãss
)

865 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

866 #ifdeà
__USE_GNU


867 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 *
__robu¡Ãss
)

869 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

873 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1));

884 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


889 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

890 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


891 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

894 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

895 
__THROW
 
	`__nÚnuÎ
 ((1));

898 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

899 
__THROWNL
 
	`__nÚnuÎ
 ((1));

902 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

903 
__THROWNL
 
	`__nÚnuÎ
 ((1));

905 #ifdeà
__USE_XOPEN2K


907 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

908 cÚ¡ 
time¥ec
 *
__»¡riù


909 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

913 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

914 
__THROWNL
 
	`__nÚnuÎ
 ((1));

917 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

918 
__THROWNL
 
	`__nÚnuÎ
 ((1));

920 #ifdeà
__USE_XOPEN2K


922 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

923 cÚ¡ 
time¥ec
 *
__»¡riù


924 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

928 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

929 
__THROWNL
 
	`__nÚnuÎ
 ((1));

935 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

936 
__THROW
 
	`__nÚnuÎ
 ((1));

939 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

940 
__THROW
 
	`__nÚnuÎ
 ((1));

943 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

944 
__»¡riù
 
__©Œ
,

945 *
__»¡riù
 
__psh¬ed
)

946 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

949 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

950 
__psh¬ed
)

951 
__THROW
 
	`__nÚnuÎ
 ((1));

954 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

955 
__»¡riù
 
__©Œ
,

956 *
__»¡riù
 
__´ef
)

957 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

960 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

961 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

969 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

970 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

971 
__THROW
 
	`__nÚnuÎ
 ((1));

974 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

975 
__THROW
 
	`__nÚnuÎ
 ((1));

978 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

979 
__THROWNL
 
	`__nÚnuÎ
 ((1));

982 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

983 
__THROWNL
 
	`__nÚnuÎ
 ((1));

990 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

991 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

992 
	`__nÚnuÎ
 ((1, 2));

1001 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1002 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1003 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1004 
	`__nÚnuÎ
 ((1, 2, 3));

1009 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1010 
__THROW
 
	`__nÚnuÎ
 ((1));

1013 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1014 
__THROW
 
	`__nÚnuÎ
 ((1));

1017 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1018 
__»¡riù
 
__©Œ
,

1019 *
__»¡riù
 
__psh¬ed
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1023 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1024 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1026 #ifdeà
__USE_XOPEN2K


1028 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1029 
__»¡riù
 
__©Œ
,

1030 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1031 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1034 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1035 
__şockid_t
 
__şock_id
)

1036 
__THROW
 
	`__nÚnuÎ
 ((1));

1040 #ifdeà
__USE_XOPEN2K


1045 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1049 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1050 
__THROW
 
	`__nÚnuÎ
 ((1));

1053 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1054 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1057 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1058 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1061 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1062 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1069 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1070 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1071 
__©Œ
, 
__couÁ
)

1072 
__THROW
 
	`__nÚnuÎ
 ((1));

1075 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1076 
__THROW
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1080 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1084 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1085 
__THROW
 
	`__nÚnuÎ
 ((1));

1088 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1089 
__THROW
 
	`__nÚnuÎ
 ((1));

1092 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1093 
__»¡riù
 
__©Œ
,

1094 *
__»¡riù
 
__psh¬ed
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1098 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1099 
__psh¬ed
)

1100 
__THROW
 
	`__nÚnuÎ
 ((1));

1112 
	$±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1113 (*
__de¡r_funùiÚ
) (*))

1114 
__THROW
 
	`__nÚnuÎ
 ((1));

1117 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1120 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1123 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1124 cÚ¡ *
__poš‹r
è
__THROW
 ;

1127 #ifdeà
__USE_XOPEN2K


1129 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1130 
__şockid_t
 *
__şock_id
)

1131 
__THROW
 
	`__nÚnuÎ
 ((2));

1146 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1147 (*
__·»Á
) (),

1148 (*
__chd
è()è
__THROW
;

1151 #ifdeà
__USE_EXTERN_INLINES


1153 
__ex‹º_šlše
 

1154 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1156  
__th»ad1
 =ğ
__th»ad2
;

1157 
	}
}

1160 
	g__END_DECLS


	@/usr/include/snappy.h

39 #iâdeà
THIRD_PARTY_SNAPPY_SNAPPY_H__


40 
	#THIRD_PARTY_SNAPPY_SNAPPY_H__


	)

42 
	~<¡ddef.h
>

43 
	~<¡ršg
>

45 
	~"¢­py-¡ubs-public.h
"

47 
Çme¥aû
 
	g¢­py
 {

48 
şass
 
	gSourû
;

49 
şass
 
	gSšk
;

57 
size_t
 
Com´ess
(
Sourû
* 
sourû
, 
Sšk
* 
sšk
);

66 
boŞ
 
G‘Uncom´es£dL’gth
(
Sourû
* 
sourû
, 
ušt32
* 
»suÉ
);

76 
size_t
 
Com´ess
(cÚ¡ * 
šput
, size_ˆ
šput_Ëngth
, 
¡ršg
* 
ouut
);

84 
boŞ
 
Uncom´ess
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

85 
¡ršg
* 
uncom´es£d
);

90 
boŞ
 
Uncom´ess
(
Sourû
* 
com´es£d
, 
Sšk
* 
uncom´es£d
);

98 
size_t
 
Uncom´essAsMuchAsPossibË
(
Sourû
* 
com´es£d
, 
Sšk
* 
uncom´es£d
);

119 
RawCom´ess
(cÚ¡ * 
šput
,

120 
size_t
 
šput_Ëngth
,

121 * 
com´es£d
,

122 
size_t
* 
com´es£d_Ëngth
);

129 
boŞ
 
RawUncom´ess
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

130 * 
uncom´es£d
);

137 
boŞ
 
RawUncom´ess
(
Sourû
* 
com´es£d
, * 
uncom´es£d
);

147 
boŞ
 
RawUncom´essToIOVec
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

148 cÚ¡ 
iovec
* 
iov
, 
size_t
 
iov_út
);

158 
boŞ
 
RawUncom´essToIOVec
(
Sourû
* 
com´es£d
, cÚ¡ 
iovec
* 
iov
,

159 
size_t
 
iov_út
);

163 
size_t
 
MaxCom´es£dL’gth
(size_ˆ
sourû_by‹s
);

169 
boŞ
 
G‘Uncom´es£dL’gth
(cÚ¡ * 
com´es£d
, 
size_t
 
com´es£d_Ëngth
,

170 
size_t
* 
»suÉ
);

176 
boŞ
 
IsV®idCom´es£dBufãr
(cÚ¡ * 
com´es£d
,

177 
size_t
 
com´es£d_Ëngth
);

185 
boŞ
 
IsV®idCom´es£d
(
Sourû
* 
com´es£d
);

196 cÚ¡ 
	gkBlockLog
 = 16;

197 cÚ¡ 
size_t
 
	gkBlockSize
 = 1 << 
kBlockLog
;

199 cÚ¡ 
	gkMaxHashTabËB™s
 = 14;

200 cÚ¡ 
size_t
 
	gkMaxHashTabËSize
 = 1 << 
kMaxHashTabËB™s
;

	@/usr/include/sqlite3.h

33 #iâdeà
SQLITE3_H


34 
	#SQLITE3_H


	)

35 
	~<¡d¬g.h
>

40 #ifdeà
__ılu¥lus


48 #iâdeà
SQLITE_EXTERN


49 
	#SQLITE_EXTERN
 

	)

51 #iâdeà
SQLITE_API


52 
	#SQLITE_API


	)

54 #iâdeà
SQLITE_CDECL


55 
	#SQLITE_CDECL


	)

57 #iâdeà
SQLITE_APICALL


58 
	#SQLITE_APICALL


	)

60 #iâdeà
SQLITE_STDCALL


61 
	#SQLITE_STDCALL
 
SQLITE_APICALL


	)

63 #iâdeà
SQLITE_CALLBACK


64 
	#SQLITE_CALLBACK


	)

66 #iâdeà
SQLITE_SYSAPI


67 
	#SQLITE_SYSAPI


	)

83 
	#SQLITE_DEPRECATED


	)

84 
	#SQLITE_EXPERIMENTAL


	)

89 #ifdeà
SQLITE_VERSION


90 #undeà
SQLITE_VERSION


92 #ifdeà
SQLITE_VERSION_NUMBER


93 #undeà
SQLITE_VERSION_NUMBER


126 
	#SQLITE_VERSION
 "3.22.0"

	)

127 
	#SQLITE_VERSION_NUMBER
 3022000

	)

128 
	#SQLITE_SOURCE_ID
 "2018-01-22 18:45:57 0c55d179733b46d8d0ba4d88e01a25e10677046“3da1d5b1581e86726f2®t1"

	)

162 
SQLITE_API
 
SQLITE_EXTERN
 cÚ¡ 
sql™e3_v”siÚ
[];

163 
SQLITE_API
 cÚ¡ *
sql™e3_libv”siÚ
();

164 
SQLITE_API
 cÚ¡ *
sql™e3_sourûid
();

165 
SQLITE_API
 
sql™e3_libv”siÚ_numb”
();

189 #iâdeà
SQLITE_OMIT_COMPILEOPTION_DIAGS


190 
SQLITE_API
 
sql™e3_compeİtiÚ_u£d
(cÚ¡ *
zO±Name
);

191 
SQLITE_API
 cÚ¡ *
sql™e3_compeİtiÚ_g‘
(
N
);

230 
SQLITE_API
 
sql™e3_th»ad§ã
();

246 
sql™e3
 
	tsql™e3
;

264 #ifdeà
SQLITE_INT64_TYPE


265 
SQLITE_INT64_TYPE
 
	tsql™e_št64
;

266 #ifdeà
SQLITE_UINT64_TYPE


267 
SQLITE_UINT64_TYPE
 
	tsql™e_ušt64
;

269 
	tSQLITE_INT64_TYPE
 
	tsql™e_ušt64
;

271 #–ià
defšed
(
_MSC_VER
è|| defšed(
__BORLANDC__
)

272 
__št64
 
	tsql™e_št64
;

273 
	t__št64
 
	tsql™e_ušt64
;

275 
	tsql™e_št64
;

276 
	tsql™e_ušt64
;

278 
sql™e_št64
 
	tsql™e3_št64
;

279 
sql™e_ušt64
 
	tsql™e3_ušt64
;

285 #ifdeà
SQLITE_OMIT_FLOATING_POINT


286 
sql™e3_št64


	)

331 
SQLITE_API
 
sql™e3_şo£
(
sql™e3
*);

332 
SQLITE_API
 
sql™e3_şo£_v2
(
sql™e3
*);

339 (*
sql™e3_ÿÎback
)(*,,**, **);

403 
SQLITE_API
 
sql™e3_exec
(

404 
sql™e3
*,

405 cÚ¡ *
sql
,

406 (*
ÿÎback
)(*,,**,**),

408 **
”rmsg


422 
	#SQLITE_OK
 0

	)

424 
	#SQLITE_ERROR
 1

	)

425 
	#SQLITE_INTERNAL
 2

	)

426 
	#SQLITE_PERM
 3

	)

427 
	#SQLITE_ABORT
 4

	)

428 
	#SQLITE_BUSY
 5

	)

429 
	#SQLITE_LOCKED
 6

	)

430 
	#SQLITE_NOMEM
 7

	)

431 
	#SQLITE_READONLY
 8

	)

432 
	#SQLITE_INTERRUPT
 9

	)

433 
	#SQLITE_IOERR
 10

	)

434 
	#SQLITE_CORRUPT
 11

	)

435 
	#SQLITE_NOTFOUND
 12

	)

436 
	#SQLITE_FULL
 13

	)

437 
	#SQLITE_CANTOPEN
 14

	)

438 
	#SQLITE_PROTOCOL
 15

	)

439 
	#SQLITE_EMPTY
 16

	)

440 
	#SQLITE_SCHEMA
 17

	)

441 
	#SQLITE_TOOBIG
 18

	)

442 
	#SQLITE_CONSTRAINT
 19

	)

443 
	#SQLITE_MISMATCH
 20

	)

444 
	#SQLITE_MISUSE
 21

	)

445 
	#SQLITE_NOLFS
 22

	)

446 
	#SQLITE_AUTH
 23

	)

447 
	#SQLITE_FORMAT
 24

	)

448 
	#SQLITE_RANGE
 25

	)

449 
	#SQLITE_NOTADB
 26

	)

450 
	#SQLITE_NOTICE
 27

	)

451 
	#SQLITE_WARNING
 28

	)

452 
	#SQLITE_ROW
 100

	)

453 
	#SQLITE_DONE
 101

	)

473 
	#SQLITE_ERROR_MISSING_COLLSEQ
 (
SQLITE_ERROR
 | (1<<8))

	)

474 
	#SQLITE_ERROR_RETRY
 (
SQLITE_ERROR
 | (2<<8))

	)

475 
	#SQLITE_IOERR_READ
 (
SQLITE_IOERR
 | (1<<8))

	)

476 
	#SQLITE_IOERR_SHORT_READ
 (
SQLITE_IOERR
 | (2<<8))

	)

477 
	#SQLITE_IOERR_WRITE
 (
SQLITE_IOERR
 | (3<<8))

	)

478 
	#SQLITE_IOERR_FSYNC
 (
SQLITE_IOERR
 | (4<<8))

	)

479 
	#SQLITE_IOERR_DIR_FSYNC
 (
SQLITE_IOERR
 | (5<<8))

	)

480 
	#SQLITE_IOERR_TRUNCATE
 (
SQLITE_IOERR
 | (6<<8))

	)

481 
	#SQLITE_IOERR_FSTAT
 (
SQLITE_IOERR
 | (7<<8))

	)

482 
	#SQLITE_IOERR_UNLOCK
 (
SQLITE_IOERR
 | (8<<8))

	)

483 
	#SQLITE_IOERR_RDLOCK
 (
SQLITE_IOERR
 | (9<<8))

	)

484 
	#SQLITE_IOERR_DELETE
 (
SQLITE_IOERR
 | (10<<8))

	)

485 
	#SQLITE_IOERR_BLOCKED
 (
SQLITE_IOERR
 | (11<<8))

	)

486 
	#SQLITE_IOERR_NOMEM
 (
SQLITE_IOERR
 | (12<<8))

	)

487 
	#SQLITE_IOERR_ACCESS
 (
SQLITE_IOERR
 | (13<<8))

	)

488 
	#SQLITE_IOERR_CHECKRESERVEDLOCK
 (
SQLITE_IOERR
 | (14<<8))

	)

489 
	#SQLITE_IOERR_LOCK
 (
SQLITE_IOERR
 | (15<<8))

	)

490 
	#SQLITE_IOERR_CLOSE
 (
SQLITE_IOERR
 | (16<<8))

	)

491 
	#SQLITE_IOERR_DIR_CLOSE
 (
SQLITE_IOERR
 | (17<<8))

	)

492 
	#SQLITE_IOERR_SHMOPEN
 (
SQLITE_IOERR
 | (18<<8))

	)

493 
	#SQLITE_IOERR_SHMSIZE
 (
SQLITE_IOERR
 | (19<<8))

	)

494 
	#SQLITE_IOERR_SHMLOCK
 (
SQLITE_IOERR
 | (20<<8))

	)

495 
	#SQLITE_IOERR_SHMMAP
 (
SQLITE_IOERR
 | (21<<8))

	)

496 
	#SQLITE_IOERR_SEEK
 (
SQLITE_IOERR
 | (22<<8))

	)

497 
	#SQLITE_IOERR_DELETE_NOENT
 (
SQLITE_IOERR
 | (23<<8))

	)

498 
	#SQLITE_IOERR_MMAP
 (
SQLITE_IOERR
 | (24<<8))

	)

499 
	#SQLITE_IOERR_GETTEMPPATH
 (
SQLITE_IOERR
 | (25<<8))

	)

500 
	#SQLITE_IOERR_CONVPATH
 (
SQLITE_IOERR
 | (26<<8))

	)

501 
	#SQLITE_IOERR_VNODE
 (
SQLITE_IOERR
 | (27<<8))

	)

502 
	#SQLITE_IOERR_AUTH
 (
SQLITE_IOERR
 | (28<<8))

	)

503 
	#SQLITE_IOERR_BEGIN_ATOMIC
 (
SQLITE_IOERR
 | (29<<8))

	)

504 
	#SQLITE_IOERR_COMMIT_ATOMIC
 (
SQLITE_IOERR
 | (30<<8))

	)

505 
	#SQLITE_IOERR_ROLLBACK_ATOMIC
 (
SQLITE_IOERR
 | (31<<8))

	)

506 
	#SQLITE_LOCKED_SHAREDCACHE
 (
SQLITE_LOCKED
 | (1<<8))

	)

507 
	#SQLITE_BUSY_RECOVERY
 (
SQLITE_BUSY
 | (1<<8))

	)

508 
	#SQLITE_BUSY_SNAPSHOT
 (
SQLITE_BUSY
 | (2<<8))

	)

509 
	#SQLITE_CANTOPEN_NOTEMPDIR
 (
SQLITE_CANTOPEN
 | (1<<8))

	)

510 
	#SQLITE_CANTOPEN_ISDIR
 (
SQLITE_CANTOPEN
 | (2<<8))

	)

511 
	#SQLITE_CANTOPEN_FULLPATH
 (
SQLITE_CANTOPEN
 | (3<<8))

	)

512 
	#SQLITE_CANTOPEN_CONVPATH
 (
SQLITE_CANTOPEN
 | (4<<8))

	)

513 
	#SQLITE_CORRUPT_VTAB
 (
SQLITE_CORRUPT
 | (1<<8))

	)

514 
	#SQLITE_READONLY_RECOVERY
 (
SQLITE_READONLY
 | (1<<8))

	)

515 
	#SQLITE_READONLY_CANTLOCK
 (
SQLITE_READONLY
 | (2<<8))

	)

516 
	#SQLITE_READONLY_ROLLBACK
 (
SQLITE_READONLY
 | (3<<8))

	)

517 
	#SQLITE_READONLY_DBMOVED
 (
SQLITE_READONLY
 | (4<<8))

	)

518 
	#SQLITE_READONLY_CANTINIT
 (
SQLITE_READONLY
 | (5<<8))

	)

519 
	#SQLITE_READONLY_DIRECTORY
 (
SQLITE_READONLY
 | (6<<8))

	)

520 
	#SQLITE_ABORT_ROLLBACK
 (
SQLITE_ABORT
 | (2<<8))

	)

521 
	#SQLITE_CONSTRAINT_CHECK
 (
SQLITE_CONSTRAINT
 | (1<<8))

	)

522 
	#SQLITE_CONSTRAINT_COMMITHOOK
 (
SQLITE_CONSTRAINT
 | (2<<8))

	)

523 
	#SQLITE_CONSTRAINT_FOREIGNKEY
 (
SQLITE_CONSTRAINT
 | (3<<8))

	)

524 
	#SQLITE_CONSTRAINT_FUNCTION
 (
SQLITE_CONSTRAINT
 | (4<<8))

	)

525 
	#SQLITE_CONSTRAINT_NOTNULL
 (
SQLITE_CONSTRAINT
 | (5<<8))

	)

526 
	#SQLITE_CONSTRAINT_PRIMARYKEY
 (
SQLITE_CONSTRAINT
 | (6<<8))

	)

527 
	#SQLITE_CONSTRAINT_TRIGGER
 (
SQLITE_CONSTRAINT
 | (7<<8))

	)

528 
	#SQLITE_CONSTRAINT_UNIQUE
 (
SQLITE_CONSTRAINT
 | (8<<8))

	)

529 
	#SQLITE_CONSTRAINT_VTAB
 (
SQLITE_CONSTRAINT
 | (9<<8))

	)

530 
	#SQLITE_CONSTRAINT_ROWID
 (
SQLITE_CONSTRAINT
 |(10<<8))

	)

531 
	#SQLITE_NOTICE_RECOVER_WAL
 (
SQLITE_NOTICE
 | (1<<8))

	)

532 
	#SQLITE_NOTICE_RECOVER_ROLLBACK
 (
SQLITE_NOTICE
 | (2<<8))

	)

533 
	#SQLITE_WARNING_AUTOINDEX
 (
SQLITE_WARNING
 | (1<<8))

	)

534 
	#SQLITE_AUTH_USER
 (
SQLITE_AUTH
 | (1<<8))

	)

535 
	#SQLITE_OK_LOAD_PERMANENTLY
 (
SQLITE_OK
 | (1<<8))

	)

544 
	#SQLITE_OPEN_READONLY
 0x00000001

	)

545 
	#SQLITE_OPEN_READWRITE
 0x00000002

	)

546 
	#SQLITE_OPEN_CREATE
 0x00000004

	)

547 
	#SQLITE_OPEN_DELETEONCLOSE
 0x00000008

	)

548 
	#SQLITE_OPEN_EXCLUSIVE
 0x00000010

	)

549 
	#SQLITE_OPEN_AUTOPROXY
 0x00000020

	)

550 
	#SQLITE_OPEN_URI
 0x00000040

	)

551 
	#SQLITE_OPEN_MEMORY
 0x00000080

	)

552 
	#SQLITE_OPEN_MAIN_DB
 0x00000100

	)

553 
	#SQLITE_OPEN_TEMP_DB
 0x00000200

	)

554 
	#SQLITE_OPEN_TRANSIENT_DB
 0x00000400

	)

555 
	#SQLITE_OPEN_MAIN_JOURNAL
 0x00000800

	)

556 
	#SQLITE_OPEN_TEMP_JOURNAL
 0x00001000

	)

557 
	#SQLITE_OPEN_SUBJOURNAL
 0x00002000

	)

558 
	#SQLITE_OPEN_MASTER_JOURNAL
 0x00004000

	)

559 
	#SQLITE_OPEN_NOMUTEX
 0x00008000

	)

560 
	#SQLITE_OPEN_FULLMUTEX
 0x00010000

	)

561 
	#SQLITE_OPEN_SHAREDCACHE
 0x00020000

	)

562 
	#SQLITE_OPEN_PRIVATECACHE
 0x00040000

	)

563 
	#SQLITE_OPEN_WAL
 0x00080000

	)

600 
	#SQLITE_IOCAP_ATOMIC
 0x00000001

	)

601 
	#SQLITE_IOCAP_ATOMIC512
 0x00000002

	)

602 
	#SQLITE_IOCAP_ATOMIC1K
 0x00000004

	)

603 
	#SQLITE_IOCAP_ATOMIC2K
 0x00000008

	)

604 
	#SQLITE_IOCAP_ATOMIC4K
 0x00000010

	)

605 
	#SQLITE_IOCAP_ATOMIC8K
 0x00000020

	)

606 
	#SQLITE_IOCAP_ATOMIC16K
 0x00000040

	)

607 
	#SQLITE_IOCAP_ATOMIC32K
 0x00000080

	)

608 
	#SQLITE_IOCAP_ATOMIC64K
 0x00000100

	)

609 
	#SQLITE_IOCAP_SAFE_APPEND
 0x00000200

	)

610 
	#SQLITE_IOCAP_SEQUENTIAL
 0x00000400

	)

611 
	#SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN
 0x00000800

	)

612 
	#SQLITE_IOCAP_POWERSAFE_OVERWRITE
 0x00001000

	)

613 
	#SQLITE_IOCAP_IMMUTABLE
 0x00002000

	)

614 
	#SQLITE_IOCAP_BATCH_ATOMIC
 0x00004000

	)

623 
	#SQLITE_LOCK_NONE
 0

	)

624 
	#SQLITE_LOCK_SHARED
 1

	)

625 
	#SQLITE_LOCK_RESERVED
 2

	)

626 
	#SQLITE_LOCK_PENDING
 3

	)

627 
	#SQLITE_LOCK_EXCLUSIVE
 4

	)

655 
	#SQLITE_SYNC_NORMAL
 0x00002

	)

656 
	#SQLITE_SYNC_FULL
 0x00003

	)

657 
	#SQLITE_SYNC_DATAONLY
 0x00010

	)

670 
sql™e3_fe
 
	tsql™e3_fe
;

671 
	ssql™e3_fe
 {

672 cÚ¡ 
sql™e3_io_m‘hods
 *
pM‘hods
;

769 
sql™e3_io_m‘hods
 
	tsql™e3_io_m‘hods
;

770 
	ssql™e3_io_m‘hods
 {

771 
iV”siÚ
;

772 (*
xClo£
)(
sql™e3_fe
*);

773 (*
xR—d
)(
sql™e3_fe
*, *, 
iAmt
, 
sql™e3_št64
 
iOf¡
);

774 (*
xWr™e
)(
sql™e3_fe
*, cÚ¡ *, 
iAmt
, 
sql™e3_št64
 
iOf¡
);

775 (*
xTrunÿ‹
)(
sql™e3_fe
*, 
sql™e3_št64
 
size
);

776 (*
xSync
)(
sql™e3_fe
*, 
æags
);

777 (*
xFeSize
)(
sql™e3_fe
*, 
sql™e3_št64
 *
pSize
);

778 (*
xLock
)(
sql™e3_fe
*, );

779 (*
xUÆock
)(
sql™e3_fe
*, );

780 (*
xCheckRe£rvedLock
)(
sql™e3_fe
*, *
pResOut
);

781 (*
xFeCÚŒŞ
)(
sql™e3_fe
*, 
İ
, *
pArg
);

782 (*
xSeùÜSize
)(
sql™e3_fe
*);

783 (*
xDeviûCh¬aù”i¡ics
)(
sql™e3_fe
*);

785 (*
xShmM­
)(
sql™e3_fe
*, 
iPg
, 
pgsz
, , volatile**);

786 (*
xShmLock
)(
sql™e3_fe
*, 
off£t
, 
n
, 
æags
);

787 (*
xShmB¬r›r
)(
sql™e3_fe
*);

788 (*
xShmUnm­
)(
sql™e3_fe
*, 
d–‘eFÏg
);

790 (*
xF‘ch
)(
sql™e3_fe
*, 
sql™e3_št64
 
iOf¡
, 
iAmt
, **
µ
);

791 (*
xUnãtch
)(
sql™e3_fe
*, 
sql™e3_št64
 
iOf¡
, *
p
);

1069 
	#SQLITE_FCNTL_LOCKSTATE
 1

	)

1070 
	#SQLITE_FCNTL_GET_LOCKPROXYFILE
 2

	)

1071 
	#SQLITE_FCNTL_SET_LOCKPROXYFILE
 3

	)

1072 
	#SQLITE_FCNTL_LAST_ERRNO
 4

	)

1073 
	#SQLITE_FCNTL_SIZE_HINT
 5

	)

1074 
	#SQLITE_FCNTL_CHUNK_SIZE
 6

	)

1075 
	#SQLITE_FCNTL_FILE_POINTER
 7

	)

1076 
	#SQLITE_FCNTL_SYNC_OMITTED
 8

	)

1077 
	#SQLITE_FCNTL_WIN32_AV_RETRY
 9

	)

1078 
	#SQLITE_FCNTL_PERSIST_WAL
 10

	)

1079 
	#SQLITE_FCNTL_OVERWRITE
 11

	)

1080 
	#SQLITE_FCNTL_VFSNAME
 12

	)

1081 
	#SQLITE_FCNTL_POWERSAFE_OVERWRITE
 13

	)

1082 
	#SQLITE_FCNTL_PRAGMA
 14

	)

1083 
	#SQLITE_FCNTL_BUSYHANDLER
 15

	)

1084 
	#SQLITE_FCNTL_TEMPFILENAME
 16

	)

1085 
	#SQLITE_FCNTL_MMAP_SIZE
 18

	)

1086 
	#SQLITE_FCNTL_TRACE
 19

	)

1087 
	#SQLITE_FCNTL_HAS_MOVED
 20

	)

1088 
	#SQLITE_FCNTL_SYNC
 21

	)

1089 
	#SQLITE_FCNTL_COMMIT_PHASETWO
 22

	)

1090 
	#SQLITE_FCNTL_WIN32_SET_HANDLE
 23

	)

1091 
	#SQLITE_FCNTL_WAL_BLOCK
 24

	)

1092 
	#SQLITE_FCNTL_ZIPVFS
 25

	)

1093 
	#SQLITE_FCNTL_RBU
 26

	)

1094 
	#SQLITE_FCNTL_VFS_POINTER
 27

	)

1095 
	#SQLITE_FCNTL_JOURNAL_POINTER
 28

	)

1096 
	#SQLITE_FCNTL_WIN32_GET_HANDLE
 29

	)

1097 
	#SQLITE_FCNTL_PDB
 30

	)

1098 
	#SQLITE_FCNTL_BEGIN_ATOMIC_WRITE
 31

	)

1099 
	#SQLITE_FCNTL_COMMIT_ATOMIC_WRITE
 32

	)

1100 
	#SQLITE_FCNTL_ROLLBACK_ATOMIC_WRITE
 33

	)

1103 
	#SQLITE_GET_LOCKPROXYFILE
 
SQLITE_FCNTL_GET_LOCKPROXYFILE


	)

1104 
	#SQLITE_SET_LOCKPROXYFILE
 
SQLITE_FCNTL_SET_LOCKPROXYFILE


	)

1105 
	#SQLITE_LAST_ERRNO
 
SQLITE_FCNTL_LAST_ERRNO


	)

1118 
sql™e3_mu‹x
 
	tsql™e3_mu‹x
;

1128 
sql™e3_­i_routšes
 
	tsql™e3_­i_routšes
;

1293 
sql™e3_vfs
 
	tsql™e3_vfs
;

1294 (*
sql™e3_sysÿÎ_±r
)();

1295 
	ssql™e3_vfs
 {

1296 
iV”siÚ
;

1297 
szOsFe
;

1298 
mxP©hÇme
;

1299 
sql™e3_vfs
 *
pNext
;

1300 cÚ¡ *
zName
;

1301 *
pAµD©a
;

1302 (*
xO³n
)(
sql™e3_vfs
*, cÚ¡ *
zName
, 
sql™e3_fe
*,

1303 
æags
, *
pOutFÏgs
);

1304 (*
xD–‘e
)(
sql™e3_vfs
*, cÚ¡ *
zName
, 
syncDœ
);

1305 (*
xAcûss
)(
sql™e3_vfs
*, cÚ¡ *
zName
, 
æags
, *
pResOut
);

1306 (*
xFuÎP©hÇme
)(
sql™e3_vfs
*, cÚ¡ *
zName
, 
nOut
, *
zOut
);

1307 *(*
xDlO³n
)(
sql™e3_vfs
*, cÚ¡ *
zF’ame
);

1308 (*
xDlE¼Ü
)(
sql™e3_vfs
*, 
nBy‹
, *
zE¼Msg
);

1309 (*(*
xDlSym
)(
sql™e3_vfs
*,*, cÚ¡ *
zSymbŞ
))();

1310 (*
xDlClo£
)(
sql™e3_vfs
*, *);

1311 (*
xRªdomÃss
)(
sql™e3_vfs
*, 
nBy‹
, *
zOut
);

1312 (*
xSË•
)(
sql™e3_vfs
*, 
miüo£cÚds
);

1313 (*
xCu¼’tTime
)(
sql™e3_vfs
*, *);

1314 (*
xG‘La¡E¼Ü
)(
sql™e3_vfs
*, , *);

1319 (*
xCu¼’tTimeIÁ64
)(
sql™e3_vfs
*, 
sql™e3_št64
*);

1324 (*
xS‘Sy¡emC®l
)(
sql™e3_vfs
*, cÚ¡ *
zName
, 
sql™e3_sysÿÎ_±r
);

1325 
sql™e3_sysÿÎ_±r
 (*
xG‘Sy¡emC®l
)(
sql™e3_vfs
*, cÚ¡ *
zName
);

1326 cÚ¡ *(*
xNextSy¡emC®l
)(
sql™e3_vfs
*, cÚ¡ *
zName
);

1354 
	#SQLITE_ACCESS_EXISTS
 0

	)

1355 
	#SQLITE_ACCESS_READWRITE
 1

	)

1356 
	#SQLITE_ACCESS_READ
 2

	)

1380 
	#SQLITE_SHM_UNLOCK
 1

	)

1381 
	#SQLITE_SHM_LOCK
 2

	)

1382 
	#SQLITE_SHM_SHARED
 4

	)

1383 
	#SQLITE_SHM_EXCLUSIVE
 8

	)

1393 
	#SQLITE_SHM_NLOCK
 8

	)

1471 
SQLITE_API
 
sql™e3_š™Ÿlize
();

1472 
SQLITE_API
 
sql™e3_shutdown
();

1473 
SQLITE_API
 
sql™e3_os_š™
();

1474 
SQLITE_API
 
sql™e3_os_’d
();

1507 
SQLITE_API
 
sql™e3_cÚfig
(, ...);

1526 
SQLITE_API
 
sql™e3_db_cÚfig
(
sql™e3
*, 
İ
, ...);

1591 
sql™e3_mem_m‘hods
 
	tsql™e3_mem_m‘hods
;

1592 
	ssql™e3_mem_m‘hods
 {

1593 *(*
xM®loc
)();

1594 (*
xF»e
)(*);

1595 *(*
xR—Îoc
)(*,);

1596 (*
xSize
)(*);

1597 (*
xRoundup
)();

1598 (*
xIn™
)(*);

1599 (*
xShutdown
)(*);

1600 *
pAµD©a
;

1928 
	#SQLITE_CONFIG_SINGLETHREAD
 1

	)

1929 
	#SQLITE_CONFIG_MULTITHREAD
 2

	)

1930 
	#SQLITE_CONFIG_SERIALIZED
 3

	)

1931 
	#SQLITE_CONFIG_MALLOC
 4

	)

1932 
	#SQLITE_CONFIG_GETMALLOC
 5

	)

1933 
	#SQLITE_CONFIG_SCRATCH
 6

	)

1934 
	#SQLITE_CONFIG_PAGECACHE
 7

	)

1935 
	#SQLITE_CONFIG_HEAP
 8

	)

1936 
	#SQLITE_CONFIG_MEMSTATUS
 9

	)

1937 
	#SQLITE_CONFIG_MUTEX
 10

	)

1938 
	#SQLITE_CONFIG_GETMUTEX
 11

	)

1940 
	#SQLITE_CONFIG_LOOKASIDE
 13

	)

1941 
	#SQLITE_CONFIG_PCACHE
 14

	)

1942 
	#SQLITE_CONFIG_GETPCACHE
 15

	)

1943 
	#SQLITE_CONFIG_LOG
 16

	)

1944 
	#SQLITE_CONFIG_URI
 17

	)

1945 
	#SQLITE_CONFIG_PCACHE2
 18

	)

1946 
	#SQLITE_CONFIG_GETPCACHE2
 19

	)

1947 
	#SQLITE_CONFIG_COVERING_INDEX_SCAN
 20

	)

1948 
	#SQLITE_CONFIG_SQLLOG
 21

	)

1949 
	#SQLITE_CONFIG_MMAP_SIZE
 22

	)

1950 
	#SQLITE_CONFIG_WIN32_HEAPSIZE
 23

	)

1951 
	#SQLITE_CONFIG_PCACHE_HDRSZ
 24

	)

1952 
	#SQLITE_CONFIG_PMASZ
 25

	)

1953 
	#SQLITE_CONFIG_STMTJRNL_SPILL
 26

	)

1954 
	#SQLITE_CONFIG_SMALL_MALLOC
 27

	)

2084 
	#SQLITE_DBCONFIG_MAINDBNAME
 1000

	)

2085 
	#SQLITE_DBCONFIG_LOOKASIDE
 1001

	)

2086 
	#SQLITE_DBCONFIG_ENABLE_FKEY
 1002

	)

2087 
	#SQLITE_DBCONFIG_ENABLE_TRIGGER
 1003

	)

2088 
	#SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER
 1004

	)

2089 
	#SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION
 1005

	)

2090 
	#SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE
 1006

	)

2091 
	#SQLITE_DBCONFIG_ENABLE_QPSG
 1007

	)

2092 
	#SQLITE_DBCONFIG_TRIGGER_EQP
 1008

	)

2093 
	#SQLITE_DBCONFIG_MAX
 1008

	)

2103 
SQLITE_API
 
sql™e3_ex‹nded_»suÉ_codes
(
sql™e3
*, 
Úoff
);

2165 
SQLITE_API
 
sql™e3_št64
 
sql™e3_Ï¡_š£¹_rowid
(
sql™e3
*);

2175 
SQLITE_API
 
sql™e3_£t_Ï¡_š£¹_rowid
(
sql™e3
*,
sql™e3_št64
);

2228 
SQLITE_API
 
sql™e3_chªges
(
sql™e3
*);

2252 
SQLITE_API
 
sql™e3_tÙ®_chªges
(
sql™e3
*);

2289 
SQLITE_API
 
sql™e3_š‹¼u±
(
sql™e3
*);

2324 
SQLITE_API
 
sql™e3_com¶‘e
(cÚ¡ *
sql
);

2325 
SQLITE_API
 
sql™e3_com¶‘e16
(cÚ¡ *
sql
);

2386 
SQLITE_API
 
sql™e3_busy_hªdËr
(
sql™e3
*,(*)(*,),*);

2409 
SQLITE_API
 
sql™e3_busy_timeout
(
sql™e3
*, 
ms
);

2484 
SQLITE_API
 
sql™e3_g‘_bË
(

2485 
sql™e3
 *
db
,

2486 cÚ¡ *
zSql
,

2487 ***
·zResuÉ
,

2488 *
²Row
,

2489 *
²CŞumn
,

2490 **
pzE¼msg


2492 
SQLITE_API
 
sql™e3_ä“_bË
(**
»suÉ
);

2598 
SQLITE_API
 *
sql™e3_m´štf
(const *,...);

2599 
SQLITE_API
 *
sql™e3_vm´štf
(cÚ¡ *, 
va_li¡
);

2600 
SQLITE_API
 *
sql™e3_¢´štf
(,*,const *, ...);

2601 
SQLITE_API
 *
sql™e3_v¢´štf
(,*,cÚ¡ *, 
va_li¡
);

2691 
SQLITE_API
 *
sql™e3_m®loc
();

2692 
SQLITE_API
 *
sql™e3_m®loc64
(
sql™e3_ušt64
);

2693 
SQLITE_API
 *
sql™e3_»®loc
(*, );

2694 
SQLITE_API
 *
sql™e3_»®loc64
(*, 
sql™e3_ušt64
);

2695 
SQLITE_API
 
sql™e3_ä“
(*);

2696 
SQLITE_API
 
sql™e3_ušt64
 
sql™e3_msize
(*);

2721 
SQLITE_API
 
sql™e3_št64
 
sql™e3_memÜy_u£d
();

2722 
SQLITE_API
 
sql™e3_št64
 
sql™e3_memÜy_highw©”
(
»£tFÏg
);

2745 
SQLITE_API
 
sql™e3_¿ndomÃss
(
N
, *
P
);

2836 
SQLITE_API
 
sql™e3_£t_authÜiz”
(

2837 
sql™e3
*,

2838 (*
xAuth
)(*,,const *,const *,const *,const *),

2839 *
pU£rD©a


2854 
	#SQLITE_DENY
 1

	)

2855 
	#SQLITE_IGNORE
 2

	)

2877 
	#SQLITE_CREATE_INDEX
 1

	)

2878 
	#SQLITE_CREATE_TABLE
 2

	)

2879 
	#SQLITE_CREATE_TEMP_INDEX
 3

	)

2880 
	#SQLITE_CREATE_TEMP_TABLE
 4

	)

2881 
	#SQLITE_CREATE_TEMP_TRIGGER
 5

	)

2882 
	#SQLITE_CREATE_TEMP_VIEW
 6

	)

2883 
	#SQLITE_CREATE_TRIGGER
 7

	)

2884 
	#SQLITE_CREATE_VIEW
 8

	)

2885 
	#SQLITE_DELETE
 9

	)

2886 
	#SQLITE_DROP_INDEX
 10

	)

2887 
	#SQLITE_DROP_TABLE
 11

	)

2888 
	#SQLITE_DROP_TEMP_INDEX
 12

	)

2889 
	#SQLITE_DROP_TEMP_TABLE
 13

	)

2890 
	#SQLITE_DROP_TEMP_TRIGGER
 14

	)

2891 
	#SQLITE_DROP_TEMP_VIEW
 15

	)

2892 
	#SQLITE_DROP_TRIGGER
 16

	)

2893 
	#SQLITE_DROP_VIEW
 17

	)

2894 
	#SQLITE_INSERT
 18

	)

2895 
	#SQLITE_PRAGMA
 19

	)

2896 
	#SQLITE_READ
 20

	)

2897 
	#SQLITE_SELECT
 21

	)

2898 
	#SQLITE_TRANSACTION
 22

	)

2899 
	#SQLITE_UPDATE
 23

	)

2900 
	#SQLITE_ATTACH
 24

	)

2901 
	#SQLITE_DETACH
 25

	)

2902 
	#SQLITE_ALTER_TABLE
 26

	)

2903 
	#SQLITE_REINDEX
 27

	)

2904 
	#SQLITE_ANALYZE
 28

	)

2905 
	#SQLITE_CREATE_VTABLE
 29

	)

2906 
	#SQLITE_DROP_VTABLE
 30

	)

2907 
	#SQLITE_FUNCTION
 31

	)

2908 
	#SQLITE_SAVEPOINT
 32

	)

2909 
	#SQLITE_COPY
 0

	)

2910 
	#SQLITE_RECURSIVE
 33

	)

2944 
SQLITE_API
 
SQLITE_DEPRECATED
 *
sql™e3_Œaû
(
sql™e3
*,

2945 (*
xT¿û
)(*,const *), *);

2946 
SQLITE_API
 
SQLITE_DEPRECATED
 *
sql™e3_´ofe
(
sql™e3
*,

2947 (*
xProfe
)(*,cÚ¡ *,
sql™e3_ušt64
), *);

3001 
	#SQLITE_TRACE_STMT
 0x01

	)

3002 
	#SQLITE_TRACE_PROFILE
 0x02

	)

3003 
	#SQLITE_TRACE_ROW
 0x04

	)

3004 
	#SQLITE_TRACE_CLOSE
 0x08

	)

3035 
SQLITE_API
 
sql™e3_Œaû_v2
(

3036 
sql™e3
*,

3037 
uMask
,

3038 (*
xC®lback
)(,*,*,*),

3039 *
pCtx


3074 
SQLITE_API
 
sql™e3_´og»ss_hªdËr
(
sql™e3
*, , (*)(*), *);

3303 
SQLITE_API
 
sql™e3_İ’
(

3304 cÚ¡ *
f’ame
,

3305 
sql™e3
 **
µDb


3307 
SQLITE_API
 
sql™e3_İ’16
(

3308 cÚ¡ *
f’ame
,

3309 
sql™e3
 **
µDb


3311 
SQLITE_API
 
sql™e3_İ’_v2
(

3312 cÚ¡ *
f’ame
,

3313 
sql™e3
 **
µDb
,

3314 
æags
,

3315 cÚ¡ *
zVfs


3357 
SQLITE_API
 cÚ¡ *
sql™e3_uri_·¿m‘”
(cÚ¡ *
zF’ame
, cÚ¡ *
zP¬am
);

3358 
SQLITE_API
 
sql™e3_uri_boŞ—n
(cÚ¡ *
zFe
, cÚ¡ *
zP¬am
, 
bDeçuÉ
);

3359 
SQLITE_API
 
sql™e3_št64
 
sql™e3_uri_št64
(const *, const *, sqlite3_int64);

3403 
SQLITE_API
 
sql™e3_”rcode
(
sql™e3
 *
db
);

3404 
SQLITE_API
 
sql™e3_ex‹nded_”rcode
(
sql™e3
 *
db
);

3405 
SQLITE_API
 cÚ¡ *
sql™e3_”rmsg
(
sql™e3
*);

3406 
SQLITE_API
 cÚ¡ *
sql™e3_”rmsg16
(
sql™e3
*);

3407 
SQLITE_API
 cÚ¡ *
sql™e3_”r¡r
();

3433 
sql™e3_¡mt
 
	tsql™e3_¡mt
;

3475 
SQLITE_API
 
sql™e3_lim™
(
sql™e3
*, 
id
, 
ÃwV®
);

3533 
	#SQLITE_LIMIT_LENGTH
 0

	)

3534 
	#SQLITE_LIMIT_SQL_LENGTH
 1

	)

3535 
	#SQLITE_LIMIT_COLUMN
 2

	)

3536 
	#SQLITE_LIMIT_EXPR_DEPTH
 3

	)

3537 
	#SQLITE_LIMIT_COMPOUND_SELECT
 4

	)

3538 
	#SQLITE_LIMIT_VDBE_OP
 5

	)

3539 
	#SQLITE_LIMIT_FUNCTION_ARG
 6

	)

3540 
	#SQLITE_LIMIT_ATTACHED
 7

	)

3541 
	#SQLITE_LIMIT_LIKE_PATTERN_LENGTH
 8

	)

3542 
	#SQLITE_LIMIT_VARIABLE_NUMBER
 9

	)

3543 
	#SQLITE_LIMIT_TRIGGER_DEPTH
 10

	)

3544 
	#SQLITE_LIMIT_WORKER_THREADS
 11

	)

3568 
	#SQLITE_PREPARE_PERSISTENT
 0x01

	)

3670 
SQLITE_API
 
sql™e3_´•¬e
(

3671 
sql™e3
 *
db
,

3672 cÚ¡ *
zSql
,

3673 
nBy‹
,

3674 
sql™e3_¡mt
 **
µStmt
,

3675 cÚ¡ **
pzTa


3677 
SQLITE_API
 
sql™e3_´•¬e_v2
(

3678 
sql™e3
 *
db
,

3679 cÚ¡ *
zSql
,

3680 
nBy‹
,

3681 
sql™e3_¡mt
 **
µStmt
,

3682 cÚ¡ **
pzTa


3684 
SQLITE_API
 
sql™e3_´•¬e_v3
(

3685 
sql™e3
 *
db
,

3686 cÚ¡ *
zSql
,

3687 
nBy‹
,

3688 
´•FÏgs
,

3689 
sql™e3_¡mt
 **
µStmt
,

3690 cÚ¡ **
pzTa


3692 
SQLITE_API
 
sql™e3_´•¬e16
(

3693 
sql™e3
 *
db
,

3694 cÚ¡ *
zSql
,

3695 
nBy‹
,

3696 
sql™e3_¡mt
 **
µStmt
,

3697 cÚ¡ **
pzTa


3699 
SQLITE_API
 
sql™e3_´•¬e16_v2
(

3700 
sql™e3
 *
db
,

3701 cÚ¡ *
zSql
,

3702 
nBy‹
,

3703 
sql™e3_¡mt
 **
µStmt
,

3704 cÚ¡ **
pzTa


3706 
SQLITE_API
 
sql™e3_´•¬e16_v3
(

3707 
sql™e3
 *
db
,

3708 cÚ¡ *
zSql
,

3709 
nBy‹
,

3710 
´•FÏgs
,

3711 
sql™e3_¡mt
 **
µStmt
,

3712 cÚ¡ **
pzTa


3747 
SQLITE_API
 cÚ¡ *
sql™e3_sql
(
sql™e3_¡mt
 *
pStmt
);

3748 
SQLITE_API
 *
sql™e3_ex·nded_sql
(
sql™e3_¡mt
 *
pStmt
);

3784 
SQLITE_API
 
sql™e3_¡mt_»adÚly
(
sql™e3_¡mt
 *
pStmt
);

3805 
SQLITE_API
 
sql™e3_¡mt_busy
(
sql™e3_¡mt
*);

3847 
sql™e3_v®ue
 
	tsql™e3_v®ue
;

3861 
sql™e3_cÚ‹xt
 
	tsql™e3_cÚ‹xt
;

3979 
SQLITE_API
 
sql™e3_bšd_blob
(
sql™e3_¡mt
*, , cÚ¡ *, 
n
, (*)(*));

3980 
SQLITE_API
 
sql™e3_bšd_blob64
(
sql™e3_¡mt
*, , cÚ¡ *, 
sql™e3_ušt64
,

3982 
SQLITE_API
 
sql™e3_bšd_doubË
(
sql™e3_¡mt
*, , );

3983 
SQLITE_API
 
sql™e3_bšd_št
(
sql™e3_¡mt
*, , );

3984 
SQLITE_API
 
sql™e3_bšd_št64
(
sql™e3_¡mt
*, , 
sql™e3_št64
);

3985 
SQLITE_API
 
sql™e3_bšd_nuÎ
(
sql™e3_¡mt
*, );

3986 
SQLITE_API
 
sql™e3_bšd_‹xt
(
sql™e3_¡mt
*,,const *,,(*)(*));

3987 
SQLITE_API
 
sql™e3_bšd_‹xt16
(
sql™e3_¡mt
*, , const *, , (*)(*));

3988 
SQLITE_API
 
sql™e3_bšd_‹xt64
(
sql™e3_¡mt
*, , cÚ¡ *, 
sql™e3_ušt64
,

3989 (*)(*), 
’codšg
);

3990 
SQLITE_API
 
sql™e3_bšd_v®ue
(
sql™e3_¡mt
*, , cÚ¡ 
sql™e3_v®ue
*);

3991 
SQLITE_API
 
sql™e3_bšd_poš‹r
(
sql™e3_¡mt
*, , *, const *,(*)(*));

3992 
SQLITE_API
 
sql™e3_bšd_z”oblob
(
sql™e3_¡mt
*, , 
n
);

3993 
SQLITE_API
 
sql™e3_bšd_z”oblob64
(
sql™e3_¡mt
*, , 
sql™e3_ušt64
);

4014 
SQLITE_API
 
sql™e3_bšd_·¿m‘”_couÁ
(
sql™e3_¡mt
*);

4042 
SQLITE_API
 cÚ¡ *
sql™e3_bšd_·¿m‘”_Çme
(
sql™e3_¡mt
*, );

4060 
SQLITE_API
 
sql™e3_bšd_·¿m‘”_šdex
(
sql™e3_¡mt
*, cÚ¡ *
zName
);

4070 
SQLITE_API
 
sql™e3_ş—r_bšdšgs
(
sql™e3_¡mt
*);

4086 
SQLITE_API
 
sql™e3_cŞumn_couÁ
(
sql™e3_¡mt
 *
pStmt
);

4115 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_Çme
(
sql™e3_¡mt
*, 
N
);

4116 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_Çme16
(
sql™e3_¡mt
*, 
N
);

4164 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_d©aba£_Çme
(
sql™e3_¡mt
*,);

4165 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_d©aba£_Çme16
(
sql™e3_¡mt
*,);

4166 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_bË_Çme
(
sql™e3_¡mt
*,);

4167 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_bË_Çme16
(
sql™e3_¡mt
*,);

4168 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_Üigš_Çme
(
sql™e3_¡mt
*,);

4169 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_Üigš_Çme16
(
sql™e3_¡mt
*,);

4201 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_deşty³
(
sql™e3_¡mt
*,);

4202 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_deşty³16
(
sql™e3_¡mt
*,);

4286 
SQLITE_API
 
sql™e3_¡•
(
sql™e3_¡mt
*);

4307 
SQLITE_API
 
sql™e3_d©a_couÁ
(
sql™e3_¡mt
 *
pStmt
);

4330 
	#SQLITE_INTEGER
 1

	)

4331 
	#SQLITE_FLOAT
 2

	)

4332 
	#SQLITE_BLOB
 4

	)

4333 
	#SQLITE_NULL
 5

	)

4334 #ifdeà
SQLITE_TEXT


4335 #undeà
SQLITE_TEXT


4337 
	#SQLITE_TEXT
 3

	)

4339 
	#SQLITE3_TEXT
 3

	)

4536 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_blob
(
sql™e3_¡mt
*, 
iCŞ
);

4537 
SQLITE_API
 
sql™e3_cŞumn_doubË
(
sql™e3_¡mt
*, 
iCŞ
);

4538 
SQLITE_API
 
sql™e3_cŞumn_št
(
sql™e3_¡mt
*, 
iCŞ
);

4539 
SQLITE_API
 
sql™e3_št64
 
sql™e3_cŞumn_št64
(
sql™e3_¡mt
*, 
iCŞ
);

4540 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_‹xt
(
sql™e3_¡mt
*, 
iCŞ
);

4541 
SQLITE_API
 cÚ¡ *
sql™e3_cŞumn_‹xt16
(
sql™e3_¡mt
*, 
iCŞ
);

4542 
SQLITE_API
 
sql™e3_v®ue
 *
sql™e3_cŞumn_v®ue
(
sql™e3_¡mt
*, 
iCŞ
);

4543 
SQLITE_API
 
sql™e3_cŞumn_by‹s
(
sql™e3_¡mt
*, 
iCŞ
);

4544 
SQLITE_API
 
sql™e3_cŞumn_by‹s16
(
sql™e3_¡mt
*, 
iCŞ
);

4545 
SQLITE_API
 
sql™e3_cŞumn_ty³
(
sql™e3_¡mt
*, 
iCŞ
);

4573 
SQLITE_API
 
sql™e3_fš®ize
(
sql™e3_¡mt
 *
pStmt
);

4600 
SQLITE_API
 
sql™e3_»£t
(
sql™e3_¡mt
 *
pStmt
);

4700 
SQLITE_API
 
sql™e3_ü—‹_funùiÚ
(

4701 
sql™e3
 *
db
,

4702 cÚ¡ *
zFunùiÚName
,

4703 
nArg
,

4704 
eTextR•
,

4705 *
pAµ
,

4706 (*
xFunc
)(
sql™e3_cÚ‹xt
*,,
sql™e3_v®ue
**),

4707 (*
xS‹p
)(
sql™e3_cÚ‹xt
*,,
sql™e3_v®ue
**),

4708 (*
xFš®
)(
sql™e3_cÚ‹xt
*)

4710 
SQLITE_API
 
sql™e3_ü—‹_funùiÚ16
(

4711 
sql™e3
 *
db
,

4712 cÚ¡ *
zFunùiÚName
,

4713 
nArg
,

4714 
eTextR•
,

4715 *
pAµ
,

4716 (*
xFunc
)(
sql™e3_cÚ‹xt
*,,
sql™e3_v®ue
**),

4717 (*
xS‹p
)(
sql™e3_cÚ‹xt
*,,
sql™e3_v®ue
**),

4718 (*
xFš®
)(
sql™e3_cÚ‹xt
*)

4720 
SQLITE_API
 
sql™e3_ü—‹_funùiÚ_v2
(

4721 
sql™e3
 *
db
,

4722 cÚ¡ *
zFunùiÚName
,

4723 
nArg
,

4724 
eTextR•
,

4725 *
pAµ
,

4726 (*
xFunc
)(
sql™e3_cÚ‹xt
*,,
sql™e3_v®ue
**),

4727 (*
xS‹p
)(
sql™e3_cÚ‹xt
*,,
sql™e3_v®ue
**),

4728 (*
xFš®
)(
sql™e3_cÚ‹xt
*),

4729 (*
xDe¡roy
)(*)

4738 
	#SQLITE_UTF8
 1

	)

4739 
	#SQLITE_UTF16LE
 2

	)

4740 
	#SQLITE_UTF16BE
 3

	)

4741 
	#SQLITE_UTF16
 4

	)

4742 
	#SQLITE_ANY
 5

	)

4743 
	#SQLITE_UTF16_ALIGNED
 8

	)

4753 
	#SQLITE_DETERMINISTIC
 0x800

	)

4765 #iâdeà
SQLITE_OMIT_DEPRECATED


4766 
SQLITE_API
 
SQLITE_DEPRECATED
 
sql™e3_agg»g©e_couÁ
(
sql™e3_cÚ‹xt
*);

4767 
SQLITE_API
 
SQLITE_DEPRECATED
 
sql™e3_expœed
(
sql™e3_¡mt
*);

4768 
SQLITE_API
 
SQLITE_DEPRECATED
 
sql™e3_Œªsãr_bšdšgs
(
sql™e3_¡mt
*, sqlite3_stmt*);

4769 
SQLITE_API
 
SQLITE_DEPRECATED
 
sql™e3_glob®_»cov”
();

4770 
SQLITE_API
 
SQLITE_DEPRECATED
 
sql™e3_th»ad_ş—nup
();

4771 
SQLITE_API
 
SQLITE_DEPRECATED
 
sql™e3_memÜy_®¬m
((*)(*,
sql™e3_št64
,),

4772 *,
sql™e3_št64
);

4874 
SQLITE_API
 cÚ¡ *
sql™e3_v®ue_blob
(
sql™e3_v®ue
*);

4875 
SQLITE_API
 
sql™e3_v®ue_doubË
(
sql™e3_v®ue
*);

4876 
SQLITE_API
 
sql™e3_v®ue_št
(
sql™e3_v®ue
*);

4877 
SQLITE_API
 
sql™e3_št64
 
sql™e3_v®ue_št64
(
sql™e3_v®ue
*);

4878 
SQLITE_API
 *
sql™e3_v®ue_poš‹r
(
sql™e3_v®ue
*, const *);

4879 
SQLITE_API
 cÚ¡ *
sql™e3_v®ue_‹xt
(
sql™e3_v®ue
*);

4880 
SQLITE_API
 cÚ¡ *
sql™e3_v®ue_‹xt16
(
sql™e3_v®ue
*);

4881 
SQLITE_API
 cÚ¡ *
sql™e3_v®ue_‹xt16Ë
(
sql™e3_v®ue
*);

4882 
SQLITE_API
 cÚ¡ *
sql™e3_v®ue_‹xt16be
(
sql™e3_v®ue
*);

4883 
SQLITE_API
 
sql™e3_v®ue_by‹s
(
sql™e3_v®ue
*);

4884 
SQLITE_API
 
sql™e3_v®ue_by‹s16
(
sql™e3_v®ue
*);

4885 
SQLITE_API
 
sql™e3_v®ue_ty³
(
sql™e3_v®ue
*);

4886 
SQLITE_API
 
sql™e3_v®ue_num”ic_ty³
(
sql™e3_v®ue
*);

4887 
SQLITE_API
 
sql™e3_v®ue_nochªge
(
sql™e3_v®ue
*);

4899 
SQLITE_API
 
sql™e3_v®ue_subty³
(
sql™e3_v®ue
*);

4915 
SQLITE_API
 
sql™e3_v®ue
 *
sql™e3_v®ue_dup
(const sqlite3_value*);

4916 
SQLITE_API
 
sql™e3_v®ue_ä“
(
sql™e3_v®ue
*);

4961 
SQLITE_API
 *
sql™e3_agg»g©e_cÚ‹xt
(
sql™e3_cÚ‹xt
*, 
nBy‹s
);

4976 
SQLITE_API
 *
sql™e3_u£r_d©a
(
sql™e3_cÚ‹xt
*);

4988 
SQLITE_API
 
sql™e3
 *
sql™e3_cÚ‹xt_db_hªdË
(
sql™e3_cÚ‹xt
*);

5047 
SQLITE_API
 *
sql™e3_g‘_auxd©a
(
sql™e3_cÚ‹xt
*, 
N
);

5048 
SQLITE_API
 
sql™e3_£t_auxd©a
(
sql™e3_cÚ‹xt
*, 
N
, *, (*)(*));

5065 (*
sql™e3_de¡ruùÜ_ty³
)(*);

5066 
	#SQLITE_STATIC
 ((
sql™e3_de¡ruùÜ_ty³
)0)

	)

5067 
	#SQLITE_TRANSIENT
 ((
sql™e3_de¡ruùÜ_ty³
)-1)

	)

5195 
SQLITE_API
 
sql™e3_»suÉ_blob
(
sql™e3_cÚ‹xt
*, const *, , (*)(*));

5196 
SQLITE_API
 
sql™e3_»suÉ_blob64
(
sql™e3_cÚ‹xt
*,const *,

5197 
sql™e3_ušt64
,(*)(*));

5198 
SQLITE_API
 
sql™e3_»suÉ_doubË
(
sql™e3_cÚ‹xt
*, );

5199 
SQLITE_API
 
sql™e3_»suÉ_”rÜ
(
sql™e3_cÚ‹xt
*, const *, );

5200 
SQLITE_API
 
sql™e3_»suÉ_”rÜ16
(
sql™e3_cÚ‹xt
*, const *, );

5201 
SQLITE_API
 
sql™e3_»suÉ_”rÜ_toobig
(
sql™e3_cÚ‹xt
*);

5202 
SQLITE_API
 
sql™e3_»suÉ_”rÜ_nomem
(
sql™e3_cÚ‹xt
*);

5203 
SQLITE_API
 
sql™e3_»suÉ_”rÜ_code
(
sql™e3_cÚ‹xt
*, );

5204 
SQLITE_API
 
sql™e3_»suÉ_št
(
sql™e3_cÚ‹xt
*, );

5205 
SQLITE_API
 
sql™e3_»suÉ_št64
(
sql™e3_cÚ‹xt
*, 
sql™e3_št64
);

5206 
SQLITE_API
 
sql™e3_»suÉ_nuÎ
(
sql™e3_cÚ‹xt
*);

5207 
SQLITE_API
 
sql™e3_»suÉ_‹xt
(
sql™e3_cÚ‹xt
*, const *, , (*)(*));

5208 
SQLITE_API
 
sql™e3_»suÉ_‹xt64
(
sql™e3_cÚ‹xt
*, cÚ¡ *,
sql™e3_ušt64
,

5209 (*)(*), 
’codšg
);

5210 
SQLITE_API
 
sql™e3_»suÉ_‹xt16
(
sql™e3_cÚ‹xt
*, const *, , (*)(*));

5211 
SQLITE_API
 
sql™e3_»suÉ_‹xt16Ë
(
sql™e3_cÚ‹xt
*, const *, ,(*)(*));

5212 
SQLITE_API
 
sql™e3_»suÉ_‹xt16be
(
sql™e3_cÚ‹xt
*, const *, ,(*)(*));

5213 
SQLITE_API
 
sql™e3_»suÉ_v®ue
(
sql™e3_cÚ‹xt
*, 
sql™e3_v®ue
*);

5214 
SQLITE_API
 
sql™e3_»suÉ_poš‹r
(
sql™e3_cÚ‹xt
*, *,const *,(*)(*));

5215 
SQLITE_API
 
sql™e3_»suÉ_z”oblob
(
sql™e3_cÚ‹xt
*, 
n
);

5216 
SQLITE_API
 
sql™e3_»suÉ_z”oblob64
(
sql™e3_cÚ‹xt
*, 
sql™e3_ušt64
 
n
);

5231 
SQLITE_API
 
sql™e3_»suÉ_subty³
(
sql™e3_cÚ‹xt
*,);

5313 
SQLITE_API
 
sql™e3_ü—‹_cŞÏtiÚ
(

5314 
sql™e3
*,

5315 cÚ¡ *
zName
,

5316 
eTextR•
,

5317 *
pArg
,

5318 (*
xCom·»
)(*,,const *,,const *)

5320 
SQLITE_API
 
sql™e3_ü—‹_cŞÏtiÚ_v2
(

5321 
sql™e3
*,

5322 cÚ¡ *
zName
,

5323 
eTextR•
,

5324 *
pArg
,

5325 (*
xCom·»
)(*,,const *,,const *),

5326 (*
xDe¡roy
)(*)

5328 
SQLITE_API
 
sql™e3_ü—‹_cŞÏtiÚ16
(

5329 
sql™e3
*,

5330 cÚ¡ *
zName
,

5331 
eTextR•
,

5332 *
pArg
,

5333 (*
xCom·»
)(*,,const *,,const *)

5363 
SQLITE_API
 
sql™e3_cŞÏtiÚ_Ãeded
(

5364 
sql™e3
*,

5366 (*)(*,
sql™e3
*,
eTextR•
,const *)

5368 
SQLITE_API
 
sql™e3_cŞÏtiÚ_Ãeded16
(

5369 
sql™e3
*,

5371 (*)(*,
sql™e3
*,
eTextR•
,const *)

5374 #ifdeà
SQLITE_HAS_CODEC


5382 
SQLITE_API
 
sql™e3_key
(

5383 
sql™e3
 *
db
,

5384 cÚ¡ *
pKey
, 
nKey


5386 
SQLITE_API
 
sql™e3_key_v2
(

5387 
sql™e3
 *
db
,

5388 cÚ¡ *
zDbName
,

5389 cÚ¡ *
pKey
, 
nKey


5400 
SQLITE_API
 
sql™e3_»key
(

5401 
sql™e3
 *
db
,

5402 cÚ¡ *
pKey
, 
nKey


5404 
SQLITE_API
 
sql™e3_»key_v2
(

5405 
sql™e3
 *
db
,

5406 cÚ¡ *
zDbName
,

5407 cÚ¡ *
pKey
, 
nKey


5414 
SQLITE_API
 
sql™e3_aùiv©e_£e
(

5415 cÚ¡ *
zPassPh¿£


5419 #ifdeà
SQLITE_ENABLE_CEROD


5424 
SQLITE_API
 
sql™e3_aùiv©e_ûrod
(

5425 cÚ¡ *
zPassPh¿£


5446 
SQLITE_API
 
sql™e3_¦“p
();

5504 
SQLITE_API
 
SQLITE_EXTERN
 *
sql™e3_‹mp_dœeùÜy
;

5541 
SQLITE_API
 
SQLITE_EXTERN
 *
sql™e3_d©a_dœeùÜy
;

5565 
SQLITE_API
 
sql™e3_g‘_autocomm™
(
sql™e3
*);

5578 
SQLITE_API
 
sql™e3
 *
sql™e3_db_hªdË
(
sql™e3_¡mt
*);

5595 
SQLITE_API
 cÚ¡ *
sql™e3_db_f’ame
(
sql™e3
 *
db
, cÚ¡ *
zDbName
);

5605 
SQLITE_API
 
sql™e3_db_»adÚly
(
sql™e3
 *
db
, cÚ¡ *
zDbName
);

5621 
SQLITE_API
 
sql™e3_¡mt
 *
sql™e3_Ãxt_¡mt
(
sql™e3
 *
pDb
, sql™e3_¡mˆ*
pStmt
);

5670 
SQLITE_API
 *
sql™e3_comm™_hook
(
sql™e3
*, (*)(*), *);

5671 
SQLITE_API
 *
sql™e3_rŞlback_hook
(
sql™e3
*, (*)(*), *);

5722 
SQLITE_API
 *
sql™e3_upd©e_hook
(

5723 
sql™e3
*,

5724 (*)(*,,cÚ¡ *,cÚ¡ *,
sql™e3_št64
),

5763 
SQLITE_API
 
sql™e3_’abË_sh¬ed_ÿche
();

5779 
SQLITE_API
 
sql™e3_»Ëa£_memÜy
();

5793 
SQLITE_API
 
sql™e3_db_»Ëa£_memÜy
(
sql™e3
*);

5846 
SQLITE_API
 
sql™e3_št64
 
sql™e3_soá_h—p_lim™64
(sql™e3_št64 
N
);

5857 
SQLITE_API
 
SQLITE_DEPRECATED
 
sql™e3_soá_h—p_lim™
(
N
);

5929 
SQLITE_API
 
sql™e3_bË_cŞumn_m‘ad©a
(

5930 
sql™e3
 *
db
,

5931 cÚ¡ *
zDbName
,

5932 cÚ¡ *
zTabËName
,

5933 cÚ¡ *
zCŞumnName
,

5934 cÚ¡ **
pzD©aTy³
,

5935 cÚ¡ **
pzCŞlSeq
,

5936 *
pNÙNuÎ
,

5937 *
pPrim¬yKey
,

5938 *
pAutošc


5985 
SQLITE_API
 
sql™e3_lßd_ex‹nsiÚ
(

5986 
sql™e3
 *
db
,

5987 cÚ¡ *
zFe
,

5988 cÚ¡ *
zProc
,

5989 **
pzE¼Msg


6017 
SQLITE_API
 
sql™e3_’abË_lßd_ex‹nsiÚ
(
sql™e3
 *
db
, 
Úoff
);

6055 
SQLITE_API
 
sql™e3_auto_ex‹nsiÚ
((*
xEÁryPošt
)());

6067 
SQLITE_API
 
sql™e3_ÿnûl_auto_ex‹nsiÚ
((*
xEÁryPošt
)());

6075 
SQLITE_API
 
sql™e3_»£t_auto_ex‹nsiÚ
();

6089 
sql™e3_vb
 
	tsql™e3_vb
;

6090 
sql™e3_šdex_šfo
 
	tsql™e3_šdex_šfo
;

6091 
sql™e3_vb_cursÜ
 
	tsql™e3_vb_cursÜ
;

6092 
sql™e3_moduË
 
	tsql™e3_moduË
;

6110 
	ssql™e3_moduË
 {

6111 
iV”siÚ
;

6112 (*
xC»©e
)(
sql™e3
*, *
pAux
,

6113 
¬gc
, cÚ¡ *cÚ¡*
¬gv
,

6114 
sql™e3_vb
 **
µVTab
, **);

6115 (*
xCÚÃù
)(
sql™e3
*, *
pAux
,

6116 
¬gc
, cÚ¡ *cÚ¡*
¬gv
,

6117 
sql™e3_vb
 **
µVTab
, **);

6118 (*
xBe¡Index
)(
sql™e3_vb
 *
pVTab
, 
sql™e3_šdex_šfo
*);

6119 (*
xDiscÚÃù
)(
sql™e3_vb
 *
pVTab
);

6120 (*
xDe¡roy
)(
sql™e3_vb
 *
pVTab
);

6121 (*
xO³n
)(
sql™e3_vb
 *
pVTab
, 
sql™e3_vb_cursÜ
 **
µCursÜ
);

6122 (*
xClo£
)(
sql™e3_vb_cursÜ
*);

6123 (*
xF‹r
)(
sql™e3_vb_cursÜ
*, 
idxNum
, cÚ¡ *
idxSŒ
,

6124 
¬gc
, 
sql™e3_v®ue
 **
¬gv
);

6125 (*
xNext
)(
sql™e3_vb_cursÜ
*);

6126 (*
xEof
)(
sql™e3_vb_cursÜ
*);

6127 (*
xCŞumn
)(
sql™e3_vb_cursÜ
*, 
sql™e3_cÚ‹xt
*, );

6128 (*
xRowid
)(
sql™e3_vb_cursÜ
*, 
sql™e3_št64
 *
pRowid
);

6129 (*
xUpd©e
)(
sql™e3_vb
 *, , 
sql™e3_v®ue
 **, 
sql™e3_št64
 *);

6130 (*
xBegš
)(
sql™e3_vb
 *
pVTab
);

6131 (*
xSync
)(
sql™e3_vb
 *
pVTab
);

6132 (*
xComm™
)(
sql™e3_vb
 *
pVTab
);

6133 (*
xRŞlback
)(
sql™e3_vb
 *
pVTab
);

6134 (*
xFšdFunùiÚ
)(
sql™e3_vb
 *
pVb
, 
nArg
, cÚ¡ *
zName
,

6135 (**
pxFunc
)(
sql™e3_cÚ‹xt
*,,
sql™e3_v®ue
**),

6136 **
µArg
);

6137 (*
xR’ame
)(
sql™e3_vb
 *
pVb
, cÚ¡ *
zNew
);

6140 (*
xSav•ošt
)(
sql™e3_vb
 *
pVTab
, );

6141 (*
xR–—£
)(
sql™e3_vb
 *
pVTab
, );

6142 (*
xRŞlbackTo
)(
sql™e3_vb
 *
pVTab
, );

6241 
	ssql™e3_šdex_šfo
 {

6243 
nCÚ¡¿št
;

6244 
	ssql™e3_šdex_cÚ¡¿št
 {

6245 
iCŞumn
;

6246 
İ
;

6247 
u§bË
;

6248 
iT”mOff£t
;

6249 } *
aCÚ¡¿št
;

6250 
nOrd”By
;

6251 
	ssql™e3_šdex_Üd”by
 {

6252 
iCŞumn
;

6253 
desc
;

6254 } *
aOrd”By
;

6256 
	ssql™e3_šdex_cÚ¡¿št_u§ge
 {

6257 
¬gvIndex
;

6258 
om™
;

6259 } *
aCÚ¡¿štU§ge
;

6260 
idxNum
;

6261 *
idxSŒ
;

6262 
ÃedToF»eIdxSŒ
;

6263 
Üd”ByCÚsumed
;

6264 
e¡im©edCo¡
;

6266 
sql™e3_št64
 
e¡im©edRows
;

6268 
idxFÏgs
;

6270 
sql™e3_ušt64
 
cŞU£d
;

6276 
	#SQLITE_INDEX_SCAN_UNIQUE
 1

	)

6286 
	#SQLITE_INDEX_CONSTRAINT_EQ
 2

	)

6287 
	#SQLITE_INDEX_CONSTRAINT_GT
 4

	)

6288 
	#SQLITE_INDEX_CONSTRAINT_LE
 8

	)

6289 
	#SQLITE_INDEX_CONSTRAINT_LT
 16

	)

6290 
	#SQLITE_INDEX_CONSTRAINT_GE
 32

	)

6291 
	#SQLITE_INDEX_CONSTRAINT_MATCH
 64

	)

6292 
	#SQLITE_INDEX_CONSTRAINT_LIKE
 65

	)

6293 
	#SQLITE_INDEX_CONSTRAINT_GLOB
 66

	)

6294 
	#SQLITE_INDEX_CONSTRAINT_REGEXP
 67

	)

6295 
	#SQLITE_INDEX_CONSTRAINT_NE
 68

	)

6296 
	#SQLITE_INDEX_CONSTRAINT_ISNOT
 69

	)

6297 
	#SQLITE_INDEX_CONSTRAINT_ISNOTNULL
 70

	)

6298 
	#SQLITE_INDEX_CONSTRAINT_ISNULL
 71

	)

6299 
	#SQLITE_INDEX_CONSTRAINT_IS
 72

	)

6327 
SQLITE_API
 
sql™e3_ü—‹_moduË
(

6328 
sql™e3
 *
db
,

6329 cÚ¡ *
zName
,

6330 cÚ¡ 
sql™e3_moduË
 *
p
,

6331 *
pCl›ÁD©a


6333 
SQLITE_API
 
sql™e3_ü—‹_moduË_v2
(

6334 
sql™e3
 *
db
,

6335 cÚ¡ *
zName
,

6336 cÚ¡ 
sql™e3_moduË
 *
p
,

6337 *
pCl›ÁD©a
,

6338 (*
xDe¡roy
)(*)

6359 
	ssql™e3_vb
 {

6360 cÚ¡ 
sql™e3_moduË
 *
pModuË
;

6361 
nRef
;

6362 *
zE¼Msg
;

6383 
	ssql™e3_vb_cursÜ
 {

6384 
sql™e3_vb
 *
pVb
;

6396 
SQLITE_API
 
sql™e3_deş¬e_vb
(
sql™e3
*, cÚ¡ *
zSQL
);

6415 
SQLITE_API
 
sql™e3_ov”lßd_funùiÚ
(
sql™e3
*, cÚ¡ *
zFuncName
, 
nArg
);

6439 
sql™e3_blob
 
	tsql™e3_blob
;

6524 
SQLITE_API
 
sql™e3_blob_İ’
(

6525 
sql™e3
*,

6526 cÚ¡ *
zDb
,

6527 cÚ¡ *
zTabË
,

6528 cÚ¡ *
zCŞumn
,

6529 
sql™e3_št64
 
iRow
,

6530 
æags
,

6531 
sql™e3_blob
 **
µBlob


6557 
SQLITE_API
 
sql™e3_blob_»İ’
(
sql™e3_blob
 *, 
sql™e3_št64
);

6580 
SQLITE_API
 
sql™e3_blob_şo£
(
sql™e3_blob
 *);

6596 
SQLITE_API
 
sql™e3_blob_by‹s
(
sql™e3_blob
 *);

6625 
SQLITE_API
 
sql™e3_blob_»ad
(
sql™e3_blob
 *, *
Z
, 
N
, 
iOff£t
);

6667 
SQLITE_API
 
sql™e3_blob_wr™e
(
sql™e3_blob
 *, cÚ¡ *
z
, 
n
, 
iOff£t
);

6698 
SQLITE_API
 
sql™e3_vfs
 *
sql™e3_vfs_fšd
(cÚ¡ *
zVfsName
);

6699 
SQLITE_API
 
sql™e3_vfs_»gi¡”
(
sql™e3_vfs
*, 
makeDæt
);

6700 
SQLITE_API
 
sql™e3_vfs_uÄegi¡”
(
sql™e3_vfs
*);

6816 
SQLITE_API
 
sql™e3_mu‹x
 *
sql™e3_mu‹x_®loc
();

6817 
SQLITE_API
 
sql™e3_mu‹x_ä“
(
sql™e3_mu‹x
*);

6818 
SQLITE_API
 
sql™e3_mu‹x_’‹r
(
sql™e3_mu‹x
*);

6819 
SQLITE_API
 
sql™e3_mu‹x_Œy
(
sql™e3_mu‹x
*);

6820 
SQLITE_API
 
sql™e3_mu‹x_Ëave
(
sql™e3_mu‹x
*);

6887 
sql™e3_mu‹x_m‘hods
 
	tsql™e3_mu‹x_m‘hods
;

6888 
	ssql™e3_mu‹x_m‘hods
 {

6889 (*
xMu‹xIn™
)();

6890 (*
xMu‹xEnd
)();

6891 
sql™e3_mu‹x
 *(*
xMu‹xAÎoc
)();

6892 (*
xMu‹xF»e
)(
sql™e3_mu‹x
 *);

6893 (*
xMu‹xEÁ”
)(
sql™e3_mu‹x
 *);

6894 (*
xMu‹xTry
)(
sql™e3_mu‹x
 *);

6895 (*
xMu‹xL—ve
)(
sql™e3_mu‹x
 *);

6896 (*
xMu‹xH–d
)(
sql™e3_mu‹x
 *);

6897 (*
xMu‹xNÙh–d
)(
sql™e3_mu‹x
 *);

6929 #iâdeà
NDEBUG


6930 
SQLITE_API
 
sql™e3_mu‹x_h–d
(
sql™e3_mu‹x
*);

6931 
SQLITE_API
 
sql™e3_mu‹x_nÙh–d
(
sql™e3_mu‹x
*);

6944 
	#SQLITE_MUTEX_FAST
 0

	)

6945 
	#SQLITE_MUTEX_RECURSIVE
 1

	)

6946 
	#SQLITE_MUTEX_STATIC_MASTER
 2

	)

6947 
	#SQLITE_MUTEX_STATIC_MEM
 3

	)

6948 
	#SQLITE_MUTEX_STATIC_MEM2
 4

	)

6949 
	#SQLITE_MUTEX_STATIC_OPEN
 4

	)

6950 
	#SQLITE_MUTEX_STATIC_PRNG
 5

	)

6951 
	#SQLITE_MUTEX_STATIC_LRU
 6

	)

6952 
	#SQLITE_MUTEX_STATIC_LRU2
 7

	)

6953 
	#SQLITE_MUTEX_STATIC_PMEM
 7

	)

6954 
	#SQLITE_MUTEX_STATIC_APP1
 8

	)

6955 
	#SQLITE_MUTEX_STATIC_APP2
 9

	)

6956 
	#SQLITE_MUTEX_STATIC_APP3
 10

	)

6957 
	#SQLITE_MUTEX_STATIC_VFS1
 11

	)

6958 
	#SQLITE_MUTEX_STATIC_VFS2
 12

	)

6959 
	#SQLITE_MUTEX_STATIC_VFS3
 13

	)

6971 
SQLITE_API
 
sql™e3_mu‹x
 *
sql™e3_db_mu‹x
(
sql™e3
*);

7006 
SQLITE_API
 
sql™e3_fe_cÚŒŞ
(
sql™e3
*, cÚ¡ *
zDbName
, 
İ
, *);

7025 
SQLITE_API
 
sql™e3_‹¡_cÚŒŞ
(
İ
, ...);

7038 
	#SQLITE_TESTCTRL_FIRST
 5

	)

7039 
	#SQLITE_TESTCTRL_PRNG_SAVE
 5

	)

7040 
	#SQLITE_TESTCTRL_PRNG_RESTORE
 6

	)

7041 
	#SQLITE_TESTCTRL_PRNG_RESET
 7

	)

7042 
	#SQLITE_TESTCTRL_BITVEC_TEST
 8

	)

7043 
	#SQLITE_TESTCTRL_FAULT_INSTALL
 9

	)

7044 
	#SQLITE_TESTCTRL_BENIGN_MALLOC_HOOKS
 10

	)

7045 
	#SQLITE_TESTCTRL_PENDING_BYTE
 11

	)

7046 
	#SQLITE_TESTCTRL_ASSERT
 12

	)

7047 
	#SQLITE_TESTCTRL_ALWAYS
 13

	)

7048 
	#SQLITE_TESTCTRL_RESERVE
 14

	)

7049 
	#SQLITE_TESTCTRL_OPTIMIZATIONS
 15

	)

7050 
	#SQLITE_TESTCTRL_ISKEYWORD
 16

	)

7051 
	#SQLITE_TESTCTRL_SCRATCHMALLOC
 17

	)

7052 
	#SQLITE_TESTCTRL_LOCALTIME_FAULT
 18

	)

7053 
	#SQLITE_TESTCTRL_EXPLAIN_STMT
 19

	)

7054 
	#SQLITE_TESTCTRL_ONCE_RESET_THRESHOLD
 19

	)

7055 
	#SQLITE_TESTCTRL_NEVER_CORRUPT
 20

	)

7056 
	#SQLITE_TESTCTRL_VDBE_COVERAGE
 21

	)

7057 
	#SQLITE_TESTCTRL_BYTEORDER
 22

	)

7058 
	#SQLITE_TESTCTRL_ISINIT
 23

	)

7059 
	#SQLITE_TESTCTRL_SORTER_MMAP
 24

	)

7060 
	#SQLITE_TESTCTRL_IMPOSTER
 25

	)

7061 
	#SQLITE_TESTCTRL_PARSER_COVERAGE
 26

	)

7062 
	#SQLITE_TESTCTRL_LAST
 26

	)

7080 
sql™e3_¡r
 
	tsql™e3_¡r
;

7102 
SQLITE_API
 
sql™e3_¡r
 *
sql™e3_¡r_Ãw
(
sql™e3
*);

7117 
SQLITE_API
 *
sql™e3_¡r_fšish
(
sql™e3_¡r
*);

7151 
SQLITE_API
 
sql™e3_¡r_­³ndf
(
sql™e3_¡r
*, cÚ¡ *
zFÜm©
, ...);

7152 
SQLITE_API
 
sql™e3_¡r_v­³ndf
(
sql™e3_¡r
*, cÚ¡ *
zFÜm©
, 
va_li¡
);

7153 
SQLITE_API
 
sql™e3_¡r_­³nd
(
sql™e3_¡r
*, cÚ¡ *
zIn
, 
N
);

7154 
SQLITE_API
 
sql™e3_¡r_­³nd®l
(
sql™e3_¡r
*, cÚ¡ *
zIn
);

7155 
SQLITE_API
 
sql™e3_¡r_­³ndch¬
(
sql™e3_¡r
*, 
N
, 
C
);

7156 
SQLITE_API
 
sql™e3_¡r_»£t
(
sql™e3_¡r
*);

7187 
SQLITE_API
 
sql™e3_¡r_”rcode
(
sql™e3_¡r
*);

7188 
SQLITE_API
 
sql™e3_¡r_Ëngth
(
sql™e3_¡r
*);

7189 
SQLITE_API
 *
sql™e3_¡r_v®ue
(
sql™e3_¡r
*);

7217 
SQLITE_API
 
sql™e3_¡©us
(
İ
, *
pCu¼’t
, *
pHighw©”
, 
»£tFÏg
);

7218 
SQLITE_API
 
sql™e3_¡©us64
(

7219 
İ
,

7220 
sql™e3_št64
 *
pCu¼’t
,

7221 
sql™e3_št64
 *
pHighw©”
,

7222 
»£tFÏg


7293 
	#SQLITE_STATUS_MEMORY_USED
 0

	)

7294 
	#SQLITE_STATUS_PAGECACHE_USED
 1

	)

7295 
	#SQLITE_STATUS_PAGECACHE_OVERFLOW
 2

	)

7296 
	#SQLITE_STATUS_SCRATCH_USED
 3

	)

7297 
	#SQLITE_STATUS_SCRATCH_OVERFLOW
 4

	)

7298 
	#SQLITE_STATUS_MALLOC_SIZE
 5

	)

7299 
	#SQLITE_STATUS_PARSER_STACK
 6

	)

7300 
	#SQLITE_STATUS_PAGECACHE_SIZE
 7

	)

7301 
	#SQLITE_STATUS_SCRATCH_SIZE
 8

	)

7302 
	#SQLITE_STATUS_MALLOC_COUNT
 9

	)

7327 
SQLITE_API
 
sql™e3_db_¡©us
(
sql™e3
*, 
İ
, *
pCur
, *
pHiwŒ
, 
»£tFlg
);

7431 
	#SQLITE_DBSTATUS_LOOKASIDE_USED
 0

	)

7432 
	#SQLITE_DBSTATUS_CACHE_USED
 1

	)

7433 
	#SQLITE_DBSTATUS_SCHEMA_USED
 2

	)

7434 
	#SQLITE_DBSTATUS_STMT_USED
 3

	)

7435 
	#SQLITE_DBSTATUS_LOOKASIDE_HIT
 4

	)

7436 
	#SQLITE_DBSTATUS_LOOKASIDE_MISS_SIZE
 5

	)

7437 
	#SQLITE_DBSTATUS_LOOKASIDE_MISS_FULL
 6

	)

7438 
	#SQLITE_DBSTATUS_CACHE_HIT
 7

	)

7439 
	#SQLITE_DBSTATUS_CACHE_MISS
 8

	)

7440 
	#SQLITE_DBSTATUS_CACHE_WRITE
 9

	)

7441 
	#SQLITE_DBSTATUS_DEFERRED_FKS
 10

	)

7442 
	#SQLITE_DBSTATUS_CACHE_USED_SHARED
 11

	)

7443 
	#SQLITE_DBSTATUS_MAX
 11

	)

7470 
SQLITE_API
 
sql™e3_¡mt_¡©us
(
sql™e3_¡mt
*, 
İ
,
»£tFlg
);

7527 
	#SQLITE_STMTSTATUS_FULLSCAN_STEP
 1

	)

7528 
	#SQLITE_STMTSTATUS_SORT
 2

	)

7529 
	#SQLITE_STMTSTATUS_AUTOINDEX
 3

	)

7530 
	#SQLITE_STMTSTATUS_VM_STEP
 4

	)

7531 
	#SQLITE_STMTSTATUS_REPREPARE
 5

	)

7532 
	#SQLITE_STMTSTATUS_RUN
 6

	)

7533 
	#SQLITE_STMTSTATUS_MEMUSED
 99

	)

7546 
sql™e3_pÿche
 
	tsql™e3_pÿche
;

7558 
sql™e3_pÿche_·ge
 
	tsql™e3_pÿche_·ge
;

7559 
	ssql™e3_pÿche_·ge
 {

7560 *
pBuf
;

7561 *
pExŒa
;

7723 
sql™e3_pÿche_m‘hods2
 
	tsql™e3_pÿche_m‘hods2
;

7724 
	ssql™e3_pÿche_m‘hods2
 {

7725 
iV”siÚ
;

7726 *
pArg
;

7727 (*
xIn™
)(*);

7728 (*
xShutdown
)(*);

7729 
sql™e3_pÿche
 *(*
xC»©e
)(
szPage
, 
szExŒa
, 
bPurg—bË
);

7730 (*
xCachesize
)(
sql™e3_pÿche
*, 
nCachesize
);

7731 (*
xPagecouÁ
)(
sql™e3_pÿche
*);

7732 
sql™e3_pÿche_·ge
 *(*
xF‘ch
)(
sql™e3_pÿche
*, 
key
, 
ü—‹FÏg
);

7733 (*
xUÅš
)(
sql™e3_pÿche
*, 
sql™e3_pÿche_·ge
*, 
disÿrd
);

7734 (*
xRekey
)(
sql™e3_pÿche
*, 
sql™e3_pÿche_·ge
*,

7735 
ŞdKey
, 
ÃwKey
);

7736 (*
xTrunÿ‹
)(
sql™e3_pÿche
*, 
iLim™
);

7737 (*
xDe¡roy
)(
sql™e3_pÿche
*);

7738 (*
xShršk
)(
sql™e3_pÿche
*);

7746 
sql™e3_pÿche_m‘hods
 
	tsql™e3_pÿche_m‘hods
;

7747 
	ssql™e3_pÿche_m‘hods
 {

7748 *
pArg
;

7749 (*
xIn™
)(*);

7750 (*
xShutdown
)(*);

7751 
sql™e3_pÿche
 *(*
xC»©e
)(
szPage
, 
bPurg—bË
);

7752 (*
xCachesize
)(
sql™e3_pÿche
*, 
nCachesize
);

7753 (*
xPagecouÁ
)(
sql™e3_pÿche
*);

7754 *(*
xF‘ch
)(
sql™e3_pÿche
*, 
key
, 
ü—‹FÏg
);

7755 (*
xUÅš
)(
sql™e3_pÿche
*, *, 
disÿrd
);

7756 (*
xRekey
)(
sql™e3_pÿche
*, *, 
ŞdKey
, 
ÃwKey
);

7757 (*
xTrunÿ‹
)(
sql™e3_pÿche
*, 
iLim™
);

7758 (*
xDe¡roy
)(
sql™e3_pÿche
*);

7772 
sql™e3_backup
 
	tsql™e3_backup
;

7960 
SQLITE_API
 
sql™e3_backup
 *
sql™e3_backup_š™
(

7961 
sql™e3
 *
pDe¡
,

7962 cÚ¡ *
zDe¡Name
,

7963 
sql™e3
 *
pSourû
,

7964 cÚ¡ *
zSourûName


7966 
SQLITE_API
 
sql™e3_backup_¡•
(
sql™e3_backup
 *
p
, 
nPage
);

7967 
SQLITE_API
 
sql™e3_backup_fšish
(
sql™e3_backup
 *
p
);

7968 
SQLITE_API
 
sql™e3_backup_»maššg
(
sql™e3_backup
 *
p
);

7969 
SQLITE_API
 
sql™e3_backup_·gecouÁ
(
sql™e3_backup
 *
p
);

8086 
SQLITE_API
 
sql™e3_uÆock_nÙify
(

8087 
sql™e3
 *
pBlocked
,

8088 (*
xNÙify
)(**
­Arg
, 
nArg
),

8089 *
pNÙifyArg


8101 
SQLITE_API
 
sql™e3_¡ricmp
(const *, const *);

8102 
SQLITE_API
 
sql™e3_¡ºicmp
(const *, const *, );

8119 
SQLITE_API
 
sql™e3_¡rglob
(cÚ¡ *
zGlob
, cÚ¡ *
zSŒ
);

8142 
SQLITE_API
 
sql™e3_¡¾ike
(cÚ¡ *
zGlob
, cÚ¡ *
zSŒ
, 
cEsc
);

8165 
SQLITE_API
 
sql™e3_log
(
iE¼Code
, cÚ¡ *
zFÜm©
, ...);

8201 
SQLITE_API
 *
sql™e3_w®_hook
(

8202 
sql™e3
*,

8203 (*)(*,
sql™e3
*,const *,),

8236 
SQLITE_API
 
sql™e3_w®_autocheckpošt
(
sql™e3
 *
db
, 
N
);

8258 
SQLITE_API
 
sql™e3_w®_checkpošt
(
sql™e3
 *
db
, cÚ¡ *
zDb
);

8352 
SQLITE_API
 
sql™e3_w®_checkpošt_v2
(

8353 
sql™e3
 *
db
,

8354 cÚ¡ *
zDb
,

8355 
eMode
,

8356 *
²Log
,

8357 *
²Ck±


8369 
	#SQLITE_CHECKPOINT_PASSIVE
 0

	)

8370 
	#SQLITE_CHECKPOINT_FULL
 1

	)

8371 
	#SQLITE_CHECKPOINT_RESTART
 2

	)

8372 
	#SQLITE_CHECKPOINT_TRUNCATE
 3

	)

8388 
SQLITE_API
 
sql™e3_vb_cÚfig
(
sql™e3
*, 
İ
, ...);

8429 
	#SQLITE_VTAB_CONSTRAINT_SUPPORT
 1

	)

8441 
SQLITE_API
 
sql™e3_vb_Ú_cÚæiù
(
sql™e3
 *);

8460 
SQLITE_API
 
sql™e3_vb_nochªge
(
sql™e3_cÚ‹xt
*);

8475 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 cÚ¡ *
sql™e3_vb_cŞÏtiÚ
(
sql™e3_šdex_šfo
*,);

8489 
	#SQLITE_ROLLBACK
 1

	)

8491 
	#SQLITE_FAIL
 3

	)

8493 
	#SQLITE_REPLACE
 5

	)

8542 
	#SQLITE_SCANSTAT_NLOOP
 0

	)

8543 
	#SQLITE_SCANSTAT_NVISIT
 1

	)

8544 
	#SQLITE_SCANSTAT_EST
 2

	)

8545 
	#SQLITE_SCANSTAT_NAME
 3

	)

8546 
	#SQLITE_SCANSTAT_EXPLAIN
 4

	)

8547 
	#SQLITE_SCANSTAT_SELECTID
 5

	)

8580 
SQLITE_API
 
sql™e3_¡mt_sÿn¡©us
(

8581 
sql™e3_¡mt
 *
pStmt
,

8582 
idx
,

8583 
iSÿnStusOp
,

8584 *
pOut


8596 
SQLITE_API
 
sql™e3_¡mt_sÿn¡©us_»£t
(
sql™e3_¡mt
*);

8628 
SQLITE_API
 
sql™e3_db_ÿcheæush
(
sql™e3
*);

8712 #ià
defšed
(
SQLITE_ENABLE_PREUPDATE_HOOK
)

8713 
SQLITE_API
 *
sql™e3_´eupd©e_hook
(

8714 
sql™e3
 *
db
,

8715 (*
xP»Upd©e
)(

8716 *
pCtx
,

8717 
sql™e3
 *
db
,

8718 
İ
,

8719 cÚ¡ *
zDb
,

8720 cÚ¡ *
zName
,

8721 
sql™e3_št64
 
iKey1
,

8722 
sql™e3_št64
 
iKey2


8726 
SQLITE_API
 
sql™e3_´eupd©e_Şd
(
sql™e3
 *, , 
sql™e3_v®ue
 **);

8727 
SQLITE_API
 
sql™e3_´eupd©e_couÁ
(
sql™e3
 *);

8728 
SQLITE_API
 
sql™e3_´eupd©e_d•th
(
sql™e3
 *);

8729 
SQLITE_API
 
sql™e3_´eupd©e_Ãw
(
sql™e3
 *, , 
sql™e3_v®ue
 **);

8742 
SQLITE_API
 
sql™e3_sy¡em_”ºo
(
sql™e3
*);

8770 
	ssql™e3_¢­shÙ
 {

8771 
hidd’
[48];

8772 } 
	tsql™e3_¢­shÙ
;

8817 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 
sql™e3_¢­shÙ_g‘
(

8818 
sql™e3
 *
db
,

8819 cÚ¡ *
zSchema
,

8820 
sql™e3_¢­shÙ
 **
µSÇpshÙ


8855 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 
sql™e3_¢­shÙ_İ’
(

8856 
sql™e3
 *
db
,

8857 cÚ¡ *
zSchema
,

8858 
sql™e3_¢­shÙ
 *
pSÇpshÙ


8872 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 
sql™e3_¢­shÙ_ä“
(
sql™e3_¢­shÙ
*);

8896 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 
sql™e3_¢­shÙ_cmp
(

8897 
sql™e3_¢­shÙ
 *
p1
,

8898 
sql™e3_¢­shÙ
 *
p2


8921 
SQLITE_API
 
SQLITE_EXPERIMENTAL
 
sql™e3_¢­shÙ_»cov”
(
sql™e3
 *
db
, cÚ¡ *
zDb
);

8927 #ifdeà
SQLITE_OMIT_FLOATING_POINT


8931 #ifdeà
__ılu¥lus


8950 #iâdeà
_SQLITE3RTREE_H_


8951 
	#_SQLITE3RTREE_H_


	)

8954 #ifdeà
__ılu¥lus


8958 
sql™e3_¹»e_geom‘ry
 
	tsql™e3_¹»e_geom‘ry
;

8959 
sql™e3_¹»e_qu”y_šfo
 
	tsql™e3_¹»e_qu”y_šfo
;

8964 #ifdeà
SQLITE_RTREE_INT_ONLY


8965 
sql™e3_št64
 
	tsql™e3_¹»e_dbl
;

8967 
	tsql™e3_¹»e_dbl
;

8976 
SQLITE_API
 
sql™e3_¹»e_geom‘ry_ÿÎback
(

8977 
sql™e3
 *
db
,

8978 cÚ¡ *
zGeom
,

8979 (*
xGeom
)(
sql™e3_¹»e_geom‘ry
*, , 
sql™e3_¹»e_dbl
*,*),

8980 *
pCÚ‹xt


8988 
	ssql™e3_¹»e_geom‘ry
 {

8989 *
pCÚ‹xt
;

8990 
nP¬am
;

8991 
sql™e3_¹»e_dbl
 *
aP¬am
;

8992 *
pU£r
;

8993 (*
xD–U£r
)(*);

9002 
SQLITE_API
 
sql™e3_¹»e_qu”y_ÿÎback
(

9003 
sql™e3
 *
db
,

9004 cÚ¡ *
zQu”yFunc
,

9005 (*
xQu”yFunc
)(
sql™e3_¹»e_qu”y_šfo
*),

9006 *
pCÚ‹xt
,

9007 (*
xDe¡ruùÜ
)(*)

9020 
	ssql™e3_¹»e_qu”y_šfo
 {

9021 *
pCÚ‹xt
;

9022 
nP¬am
;

9023 
sql™e3_¹»e_dbl
 *
aP¬am
;

9024 *
pU£r
;

9025 (*
xD–U£r
)(*);

9026 
sql™e3_¹»e_dbl
 *
aCoÜd
;

9027 *
ªQueue
;

9028 
nCoÜd
;

9029 
iLev–
;

9030 
mxLev–
;

9031 
sql™e3_št64
 
iRowid
;

9032 
sql™e3_¹»e_dbl
 
rP¬’tScÜe
;

9033 
eP¬’tW™hš
;

9034 
eW™hš
;

9035 
sql™e3_¹»e_dbl
 
rScÜe
;

9037 
sql™e3_v®ue
 **
­SqlP¬am
;

9043 
	#NOT_WITHIN
 0

	)

9044 
	#PARTLY_WITHIN
 1

	)

9045 
	#FULLY_WITHIN
 2

	)

9048 #ifdeà
__ılu¥lus


9057 #ià!
defšed
(
__SQLITESESSION_H_
è&& defšed(
SQLITE_ENABLE_SESSION
)

9058 
	#__SQLITESESSION_H_
 1

	)

9063 #ifdeà
__ılu¥lus


9071 
sql™e3_£ssiÚ
 
	tsql™e3_£ssiÚ
;

9076 
sql™e3_chªge£t_™”
 
	tsql™e3_chªge£t_™”
;

9108 
SQLITE_API
 
sql™e3£ssiÚ_ü—‹
(

9109 
sql™e3
 *
db
,

9110 cÚ¡ *
zDb
,

9111 
sql™e3_£ssiÚ
 **
µSessiÚ


9126 
SQLITE_API
 
sql™e3£ssiÚ_d–‘e
(
sql™e3_£ssiÚ
 *
pSessiÚ
);

9146 
SQLITE_API
 
sql™e3£ssiÚ_’abË
(
sql™e3_£ssiÚ
 *
pSessiÚ
, 
bEÇbË
);

9175 
SQLITE_API
 
sql™e3£ssiÚ_šdœeù
(
sql™e3_£ssiÚ
 *
pSessiÚ
, 
bIndœeù
);

9234 
SQLITE_API
 
sql™e3£ssiÚ_©ch
(

9235 
sql™e3_£ssiÚ
 *
pSessiÚ
,

9236 cÚ¡ *
zTab


9248 
SQLITE_API
 
sql™e3£ssiÚ_bË_f‹r
(

9249 
sql™e3_£ssiÚ
 *
pSessiÚ
,

9250 (*
xF‹r
)(

9251 *
pCtx
,

9252 cÚ¡ *
zTab


9254 *
pCtx


9361 
SQLITE_API
 
sql™e3£ssiÚ_chªge£t
(

9362 
sql™e3_£ssiÚ
 *
pSessiÚ
,

9363 *
²Chªge£t
,

9364 **
µChªge£t


9423 
SQLITE_API
 
sql™e3£ssiÚ_diff
(

9424 
sql™e3_£ssiÚ
 *
pSessiÚ
,

9425 cÚ¡ *
zFromDb
,

9426 cÚ¡ *
zTbl
,

9427 **
pzE¼Msg


9459 
SQLITE_API
 
sql™e3£ssiÚ_·tch£t
(

9460 
sql™e3_£ssiÚ
 *
pSessiÚ
,

9461 *
²P©ch£t
,

9462 **
µP©ch£t


9480 
SQLITE_API
 
sql™e3£ssiÚ_i£m±y
(
sql™e3_£ssiÚ
 *
pSessiÚ
);

9515 
SQLITE_API
 
sql™e3chªge£t_¡¬t
(

9516 
sql™e3_chªge£t_™”
 **
µ
,

9517 
nChªge£t
,

9518 *
pChªge£t


9544 
SQLITE_API
 
sql™e3chªge£t_Ãxt
(
sql™e3_chªge£t_™”
 *
pI‹r
);

9572 
SQLITE_API
 
sql™e3chªge£t_İ
(

9573 
sql™e3_chªge£t_™”
 *
pI‹r
,

9574 cÚ¡ **
pzTab
,

9575 *
²CŞ
,

9576 *
pOp
,

9577 *
pbIndœeù


9605 
SQLITE_API
 
sql™e3chªge£t_pk
(

9606 
sql™e3_chªge£t_™”
 *
pI‹r
,

9607 **
·bPK
,

9608 *
²CŞ


9635 
SQLITE_API
 
sql™e3chªge£t_Şd
(

9636 
sql™e3_chªge£t_™”
 *
pI‹r
,

9637 
iV®
,

9638 
sql™e3_v®ue
 **
µV®ue


9668 
SQLITE_API
 
sql™e3chªge£t_Ãw
(

9669 
sql™e3_chªge£t_™”
 *
pI‹r
,

9670 
iV®
,

9671 
sql™e3_v®ue
 **
µV®ue


9695 
SQLITE_API
 
sql™e3chªge£t_cÚæiù
(

9696 
sql™e3_chªge£t_™”
 *
pI‹r
,

9697 
iV®
,

9698 
sql™e3_v®ue
 **
µV®ue


9711 
SQLITE_API
 
sql™e3chªge£t_fk_cÚæiùs
(

9712 
sql™e3_chªge£t_™”
 *
pI‹r
,

9713 *
²Out


9744 
SQLITE_API
 
sql™e3chªge£t_fš®ize
(
sql™e3_chªge£t_™”
 *
pI‹r
);

9774 
SQLITE_API
 
sql™e3chªge£t_šv”t
(

9775 
nIn
, cÚ¡ *
pIn
,

9776 *
²Out
, **
µOut


9803 
SQLITE_API
 
sql™e3chªge£t_cÚÿt
(

9804 
nA
,

9805 *
pA
,

9806 
nB
,

9807 *
pB
,

9808 *
²Out
,

9809 **
µOut


9816 
sql™e3_chªgegroup
 
	tsql™e3_chªgegroup
;

9853 
SQLITE_API
 
sql™e3chªgegroup_Ãw
(
sql™e3_chªgegroup
 **
µ
);

9930 
SQLITE_API
 
sql™e3chªgegroup_add
(
sql™e3_chªgegroup
*, 
nD©a
, *
pD©a
);

9956 
SQLITE_API
 
sql™e3chªgegroup_ouut
(

9957 
sql™e3_chªgegroup
*,

9958 *
²D©a
,

9959 **
µD©a


9965 
SQLITE_API
 
sql™e3chªgegroup_d–‘e
(
sql™e3_chªgegroup
*);

10109 
SQLITE_API
 
sql™e3chªge£t_­¶y
(

10110 
sql™e3
 *
db
,

10111 
nChªge£t
,

10112 *
pChªge£t
,

10113 (*
xF‹r
)(

10114 *
pCtx
,

10115 cÚ¡ *
zTab


10117 (*
xCÚæiù
)(

10118 *
pCtx
,

10119 
eCÚæiù
,

10120 
sql™e3_chªge£t_™”
 *
p


10122 *
pCtx


10180 
	#SQLITE_CHANGESET_DATA
 1

	)

10181 
	#SQLITE_CHANGESET_NOTFOUND
 2

	)

10182 
	#SQLITE_CHANGESET_CONFLICT
 3

	)

10183 
	#SQLITE_CHANGESET_CONSTRAINT
 4

	)

10184 
	#SQLITE_CHANGESET_FOREIGN_KEY
 5

	)

10217 
	#SQLITE_CHANGESET_OMIT
 0

	)

10218 
	#SQLITE_CHANGESET_REPLACE
 1

	)

10219 
	#SQLITE_CHANGESET_ABORT
 2

	)

10310 
SQLITE_API
 
sql™e3chªge£t_­¶y_¡rm
(

10311 
sql™e3
 *
db
,

10312 (*
xIÅut
)(*
pIn
, *
pD©a
, *
²D©a
),

10313 *
pIn
,

10314 (*
xF‹r
)(

10315 *
pCtx
,

10316 cÚ¡ *
zTab


10318 (*
xCÚæiù
)(

10319 *
pCtx
,

10320 
eCÚæiù
,

10321 
sql™e3_chªge£t_™”
 *
p


10323 *
pCtx


10325 
SQLITE_API
 
sql™e3chªge£t_cÚÿt_¡rm
(

10326 (*
xIÅutA
)(*
pIn
, *
pD©a
, *
²D©a
),

10327 *
pInA
,

10328 (*
xIÅutB
)(*
pIn
, *
pD©a
, *
²D©a
),

10329 *
pInB
,

10330 (*
xOuut
)(*
pOut
, cÚ¡ *
pD©a
, 
nD©a
),

10331 *
pOut


10333 
SQLITE_API
 
sql™e3chªge£t_šv”t_¡rm
(

10334 (*
xIÅut
)(*
pIn
, *
pD©a
, *
²D©a
),

10335 *
pIn
,

10336 (*
xOuut
)(*
pOut
, cÚ¡ *
pD©a
, 
nD©a
),

10337 *
pOut


10339 
SQLITE_API
 
sql™e3chªge£t_¡¬t_¡rm
(

10340 
sql™e3_chªge£t_™”
 **
µ
,

10341 (*
xIÅut
)(*
pIn
, *
pD©a
, *
²D©a
),

10342 *
pIn


10344 
SQLITE_API
 
sql™e3£ssiÚ_chªge£t_¡rm
(

10345 
sql™e3_£ssiÚ
 *
pSessiÚ
,

10346 (*
xOuut
)(*
pOut
, cÚ¡ *
pD©a
, 
nD©a
),

10347 *
pOut


10349 
SQLITE_API
 
sql™e3£ssiÚ_·tch£t_¡rm
(

10350 
sql™e3_£ssiÚ
 *
pSessiÚ
,

10351 (*
xOuut
)(*
pOut
, cÚ¡ *
pD©a
, 
nD©a
),

10352 *
pOut


10354 
SQLITE_API
 
sql™e3chªgegroup_add_¡rm
(
sql™e3_chªgegroup
*,

10355 (*
xIÅut
)(*
pIn
, *
pD©a
, *
²D©a
),

10356 *
pIn


10358 
SQLITE_API
 
sql™e3chªgegroup_ouut_¡rm
(
sql™e3_chªgegroup
*,

10359 (*
xOuut
)(*
pOut
, cÚ¡ *
pD©a
, 
nD©a
),

10360 *
pOut


10367 #ifdeà
__ılu¥lus


10395 #iâdeà
_FTS5_H


10396 
	#_FTS5_H


	)

10399 #ifdeà
__ılu¥lus


10410 
Fts5Ex‹nsiÚApi
 
	tFts5Ex‹nsiÚApi
;

10411 
Fts5CÚ‹xt
 
	tFts5CÚ‹xt
;

10412 
Fts5Ph¿£I‹r
 
	tFts5Ph¿£I‹r
;

10414 (*
ás5_ex‹nsiÚ_funùiÚ
)(

10415 cÚ¡ 
	tFts5Ex‹nsiÚApi
 *
	tpApi
,

10416 
	tFts5CÚ‹xt
 *
	tpFts
,

10417 
	tsql™e3_cÚ‹xt
 *
	tpCtx
,

10418 
	tnV®
,

10419 
	tsql™e3_v®ue
 **
	t­V®


10422 
	sFts5Ph¿£I‹r
 {

10423 cÚ¡ *
a
;

10424 cÚ¡ *
b
;

10642 
	sFts5Ex‹nsiÚApi
 {

10643 
iV”siÚ
;

10645 *(*
xU£rD©a
)(
Fts5CÚ‹xt
*);

10647 (*
xCŞumnCouÁ
)(
Fts5CÚ‹xt
*);

10648 (*
xRowCouÁ
)(
Fts5CÚ‹xt
*, 
sql™e3_št64
 *
²Row
);

10649 (*
xCŞumnTÙ®Size
)(
Fts5CÚ‹xt
*, 
iCŞ
, 
sql™e3_št64
 *
²Tok’
);

10651 (*
xTok’ize
)(
Fts5CÚ‹xt
*,

10652 cÚ¡ *
pText
, 
nText
,

10653 *
pCtx
,

10654 (*
xTok’
)(*, , const *, , , )

10657 (*
xPh¿£CouÁ
)(
Fts5CÚ‹xt
*);

10658 (*
xPh¿£Size
)(
Fts5CÚ‹xt
*, 
iPh¿£
);

10660 (*
xIn¡CouÁ
)(
Fts5CÚ‹xt
*, *
²In¡
);

10661 (*
xIn¡
)(
Fts5CÚ‹xt
*, 
iIdx
, *
piPh¿£
, *
piCŞ
, *
piOff
);

10663 
sql™e3_št64
 (*
xRowid
)(
Fts5CÚ‹xt
*);

10664 (*
xCŞumnText
)(
Fts5CÚ‹xt
*, 
iCŞ
, cÚ¡ **
pz
, *
²
);

10665 (*
xCŞumnSize
)(
Fts5CÚ‹xt
*, 
iCŞ
, *
²Tok’
);

10667 (*
xQu”yPh¿£
)(
Fts5CÚ‹xt
*, 
iPh¿£
, *
pU£rD©a
,

10668 (*)(cÚ¡ 
Fts5Ex‹nsiÚApi
*,
Fts5CÚ‹xt
*,*)

10670 (*
xS‘Auxd©a
)(
Fts5CÚ‹xt
*, *
pAux
, (*
xD–‘e
)(*));

10671 *(*
xG‘Auxd©a
)(
Fts5CÚ‹xt
*, 
bCË¬
);

10673 (*
xPh¿£Fœ¡
)(
Fts5CÚ‹xt
*, 
iPh¿£
, 
Fts5Ph¿£I‹r
*, *, *);

10674 (*
xPh¿£Next
)(
Fts5CÚ‹xt
*, 
Fts5Ph¿£I‹r
*, *
piCŞ
, *
piOff
);

10676 (*
xPh¿£Fœ¡CŞumn
)(
Fts5CÚ‹xt
*, 
iPh¿£
, 
Fts5Ph¿£I‹r
*, *);

10677 (*
xPh¿£NextCŞumn
)(
Fts5CÚ‹xt
*, 
Fts5Ph¿£I‹r
*, *
piCŞ
);

10876 
Fts5Tok’iz”
 
	tFts5Tok’iz”
;

10877 
ás5_tok’iz”
 
	tás5_tok’iz”
;

10878 
	sás5_tok’iz”
 {

10879 (*
xC»©e
)(*, cÚ¡ **
azArg
, 
nArg
, 
Fts5Tok’iz”
 **
µOut
);

10880 (*
xD–‘e
)(
Fts5Tok’iz”
*);

10881 (*
xTok’ize
)(
Fts5Tok’iz”
*,

10882 *
pCtx
,

10883 
æags
,

10884 cÚ¡ *
pText
, 
nText
,

10885 (*
xTok’
)(

10886 *
pCtx
,

10887 
tæags
,

10888 cÚ¡ *
pTok’
,

10889 
nTok’
,

10890 
iS¹
,

10891 
iEnd


10897 
	#FTS5_TOKENIZE_QUERY
 0x0001

	)

10898 
	#FTS5_TOKENIZE_PREFIX
 0x0002

	)

10899 
	#FTS5_TOKENIZE_DOCUMENT
 0x0004

	)

10900 
	#FTS5_TOKENIZE_AUX
 0x0008

	)

10904 
	#FTS5_TOKEN_COLOCATED
 0x0001

	)

10913 
ás5_­i
 
	tás5_­i
;

10914 
	sás5_­i
 {

10915 
iV”siÚ
;

10918 (*
xC»©eTok’iz”
)(

10919 
ás5_­i
 *
pApi
,

10920 cÚ¡ *
zName
,

10921 *
pCÚ‹xt
,

10922 
ás5_tok’iz”
 *
pTok’iz”
,

10923 (*
xDe¡roy
)(*)

10927 (*
xFšdTok’iz”
)(

10928 
ás5_­i
 *
pApi
,

10929 cÚ¡ *
zName
,

10930 **
µCÚ‹xt
,

10931 
ás5_tok’iz”
 *
pTok’iz”


10935 (*
xC»©eFunùiÚ
)(

10936 
ás5_­i
 *
pApi
,

10937 cÚ¡ *
zName
,

10938 *
pCÚ‹xt
,

10939 
ás5_ex‹nsiÚ_funùiÚ
 
xFunùiÚ
,

10940 (*
xDe¡roy
)(*)

10948 #ifdeà
__ılu¥lus


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wch¬.h
>

29 
	~<b™s/wÜdsize.h
>

34 
	~<b™s/¡dšt-šŠ.h
>

37 
	~<b™s/¡dšt-ušŠ.h
>

43 sigÃd 
	tšt_Ëa¡8_t
;

44 
	tšt_Ëa¡16_t
;

45 
	tšt_Ëa¡32_t
;

46 #ià
__WORDSIZE
 == 64

47 
	tšt_Ëa¡64_t
;

49 
__ex‹nsiÚ__


50 
	tšt_Ëa¡64_t
;

54 
	tušt_Ëa¡8_t
;

55 
	tušt_Ëa¡16_t
;

56 
	tušt_Ëa¡32_t
;

57 #ià
__WORDSIZE
 == 64

58 
	tušt_Ëa¡64_t
;

60 
__ex‹nsiÚ__


61 
	tušt_Ëa¡64_t
;

68 sigÃd 
	tšt_ç¡8_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_ç¡16_t
;

71 
	tšt_ç¡32_t
;

72 
	tšt_ç¡64_t
;

74 
	tšt_ç¡16_t
;

75 
	tšt_ç¡32_t
;

76 
__ex‹nsiÚ__


77 
	tšt_ç¡64_t
;

81 
	tušt_ç¡8_t
;

82 #ià
__WORDSIZE
 == 64

83 
	tušt_ç¡16_t
;

84 
	tušt_ç¡32_t
;

85 
	tušt_ç¡64_t
;

87 
	tušt_ç¡16_t
;

88 
	tušt_ç¡32_t
;

89 
__ex‹nsiÚ__


90 
	tušt_ç¡64_t
;

95 #ià
__WORDSIZE
 == 64

96 #iâdeà
__šŒ_t_defšed


97 
	tšŒ_t
;

98 
	#__šŒ_t_defšed


	)

100 
	tušŒ_t
;

102 #iâdeà
__šŒ_t_defšed


103 
	tšŒ_t
;

104 
	#__šŒ_t_defšed


	)

106 
	tušŒ_t
;

111 
__štmax_t
 
	tštmax_t
;

112 
__uštmax_t
 
	tuštmax_t
;

115 #ià
__WORDSIZE
 == 64

116 
	#__INT64_C
(
c
èø## 
L


	)

117 
	#__UINT64_C
(
c
èø## 
UL


	)

119 
	#__INT64_C
(
c
èø## 
LL


	)

120 
	#__UINT64_C
(
c
èø## 
ULL


	)

126 
	#INT8_MIN
 (-128)

	)

127 
	#INT16_MIN
 (-32767-1)

	)

128 
	#INT32_MIN
 (-2147483647-1)

	)

129 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

131 
	#INT8_MAX
 (127)

	)

132 
	#INT16_MAX
 (32767)

	)

133 
	#INT32_MAX
 (2147483647)

	)

134 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

137 
	#UINT8_MAX
 (255)

	)

138 
	#UINT16_MAX
 (65535)

	)

139 
	#UINT32_MAX
 (4294967295U)

	)

140 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

144 
	#INT_LEAST8_MIN
 (-128)

	)

145 
	#INT_LEAST16_MIN
 (-32767-1)

	)

146 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

147 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

149 
	#INT_LEAST8_MAX
 (127)

	)

150 
	#INT_LEAST16_MAX
 (32767)

	)

151 
	#INT_LEAST32_MAX
 (2147483647)

	)

152 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

155 
	#UINT_LEAST8_MAX
 (255)

	)

156 
	#UINT_LEAST16_MAX
 (65535)

	)

157 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

158 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

162 
	#INT_FAST8_MIN
 (-128)

	)

163 #ià
__WORDSIZE
 == 64

164 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

165 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

167 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

168 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

170 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

172 
	#INT_FAST8_MAX
 (127)

	)

173 #ià
__WORDSIZE
 == 64

174 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

175 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

177 
	#INT_FAST16_MAX
 (2147483647)

	)

178 
	#INT_FAST32_MAX
 (2147483647)

	)

180 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

183 
	#UINT_FAST8_MAX
 (255)

	)

184 #ià
__WORDSIZE
 == 64

185 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

186 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

188 
	#UINT_FAST16_MAX
 (4294967295U)

	)

189 
	#UINT_FAST32_MAX
 (4294967295U)

	)

191 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

195 #ià
__WORDSIZE
 == 64

196 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

197 
	#INTPTR_MAX
 (9223372036854775807L)

	)

198 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

200 
	#INTPTR_MIN
 (-2147483647-1)

	)

201 
	#INTPTR_MAX
 (2147483647)

	)

202 
	#UINTPTR_MAX
 (4294967295U)

	)

207 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

209 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

218 #ià
__WORDSIZE
 == 64

219 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

220 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

222 #ià
__WORDSIZE32_PTRDIFF_LONG


223 
	#PTRDIFF_MIN
 (-2147483647L-1)

	)

224 
	#PTRDIFF_MAX
 (2147483647L)

	)

226 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

227 
	#PTRDIFF_MAX
 (2147483647)

	)

232 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

233 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

236 #ià
__WORDSIZE
 == 64

237 
	#SIZE_MAX
 (18446744073709551615UL)

	)

239 #ià
__WORDSIZE32_SIZE_ULONG


240 
	#SIZE_MAX
 (4294967295UL)

	)

242 
	#SIZE_MAX
 (4294967295U)

	)

247 #iâdeà
WCHAR_MIN


249 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

250 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

254 
	#WINT_MIN
 (0u)

	)

255 
	#WINT_MAX
 (4294967295u)

	)

258 
	#INT8_C
(
c
è
	)
c

259 
	#INT16_C
(
c
è
	)
c

260 
	#INT32_C
(
c
è
	)
c

261 #ià
__WORDSIZE
 == 64

262 
	#INT64_C
(
c
èø## 
L


	)

264 
	#INT64_C
(
c
èø## 
LL


	)

268 
	#UINT8_C
(
c
è
	)
c

269 
	#UINT16_C
(
c
è
	)
c

270 
	#UINT32_C
(
c
èø## 
U


	)

271 #ià
__WORDSIZE
 == 64

272 
	#UINT64_C
(
c
èø## 
UL


	)

274 
	#UINT64_C
(
c
èø## 
ULL


	)

278 #ià
__WORDSIZE
 == 64

279 
	#INTMAX_C
(
c
èø## 
L


	)

280 
	#UINTMAX_C
(
c
èø## 
UL


	)

282 
	#INTMAX_C
(
c
èø## 
LL


	)

283 
	#UINTMAX_C
(
c
èø## 
ULL


	)

286 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

288 
	#INT8_WIDTH
 8

	)

289 
	#UINT8_WIDTH
 8

	)

290 
	#INT16_WIDTH
 16

	)

291 
	#UINT16_WIDTH
 16

	)

292 
	#INT32_WIDTH
 32

	)

293 
	#UINT32_WIDTH
 32

	)

294 
	#INT64_WIDTH
 64

	)

295 
	#UINT64_WIDTH
 64

	)

297 
	#INT_LEAST8_WIDTH
 8

	)

298 
	#UINT_LEAST8_WIDTH
 8

	)

299 
	#INT_LEAST16_WIDTH
 16

	)

300 
	#UINT_LEAST16_WIDTH
 16

	)

301 
	#INT_LEAST32_WIDTH
 32

	)

302 
	#UINT_LEAST32_WIDTH
 32

	)

303 
	#INT_LEAST64_WIDTH
 64

	)

304 
	#UINT_LEAST64_WIDTH
 64

	)

306 
	#INT_FAST8_WIDTH
 8

	)

307 
	#UINT_FAST8_WIDTH
 8

	)

308 
	#INT_FAST16_WIDTH
 
__WORDSIZE


	)

309 
	#UINT_FAST16_WIDTH
 
__WORDSIZE


	)

310 
	#INT_FAST32_WIDTH
 
__WORDSIZE


	)

311 
	#UINT_FAST32_WIDTH
 
__WORDSIZE


	)

312 
	#INT_FAST64_WIDTH
 64

	)

313 
	#UINT_FAST64_WIDTH
 64

	)

315 
	#INTPTR_WIDTH
 
__WORDSIZE


	)

316 
	#UINTPTR_WIDTH
 
__WORDSIZE


	)

318 
	#INTMAX_WIDTH
 64

	)

319 
	#UINTMAX_WIDTH
 64

	)

321 
	#PTRDIFF_WIDTH
 
__WORDSIZE


	)

322 
	#SIG_ATOMIC_WIDTH
 32

	)

323 
	#SIZE_WIDTH
 
__WORDSIZE


	)

324 
	#WCHAR_WIDTH
 32

	)

325 
	#WINT_WIDTH
 32

	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


24 
	#_STDIO_H
 1

	)

26 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

27 
	~<b™s/libc-h—d”-¡¬t.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	~<b™s/ty³s/__FILE.h
>

37 
	~<b™s/ty³s/FILE.h
>

39 
	#_STDIO_USES_IOSTREAM


	)

41 
	~<b™s/libio.h
>

43 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


44 #ifdeà
__GNUC__


45 #iâdeà
_VA_LIST_DEFINED


46 
_G_va_li¡
 
	tva_li¡
;

47 
	#_VA_LIST_DEFINED


	)

50 
	~<¡d¬g.h
>

54 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


55 #iâdeà
__off_t_defšed


56 #iâdeà
__USE_FILE_OFFSET64


57 
__off_t
 
	toff_t
;

59 
__off64_t
 
	toff_t
;

61 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

69 #ifdeà
__USE_XOPEN2K8


70 #iâdeà
__ssize_t_defšed


71 
__ssize_t
 
	tssize_t
;

72 
	#__ssize_t_defšed


	)

77 #iâdeà
__USE_FILE_OFFSET64


78 
_G_åos_t
 
	tåos_t
;

80 
_G_åos64_t
 
	tåos_t
;

82 #ifdeà
__USE_LARGEFILE64


83 
_G_åos64_t
 
	tåos64_t
;

87 
	#_IOFBF
 0

	)

88 
	#_IOLBF
 1

	)

89 
	#_IONBF
 2

	)

93 #iâdeà
BUFSIZ


94 
	#BUFSIZ
 
_IO_BUFSIZ


	)

100 #iâdeà
EOF


101 
	#EOF
 (-1)

	)

107 
	#SEEK_SET
 0

	)

108 
	#SEEK_CUR
 1

	)

109 
	#SEEK_END
 2

	)

110 #ifdeà
__USE_GNU


111 
	#SEEK_DATA
 3

	)

112 
	#SEEK_HOLE
 4

	)

116 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


118 
	#P_tmpdœ
 "/tmp"

	)

131 
	~<b™s/¡dio_lim.h
>

135 
_IO_FILE
 *
¡dš
;

136 
_IO_FILE
 *
¡dout
;

137 
_IO_FILE
 *
¡d”r
;

139 
	#¡dš
 
¡dš


	)

140 
	#¡dout
 
¡dout


	)

141 
	#¡d”r
 
¡d”r


	)

144 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

146 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

148 #ifdeà
__USE_ATFILE


150 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

151 cÚ¡ *
__Ãw
è
__THROW
;

158 #iâdeà
__USE_FILE_OFFSET64


159 
FILE
 *
	$tmpfe
 (è
__wur
;

161 #ifdeà
__REDIRECT


162 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

164 
	#tmpfe
 
tmpfe64


	)

168 #ifdeà
__USE_LARGEFILE64


169 
FILE
 *
	$tmpfe64
 (è
__wur
;

173 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

175 #ifdeà
__USE_MISC


178 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

182 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


190 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

191 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

199 
	`fşo£
 (
FILE
 *
__¡»am
);

204 
	`fæush
 (
FILE
 *
__¡»am
);

206 #ifdeà
__USE_MISC


213 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

216 #ifdeà
__USE_GNU


223 
	`fşo£®l
 ();

227 #iâdeà
__USE_FILE_OFFSET64


232 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

233 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

238 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

239 cÚ¡ *
__»¡riù
 
__modes
,

240 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

242 #ifdeà
__REDIRECT


243 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

244 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

245 
__wur
;

246 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

247 cÚ¡ *
__»¡riù
 
__modes
,

248 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

249 
__wur
;

251 
	#fİ’
 
fİ’64


	)

252 
	#äeİ’
 
äeİ’64


	)

255 #ifdeà
__USE_LARGEFILE64


256 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

257 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

258 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

259 cÚ¡ *
__»¡riù
 
__modes
,

260 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

263 #ifdef 
__USE_POSIX


265 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

268 #ifdef 
__USE_GNU


271 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

272 cÚ¡ *
__»¡riù
 
__modes
,

273 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

276 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

278 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

279 
__THROW
 
__wur
;

284 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

290 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

294 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

295 
__modes
, 
size_t
 
__n
è
__THROW
;

297 #ifdef 
__USE_MISC


300 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

301 
size_t
 
__size
è
__THROW
;

304 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

312 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

313 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

318 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

320 
	$¥rštf
 (*
__»¡riù
 
__s
,

321 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

327 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

328 
_G_va_li¡
 
__¬g
);

333 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

335 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

336 
_G_va_li¡
 
__¬g
è
__THROWNL
;

338 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


340 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

341 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

342 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

344 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

345 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

346 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

349 #ià
	`__GLIBC_USE
 (
LIB_EXT2
)

352 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

353 
_G_va_li¡
 
__¬g
)

354 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

355 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

356 cÚ¡ *
__»¡riù
 
__fmt
, ...)

357 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

358 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

359 cÚ¡ *
__»¡riù
 
__fmt
, ...)

360 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

363 #ifdeà
__USE_XOPEN2K8


365 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

366 
_G_va_li¡
 
__¬g
)

367 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

368 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

369 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

377 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

378 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

383 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

385 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

386 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

388 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

389 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

390 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

391 #ifdeà
__REDIRECT


395 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

396 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

397 
__isoc99_fsÿnf
è
__wur
;

398 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

399 
__isoc99_sÿnf
è
__wur
;

400 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

401 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

402 
__isoc99_ssÿnf
);

404 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

405 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

406 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

407 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

408 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

409 
	#fsÿnf
 
__isoc99_fsÿnf


	)

410 
	#sÿnf
 
__isoc99_sÿnf


	)

411 
	#ssÿnf
 
__isoc99_ssÿnf


	)

415 #ifdef 
__USE_ISOC99


420 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

421 
_G_va_li¡
 
__¬g
)

422 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

428 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

429 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

432 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

433 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

434 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

436 #ià!
defšed
 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
vfsÿnf
,

444 (
FILE
 *
__»¡riù
 
__s
,

445 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

446 
__isoc99_vfsÿnf
)

447 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

448 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

449 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

450 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

451 
	`__REDIRECT_NTH
 (
vssÿnf
,

452 (cÚ¡ *
__»¡riù
 
__s
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
,

454 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

455 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

457 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

458 cÚ¡ *
__»¡riù
 
__fÜm©
,

459 
_G_va_li¡
 
__¬g
è
__wur
;

460 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

461 
_G_va_li¡
 
__¬g
è
__wur
;

462 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

463 cÚ¡ *
__»¡riù
 
__fÜm©
,

464 
_G_va_li¡
 
__¬g
è
__THROW
;

465 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

466 
	#vsÿnf
 
__isoc99_vsÿnf


	)

467 
	#vssÿnf
 
__isoc99_vssÿnf


	)

477 
	`fg‘c
 (
FILE
 *
__¡»am
);

478 
	`g‘c
 (
FILE
 *
__¡»am
);

484 
	`g‘ch¬
 ();

488 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

490 #ifdeà
__USE_POSIX199506


495 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

496 
	`g‘ch¬_uÆocked
 ();

499 #ifdeà
__USE_MISC


506 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

517 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

518 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

524 
	`putch¬
 (
__c
);

528 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

530 #ifdeà
__USE_MISC


537 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

540 #ifdeà
__USE_POSIX199506


545 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

546 
	`putch¬_uÆocked
 (
__c
);

550 #ià
defšed
 
__USE_MISC
 \

551 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

553 
	`g‘w
 (
FILE
 *
__¡»am
);

556 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

564 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

565 
__wur
;

567 #ià
	`__GLIBC_USE
 (
DEPRECATED_GETS
)

577 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

580 #ifdeà
__USE_GNU


587 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

588 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

592 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

603 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

604 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

605 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

606 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

607 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

608 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

616 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

617 
size_t
 *
__»¡riù
 
__n
,

618 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

626 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

632 
	`puts
 (cÚ¡ *
__s
);

639 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

646 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

647 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

652 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

653 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

655 #ifdeà
__USE_GNU


662 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

663 
FILE
 *
__»¡riù
 
__¡»am
);

666 #ifdeà
__USE_MISC


673 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

674 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

675 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

676 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

684 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

689 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

694 
	`»wšd
 (
FILE
 *
__¡»am
);

701 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


702 #iâdeà
__USE_FILE_OFFSET64


707 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

712 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

714 #ifdeà
__REDIRECT


715 
	`__REDIRECT
 (
f£eko
,

716 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

717 
f£eko64
);

718 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

720 
	#f£eko
 
f£eko64


	)

721 
	#á–lo
 
á–lo64


	)

726 #iâdeà
__USE_FILE_OFFSET64


731 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

736 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

738 #ifdeà
__REDIRECT


739 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

740 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

741 
	`__REDIRECT
 (
f£os
,

742 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

744 
	#fg‘pos
 
fg‘pos64


	)

745 
	#f£os
 
f£os64


	)

749 #ifdeà
__USE_LARGEFILE64


750 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

751 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

752 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

753 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

757 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

759 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

761 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

763 #ifdeà
__USE_MISC


765 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

766 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

767 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

775 
	`³¼Ü
 (cÚ¡ *
__s
);

781 
	~<b™s/sys_”¾i¡.h
>

784 #ifdef 
__USE_POSIX


786 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

789 #ifdeà
__USE_MISC


791 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

795 #ifdeà
__USE_POSIX2


800 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

806 
	`pşo£
 (
FILE
 *
__¡»am
);

810 #ifdef 
__USE_POSIX


812 *
	$ù”mid
 (*
__s
è
__THROW
;

816 #ià(
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
è|| defšed 
__USE_GNU


818 *
	`cu£rid
 (*
__s
);

822 #ifdef 
__USE_GNU


823 
ob¡ack
;

826 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

827 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

828 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

829 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

830 cÚ¡ *
__»¡riù
 
__fÜm©
,

831 
_G_va_li¡
 
__¬gs
)

832 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

836 #ifdeà
__USE_POSIX199506


840 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

844 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

847 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

850 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


853 
	~<b™s/g‘İt_posix.h
>

858 #ifdeà
__USE_EXTERN_INLINES


859 
	~<b™s/¡dio.h
>

861 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


862 
	~<b™s/¡dio2.h
>

864 #ifdeà
__LDBL_COMPAT


865 
	~<b™s/¡dio-ldbl.h
>

868 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

25 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	#__Ãed_size_t


	)

29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

31 
	~<¡ddef.h
>

33 
	g__BEGIN_DECLS


35 
	#_STDLIB_H
 1

	)

37 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


39 
	~<b™s/wa™æags.h
>

40 
	~<b™s/wa™¡©us.h
>

43 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (¡©us)

	)

44 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (¡©us)

	)

45 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (¡©us)

	)

46 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (¡©us)

	)

47 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (¡©us)

	)

48 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (¡©us)

	)

49 #ifdeà
__WIFCONTINUED


50 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (¡©us)

	)

55 
	~<b™s/æßŠ.h
>

60 
	mquÙ
;

61 
	m»m
;

62 } 
	tdiv_t
;

65 #iâdeà
__ldiv_t_defšed


68 
	mquÙ
;

69 
	m»m
;

70 } 
	tldiv_t
;

71 
	#__ldiv_t_defšed
 1

	)

74 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


76 
__ex‹nsiÚ__
 struct

78 
	mquÙ
;

79 
	m»m
;

80 } 
	tÎdiv_t
;

81 
	#__Îdiv_t_defšed
 1

	)

86 
	#RAND_MAX
 2147483647

	)

91 
	#EXIT_FAILURE
 1

	)

92 
	#EXIT_SUCCESS
 0

	)

96 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

97 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

101 
	$©of
 (cÚ¡ *
__ÅŒ
)

102 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

104 
	$©oi
 (cÚ¡ *
__ÅŒ
)

105 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

107 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

108 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

110 #ifdeà
__USE_ISOC99


112 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

113 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

117 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

118 **
__»¡riù
 
__’d±r
)

119 
__THROW
 
	`__nÚnuÎ
 ((1));

121 #ifdef 
__USE_ISOC99


123 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

124 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

126 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

127 **
__»¡riù
 
__’d±r
)

128 
__THROW
 
	`__nÚnuÎ
 ((1));

133 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

134 
_Flßt16
 
	$¡¹of16
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

135 **
__»¡riù
 
__’d±r
)

136 
__THROW
 
	`__nÚnuÎ
 ((1));

139 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

140 
_Flßt32
 
	$¡¹of32
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

141 **
__»¡riù
 
__’d±r
)

142 
__THROW
 
	`__nÚnuÎ
 ((1));

145 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

146 
_Flßt64
 
	$¡¹of64
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

147 **
__»¡riù
 
__’d±r
)

148 
__THROW
 
	`__nÚnuÎ
 ((1));

151 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

152 
_Flßt128
 
	$¡¹of128
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

153 **
__»¡riù
 
__’d±r
)

154 
__THROW
 
	`__nÚnuÎ
 ((1));

157 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

158 
_Flßt32x
 
	$¡¹of32x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

159 **
__»¡riù
 
__’d±r
)

160 
__THROW
 
	`__nÚnuÎ
 ((1));

163 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

164 
_Flßt64x
 
	$¡¹of64x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

169 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

170 
_Flßt128x
 
	$¡¹of128x
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

171 **
__»¡riù
 
__’d±r
)

172 
__THROW
 
	`__nÚnuÎ
 ((1));

176 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

177 **
__»¡riù
 
__’d±r
, 
__ba£
)

178 
__THROW
 
	`__nÚnuÎ
 ((1));

180 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

181 **
__»¡riù
 
__’d±r
, 
__ba£
)

182 
__THROW
 
	`__nÚnuÎ
 ((1));

184 #ifdeà
__USE_MISC


186 
__ex‹nsiÚ__


187 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

191 
__ex‹nsiÚ__


192 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

193 **
__»¡riù
 
__’d±r
, 
__ba£
)

194 
__THROW
 
	`__nÚnuÎ
 ((1));

197 #ifdeà
__USE_ISOC99


199 
__ex‹nsiÚ__


200 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

204 
__ex‹nsiÚ__


205 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

206 **
__»¡riù
 
__’d±r
, 
__ba£
)

207 
__THROW
 
	`__nÚnuÎ
 ((1));

211 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

212 
	$¡räomd
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

213 
__f
)

214 
__THROW
 
	`__nÚnuÎ
 ((3));

216 
	$¡räomf
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

217 
__f
)

218 
__THROW
 
	`__nÚnuÎ
 ((3));

220 
	$¡räoml
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ *
__fÜm©
,

221 
__f
)

222 
__THROW
 
	`__nÚnuÎ
 ((3));

225 #ià
__HAVE_FLOAT16
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

226 
	$¡räomf16
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

227 
_Flßt16
 
__f
)

228 
__THROW
 
	`__nÚnuÎ
 ((3));

231 #ià
__HAVE_FLOAT32
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

232 
	$¡räomf32
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

233 
_Flßt32
 
__f
)

234 
__THROW
 
	`__nÚnuÎ
 ((3));

237 #ià
__HAVE_FLOAT64
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

238 
	$¡räomf64
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

239 
_Flßt64
 
__f
)

240 
__THROW
 
	`__nÚnuÎ
 ((3));

243 #ià
__HAVE_FLOAT128
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

244 
	$¡räomf128
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

245 
_Flßt128
 
__f
)

246 
__THROW
 
	`__nÚnuÎ
 ((3));

249 #ià
__HAVE_FLOAT32X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

250 
	$¡räomf32x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

251 
_Flßt32x
 
__f
)

252 
__THROW
 
	`__nÚnuÎ
 ((3));

255 #ià
__HAVE_FLOAT64X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

256 
	$¡räomf64x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

257 
_Flßt64x
 
__f
)

258 
__THROW
 
	`__nÚnuÎ
 ((3));

261 #ià
__HAVE_FLOAT128X
 && 
	`__GLIBC_USE
 (
IEC_60559_TYPES_EXT
)

262 
	$¡räomf128x
 (*
__de¡
, 
size_t
 
__size
, cÚ¡ * 
__fÜm©
,

263 
_Flßt128x
 
__f
)

264 
__THROW
 
	`__nÚnuÎ
 ((3));

268 #ifdeà
__USE_GNU


272 
	~<b™s/ty³s/loÿË_t.h
>

274 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

275 **
__»¡riù
 
__’d±r
, 
__ba£
,

276 
loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

278 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

279 **
__»¡riù
 
__’d±r
,

280 
__ba£
, 
loÿË_t
 
__loc
)

281 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

283 
__ex‹nsiÚ__


284 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

285 **
__»¡riù
 
__’d±r
, 
__ba£
,

286 
loÿË_t
 
__loc
)

287 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

289 
__ex‹nsiÚ__


290 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

291 **
__»¡riù
 
__’d±r
,

292 
__ba£
, 
loÿË_t
 
__loc
)

293 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

295 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

296 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

297 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

299 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

300 **
__»¡riù
 
__’d±r
, 
loÿË_t
 
__loc
)

301 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

303 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

304 **
__»¡riù
 
__’d±r
,

305 
loÿË_t
 
__loc
)

306 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

308 #ià
__HAVE_FLOAT16


309 
_Flßt16
 
	$¡¹of16_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

310 **
__»¡riù
 
__’d±r
,

311 
loÿË_t
 
__loc
)

312 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

315 #ià
__HAVE_FLOAT32


316 
_Flßt32
 
	$¡¹of32_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

317 **
__»¡riù
 
__’d±r
,

318 
loÿË_t
 
__loc
)

319 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

322 #ià
__HAVE_FLOAT64


323 
_Flßt64
 
	$¡¹of64_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

324 **
__»¡riù
 
__’d±r
,

325 
loÿË_t
 
__loc
)

326 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

329 #ià
__HAVE_FLOAT128


330 
_Flßt128
 
	$¡¹of128_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 **
__»¡riù
 
__’d±r
,

332 
loÿË_t
 
__loc
)

333 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

336 #ià
__HAVE_FLOAT32X


337 
_Flßt32x
 
	$¡¹of32x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

338 **
__»¡riù
 
__’d±r
,

339 
loÿË_t
 
__loc
)

340 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

343 #ià
__HAVE_FLOAT64X


344 
_Flßt64x
 
	$¡¹of64x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

345 **
__»¡riù
 
__’d±r
,

346 
loÿË_t
 
__loc
)

347 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

350 #ià
__HAVE_FLOAT128X


351 
_Flßt128x
 
	$¡¹of128x_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

352 **
__»¡riù
 
__’d±r
,

353 
loÿË_t
 
__loc
)

354 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

359 #ifdeà
__USE_EXTERN_INLINES


360 
__ex‹º_šlše
 

361 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

363  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

364 
	}
}

365 
__ex‹º_šlše
 

366 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

368  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

369 
	}
}

371 #ifdeà
__USE_ISOC99


372 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

373 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

375  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

376 
	}
}

381 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


385 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

388 
	$a64l
 (cÚ¡ *
__s
)

389 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

393 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


394 
	~<sys/ty³s.h
>

401 
	$¿ndom
 (è
__THROW
;

404 
	$¤ªdom
 (
__£ed
è
__THROW
;

410 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

411 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

415 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

418 #ifdeà
__USE_MISC


423 
	s¿ndom_d©a


425 
št32_t
 *
åŒ
;

426 
št32_t
 *
½Œ
;

427 
št32_t
 *
¡©e
;

428 
¿nd_ty³
;

429 
¿nd_deg
;

430 
¿nd_£p
;

431 
št32_t
 *
’d_±r
;

434 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

435 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

437 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

438 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

441 
size_t
 
__¡©–’
,

442 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

443 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

445 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

446 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

447 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

453 
	$¿nd
 (è
__THROW
;

455 
	$¤ªd
 (
__£ed
è
__THROW
;

457 #ifdeà
__USE_POSIX199506


459 
	$¿nd_r
 (*
__£ed
è
__THROW
;

463 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


467 
	$d¿nd48
 (è
__THROW
;

468 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

471 
	$Ìªd48
 (è
__THROW
;

472 
	$Äªd48
 (
__xsubi
[3])

473 
__THROW
 
	`__nÚnuÎ
 ((1));

476 
	$m¿nd48
 (è
__THROW
;

477 
	$j¿nd48
 (
__xsubi
[3])

478 
__THROW
 
	`__nÚnuÎ
 ((1));

481 
	$¤ªd48
 (
__£edv®
è
__THROW
;

482 *
	$£ed48
 (
__£ed16v
[3])

483 
__THROW
 
	`__nÚnuÎ
 ((1));

484 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

486 #ifdeà
__USE_MISC


490 
	sd¿nd48_d©a


492 
__x
[3];

493 
__Şd_x
[3];

494 
__c
;

495 
__š™
;

496 
__ex‹nsiÚ__
 
__a
;

501 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

502 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

503 
	$”ªd48_r
 (
__xsubi
[3],

504 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

505 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

508 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

509 *
__»¡riù
 
__»suÉ
)

510 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

511 
	$Äªd48_r
 (
__xsubi
[3],

512 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

513 *
__»¡riù
 
__»suÉ
)

514 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

517 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

518 *
__»¡riù
 
__»suÉ
)

519 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

520 
	$j¿nd48_r
 (
__xsubi
[3],

521 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

522 *
__»¡riù
 
__»suÉ
)

523 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

526 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

527 
__THROW
 
	`__nÚnuÎ
 ((2));

529 
	$£ed48_r
 (
__£ed16v
[3],

530 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

532 
	$lcÚg48_r
 (
__·¿m
[7],

533 
d¿nd48_d©a
 *
__bufãr
)

534 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

539 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

541 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

542 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

549 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

550 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

552 #ifdeà
__USE_GNU


558 *
	$»®loÿ¼ay
 (*
__±r
, 
size_t
 
__nmemb
, size_ˆ
__size
)

559 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

563 
	$ä“
 (*
__±r
è
__THROW
;

565 #ifdeà
__USE_MISC


566 
	~<®loÿ.h
>

569 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

570 || 
defšed
 
__USE_MISC


572 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

575 #ifdeà
__USE_XOPEN2K


577 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

578 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

581 #ifdeà
__USE_ISOC11


583 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

584 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

588 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

592 
	$©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

594 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


596 #ifdeà
__ılu¥lus


597 "C++" 
	$©_quick_ex™
 ((*
__func
) ())

598 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

600 
	$©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

604 #ifdef 
__USE_MISC


607 
	$Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

608 
__THROW
 
	`__nÚnuÎ
 ((1));

614 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

616 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


620 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

623 #ifdeà
__USE_ISOC99


626 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

631 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

633 #ifdeà
__USE_GNU


636 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

637 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

640 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


644 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

647 #ifdeà
__USE_XOPEN2K


650 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

651 
__THROW
 
	`__nÚnuÎ
 ((2));

654 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

657 #ifdef 
__USE_MISC


661 
	$ş—»nv
 (è
__THROW
;

665 #ià
defšed
 
__USE_MISC
 \

666 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

672 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

675 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


684 #iâdeà
__USE_FILE_OFFSET64


685 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

687 #ifdeà
__REDIRECT


688 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

689 
	`__nÚnuÎ
 ((1)è
__wur
;

691 
	#mk¡emp
 
mk¡emp64


	)

694 #ifdeà
__USE_LARGEFILE64


695 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

699 #ifdeà
__USE_MISC


706 #iâdeà
__USE_FILE_OFFSET64


707 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

711 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

713 
	#mk¡emps
 
mk¡emps64


	)

716 #ifdeà
__USE_LARGEFILE64


717 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

718 
	`__nÚnuÎ
 ((1)è
__wur
;

722 #ifdeà
__USE_XOPEN2K8


728 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

731 #ifdeà
__USE_GNU


738 #iâdeà
__USE_FILE_OFFSET64


739 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

741 #ifdeà
__REDIRECT


742 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

743 
	`__nÚnuÎ
 ((1)è
__wur
;

745 
	#mko¡emp
 
mko¡emp64


	)

748 #ifdeà
__USE_LARGEFILE64


749 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

758 #iâdeà
__USE_FILE_OFFSET64


759 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

760 
	`__nÚnuÎ
 ((1)è
__wur
;

762 #ifdeà
__REDIRECT


763 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

764 
__æags
), 
mko¡emps64
)

765 
	`__nÚnuÎ
 ((1)è
__wur
;

767 
	#mko¡emps
 
mko¡emps64


	)

770 #ifdeà
__USE_LARGEFILE64


771 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

772 
	`__nÚnuÎ
 ((1)è
__wur
;

781 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

784 #ifdef 
__USE_GNU


787 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

788 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

791 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


797 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

798 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

803 #iâdeà
__COMPAR_FN_T


804 
	#__COMPAR_FN_T


	)

805 (*
	t__com·r_â_t
) (const *, const *);

807 #ifdef 
__USE_GNU


808 
__com·r_â_t
 
	tcom·risÚ_â_t
;

811 #ifdeà
__USE_GNU


812 (*
	t__com·r_d_â_t
) (const *, const *, *);

817 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

818 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

819 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

821 #ifdeà
__USE_EXTERN_INLINES


822 
	~<b™s/¡dlib-b£¬ch.h
>

827 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

828 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

829 #ifdeà
__USE_GNU


830 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

831 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

832 
	`__nÚnuÎ
 ((1, 4));

837 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

838 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

840 #ifdeà
__USE_ISOC99


841 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

842 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

849 
div_t
 
	$div
 (
__num”
, 
__d’om
)

850 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

851 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

852 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

854 #ifdeà
__USE_ISOC99


855 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

856 
__d’om
)

857 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

861 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

862 || 
defšed
 
__USE_MISC


869 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

870 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

875 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

876 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

881 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

882 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

885 #ifdeà
__USE_MISC


887 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

888 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

889 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

890 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

891 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

892 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

893 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

894 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

899 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

900 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

901 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

902 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

903 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

904 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

906 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

907 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

908 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

909 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

910 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

911 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

912 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

913 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

919 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

922 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

923 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

926 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

930 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

931 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

933 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

934 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

935 
__THROW
;

938 #ifdeà
__USE_MISC


943 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

947 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


954 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

955 *cÚ¡ *
__»¡riù
 
__tok’s
,

956 **
__»¡riù
 
__v®u•
)

957 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

961 #ifdeà
__USE_XOPEN


963 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

969 #ifdeà
__USE_XOPEN2KXSI


971 
	$posix_İ’±
 (
__oæag
è
__wur
;

974 #ifdeà
__USE_XOPEN_EXTENDED


979 
	$g¿Á±
 (
__fd
è
__THROW
;

983 
	$uÆock±
 (
__fd
è
__THROW
;

988 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

991 #ifdeà
__USE_GNU


995 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

996 
__THROW
 
	`__nÚnuÎ
 ((2));

999 
	`g‘±
 ();

1002 #ifdeà
__USE_MISC


1006 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1));

1010 #ià
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K


1013 
	$‰y¦Ù
 (è
__THROW
;

1016 
	~<b™s/¡dlib-æßt.h
>

1019 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1020 
	~<b™s/¡dlib.h
>

1022 #ifdeà
__LDBL_COMPAT


1023 
	~<b™s/¡dlib-ldbl.h
>

1026 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	#__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


	)

26 
	~<b™s/libc-h—d”-¡¬t.h
>

28 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

36 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

37 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

42 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

46 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


53 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

54 
__c
, 
size_t
 
__n
)

55 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

60 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

63 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

64 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

67 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


70 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

71 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

72 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

75 #ifdeà
__OPTIMIZE__


76 
__ex‹º_®ways_šlše
 *

77 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


79  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

82 
__ex‹º_®ways_šlše
 const *

83 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
	}
}

90 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

91 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

94 #ifdeà
__USE_GNU


97 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


98 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

99 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

100 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

101 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

103 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

104 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

108 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


109 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

110 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

112 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

122 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

124 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

125 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

129 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

133 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

137 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

139 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

140 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

146 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

147 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

148 
__THROW
 
	`__nÚnuÎ
 ((2));

150 #ifdeà
__USE_XOPEN2K8


152 
	~<b™s/ty³s/loÿË_t.h
>

155 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__l
)

156 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

159 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

160 
loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

163 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8
 \

164 || 
	$__GLIBC_USE
 (
LIB_EXT2
))

166 *
	$¡rdup
 (cÚ¡ *
__s
)

167 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

173 #ià
defšed
 
__USE_XOPEN2K8
 || 
	`__GLIBC_USE
 (
LIB_EXT2
)

174 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

175 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

178 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


180 
	#¡rdu·
(
s
) \

181 (
__ex‹nsiÚ__
 \

183 cÚ¡ *
__Şd
 = (
s
); \

184 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

185 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

186 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

187 
	}
}))

	)

190 
	#¡ºdu·
(
s
, 
n
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

196 
__Ãw
[
__Ën
] = '\0'; \

197 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

198 }))

	)

202 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


205 *
¡rchr
 (*
__s
, 
__c
)

206 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

207 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

208 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

210 #ifdeà
__OPTIMIZE__


211 
__ex‹º_®ways_šlše
 *

212 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


214  
__butš_¡rchr
 (
__s
, 
__c
);

217 
__ex‹º_®ways_šlše
 const *

218 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


220  
__butš_¡rchr
 (
__s
, 
__c
);

225 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

226 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

229 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


232 *
	`¡¼chr
 (*
__s
, 
__c
)

233 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

234 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

235 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

237 #ifdeà
__OPTIMIZE__


238 
__ex‹º_®ways_šlše
 *

239 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


241  
	`__butš_¡¼chr
 (
__s
, 
__c
);

244 
__ex‹º_®ways_šlše
 const *

245 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


247  
	`__butš_¡¼chr
 (
__s
, 
__c
);

250 
	}
}

252 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

253 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

256 #ifdeà
__USE_GNU


259 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


260 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

261 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

262 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

263 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

265 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

266 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

272 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

273 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

276 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

277 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

279 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


282 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

283 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

284 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

285 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

287 #ifdeà
__OPTIMIZE__


288 
__ex‹º_®ways_šlše
 *

289 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


291  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

294 
__ex‹º_®ways_šlše
 const *

295 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


297  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

300 
	}
}

302 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

303 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

306 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


309 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

310 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

311 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

312 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

314 #ifdeà
__OPTIMIZE__


315 
__ex‹º_®ways_šlše
 *

316 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


318  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

321 
__ex‹º_®ways_šlše
 const *

322 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


324  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

327 
	}
}

329 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

330 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

335 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

336 
__THROW
 
	`__nÚnuÎ
 ((2));

340 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

341 cÚ¡ *
__»¡riù
 
__d–im
,

342 **
__»¡riù
 
__§ve_±r
)

343 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

344 #ifdeà
__USE_POSIX


345 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

346 **
__»¡riù
 
__§ve_±r
)

347 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

350 #ifdeà
__USE_GNU


352 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


353 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

354 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

355 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

356 cÚ¡ *
__ÃedË
)

357 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

359 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

360 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

364 #ifdeà
__USE_GNU


368 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

369 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

370 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

374 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

375 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

376 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

377 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

378 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

379 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

384 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

385 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

387 #ifdef 
__USE_XOPEN2K8


390 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

391 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

396 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

397 #ifdeà
__USE_XOPEN2K


405 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


408 #ifdeà
__REDIRECT_NTH


409 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

410 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

411 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

413 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

414 
__THROW
 
	`__nÚnuÎ
 ((2));

415 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

420 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

421 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

425 #ifdeà
__USE_XOPEN2K8


427 *
	$¡»¼Ü_l
 (
__”ºum
, 
loÿË_t
 
__l
è
__THROW
;

430 #ifdeà
__USE_MISC


431 
	~<¡ršgs.h
>

435 
	$ex¶ic™_bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

439 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

440 cÚ¡ *
__»¡riù
 
__d–im
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

444 #ifdef 
__USE_XOPEN2K8


446 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

449 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

450 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

451 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

452 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

456 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

457 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

458 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

460 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

461 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

464 #ifdef 
__USE_GNU


466 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

467 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

470 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

473 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

475 #iâdeà
ba£Çme


480 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


481 "C++" *
	$ba£Çme
 (*
__f’ame
)

482 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

483 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

484 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

486 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

491 #ià
	`__GNUC_PREREQ
 (3,4)

492 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


494 
	~<b™s/¡ršg_fÜtif›d.h
>

498 
__END_DECLS


	@/usr/include/sys/mman.h

19 #iâdef 
_SYS_MMAN_H


20 
	#_SYS_MMAN_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<b™s/ty³s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 #iâdeà
__off_t_defšed


28 #iâdeà
__USE_FILE_OFFSET64


29 
__off_t
 
	toff_t
;

31 
__off64_t
 
	toff_t
;

33 
	#__off_t_defšed


	)

36 #iâdeà
__mode_t_defšed


37 
__mode_t
 
	tmode_t
;

38 
	#__mode_t_defšed


	)

41 
	~<b™s/mmª.h
>

44 
	#MAP_FAILED
 ((*è-1)

	)

46 
	g__BEGIN_DECLS


56 #iâdeà
__USE_FILE_OFFSET64


57 *
	$mm­
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

58 
__æags
, 
__fd
, 
__off_t
 
__off£t
è
__THROW
;

60 #ifdeà
__REDIRECT_NTH


61 * 
	`__REDIRECT_NTH
 (
mm­
,

62 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

63 
__æags
, 
__fd
, 
__off64_t
 
__off£t
),

64 
mm­64
);

66 
	#mm­
 
mm­64


	)

69 #ifdeà
__USE_LARGEFILE64


70 *
	$mm­64
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
,

71 
__æags
, 
__fd
, 
__off64_t
 
__off£t
è
__THROW
;

76 
	$munm­
 (*
__addr
, 
size_t
 
__Ën
è
__THROW
;

81 
	$m´Ùeù
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
è
__THROW
;

89 
	`msync
 (*
__addr
, 
size_t
 
__Ën
, 
__æags
);

91 #ifdeà
__USE_MISC


94 
	$madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

96 #ifdeà
__USE_XOPEN2K


98 
	$posix_madvi£
 (*
__addr
, 
size_t
 
__Ën
, 
__adviû
è
__THROW
;

103 
	$mlock
 (cÚ¡ *
__addr
, 
size_t
 
__Ën
è
__THROW
;

106 
	$muÆock
 (cÚ¡ *
__addr
, 
size_t
 
__Ën
è
__THROW
;

111 
	$mlock®l
 (
__æags
è
__THROW
;

115 
	$muÆock®l
 (è
__THROW
;

117 #ifdeà
__USE_MISC


123 
	$mšcÜe
 (*
__¡¬t
, 
size_t
 
__Ën
, *
__vec
)

124 
__THROW
;

127 #ifdeà
__USE_GNU


133 *
	$m»m­
 (*
__addr
, 
size_t
 
__Şd_Ën
, size_ˆ
__Ãw_Ën
,

134 
__æags
, ...è
__THROW
;

138 
	$»m­_fe_·ges
 (*
__¡¬t
, 
size_t
 
__size
, 
__´Ù
,

139 
size_t
 
__pgoff
, 
__æags
è
__THROW
;

144 
	`shm_İ’
 (cÚ¡ *
__Çme
, 
__oæag
, 
mode_t
 
__mode
);

147 
	`shm_uÆšk
 (cÚ¡ *
__Çme
);

149 
__END_DECLS


	@/usr/include/sys/resource.h

18 #iâdef 
_SYS_RESOURCE_H


19 
	#_SYS_RESOURCE_H
 1

	)

21 
	~<ã©u»s.h
>

24 
	~<b™s/»sourû.h
>

26 #iâdeà
__id_t_defšed


27 
__id_t
 
	tid_t
;

28 
	#__id_t_defšed


	)

31 
	g__BEGIN_DECLS


37 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


38 
__¾im™_»sourû
 
	t__¾im™_»sourû_t
;

39 
__ru§ge_who
 
	t__ru§ge_who_t
;

40 
__´iÜ™y_which
 
	t__´iÜ™y_which_t
;

42 
	t__¾im™_»sourû_t
;

43 
	t__ru§ge_who_t
;

44 
	t__´iÜ™y_which_t
;

49 #iâdeà
__USE_FILE_OFFSET64


50 
	$g‘¾im™
 (
__¾im™_»sourû_t
 
__»sourû
,

51 
¾im™
 *
__¾im™s
è
__THROW
;

53 #ifdeà
__REDIRECT_NTH


54 
	`__REDIRECT_NTH
 (
g‘¾im™
, (
__¾im™_»sourû_t
 
__»sourû
,

55 
¾im™
 *
__¾im™s
), 
g‘¾im™64
);

57 
	#g‘¾im™
 
g‘¾im™64


	)

60 #ifdeà
__USE_LARGEFILE64


61 
	$g‘¾im™64
 (
__¾im™_»sourû_t
 
__»sourû
,

62 
¾im™64
 *
__¾im™s
è
__THROW
;

68 #iâdeà
__USE_FILE_OFFSET64


69 
	$£Œlim™
 (
__¾im™_»sourû_t
 
__»sourû
,

70 cÚ¡ 
¾im™
 *
__¾im™s
è
__THROW
;

72 #ifdeà
__REDIRECT_NTH


73 
	`__REDIRECT_NTH
 (
£Œlim™
, (
__¾im™_»sourû_t
 
__»sourû
,

74 cÚ¡ 
¾im™
 *
__¾im™s
),

75 
£Œlim™64
);

77 
	#£Œlim™
 
£Œlim™64


	)

80 #ifdeà
__USE_LARGEFILE64


81 
	$£Œlim™64
 (
__¾im™_»sourû_t
 
__»sourû
,

82 cÚ¡ 
¾im™64
 *
__¾im™s
è
__THROW
;

87 
	$g‘ru§ge
 (
__ru§ge_who_t
 
__who
, 
ru§ge
 *
__u§ge
è
__THROW
;

93 
	$g‘´iÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
è
__THROW
;

97 
	$£riÜ™y
 (
__´iÜ™y_which_t
 
__which
, 
id_t
 
__who
, 
__´io
)

98 
__THROW
;

100 
__END_DECLS


	@/usr/include/sys/stat.h

22 #iâdef 
_SYS_STAT_H


23 
	#_SYS_STAT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

29 #ifdeà
__USE_XOPEN2K8


30 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

33 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


37 
	~<b™s/ty³s/time_t.h
>

39 #iâdeà
__dev_t_defšed


40 
__dev_t
 
	tdev_t
;

41 
	#__dev_t_defšed


	)

44 #iâdeà
__gid_t_defšed


45 
__gid_t
 
	tgid_t
;

46 
	#__gid_t_defšed


	)

49 #iâdeà
__šo_t_defšed


50 #iâdeà
__USE_FILE_OFFSET64


51 
__šo_t
 
	tšo_t
;

53 
__šo64_t
 
	tšo_t
;

55 
	#__šo_t_defšed


	)

58 #iâdeà
__mode_t_defšed


59 
__mode_t
 
	tmode_t
;

60 
	#__mode_t_defšed


	)

63 #iâdeà
__Æšk_t_defšed


64 
__Æšk_t
 
	tÆšk_t
;

65 
	#__Æšk_t_defšed


	)

68 #iâdeà
__off_t_defšed


69 #iâdeà
__USE_FILE_OFFSET64


70 
__off_t
 
	toff_t
;

72 
__off64_t
 
	toff_t
;

74 
	#__off_t_defšed


	)

77 #iâdeà
__uid_t_defšed


78 
__uid_t
 
	tuid_t
;

79 
	#__uid_t_defšed


	)

83 #ifdeà
__USE_UNIX98


84 #iâdeà
__blkút_t_defšed


85 #iâdeà
__USE_FILE_OFFSET64


86 
__blkút_t
 
	tblkút_t
;

88 
__blkút64_t
 
	tblkút_t
;

90 
	#__blkút_t_defšed


	)

93 #iâdeà
__blksize_t_defšed


94 
__blksize_t
 
	tblksize_t
;

95 
	#__blksize_t_defšed


	)

99 
	g__BEGIN_DECLS


101 
	~<b™s/¡©.h
>

103 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


104 
	#S_IFMT
 
__S_IFMT


	)

105 
	#S_IFDIR
 
__S_IFDIR


	)

106 
	#S_IFCHR
 
__S_IFCHR


	)

107 
	#S_IFBLK
 
__S_IFBLK


	)

108 
	#S_IFREG
 
__S_IFREG


	)

109 #ifdeà
__S_IFIFO


110 
	#S_IFIFO
 
__S_IFIFO


	)

112 #ifdeà
__S_IFLNK


113 
	#S_IFLNK
 
__S_IFLNK


	)

115 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
) \

116 && 
defšed
 
	g__S_IFSOCK


117 
	#S_IFSOCK
 
__S_IFSOCK


	)

123 
	#__S_ISTYPE
(
mode
, 
mask
è(((modeè& 
__S_IFMT
è=ğ(mask))

	)

125 
	#S_ISDIR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

126 
	#S_ISCHR
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

127 
	#S_ISBLK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

128 
	#S_ISREG
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

129 #ifdeà
__S_IFIFO


130 
	#S_ISFIFO
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

132 #ifdeà
__S_IFLNK


133 
	#S_ISLNK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

136 #ià
defšed
 
__USE_MISC
 && !defšed 
__S_IFLNK


137 
	#S_ISLNK
(
mode
è0

	)

140 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K
) \

141 && 
defšed
 
	g__S_IFSOCK


142 
	#S_ISSOCK
(
mode
è
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

143 #–ià
defšed
 
__USE_XOPEN2K


144 
	#S_ISSOCK
(
mode
è0

	)

151 #ifdef 
__USE_POSIX199309


152 
	#S_TYPEISMQ
(
buf
è
	`__S_TYPEISMQ
(buf)

	)

153 
	#S_TYPEISSEM
(
buf
è
	`__S_TYPEISSEM
(buf)

	)

154 
	#S_TYPEISSHM
(
buf
è
	`__S_TYPEISSHM
(buf)

	)

160 
	#S_ISUID
 
__S_ISUID


	)

161 
	#S_ISGID
 
__S_ISGID


	)

163 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


165 
	#S_ISVTX
 
__S_ISVTX


	)

168 
	#S_IRUSR
 
__S_IREAD


	)

169 
	#S_IWUSR
 
__S_IWRITE


	)

170 
	#S_IXUSR
 
__S_IEXEC


	)

172 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

174 #ifdeà
__USE_MISC


175 
	#S_IREAD
 
S_IRUSR


	)

176 
	#S_IWRITE
 
S_IWUSR


	)

177 
	#S_IEXEC
 
S_IXUSR


	)

180 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

181 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

182 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

184 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

186 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

187 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

188 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

190 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

193 #ifdef 
__USE_MISC


195 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
è

	)

196 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

197 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

199 
	#S_BLKSIZE
 512

	)

203 #iâdeà
__USE_FILE_OFFSET64


205 
	$¡©
 (cÚ¡ *
__»¡riù
 
__fe
,

206 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

210 
	$f¡©
 (
__fd
, 
¡©
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

212 #ifdeà
__REDIRECT_NTH


213 
	`__REDIRECT_NTH
 (
¡©
, (cÚ¡ *
__»¡riù
 
__fe
,

214 
¡©
 *
__»¡riù
 
__buf
), 
¡©64
)

215 
	`__nÚnuÎ
 ((1, 2));

216 
	`__REDIRECT_NTH
 (
f¡©
, (
__fd
, 
¡©
 *
__buf
), 
f¡©64
)

217 
	`__nÚnuÎ
 ((2));

219 
	#¡©
 
¡©64


	)

220 
	#f¡©
 
f¡©64


	)

223 #ifdeà
__USE_LARGEFILE64


224 
	$¡©64
 (cÚ¡ *
__»¡riù
 
__fe
,

225 
¡©64
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

226 
	$f¡©64
 (
__fd
, 
¡©64
 *
__buf
è
__THROW
 
	`__nÚnuÎ
 ((2));

229 #ifdeà
__USE_ATFILE


233 #iâdeà
__USE_FILE_OFFSET64


234 
	$f¡©©
 (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

235 
¡©
 *
__»¡riù
 
__buf
, 
__æag
)

236 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

238 #ifdeà
__REDIRECT_NTH


239 
	`__REDIRECT_NTH
 (
f¡©©
, (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

240 
¡©
 *
__»¡riù
 
__buf
,

241 
__æag
),

242 
f¡©©64
è
	`__nÚnuÎ
 ((2, 3));

244 
	#f¡©©
 
f¡©©64


	)

248 #ifdeà
__USE_LARGEFILE64


249 
	$f¡©©64
 (
__fd
, cÚ¡ *
__»¡riù
 
__fe
,

250 
¡©64
 *
__»¡riù
 
__buf
, 
__æag
)

251 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

255 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


256 #iâdeà
__USE_FILE_OFFSET64


259 
	$l¡©
 (cÚ¡ *
__»¡riù
 
__fe
,

260 
¡©
 *
__»¡riù
 
__buf
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

262 #ifdeà
__REDIRECT_NTH


263 
	`__REDIRECT_NTH
 (
l¡©
,

264 (cÚ¡ *
__»¡riù
 
__fe
,

265 
¡©
 *
__»¡riù
 
__buf
), 
l¡©64
)

266 
	`__nÚnuÎ
 ((1, 2));

268 
	#l¡©
 
l¡©64


	)

271 #ifdeà
__USE_LARGEFILE64


272 
	$l¡©64
 (cÚ¡ *
__»¡riù
 
__fe
,

273 
¡©64
 *
__»¡riù
 
__buf
)

274 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

280 
	$chmod
 (cÚ¡ *
__fe
, 
__mode_t
 
__mode
)

281 
__THROW
 
	`__nÚnuÎ
 ((1));

283 #ifdeà
__USE_MISC


287 
	$lchmod
 (cÚ¡ *
__fe
, 
__mode_t
 
__mode
)

288 
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


293 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
è
__THROW
;

296 #ifdeà
__USE_ATFILE


299 
	$fchmod©
 (
__fd
, cÚ¡ *
__fe
, 
__mode_t
 
__mode
,

300 
__æag
)

301 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

308 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
è
__THROW
;

310 #ifdef 
__USE_GNU


313 
__mode_t
 
	$g‘umask
 (è
__THROW
;

317 
	$mkdœ
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

318 
__THROW
 
	`__nÚnuÎ
 ((1));

320 #ifdeà
__USE_ATFILE


324 
	$mkdœ©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

325 
__THROW
 
	`__nÚnuÎ
 ((2));

331 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


332 
	$mknod
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

333 
__THROW
 
	`__nÚnuÎ
 ((1));

335 #ifdeà
__USE_ATFILE


339 
	$mknod©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

340 
__dev_t
 
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2));

346 
	$mkfifo
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

347 
__THROW
 
	`__nÚnuÎ
 ((1));

349 #ifdeà
__USE_ATFILE


353 
	$mkfifßt
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
)

354 
__THROW
 
	`__nÚnuÎ
 ((2));

357 #ifdeà
__USE_ATFILE


360 
	$utim’§t
 (
__fd
, cÚ¡ *
__·th
,

361 cÚ¡ 
time¥ec
 
__times
[2],

362 
__æags
)

363 
__THROW
 
	`__nÚnuÎ
 ((2));

366 #ifdeà
__USE_XOPEN2K8


368 
	$futim’s
 (
__fd
, cÚ¡ 
time¥ec
 
__times
[2]è
__THROW
;

386 #iâdeà
_STAT_VER


387 
	#_STAT_VER
 0

	)

389 #iâdeà
_MKNOD_VER


390 
	#_MKNOD_VER
 0

	)

394 #iâdeà
__USE_FILE_OFFSET64


395 
	$__fx¡©
 (
__v”
, 
__fdes
, 
¡©
 *
__¡©_buf
)

396 
__THROW
 
	`__nÚnuÎ
 ((3));

397 
	$__x¡©
 (
__v”
, cÚ¡ *
__f’ame
,

398 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

399 
	$__lx¡©
 (
__v”
, cÚ¡ *
__f’ame
,

400 
¡©
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

401 
	$__fx¡©©
 (
__v”
, 
__fdes
, cÚ¡ *
__f’ame
,

402 
¡©
 *
__¡©_buf
, 
__æag
)

403 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

405 #ifdeà
__REDIRECT_NTH


406 
	`__REDIRECT_NTH
 (
__fx¡©
, (
__v”
, 
__fdes
,

407 
¡©
 *
__¡©_buf
), 
__fx¡©64
)

408 
	`__nÚnuÎ
 ((3));

409 
	`__REDIRECT_NTH
 (
__x¡©
, (
__v”
, cÚ¡ *
__f’ame
,

410 
¡©
 *
__¡©_buf
), 
__x¡©64
)

411 
	`__nÚnuÎ
 ((2, 3));

412 
	`__REDIRECT_NTH
 (
__lx¡©
, (
__v”
, cÚ¡ *
__f’ame
,

413 
¡©
 *
__¡©_buf
), 
__lx¡©64
)

414 
	`__nÚnuÎ
 ((2, 3));

415 
	`__REDIRECT_NTH
 (
__fx¡©©
, (
__v”
, 
__fdes
,

416 cÚ¡ *
__f’ame
,

417 
¡©
 *
__¡©_buf
, 
__æag
),

418 
__fx¡©©64
è
	`__nÚnuÎ
 ((3, 4));

421 
	#__fx¡©
 
__fx¡©64


	)

422 
	#__x¡©
 
__x¡©64


	)

423 
	#__lx¡©
 
__lx¡©64


	)

427 #ifdeà
__USE_LARGEFILE64


428 
	$__fx¡©64
 (
__v”
, 
__fdes
, 
¡©64
 *
__¡©_buf
)

429 
__THROW
 
	`__nÚnuÎ
 ((3));

430 
	$__x¡©64
 (
__v”
, cÚ¡ *
__f’ame
,

431 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

432 
	$__lx¡©64
 (
__v”
, cÚ¡ *
__f’ame
,

433 
¡©64
 *
__¡©_buf
è
__THROW
 
	`__nÚnuÎ
 ((2, 3));

434 
	$__fx¡©©64
 (
__v”
, 
__fdes
, cÚ¡ *
__f’ame
,

435 
¡©64
 *
__¡©_buf
, 
__æag
)

436 
__THROW
 
	`__nÚnuÎ
 ((3, 4));

438 
	$__xmknod
 (
__v”
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

439 
__dev_t
 *
__dev
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

441 
	$__xmknod©
 (
__v”
, 
__fd
, cÚ¡ *
__·th
,

442 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

443 
__THROW
 
	`__nÚnuÎ
 ((3, 5));

445 #ifdeà
__USE_EXTERN_INLINES


448 
__ex‹º_šlše
 

449 
	`__NTH
 (
	$¡©
 (cÚ¡ *
__·th
, 
¡©
 *
__¡©buf
))

451  
	`__x¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

452 
	}
}

454 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


455 
__ex‹º_šlše
 

456 
__NTH
 (
	$l¡©
 (cÚ¡ *
__·th
, 
¡©
 *
__¡©buf
))

458  
	`__lx¡©
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

459 
	}
}

462 
__ex‹º_šlše
 

463 
__NTH
 (
	$f¡©
 (
__fd
, 
¡©
 *
__¡©buf
))

465  
	`__fx¡©
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

466 
	}
}

468 #ifdeà
__USE_ATFILE


469 
__ex‹º_šlše
 

470 
__NTH
 (
	$f¡©©
 (
__fd
, cÚ¡ *
__f’ame
, 
¡©
 *
__¡©buf
,

471 
__æag
))

473  
	`__fx¡©©
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

474 
	}
}

477 #ifdeà
__USE_MISC


478 
__ex‹º_šlše
 

479 
__NTH
 (
	$mknod
 (cÚ¡ *
__·th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

481  
	`__xmknod
 (
_MKNOD_VER
, 
__·th
, 
__mode
, &
__dev
);

482 
	}
}

485 #ifdeà
__USE_ATFILE


486 
__ex‹º_šlše
 

487 
__NTH
 (
	$mknod©
 (
__fd
, cÚ¡ *
__·th
, 
__mode_t
 
__mode
,

488 
__dev_t
 
__dev
))

490  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__·th
, 
__mode
, &
__dev
);

491 
	}
}

494 #ià
defšed
 
__USE_LARGEFILE64
 \

495 && (! 
defšed
 
	g__USE_FILE_OFFSET64
 \

496 || (
defšed
 
	g__REDIRECT_NTH
 && defšed 
	g__OPTIMIZE__
))

497 
__ex‹º_šlše
 

498 
__NTH
 (
	$¡©64
 (cÚ¡ *
__·th
, 
¡©64
 *
__¡©buf
))

500  
	`__x¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

501 
	}
}

503 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


504 
__ex‹º_šlše
 

505 
__NTH
 (
	$l¡©64
 (cÚ¡ *
__·th
, 
¡©64
 *
__¡©buf
))

507  
	`__lx¡©64
 (
_STAT_VER
, 
__·th
, 
__¡©buf
);

508 
	}
}

511 
__ex‹º_šlše
 

512 
__NTH
 (
	$f¡©64
 (
__fd
, 
¡©64
 *
__¡©buf
))

514  
	`__fx¡©64
 (
_STAT_VER
, 
__fd
, 
__¡©buf
);

515 
	}
}

517 #ifdeà
__USE_ATFILE


518 
__ex‹º_šlše
 

519 
__NTH
 (
	$f¡©©64
 (
__fd
, cÚ¡ *
__f’ame
, 
¡©64
 *
__¡©buf
,

520 
__æag
))

522  
	`__fx¡©©64
 (
_STAT_VER
, 
__fd
, 
__f’ame
, 
__¡©buf
, 
__æag
);

523 
	}
}

530 
	g__END_DECLS


	@/usr/include/sys/time.h

18 #iâdeà
_SYS_TIME_H


19 
	#_SYS_TIME_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<b™s/ty³s.h
>

24 
	~<b™s/ty³s/time_t.h
>

25 
	~<b™s/ty³s/¡ruù_timev®.h
>

27 #iâdeà
__su£cÚds_t_defšed


28 
__su£cÚds_t
 
	tsu£cÚds_t
;

29 
	#__su£cÚds_t_defšed


	)

32 
	~<sys/£Ëù.h
>

34 
	g__BEGIN_DECLS


36 #ifdeà
__USE_GNU


38 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

39 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

40 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

41 }

	)

42 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

43 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

44 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

45 }

	)

49 #ifdeà
__USE_MISC


52 
	stimezÚe


54 
	mtz_mšu‹swe¡
;

55 
	mtz_d¡time
;

58 
timezÚe
 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

60 *
	t__»¡riù
 
	t__timezÚe_±r_t
;

68 
	$g‘timeofday
 (
timev®
 *
__»¡riù
 
__tv
,

69 
__timezÚe_±r_t
 
__tz
è
__THROW
 
	`__nÚnuÎ
 ((1));

71 #ifdeà
__USE_MISC


74 
	$£‰imeofday
 (cÚ¡ 
timev®
 *
__tv
,

75 cÚ¡ 
timezÚe
 *
__tz
)

76 
__THROW
;

82 
	$adjtime
 (cÚ¡ 
timev®
 *
__d–
,

83 
timev®
 *
__Şdd–
è
__THROW
;

88 
	e__™im”_which


91 
ITIMER_REAL
 = 0,

92 
	#ITIMER_REAL
 
ITIMER_REAL


	)

94 
ITIMER_VIRTUAL
 = 1,

95 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

98 
ITIMER_PROF
 = 2

99 
	#ITIMER_PROF
 
ITIMER_PROF


	)

104 
	s™im”v®


107 
timev®
 
™_š‹rv®
;

109 
timev®
 
™_v®ue
;

112 #ià
defšed
 
__USE_GNU
 && !defšed 
__ılu¥lus


115 
__™im”_which
 
	t__™im”_which_t
;

117 
	t__™im”_which_t
;

122 
	$g‘™im”
 (
__™im”_which_t
 
__which
,

123 
™im”v®
 *
__v®ue
è
__THROW
;

128 
	$£t™im”
 (
__™im”_which_t
 
__which
,

129 cÚ¡ 
™im”v®
 *
__»¡riù
 
__Ãw
,

130 
™im”v®
 *
__»¡riù
 
__Şd
è
__THROW
;

135 
	$utimes
 (cÚ¡ *
__fe
, cÚ¡ 
timev®
 
__tvp
[2])

136 
__THROW
 
	`__nÚnuÎ
 ((1));

138 #ifdeà
__USE_MISC


140 
	$lutimes
 (cÚ¡ *
__fe
, cÚ¡ 
timev®
 
__tvp
[2])

141 
__THROW
 
	`__nÚnuÎ
 ((1));

144 
	$futimes
 (
__fd
, cÚ¡ 
timev®
 
__tvp
[2]è
__THROW
;

147 #ifdeà
__USE_GNU


151 
	$futime§t
 (
__fd
, cÚ¡ *
__fe
,

152 cÚ¡ 
timev®
 
__tvp
[2]è
__THROW
;

156 #ifdeà
__USE_MISC


159 
	#tim”is£t
(
tvp
è(Ñvp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

160 
	#tim”ş—r
(
tvp
è(Ñvp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

161 
	#tim”cmp
(
a
, 
b
, 
CMP
) \

162 (((
a
)->
tv_£c
 =ğ(
b
)->tv_sec) ? \

163 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

164 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

165 
	#tim”add
(
a
, 
b
, 
»suÉ
) \

167 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø+ (
b
)->tv_sec; \

168 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø+ (
b
)->tv_usec; \

169 ià((
»suÉ
)->
tv_u£c
 >= 1000000) \

171 ++(
»suÉ
)->
tv_£c
; \

172 (
»suÉ
)->
tv_u£c
 -= 1000000; \

174 
	}
} 0)

	)

175 
	#tim”sub
(
a
, 
b
, 
»suÉ
) \

177 (
»suÉ
)->
tv_£c
 = (
a
)->tv_£ø- (
b
)->tv_sec; \

178 (
»suÉ
)->
tv_u£c
 = (
a
)->tv_u£ø- (
b
)->tv_usec; \

179 ià((
»suÉ
)->
tv_u£c
 < 0) { \

180 --(
»suÉ
)->
tv_£c
; \

181 (
»suÉ
)->
tv_u£c
 += 1000000; \

183 } 0)

	)

186 
	g__END_DECLS


	@/usr/include/sys/types.h

22 #iâdef 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdef 
__USE_MISC


32 #iâdeà
__u_ch¬_defšed


33 
__u_ch¬
 
	tu_ch¬
;

34 
__u_shÜt
 
	tu_shÜt
;

35 
__u_št
 
	tu_št
;

36 
__u_lÚg
 
	tu_lÚg
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¬_defšed


	)

44 
__loff_t
 
	tloff_t
;

46 #iâdeà
__šo_t_defšed


47 #iâdeà
__USE_FILE_OFFSET64


48 
__šo_t
 
	tšo_t
;

50 
__šo64_t
 
	tšo_t
;

52 
	#__šo_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


55 
__šo64_t
 
	tšo64_t
;

56 
	#__šo64_t_defšed


	)

59 #iâdeà
__dev_t_defšed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_defšed


	)

64 #iâdeà
__gid_t_defšed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_defšed


	)

69 #iâdeà
__mode_t_defšed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_defšed


	)

74 #iâdeà
__Æšk_t_defšed


75 
__Æšk_t
 
	tÆšk_t
;

76 
	#__Æšk_t_defšed


	)

79 #iâdeà
__uid_t_defšed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_defšed


	)

84 #iâdeà
__off_t_defšed


85 #iâdeà
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_defšed


	)

92 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_defšed


	)

97 #iâdeà
__pid_t_defšed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_defšed


	)

102 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
) \

103 && !
defšed
 
__id_t_defšed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_defšed


	)

108 #iâdeà
__ssize_t_defšed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_defšed


	)

113 #ifdef 
__USE_MISC


114 #iâdeà
__daddr_t_defšed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ÿddr_t
 
	tÿddr_t
;

117 
	#__daddr_t_defšed


	)

121 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_defšed


	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	~<b™s/ty³s/şock_t.h
>

129 
	~<b™s/ty³s/şockid_t.h
>

130 
	~<b™s/ty³s/time_t.h
>

131 
	~<b™s/ty³s/tim”_t.h
>

133 #ifdeà
__USE_XOPEN


134 #iâdeà
__u£cÚds_t_defšed


135 
__u£cÚds_t
 
	tu£cÚds_t
;

136 
	#__u£cÚds_t_defšed


	)

138 #iâdeà
__su£cÚds_t_defšed


139 
__su£cÚds_t
 
	tsu£cÚds_t
;

140 
	#__su£cÚds_t_defšed


	)

144 
	#__Ãed_size_t


	)

145 
	~<¡ddef.h
>

147 #ifdeà
__USE_MISC


149 
	tulÚg
;

150 
	tushÜt
;

151 
	tušt
;

156 
	~<b™s/¡dšt-šŠ.h
>

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 
	tu_št8_t
;

162 
	tu_št16_t
;

163 
	tu_št32_t
;

164 #ià
__WORDSIZE
 == 64

165 
	tu_št64_t
;

167 
__ex‹nsiÚ__
 
	tu_št64_t
;

170 
	t»gi¡”_t
;

175 
	#__u_štN_t
(
N
, 
MODE
) \

176 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

178 
	t__u_štN_t
 (8, 
	t__QI__
);

179 
__u_štN_t
 (16, 
__HI__
);

180 
__u_štN_t
 (32, 
__SI__
);

181 
__u_štN_t
 (64, 
__DI__
);

183 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

189 
	#__BIT_TYPES_DEFINED__
 1

	)

192 #ifdef 
__USE_MISC


194 
	~<’dŸn.h
>

197 
	~<sys/£Ëù.h
>

204 
	#__SYSMACROS_DEPRECATED_INCLUSION


	)

205 
	~<sys/sysmaüos.h
>

206 #undeà
__SYSMACROS_DEPRECATED_INCLUSION


210 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
) \

211 && !
defšed
 
__blksize_t_defšed


212 
__blksize_t
 
	tblksize_t
;

213 
	#__blksize_t_defšed


	)

217 #iâdeà
__USE_FILE_OFFSET64


218 #iâdeà
__blkút_t_defšed


219 
__blkút_t
 
	tblkút_t
;

220 
	#__blkút_t_defšed


	)

222 #iâdeà
__fsblkút_t_defšed


223 
__fsblkút_t
 
	tfsblkút_t
;

224 
	#__fsblkút_t_defšed


	)

226 #iâdeà
__fsfút_t_defšed


227 
__fsfút_t
 
	tfsfút_t
;

228 
	#__fsfút_t_defšed


	)

231 #iâdeà
__blkút_t_defšed


232 
__blkút64_t
 
	tblkút_t
;

233 
	#__blkút_t_defšed


	)

235 #iâdeà
__fsblkút_t_defšed


236 
__fsblkút64_t
 
	tfsblkút_t
;

237 
	#__fsblkút_t_defšed


	)

239 #iâdeà
__fsfút_t_defšed


240 
__fsfút64_t
 
	tfsfút_t
;

241 
	#__fsfút_t_defšed


	)

245 #ifdeà
__USE_LARGEFILE64


246 
__blkút64_t
 
	tblkút64_t
;

247 
__fsblkút64_t
 
	tfsblkút64_t
;

248 
__fsfút64_t
 
	tfsfút64_t
;

253 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


254 
	~<b™s/±h»adty³s.h
>

257 
	g__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifdeà
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #–ià
defšed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #–ià
defšed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<b™s/posix_İt.h
>

208 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


209 
	~<b™s/’vœÚm’ts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<b™s/ty³s.h
>

222 #iâdef 
__ssize_t_defšed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_defšed


	)

227 
	#__Ãed_size_t


	)

228 
	#__Ãed_NULL


	)

229 
	~<¡ddef.h
>

231 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


234 #iâdeà
__gid_t_defšed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_defšed


	)

239 #iâdeà
__uid_t_defšed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_defšed


	)

244 #iâdeà
__off_t_defšed


245 #iâdeà
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_defšed


	)

252 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_defšed


	)

257 #iâdeà
__u£cÚds_t_defšed


258 
__u£cÚds_t
 
	tu£cÚds_t
;

259 
	#__u£cÚds_t_defšed


	)

262 #iâdeà
__pid_t_defšed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_defšed


	)

268 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


269 #iâdeà
__šŒ_t_defšed


270 
__šŒ_t
 
	tšŒ_t
;

271 
	#__šŒ_t_defšed


	)

275 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


276 #iâdeà
__sockËn_t_defšed


277 
__sockËn_t
 
	tsockËn_t
;

278 
	#__sockËn_t_defšed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ifdeà
__USE_GNU


295 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

296 
__THROW
 
	`__nÚnuÎ
 ((1));

299 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

300 
__THROW
 
	`__nÚnuÎ
 ((1));

303 #ifdeà
__USE_ATFILE


307 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

308 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

313 #iâdef 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifdeà
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #ià
defšed
 
__USE_MISC
 && !defšed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #iâdeà
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

339 #ifdeà
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifdeà
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

349 
__THROW
;

356 
	`şo£
 (
__fd
);

363 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

369 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

371 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


372 #iâdeà
__USE_FILE_OFFSET64


379 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

380 
__off_t
 
__off£t
è
__wur
;

387 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
è
__wur
;

390 #ifdeà
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

392 
__off64_t
 
__off£t
),

393 
´—d64
è
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

395 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

396 
pwr™e64
è
__wur
;

398 
	#´—d
 
´—d64


	)

399 
	#pwr™e
 
pwr™e64


	)

403 #ifdeà
__USE_LARGEFILE64


407 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

408 
__off64_t
 
__off£t
è
__wur
;

411 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
è
__wur
;

420 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

422 #ifdeà
__USE_GNU


425 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

435 
	$®¬m
 (
__£cÚds
è
__THROW
;

447 
	`¦“p
 (
__£cÚds
);

449 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

450 || 
defšed
 
__USE_MISC


455 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

456 
__THROW
;

463 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

472 
	`·u£
 ();

476 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

479 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

486 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

491 #ifdeà
__USE_ATFILE


494 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

495 
__gid_t
 
__group
, 
__æag
)

496 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

500 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

502 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


504 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

514 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

523 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

524 || 
defšed
 
__USE_MISC


528 *
	$g‘wd
 (*
__buf
)

529 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

534 
	$dup
 (
__fd
è
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

539 #ifdeà
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

546 **
__’vœÚ
;

547 #ifdeà
__USE_GNU


548 **
’vœÚ
;

554 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

555 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdeà
__USE_XOPEN2K8


560 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

561 
__THROW
 
	`__nÚnuÎ
 ((2));

566 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

567 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

577 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

581 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

582 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

588 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

590 #ifdeà
__USE_GNU


593 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

594 *cÚ¡ 
__’vp
[])

595 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

599 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


601 
	$niû
 (
__šc
è
__THROW
 
__wur
;

606 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

612 
	~<b™s/cÚâame.h
>

615 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

616 
__THROW
 
	`__nÚnuÎ
 ((1));

619 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

622 
	$syscÚf
 (
__Çme
è
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

631 
__pid_t
 
	$g‘pid
 (è
__THROW
;

634 
__pid_t
 
	$g‘µid
 (è
__THROW
;

637 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

640 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

641 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


642 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

649 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

651 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


663 
	$£g½
 (è
__THROW
;

670 
__pid_t
 
	$£tsid
 (è
__THROW
;

672 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


674 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

678 
__uid_t
 
	$g‘uid
 (è
__THROW
;

681 
__uid_t
 
	$g‘euid
 (è
__THROW
;

684 
__gid_t
 
	$g‘gid
 (è
__THROW
;

687 
__gid_t
 
	$g‘egid
 (è
__THROW
;

692 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

705 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


708 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

711 #ifdeà
__USE_XOPEN2K


713 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

722 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


725 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

728 #ifdeà
__USE_XOPEN2K


730 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

733 #ifdeà
__USE_GNU


736 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

737 
__THROW
;

741 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

742 
__THROW
;

746 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

747 
__THROW
 
__wur
;

751 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

761 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

762 || 
defšed
 
__USE_MISC


767 
__pid_t
 
	$vfÜk
 (è
__THROW
;

773 *
	$‰yÇme
 (
__fd
è
__THROW
;

777 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

778 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

782 
	$i§‰y
 (
__fd
è
__THROW
;

784 #ifdeà
__USE_MISC


787 
	$‰y¦Ù
 (è
__THROW
;

792 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

793 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

795 #ifdeà
__USE_ATFILE


798 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

799 cÚ¡ *
__to
, 
__æags
)

800 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

803 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


805 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

806 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

811 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

812 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

813 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

816 #ifdeà
__USE_ATFILE


818 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

819 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

822 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

823 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

824 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

828 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

830 #ifdeà
__USE_ATFILE


832 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

833 
__THROW
 
	`__nÚnuÎ
 ((2));

837 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

841 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

844 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

851 *
	`g‘logš
 ();

852 #ifdeà
__USE_POSIX199506


859 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

862 #ifdef 
__USE_MISC


864 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

868 #ifdef 
__USE_POSIX2


872 
	~<b™s/g‘İt_posix.h
>

876 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


880 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

884 #ià
defšed
 
__USE_MISC


887 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

888 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

898 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

899 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

900 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

901 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

907 
	$vhªgup
 (è
__THROW
;

910 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

918 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

919 
size_t
 
__off£t
, 
__sÿË
)

920 
__THROW
 
	`__nÚnuÎ
 ((1));

926 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

930 *
	$g‘u£rsh–l
 (è
__THROW
;

931 
	$’du£rsh–l
 (è
__THROW
;

932 
	$£tu£rsh–l
 (è
__THROW
;

938 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

942 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

945 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

949 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

957 
	`fsync
 (
__fd
);

960 #ifdeà
__USE_GNU


963 
	$syncfs
 (
__fd
è
__THROW
;

967 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


970 
	`g‘ho¡id
 ();

973 
	$sync
 (è
__THROW
;

976 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K


979 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

984 
	$g‘dbËsize
 (è
__THROW
;

990 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


993 #iâdeà
__USE_FILE_OFFSET64


994 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

995 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

997 #ifdeà
__REDIRECT_NTH


998 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

999 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

1000 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1002 
	#Œunÿ‹
 
Œunÿ‹64


	)

1005 #ifdeà
__USE_LARGEFILE64


1006 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1007 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1012 #ià
defšed
 
__USE_POSIX199309
 \

1013 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1016 #iâdeà
__USE_FILE_OFFSET64


1017 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1019 #ifdeà
__REDIRECT_NTH


1020 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1021 
árunÿ‹64
è
__wur
;

1023 
	#árunÿ‹
 
árunÿ‹64


	)

1026 #ifdeà
__USE_LARGEFILE64


1027 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1033 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1034 || 
defšed
 
__USE_MISC


1038 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1044 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1048 #ifdeà
__USE_MISC


1059 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1064 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1076 
	#F_ULOCK
 0

	)

1077 
	#F_LOCK
 1

	)

1078 
	#F_TLOCK
 2

	)

1079 
	#F_TEST
 3

	)

1081 #iâdeà
__USE_FILE_OFFSET64


1082 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1084 #ifdeà
__REDIRECT


1085 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1086 
lockf64
è
__wur
;

1088 
	#lockf
 
lockf64


	)

1091 #ifdeà
__USE_LARGEFILE64


1092 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1097 #ifdeà
__USE_GNU


1102 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1103 (
__ex‹nsiÚ__
 \

1104 ({ 
__»suÉ
; \

1105 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1106 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1107 
__»suÉ
; 
	}
}))

	)

1110 
ssize_t
 
cİy_fe_¿nge
 (
__šfd
, 
__off64_t
 *
__pšoff
,

1111 
__outfd
, 
__off64_t
 *
__poutoff
,

1112 
size_t
 
__Ëngth
, 
__æags
);

1115 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1118 
fd©async
 (
__fdes
);

1124 #ifdef 
__USE_XOPEN


1126 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1127 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1131 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1132 
__THROW
 
	`__nÚnuÎ
 ((1));

1139 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1140 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1147 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1149 *
	$ù”mid
 (*
__s
è
__THROW
;

1152 *
	`cu£rid
 (*
__s
);

1158 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_XOPEN2K


1159 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1160 (*
__·»Á
) (),

1161 (*
__chd
è()è
__THROW
;

1164 #ifdeà
__USE_MISC


1167 
	$g‘’Œİy
 (*
__bufãr
, 
size_t
 
__Ëngth
è
__wur
;

1171 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1172 
	~<b™s/uni¡d.h
>

1175 
__END_DECLS


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/bits/confname.h

19 #iâdeà
_UNISTD_H


26 
	m_PC_LINK_MAX
,

27 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

28 
	m_PC_MAX_CANON
,

29 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

30 
	m_PC_MAX_INPUT
,

31 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

32 
	m_PC_NAME_MAX
,

33 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

34 
	m_PC_PATH_MAX
,

35 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

36 
	m_PC_PIPE_BUF
,

37 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

38 
	m_PC_CHOWN_RESTRICTED
,

39 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

40 
	m_PC_NO_TRUNC
,

41 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

42 
	m_PC_VDISABLE
,

43 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

44 
	m_PC_SYNC_IO
,

45 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

46 
	m_PC_ASYNC_IO
,

47 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

48 
	m_PC_PRIO_IO
,

49 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

50 
	m_PC_SOCK_MAXBUF
,

51 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

52 
	m_PC_FILESIZEBITS
,

53 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

54 
	m_PC_REC_INCR_XFER_SIZE
,

55 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

56 
	m_PC_REC_MAX_XFER_SIZE
,

57 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

58 
	m_PC_REC_MIN_XFER_SIZE
,

59 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

60 
	m_PC_REC_XFER_ALIGN
,

61 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

62 
	m_PC_ALLOC_SIZE_MIN
,

63 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

64 
	m_PC_SYMLINK_MAX
,

65 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

66 
	m_PC_2_SYMLINKS


67 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

73 
	m_SC_ARG_MAX
,

74 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

75 
	m_SC_CHILD_MAX
,

76 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

77 
	m_SC_CLK_TCK
,

78 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

79 
	m_SC_NGROUPS_MAX
,

80 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

81 
	m_SC_OPEN_MAX
,

82 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

83 
	m_SC_STREAM_MAX
,

84 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

85 
	m_SC_TZNAME_MAX
,

86 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

87 
	m_SC_JOB_CONTROL
,

88 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

89 
	m_SC_SAVED_IDS
,

90 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

91 
	m_SC_REALTIME_SIGNALS
,

92 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

93 
	m_SC_PRIORITY_SCHEDULING
,

94 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

95 
	m_SC_TIMERS
,

96 
	#_SC_TIMERS
 
_SC_TIMERS


	)

97 
	m_SC_ASYNCHRONOUS_IO
,

98 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

99 
	m_SC_PRIORITIZED_IO
,

100 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

101 
	m_SC_SYNCHRONIZED_IO
,

102 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

103 
	m_SC_FSYNC
,

104 
	#_SC_FSYNC
 
_SC_FSYNC


	)

105 
	m_SC_MAPPED_FILES
,

106 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

107 
	m_SC_MEMLOCK
,

108 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

109 
	m_SC_MEMLOCK_RANGE
,

110 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

111 
	m_SC_MEMORY_PROTECTION
,

112 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

113 
	m_SC_MESSAGE_PASSING
,

114 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

115 
	m_SC_SEMAPHORES
,

116 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

117 
	m_SC_SHARED_MEMORY_OBJECTS
,

118 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

119 
	m_SC_AIO_LISTIO_MAX
,

120 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

121 
	m_SC_AIO_MAX
,

122 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

123 
	m_SC_AIO_PRIO_DELTA_MAX
,

124 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

125 
	m_SC_DELAYTIMER_MAX
,

126 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

127 
	m_SC_MQ_OPEN_MAX
,

128 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

129 
	m_SC_MQ_PRIO_MAX
,

130 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

131 
	m_SC_VERSION
,

132 
	#_SC_VERSION
 
_SC_VERSION


	)

133 
	m_SC_PAGESIZE
,

134 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

135 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

136 
	m_SC_RTSIG_MAX
,

137 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

138 
	m_SC_SEM_NSEMS_MAX
,

139 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

140 
	m_SC_SEM_VALUE_MAX
,

141 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

142 
	m_SC_SIGQUEUE_MAX
,

143 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

144 
	m_SC_TIMER_MAX
,

145 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

149 
	m_SC_BC_BASE_MAX
,

150 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

151 
	m_SC_BC_DIM_MAX
,

152 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

153 
	m_SC_BC_SCALE_MAX
,

154 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

155 
	m_SC_BC_STRING_MAX
,

156 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

157 
	m_SC_COLL_WEIGHTS_MAX
,

158 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

159 
	m_SC_EQUIV_CLASS_MAX
,

160 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

161 
	m_SC_EXPR_NEST_MAX
,

162 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

163 
	m_SC_LINE_MAX
,

164 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

165 
	m_SC_RE_DUP_MAX
,

166 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

167 
	m_SC_CHARCLASS_NAME_MAX
,

168 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

170 
	m_SC_2_VERSION
,

171 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

172 
	m_SC_2_C_BIND
,

173 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

174 
	m_SC_2_C_DEV
,

175 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

176 
	m_SC_2_FORT_DEV
,

177 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

178 
	m_SC_2_FORT_RUN
,

179 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

180 
	m_SC_2_SW_DEV
,

181 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

182 
	m_SC_2_LOCALEDEF
,

183 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

185 
	m_SC_PII
,

186 
	#_SC_PII
 
_SC_PII


	)

187 
	m_SC_PII_XTI
,

188 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

189 
	m_SC_PII_SOCKET
,

190 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

191 
	m_SC_PII_INTERNET
,

192 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

193 
	m_SC_PII_OSI
,

194 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

195 
	m_SC_POLL
,

196 
	#_SC_POLL
 
_SC_POLL


	)

197 
	m_SC_SELECT
,

198 
	#_SC_SELECT
 
_SC_SELECT


	)

199 
	m_SC_UIO_MAXIOV
,

200 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

201 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

202 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

203 
	m_SC_PII_INTERNET_STREAM
,

204 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

205 
	m_SC_PII_INTERNET_DGRAM
,

206 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

207 
	m_SC_PII_OSI_COTS
,

208 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

209 
	m_SC_PII_OSI_CLTS
,

210 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

211 
	m_SC_PII_OSI_M
,

212 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

213 
	m_SC_T_IOV_MAX
,

214 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

217 
	m_SC_THREADS
,

218 
	#_SC_THREADS
 
_SC_THREADS


	)

219 
	m_SC_THREAD_SAFE_FUNCTIONS
,

220 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

221 
	m_SC_GETGR_R_SIZE_MAX
,

222 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

223 
	m_SC_GETPW_R_SIZE_MAX
,

224 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

225 
	m_SC_LOGIN_NAME_MAX
,

226 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

227 
	m_SC_TTY_NAME_MAX
,

228 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

229 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

230 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

231 
	m_SC_THREAD_KEYS_MAX
,

232 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

233 
	m_SC_THREAD_STACK_MIN
,

234 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

235 
	m_SC_THREAD_THREADS_MAX
,

236 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

237 
	m_SC_THREAD_ATTR_STACKADDR
,

238 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

239 
	m_SC_THREAD_ATTR_STACKSIZE
,

240 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

241 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

242 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

243 
	m_SC_THREAD_PRIO_INHERIT
,

244 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

245 
	m_SC_THREAD_PRIO_PROTECT
,

246 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

247 
	m_SC_THREAD_PROCESS_SHARED
,

248 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

250 
	m_SC_NPROCESSORS_CONF
,

251 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

252 
	m_SC_NPROCESSORS_ONLN
,

253 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

254 
	m_SC_PHYS_PAGES
,

255 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

256 
	m_SC_AVPHYS_PAGES
,

257 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

258 
	m_SC_ATEXIT_MAX
,

259 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

260 
	m_SC_PASS_MAX
,

261 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

263 
	m_SC_XOPEN_VERSION
,

264 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

265 
	m_SC_XOPEN_XCU_VERSION
,

266 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

267 
	m_SC_XOPEN_UNIX
,

268 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

269 
	m_SC_XOPEN_CRYPT
,

270 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

271 
	m_SC_XOPEN_ENH_I18N
,

272 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

273 
	m_SC_XOPEN_SHM
,

274 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

276 
	m_SC_2_CHAR_TERM
,

277 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

278 
	m_SC_2_C_VERSION
,

279 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

280 
	m_SC_2_UPE
,

281 
	#_SC_2_UPE
 
_SC_2_UPE


	)

283 
	m_SC_XOPEN_XPG2
,

284 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

285 
	m_SC_XOPEN_XPG3
,

286 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

287 
	m_SC_XOPEN_XPG4
,

288 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

290 
	m_SC_CHAR_BIT
,

291 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

292 
	m_SC_CHAR_MAX
,

293 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

294 
	m_SC_CHAR_MIN
,

295 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

296 
	m_SC_INT_MAX
,

297 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

298 
	m_SC_INT_MIN
,

299 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

300 
	m_SC_LONG_BIT
,

301 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

302 
	m_SC_WORD_BIT
,

303 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

304 
	m_SC_MB_LEN_MAX
,

305 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

306 
	m_SC_NZERO
,

307 
	#_SC_NZERO
 
_SC_NZERO


	)

308 
	m_SC_SSIZE_MAX
,

309 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

310 
	m_SC_SCHAR_MAX
,

311 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

312 
	m_SC_SCHAR_MIN
,

313 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

314 
	m_SC_SHRT_MAX
,

315 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

316 
	m_SC_SHRT_MIN
,

317 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

318 
	m_SC_UCHAR_MAX
,

319 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

320 
	m_SC_UINT_MAX
,

321 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

322 
	m_SC_ULONG_MAX
,

323 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

324 
	m_SC_USHRT_MAX
,

325 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

327 
	m_SC_NL_ARGMAX
,

328 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

329 
	m_SC_NL_LANGMAX
,

330 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

331 
	m_SC_NL_MSGMAX
,

332 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

333 
	m_SC_NL_NMAX
,

334 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

335 
	m_SC_NL_SETMAX
,

336 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

337 
	m_SC_NL_TEXTMAX
,

338 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

340 
	m_SC_XBS5_ILP32_OFF32
,

341 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

342 
	m_SC_XBS5_ILP32_OFFBIG
,

343 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

344 
	m_SC_XBS5_LP64_OFF64
,

345 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

346 
	m_SC_XBS5_LPBIG_OFFBIG
,

347 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

349 
	m_SC_XOPEN_LEGACY
,

350 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

351 
	m_SC_XOPEN_REALTIME
,

352 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

353 
	m_SC_XOPEN_REALTIME_THREADS
,

354 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

356 
	m_SC_ADVISORY_INFO
,

357 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

358 
	m_SC_BARRIERS
,

359 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

360 
	m_SC_BASE
,

361 
	#_SC_BASE
 
_SC_BASE


	)

362 
	m_SC_C_LANG_SUPPORT
,

363 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

364 
	m_SC_C_LANG_SUPPORT_R
,

365 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

366 
	m_SC_CLOCK_SELECTION
,

367 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

368 
	m_SC_CPUTIME
,

369 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

370 
	m_SC_THREAD_CPUTIME
,

371 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

372 
	m_SC_DEVICE_IO
,

373 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

374 
	m_SC_DEVICE_SPECIFIC
,

375 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

376 
	m_SC_DEVICE_SPECIFIC_R
,

377 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

378 
	m_SC_FD_MGMT
,

379 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

380 
	m_SC_FIFO
,

381 
	#_SC_FIFO
 
_SC_FIFO


	)

382 
	m_SC_PIPE
,

383 
	#_SC_PIPE
 
_SC_PIPE


	)

384 
	m_SC_FILE_ATTRIBUTES
,

385 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

386 
	m_SC_FILE_LOCKING
,

387 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

388 
	m_SC_FILE_SYSTEM
,

389 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

390 
	m_SC_MONOTONIC_CLOCK
,

391 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

392 
	m_SC_MULTI_PROCESS
,

393 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

394 
	m_SC_SINGLE_PROCESS
,

395 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

396 
	m_SC_NETWORKING
,

397 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

398 
	m_SC_READER_WRITER_LOCKS
,

399 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

400 
	m_SC_SPIN_LOCKS
,

401 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

402 
	m_SC_REGEXP
,

403 
	#_SC_REGEXP
 
_SC_REGEXP


	)

404 
	m_SC_REGEX_VERSION
,

405 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

406 
	m_SC_SHELL
,

407 
	#_SC_SHELL
 
_SC_SHELL


	)

408 
	m_SC_SIGNALS
,

409 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

410 
	m_SC_SPAWN
,

411 
	#_SC_SPAWN
 
_SC_SPAWN


	)

412 
	m_SC_SPORADIC_SERVER
,

413 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

414 
	m_SC_THREAD_SPORADIC_SERVER
,

415 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

416 
	m_SC_SYSTEM_DATABASE
,

417 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

418 
	m_SC_SYSTEM_DATABASE_R
,

419 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

420 
	m_SC_TIMEOUTS
,

421 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

422 
	m_SC_TYPED_MEMORY_OBJECTS
,

423 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

424 
	m_SC_USER_GROUPS
,

425 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

426 
	m_SC_USER_GROUPS_R
,

427 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

428 
	m_SC_2_PBS
,

429 
	#_SC_2_PBS
 
_SC_2_PBS


	)

430 
	m_SC_2_PBS_ACCOUNTING
,

431 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

432 
	m_SC_2_PBS_LOCATE
,

433 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

434 
	m_SC_2_PBS_MESSAGE
,

435 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

436 
	m_SC_2_PBS_TRACK
,

437 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

438 
	m_SC_SYMLOOP_MAX
,

439 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

440 
	m_SC_STREAMS
,

441 
	#_SC_STREAMS
 
_SC_STREAMS


	)

442 
	m_SC_2_PBS_CHECKPOINT
,

443 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

445 
	m_SC_V6_ILP32_OFF32
,

446 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

447 
	m_SC_V6_ILP32_OFFBIG
,

448 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

449 
	m_SC_V6_LP64_OFF64
,

450 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

451 
	m_SC_V6_LPBIG_OFFBIG
,

452 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

454 
	m_SC_HOST_NAME_MAX
,

455 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

456 
	m_SC_TRACE
,

457 
	#_SC_TRACE
 
_SC_TRACE


	)

458 
	m_SC_TRACE_EVENT_FILTER
,

459 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

460 
	m_SC_TRACE_INHERIT
,

461 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

462 
	m_SC_TRACE_LOG
,

463 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

465 
	m_SC_LEVEL1_ICACHE_SIZE
,

466 
	#_SC_LEVEL1_ICACHE_SIZE
 
_SC_LEVEL1_ICACHE_SIZE


	)

467 
	m_SC_LEVEL1_ICACHE_ASSOC
,

468 
	#_SC_LEVEL1_ICACHE_ASSOC
 
_SC_LEVEL1_ICACHE_ASSOC


	)

469 
	m_SC_LEVEL1_ICACHE_LINESIZE
,

470 
	#_SC_LEVEL1_ICACHE_LINESIZE
 
_SC_LEVEL1_ICACHE_LINESIZE


	)

471 
	m_SC_LEVEL1_DCACHE_SIZE
,

472 
	#_SC_LEVEL1_DCACHE_SIZE
 
_SC_LEVEL1_DCACHE_SIZE


	)

473 
	m_SC_LEVEL1_DCACHE_ASSOC
,

474 
	#_SC_LEVEL1_DCACHE_ASSOC
 
_SC_LEVEL1_DCACHE_ASSOC


	)

475 
	m_SC_LEVEL1_DCACHE_LINESIZE
,

476 
	#_SC_LEVEL1_DCACHE_LINESIZE
 
_SC_LEVEL1_DCACHE_LINESIZE


	)

477 
	m_SC_LEVEL2_CACHE_SIZE
,

478 
	#_SC_LEVEL2_CACHE_SIZE
 
_SC_LEVEL2_CACHE_SIZE


	)

479 
	m_SC_LEVEL2_CACHE_ASSOC
,

480 
	#_SC_LEVEL2_CACHE_ASSOC
 
_SC_LEVEL2_CACHE_ASSOC


	)

481 
	m_SC_LEVEL2_CACHE_LINESIZE
,

482 
	#_SC_LEVEL2_CACHE_LINESIZE
 
_SC_LEVEL2_CACHE_LINESIZE


	)

483 
	m_SC_LEVEL3_CACHE_SIZE
,

484 
	#_SC_LEVEL3_CACHE_SIZE
 
_SC_LEVEL3_CACHE_SIZE


	)

485 
	m_SC_LEVEL3_CACHE_ASSOC
,

486 
	#_SC_LEVEL3_CACHE_ASSOC
 
_SC_LEVEL3_CACHE_ASSOC


	)

487 
	m_SC_LEVEL3_CACHE_LINESIZE
,

488 
	#_SC_LEVEL3_CACHE_LINESIZE
 
_SC_LEVEL3_CACHE_LINESIZE


	)

489 
	m_SC_LEVEL4_CACHE_SIZE
,

490 
	#_SC_LEVEL4_CACHE_SIZE
 
_SC_LEVEL4_CACHE_SIZE


	)

491 
	m_SC_LEVEL4_CACHE_ASSOC
,

492 
	#_SC_LEVEL4_CACHE_ASSOC
 
_SC_LEVEL4_CACHE_ASSOC


	)

493 
	m_SC_LEVEL4_CACHE_LINESIZE
,

494 
	#_SC_LEVEL4_CACHE_LINESIZE
 
_SC_LEVEL4_CACHE_LINESIZE


	)

497 
	m_SC_IPV6
 = 
_SC_LEVEL1_ICACHE_SIZE
 + 50,

498 
	#_SC_IPV6
 
_SC_IPV6


	)

499 
	m_SC_RAW_SOCKETS
,

500 
	#_SC_RAW_SOCKETS
 
_SC_RAW_SOCKETS


	)

502 
	m_SC_V7_ILP32_OFF32
,

503 
	#_SC_V7_ILP32_OFF32
 
_SC_V7_ILP32_OFF32


	)

504 
	m_SC_V7_ILP32_OFFBIG
,

505 
	#_SC_V7_ILP32_OFFBIG
 
_SC_V7_ILP32_OFFBIG


	)

506 
	m_SC_V7_LP64_OFF64
,

507 
	#_SC_V7_LP64_OFF64
 
_SC_V7_LP64_OFF64


	)

508 
	m_SC_V7_LPBIG_OFFBIG
,

509 
	#_SC_V7_LPBIG_OFFBIG
 
_SC_V7_LPBIG_OFFBIG


	)

511 
	m_SC_SS_REPL_MAX
,

512 
	#_SC_SS_REPL_MAX
 
_SC_SS_REPL_MAX


	)

514 
	m_SC_TRACE_EVENT_NAME_MAX
,

515 
	#_SC_TRACE_EVENT_NAME_MAX
 
_SC_TRACE_EVENT_NAME_MAX


	)

516 
	m_SC_TRACE_NAME_MAX
,

517 
	#_SC_TRACE_NAME_MAX
 
_SC_TRACE_NAME_MAX


	)

518 
	m_SC_TRACE_SYS_MAX
,

519 
	#_SC_TRACE_SYS_MAX
 
_SC_TRACE_SYS_MAX


	)

520 
	m_SC_TRACE_USER_EVENT_MAX
,

521 
	#_SC_TRACE_USER_EVENT_MAX
 
_SC_TRACE_USER_EVENT_MAX


	)

523 
	m_SC_XOPEN_STREAMS
,

524 
	#_SC_XOPEN_STREAMS
 
_SC_XOPEN_STREAMS


	)

526 
	m_SC_THREAD_ROBUST_PRIO_INHERIT
,

527 
	#_SC_THREAD_ROBUST_PRIO_INHERIT
 
_SC_THREAD_ROBUST_PRIO_INHERIT


	)

528 
	m_SC_THREAD_ROBUST_PRIO_PROTECT


529 
	#_SC_THREAD_ROBUST_PRIO_PROTECT
 
_SC_THREAD_ROBUST_PRIO_PROTECT


	)

535 
	m_CS_PATH
,

536 
	#_CS_PATH
 
_CS_PATH


	)

538 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

539 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

540 
	#_CS_POSIX_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

542 
	m_CS_GNU_LIBC_VERSION
,

543 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

544 
	m_CS_GNU_LIBPTHREAD_VERSION
,

545 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

547 
	m_CS_V5_WIDTH_RESTRICTED_ENVS
,

548 
	#_CS_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

549 
	#_CS_POSIX_V5_WIDTH_RESTRICTED_ENVS
 
_CS_V5_WIDTH_RESTRICTED_ENVS


	)

551 
	m_CS_V7_WIDTH_RESTRICTED_ENVS
,

552 
	#_CS_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

553 
	#_CS_POSIX_V7_WIDTH_RESTRICTED_ENVS
 
_CS_V7_WIDTH_RESTRICTED_ENVS


	)

555 
	m_CS_LFS_CFLAGS
 = 1000,

556 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

557 
	m_CS_LFS_LDFLAGS
,

558 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

559 
	m_CS_LFS_LIBS
,

560 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

561 
	m_CS_LFS_LINTFLAGS
,

562 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

563 
	m_CS_LFS64_CFLAGS
,

564 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

565 
	m_CS_LFS64_LDFLAGS
,

566 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

567 
	m_CS_LFS64_LIBS
,

568 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

569 
	m_CS_LFS64_LINTFLAGS
,

570 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

572 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

573 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

574 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

575 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

576 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

577 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

578 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

579 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

580 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

581 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

582 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

583 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

584 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

585 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

586 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

587 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

588 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

589 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

590 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

591 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

592 
	m_CS_XBS5_LP64_OFF64_LIBS
,

593 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

594 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

595 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

596 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

597 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

598 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

599 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

600 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

601 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

602 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

603 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

605 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

606 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

607 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

608 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

609 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

610 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

611 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

612 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

613 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

614 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

615 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

616 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

617 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

618 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

619 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

620 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

621 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

622 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

623 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

624 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

625 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

626 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

627 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

628 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

629 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

630 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

631 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

632 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

633 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

634 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

635 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
,

636 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

638 
	m_CS_POSIX_V7_ILP32_OFF32_CFLAGS
,

639 
	#_CS_POSIX_V7_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_CFLAGS


	)

640 
	m_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
,

641 
	#_CS_POSIX_V7_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LDFLAGS


	)

642 
	m_CS_POSIX_V7_ILP32_OFF32_LIBS
,

643 
	#_CS_POSIX_V7_ILP32_OFF32_LIBS
 
_CS_POSIX_V7_ILP32_OFF32_LIBS


	)

644 
	m_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
,

645 
	#_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFF32_LINTFLAGS


	)

646 
	m_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
,

647 
	#_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_CFLAGS


	)

648 
	m_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
,

649 
	#_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LDFLAGS


	)

650 
	m_CS_POSIX_V7_ILP32_OFFBIG_LIBS
,

651 
	#_CS_POSIX_V7_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V7_ILP32_OFFBIG_LIBS


	)

652 
	m_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
,

653 
	#_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_ILP32_OFFBIG_LINTFLAGS


	)

654 
	m_CS_POSIX_V7_LP64_OFF64_CFLAGS
,

655 
	#_CS_POSIX_V7_LP64_OFF64_CFLAGS
 
_CS_POSIX_V7_LP64_OFF64_CFLAGS


	)

656 
	m_CS_POSIX_V7_LP64_OFF64_LDFLAGS
,

657 
	#_CS_POSIX_V7_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LDFLAGS


	)

658 
	m_CS_POSIX_V7_LP64_OFF64_LIBS
,

659 
	#_CS_POSIX_V7_LP64_OFF64_LIBS
 
_CS_POSIX_V7_LP64_OFF64_LIBS


	)

660 
	m_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
,

661 
	#_CS_POSIX_V7_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V7_LP64_OFF64_LINTFLAGS


	)

662 
	m_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
,

663 
	#_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_CFLAGS


	)

664 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
,

665 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LDFLAGS


	)

666 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
,

667 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LIBS


	)

668 
	m_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
,

669 
	#_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V7_LPBIG_OFFBIG_LINTFLAGS


	)

671 
	m_CS_V6_ENV
,

672 
	#_CS_V6_ENV
 
_CS_V6_ENV


	)

673 
	m_CS_V7_ENV


674 
	#_CS_V7_ENV
 
_CS_V7_ENV


	)

	@/usr/include/bits/dirent.h

18 #iâdeà
_DIRENT_H


22 
	sdœ’t


24 #iâdeà
__USE_FILE_OFFSET64


25 
__šo_t
 
	md_šo
;

26 
__off_t
 
	md_off
;

28 
__šo64_t
 
	md_šo
;

29 
__off64_t
 
	md_off
;

31 
	md_»ş’
;

32 
	md_ty³
;

33 
	md_Çme
[256];

36 #ifdeà
__USE_LARGEFILE64


37 
	sdœ’t64


39 
__šo64_t
 
	md_šo
;

40 
__off64_t
 
	md_off
;

41 
	md_»ş’
;

42 
	md_ty³
;

43 
	md_Çme
[256];

47 
	#d_f’o
 
d_šo


	)

49 #undeà
_DIRENT_HAVE_D_NAMLEN


50 
	#_DIRENT_HAVE_D_RECLEN


	)

51 
	#_DIRENT_HAVE_D_OFF


	)

52 
	#_DIRENT_HAVE_D_TYPE


	)

54 #ià
defšed
 
__OFF_T_MATCHES_OFF64_T
 && defšed 
__INO_T_MATCHES_INO64_T


56 
	#_DIRENT_MATCHES_DIRENT64
 1

	)

	@/usr/include/bits/environments.h

18 #iâdeà
_UNISTD_H


22 
	~<b™s/wÜdsize.h
>

42 #ià
__WORDSIZE
 == 64

56 
	#_POSIX_V7_LPBIG_OFFBIG
 -1

	)

57 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

58 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

61 
	#_POSIX_V7_LP64_OFF64
 1

	)

62 
	#_POSIX_V6_LP64_OFF64
 1

	)

63 
	#_XBS5_LP64_OFF64
 1

	)

69 
	#_POSIX_V7_ILP32_OFFBIG
 1

	)

70 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

71 
	#_XBS5_ILP32_OFFBIG
 1

	)

73 #iâdeà
__x86_64__


75 
	#_POSIX_V7_ILP32_OFF32
 1

	)

76 
	#_POSIX_V6_ILP32_OFF32
 1

	)

77 
	#_XBS5_ILP32_OFF32
 1

	)

95 
	#__ILP32_OFF32_CFLAGS
 "-m32"

	)

96 
	#__ILP32_OFF32_LDFLAGS
 "-m32"

	)

97 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


98 
	#__ILP32_OFFBIG_CFLAGS
 "-mx32"

	)

99 
	#__ILP32_OFFBIG_LDFLAGS
 "-mx32"

	)

101 
	#__ILP32_OFFBIG_CFLAGS
 "-m32 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64"

	)

102 
	#__ILP32_OFFBIG_LDFLAGS
 "-m32"

	)

104 
	#__LP64_OFF64_CFLAGS
 "-m64"

	)

105 
	#__LP64_OFF64_LDFLAGS
 "-m64"

	)

	@/usr/include/bits/errno.h

19 #iâdeà
_BITS_ERRNO_H


20 
	#_BITS_ERRNO_H
 1

	)

22 #ià!
defšed
 
_ERRNO_H


26 
	~<lšux/”ºo.h
>

29 #iâdeà
ENOTSUP


30 
	#ENOTSUP
 
EOPNOTSUPP


	)

33 #iâdeà
ECANCELED


34 
	#ECANCELED
 125

	)

37 #iâdeà
EOWNERDEAD


38 
	#EOWNERDEAD
 130

	)

41 #iâdeà
ENOTRECOVERABLE


42 
	#ENOTRECOVERABLE
 131

	)

45 #iâdeà
ERFKILL


46 
	#ERFKILL
 132

	)

49 #iâdeà
EHWPOISON


50 
	#EHWPOISON
 133

	)

	@/usr/include/bits/fcntl.h

19 #iâdeà
_FCNTL_H


23 #ifdeà
__x86_64__


24 
	#__O_LARGEFILE
 0

	)

27 #ifdeà
__x86_64__


29 
	#F_GETLK64
 5

	)

30 
	#F_SETLK64
 6

	)

31 
	#F_SETLKW64
 7

	)

35 
	sæock


37 
	ml_ty³
;

38 
	ml_wh’û
;

39 #iâdeà
__USE_FILE_OFFSET64


40 
__off_t
 
	ml_¡¬t
;

41 
__off_t
 
	ml_Ën
;

43 
__off64_t
 
	ml_¡¬t
;

44 
__off64_t
 
	ml_Ën
;

46 
__pid_t
 
	ml_pid
;

49 #ifdeà
__USE_LARGEFILE64


50 
	sæock64


52 
	ml_ty³
;

53 
	ml_wh’û
;

54 
__off64_t
 
	ml_¡¬t
;

55 
__off64_t
 
	ml_Ën
;

56 
__pid_t
 
	ml_pid
;

61 
	~<b™s/fú-lšux.h
>

	@/usr/include/bits/fcntl2.h

19 #iâdef 
_FCNTL_H


25 #iâdeà
__USE_FILE_OFFSET64


26 
	$__İ’_2
 (cÚ¡ *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

27 
	`__REDIRECT
 (
__İ’_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
, ...),

28 
İ’
è
	`__nÚnuÎ
 ((1));

30 
	`__REDIRECT
 (
__İ’_2
, (cÚ¡ *
__·th
, 
__oæag
),

31 
__İ’64_2
è
	`__nÚnuÎ
 ((1));

32 
	`__REDIRECT
 (
__İ’_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
, ...),

33 
İ’64
è
	`__nÚnuÎ
 ((1));

35 
	`__”rÜdeş
 (
__İ’_too_mªy_¬gs
,

37 
	`__”rÜdeş
 (
__İ’_missšg_mode
,

40 
__fÜtify_funùiÚ
 

41 
	$İ’
 (cÚ¡ *
__·th
, 
__oæag
, ...)

43 ià(
	`__va_¬g_·ck_Ën
 () > 1)

44 
	`__İ’_too_mªy_¬gs
 ();

46 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

48 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

50 
	`__İ’_missšg_mode
 ();

51  
	`__İ’_2
 (
__·th
, 
__oæag
);

53  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

56 ià(
	`__va_¬g_·ck_Ën
 () < 1)

57  
	`__İ’_2
 (
__·th
, 
__oæag
);

59  
	`__İ’_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

60 
	}
}

63 #ifdeà
__USE_LARGEFILE64


64 
	$__İ’64_2
 (cÚ¡ *
__·th
, 
__oæag
è
	`__nÚnuÎ
 ((1));

65 
	`__REDIRECT
 (
__İ’64_®Ÿs
, (cÚ¡ *
__·th
, 
__oæag
,

66 ...), 
İ’64
è
	`__nÚnuÎ
 ((1));

67 
	`__”rÜdeş
 (
__İ’64_too_mªy_¬gs
,

69 
	`__”rÜdeş
 (
__İ’64_missšg_mode
,

72 
__fÜtify_funùiÚ
 

73 
	$İ’64
 (cÚ¡ *
__·th
, 
__oæag
, ...)

75 ià(
	`__va_¬g_·ck_Ën
 () > 1)

76 
	`__İ’64_too_mªy_¬gs
 ();

78 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

80 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

82 
	`__İ’64_missšg_mode
 ();

83  
	`__İ’64_2
 (
__·th
, 
__oæag
);

85  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

88 ià(
	`__va_¬g_·ck_Ën
 () < 1)

89  
	`__İ’64_2
 (
__·th
, 
__oæag
);

91  
	`__İ’64_®Ÿs
 (
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

92 
	}
}

96 #ifdeà
__USE_ATFILE


97 #iâdeà
__USE_FILE_OFFSET64


98 
	$__İ’©_2
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
)

99 
	`__nÚnuÎ
 ((2));

100 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

101 
__oæag
, ...), 
İ’©
)

102 
	`__nÚnuÎ
 ((2));

104 
	`__REDIRECT
 (
__İ’©_2
, (
__fd
, cÚ¡ *
__·th
,

105 
__oæag
), 
__İ’©64_2
)

106 
	`__nÚnuÎ
 ((2));

107 
	`__REDIRECT
 (
__İ’©_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

108 
__oæag
, ...), 
İ’©64
)

109 
	`__nÚnuÎ
 ((2));

111 
	`__”rÜdeş
 (
__İ’©_too_mªy_¬gs
,

113 
	`__”rÜdeş
 (
__İ’©_missšg_mode
,

116 
__fÜtify_funùiÚ
 

117 
	$İ’©
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
, ...)

119 ià(
	`__va_¬g_·ck_Ën
 () > 1)

120 
	`__İ’©_too_mªy_¬gs
 ();

122 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

124 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

126 
	`__İ’©_missšg_mode
 ();

127  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

129  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

132 ià(
	`__va_¬g_·ck_Ën
 () < 1)

133  
	`__İ’©_2
 (
__fd
, 
__·th
, 
__oæag
);

135  
	`__İ’©_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

136 
	}
}

139 #ifdeà
__USE_LARGEFILE64


140 
	$__İ’©64_2
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
)

141 
	`__nÚnuÎ
 ((2));

142 
	`__REDIRECT
 (
__İ’©64_®Ÿs
, (
__fd
, cÚ¡ *
__·th
,

143 
__oæag
, ...), 
İ’©64
)

144 
	`__nÚnuÎ
 ((2));

145 
	`__”rÜdeş
 (
__İ’©64_too_mªy_¬gs
,

147 
	`__”rÜdeş
 (
__İ’©64_missšg_mode
,

150 
__fÜtify_funùiÚ
 

151 
	$İ’©64
 (
__fd
, cÚ¡ *
__·th
, 
__oæag
, ...)

153 ià(
	`__va_¬g_·ck_Ën
 () > 1)

154 
	`__İ’©64_too_mªy_¬gs
 ();

156 ià(
	`__butš_cÚ¡ªt_p
 (
__oæag
))

158 ià(
	`__OPEN_NEEDS_MODE
 (
__oæag
è&& 
	`__va_¬g_·ck_Ën
 () < 1)

160 
	`__İ’©64_missšg_mode
 ();

161  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

163  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

166 ià(
	`__va_¬g_·ck_Ën
 () < 1)

167  
	`__İ’©64_2
 (
__fd
, 
__·th
, 
__oæag
);

169  
	`__İ’©64_®Ÿs
 (
__fd
, 
__·th
, 
__oæag
, 
	`__va_¬g_·ck
 ());

170 
	}
}

	@/usr/include/bits/floatn.h

19 #iâdeà
_BITS_FLOATN_H


20 
	#_BITS_FLOATN_H


	)

22 
	~<ã©u»s.h
>

29 #ià(
defšed
 
__x86_64__
 \

30 ? 
__GNUC_PREREQ
 (4, 3) \

31 : (
defšed
 
__GNU__
 ? 
	$__GNUC_PREREQ
 (4, 5è: 
	`__GNUC_PREREQ
 (4, 4))) \

32 && !
	`defšed
(
__CUDACC__
è&& !
	$defšed
(
__ICC
)

33 
	#__HAVE_FLOAT128
 1

	)

35 
	#__HAVE_FLOAT128
 0

	)

40 #ià
__HAVE_FLOAT128


41 
	#__HAVE_DISTINCT_FLOAT128
 1

	)

43 
	#__HAVE_DISTINCT_FLOAT128
 0

	)

49 
	#__HAVE_FLOAT64X
 1

	)

55 
	#__HAVE_FLOAT64X_LONG_DOUBLE
 1

	)

57 #iâdeà
__ASSEMBLER__


61 #ià
__HAVE_FLOAT128


62 #ià!
	`__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


64 
	#__f128
(
x
èx##
q


	)

66 
	#__f128
(
x
èx##
f128


	)

71 #ià
__HAVE_FLOAT128


72 #ià!
	`__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


75 
_Com¶ex
 
	t__cæßt128
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__TC__
)));

76 
	#__CFLOAT128
 
__cæßt128


	)

78 
	#__CFLOAT128
 
_Com¶ex
 
_Flßt128


	)

83 #ià
__HAVE_FLOAT128


86 #ià!
	`__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


87 
__æßt128
 
	t_Flßt128
;

91 #ià!
	`__GNUC_PREREQ
 (7, 0)

92 
	#__butš_huge_v®f128
(è((
_Flßt128
è
	`__butš_huge_v®
 ())

	)

100 #ià!
	`__GNUC_PREREQ
 (7, 0)

101 
	#__butš_cİysignf128
 
__butš_cİysignq


	)

102 
	#__butš_çbsf128
 
__butš_çbsq


	)

103 
	#__butš_šff128
(è((
_Flßt128
è
	`__butš_šf
 ())

	)

104 
	#__butš_Çnf128
(
x
è((
_Flßt128
è
	`__butš_Çn
 (x))

	)

105 
	#__butš_Çnsf128
(
x
è((
_Flßt128
è
	`__butš_Çns
 (x))

	)

112 #ià!
	`__GNUC_PREREQ
 (6, 0)

113 
	#__butš_signb™f128
 
__signb™f128


	)

120 
	~<b™s/æßŠ-commÚ.h
>

	@/usr/include/bits/flt-eval-method.h

19 #iâdeà
_MATH_H


23 #ifdeà
__FLT_EVAL_METHOD__


24 #ià
__FLT_EVAL_METHOD__
 == -1

25 
	#__GLIBC_FLT_EVAL_METHOD
 2

	)

27 
	#__GLIBC_FLT_EVAL_METHOD
 
__FLT_EVAL_METHOD__


	)

29 #–ià
defšed
 
__x86_64__


30 
	#__GLIBC_FLT_EVAL_METHOD
 0

	)

32 
	#__GLIBC_FLT_EVAL_METHOD
 2

	)

	@/usr/include/bits/fp-fast.h

19 #iâdeà
_MATH_H


23 #ifdeà
__USE_ISOC99


27 #ifdeà
__FP_FAST_FMA


28 
	#FP_FAST_FMA
 1

	)

31 #ifdeà
__FP_FAST_FMAF


32 
	#FP_FAST_FMAF
 1

	)

35 #ifdeà
__FP_FAST_FMAL


36 
	#FP_FAST_FMAL
 1

	)

	@/usr/include/bits/fp-logb.h

19 #iâdeà
_MATH_H


23 
	#__FP_LOGB0_IS_MIN
 1

	)

24 
	#__FP_LOGBNAN_IS_MIN
 1

	)

	@/usr/include/bits/getopt_posix.h

20 #iâdeà
_GETOPT_POSIX_H


21 
	#_GETOPT_POSIX_H
 1

	)

23 #ià!
defšed
 
_UNISTD_H
 && !defšed 
_STDIO_H


27 
	~<b™s/g‘İt_cÜe.h
>

29 
	g__BEGIN_DECLS


31 #ià
defšed
 
__USE_POSIX2
 && !defšed 
__USE_POSIX_IMPLICITLY
 \

32 && !
defšed
 
	g__USE_GNU
 && !defšed 
	g_GETOPT_H


37 #ifdeà
__REDIRECT


38 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

39 cÚ¡ *
__shÜtİts
),

40 
__posix_g‘İt
);

42 
	$__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

43 cÚ¡ *
__shÜtİts
)

44 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

45 
	#g‘İt
 
__posix_g‘İt


	)

49 
__END_DECLS


	@/usr/include/bits/iscanonical.h

19 #iâdeà
_MATH_H


23 
	$__isÿnÚiÿÎ
 (
__x
)

24 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

25 
	#__isÿnÚiÿlf
(
x
è((è(
	`__ty³of
 (x)è(x), 1)

	)

26 
	#__isÿnÚiÿl
(
x
è((è(
	`__ty³of
 (x)è(x), 1)

	)

27 #ià
__HAVE_DISTINCT_FLOAT128


28 
	#__isÿnÚiÿlf128
(
x
è((è(
	`__ty³of
 (x)è(x), 1)

	)

37 #iâdeà
__ılu¥lus


38 
	#isÿnÚiÿl
(
x
è
	`__MATH_TG
 ((x), 
__isÿnÚiÿl
, (x))

	)

47 
šlše
 
	`isÿnÚiÿl
 (
__v®
è{  
	`__isÿnÚiÿlf
 (__val); }

48 
šlše
 
	`isÿnÚiÿl
 (
__v®
è{  
	`__isÿnÚiÿl
 (__val); }

49 
šlše
 
	`isÿnÚiÿl
 (
__v®
è{  
	`__isÿnÚiÿÎ
 (__val); }

50 #ià
__HAVE_DISTINCT_FLOAT128


51 
šlše
 
	`isÿnÚiÿl
 (
_Flßt128
 
__v®
è{  
	`__isÿnÚiÿlf128
 (__val); }

53 
	}
}

	@/usr/include/bits/libc-header-start.h

27 #iâdeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


31 #undeà
__GLIBC_INTERNAL_STARTING_HEADER_IMPLEMENTATION


33 
	~<ã©u»s.h
>

37 #undeà
__GLIBC_USE_LIB_EXT2


38 #ià(
defšed
 
__USE_GNU
 \

39 || (
defšed
 
	g__STDC_WANT_LIB_EXT2__
 && __STDC_WANT_LIB_EXT2__ > 0))

40 
	#__GLIBC_USE_LIB_EXT2
 1

	)

42 
	#__GLIBC_USE_LIB_EXT2
 0

	)

47 #undeà
__GLIBC_USE_IEC_60559_BFP_EXT


48 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_BFP_EXT__


49 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 1

	)

51 
	#__GLIBC_USE_IEC_60559_BFP_EXT
 0

	)

56 #undeà
__GLIBC_USE_IEC_60559_FUNCS_EXT


57 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_FUNCS_EXT__


58 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 1

	)

60 
	#__GLIBC_USE_IEC_60559_FUNCS_EXT
 0

	)

65 #undeà
__GLIBC_USE_IEC_60559_TYPES_EXT


66 #ià
defšed
 
__USE_GNU
 || defšed 
__STDC_WANT_IEC_60559_TYPES_EXT__


67 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 1

	)

69 
	#__GLIBC_USE_IEC_60559_TYPES_EXT
 0

	)

	@/usr/include/bits/libio.h

28 #iâdeà
_BITS_LIBIO_H


29 
	#_BITS_LIBIO_H
 1

	)

31 #ià!
defšed
 
_STDIO_H
 && !defšed 
_LIBIO_H


35 
	~<b™s/_G_cÚfig.h
>

37 
	#_IO_åos_t
 
_G_åos_t


	)

38 
	#_IO_åos64_t
 
_G_åos64_t


	)

39 
	#_IO_size_t
 
size_t


	)

40 
	#_IO_ssize_t
 
__ssize_t


	)

41 
	#_IO_off_t
 
__off_t


	)

42 
	#_IO_off64_t
 
__off64_t


	)

43 
	#_IO_pid_t
 
__pid_t


	)

44 
	#_IO_uid_t
 
__uid_t


	)

45 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

46 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

47 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

48 
	#_IO_va_li¡
 
_G_va_li¡


	)

49 
	#_IO_wšt_t
 
wšt_t


	)

52 
	#__Ãed___va_li¡


	)

53 
	~<¡d¬g.h
>

54 #ifdeà
__GNUC_VA_LIST


55 #undeà
_IO_va_li¡


56 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

59 #iâdeà
__P


60 
	~<sys/cdefs.h
>

63 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

65 #iâdeà
EOF


66 
	#EOF
 (-1)

	)

68 #iâdeà
NULL


69 #ià
defšed
 
__GNUG__
 && \

70 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

71 
	#NULL
 (
__nuÎ
)

	)

73 #ià!
defšed
(
__ılu¥lus
)

74 
	#NULL
 ((*)0)

	)

76 
	#NULL
 (0)

	)

81 
	#_IOS_INPUT
 1

	)

82 
	#_IOS_OUTPUT
 2

	)

83 
	#_IOS_ATEND
 4

	)

84 
	#_IOS_APPEND
 8

	)

85 
	#_IOS_TRUNC
 16

	)

86 
	#_IOS_NOCREATE
 32

	)

87 
	#_IOS_NOREPLACE
 64

	)

88 
	#_IOS_BIN
 128

	)

96 
	#_IO_MAGIC
 0xFBAD0000

	)

97 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

98 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

99 
	#_IO_USER_BUF
 1

	)

100 
	#_IO_UNBUFFERED
 2

	)

101 
	#_IO_NO_READS
 4

	)

102 
	#_IO_NO_WRITES
 8

	)

103 
	#_IO_EOF_SEEN
 0x10

	)

104 
	#_IO_ERR_SEEN
 0x20

	)

105 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

106 
	#_IO_LINKED
 0x80

	)

107 
	#_IO_IN_BACKUP
 0x100

	)

108 
	#_IO_LINE_BUF
 0x200

	)

109 
	#_IO_TIED_PUT_GET
 0x400

	)

110 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

111 
	#_IO_IS_APPENDING
 0x1000

	)

112 
	#_IO_IS_FILEBUF
 0x2000

	)

113 
	#_IO_BAD_SEEN
 0x4000

	)

114 
	#_IO_USER_LOCK
 0x8000

	)

116 
	#_IO_FLAGS2_MMAP
 1

	)

117 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_FORTIFY
 4

	)

121 
	#_IO_FLAGS2_USER_WBUF
 8

	)

122 #ifdeà
_LIBC


123 
	#_IO_FLAGS2_SCANF_STD
 16

	)

124 
	#_IO_FLAGS2_NOCLOSE
 32

	)

125 
	#_IO_FLAGS2_CLOEXEC
 64

	)

126 
	#_IO_FLAGS2_NEED_LOCK
 128

	)

130 
	#_IO_SKIPWS
 01

	)

131 
	#_IO_LEFT
 02

	)

132 
	#_IO_RIGHT
 04

	)

133 
	#_IO_INTERNAL
 010

	)

134 
	#_IO_DEC
 020

	)

135 
	#_IO_OCT
 040

	)

136 
	#_IO_HEX
 0100

	)

137 
	#_IO_SHOWBASE
 0200

	)

138 
	#_IO_SHOWPOINT
 0400

	)

139 
	#_IO_UPPERCASE
 01000

	)

140 
	#_IO_SHOWPOS
 02000

	)

141 
	#_IO_SCIENTIFIC
 04000

	)

142 
	#_IO_FIXED
 010000

	)

143 
	#_IO_UNITBUF
 020000

	)

144 
	#_IO_STDIO
 040000

	)

145 
	#_IO_DONT_CLOSE
 0100000

	)

146 
	#_IO_BOOLALPHA
 0200000

	)

149 
_IO_jump_t
; 
	g_IO_FILE
;

153 #iâdeà
_IO_lock_t_defšed


154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

301 *
	m__·d1
;

302 *
	m__·d2
;

303 *
	m__·d3
;

304 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

307 
	m_mode
;

309 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

313 #iâdeà
__ılu¥lus


314 
_IO_FILE
 
	t_IO_FILE
;

317 
	g_IO_FILE_¶us
;

319 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

322 #iâdeà
_LIBC


323 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

324 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

325 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

327 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

328 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

337 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

345 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

346 
	tsize_t
 
	t__n
);

354 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

357 
	t__io_şo£_â
 (*
	t__cook›
);

360 #ifdeà
__USE_GNU


362 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

363 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

364 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

365 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

370 
__io_»ad_â
 *
	m»ad
;

371 
__io_wr™e_â
 *
	mwr™e
;

372 
__io_£ek_â
 *
	m£ek
;

373 
__io_şo£_â
 *
	mşo£
;

374 } 
	t_IO_cook›_io_funùiÚs_t
;

375 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

377 
	g_IO_cook›_fe
;

380 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

381 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

385 #ifdeà
__ılu¥lus


389 
__und”æow
 (
_IO_FILE
 *);

390 
__uæow
 (
_IO_FILE
 *);

391 
__ov”æow
 (
_IO_FILE
 *, );

392 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


393 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

394 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

398 #ià 
__GNUC__
 >= 3

399 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

401 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

404 
	#_IO_g‘c_uÆocked
(
_å
) \

405 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

406 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

407 
	#_IO_³ekc_uÆocked
(
_å
) \

408 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

409 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

410 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

411 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

412 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

413 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

414 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

416 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


417 
	#_IO_g‘wc_uÆocked
(
_å
) \

418 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

419 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

420 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

421 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

422 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

423 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

424 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

425 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

426 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

427 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

430 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

431 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

433 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

434 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

435 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

436 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

438 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

441 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

442 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

444 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

445 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

448 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

449 
	#_IO_æockfe
(
_å
è

	)

450 
	#_IO_fuÆockfe
(
_å
è

	)

451 
	#_IO_árylockfe
(
_å
è

	)

452 #iâdeà
_IO_ş—nup_»giÚ_¡¬t


453 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

455 #iâdeà
_IO_ş—nup_»giÚ_’d


456 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

459 
	#_IO_Ãed_lock
(
_å
) \

460 (((
_å
)->
_æags2
 & 
_IO_FLAGS2_NEED_LOCK
è!ğ0)

	)

462 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

463 
_IO_va_li¡
, *
__»¡riù
);

464 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

465 
_IO_va_li¡
);

466 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

467 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

469 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

470 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

472 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

474 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


475 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

476 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

477 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

478 #ià
__GNUC__
 >= 2

481 #ià
defšed
 
_LIBC
 && defšed 
SHARED


482 
	~<shlib-com·t.h
>

483 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

484 
	#_IO_fwide_maybe_šcom·tibË
 \

485 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

486 cÚ¡ 
_IO_¡dš_u£d
;

487 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

490 #iâdeà
_IO_fwide_maybe_šcom·tibË


491 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

495 
	#_IO_fwide
(
__å
, 
__mode
) \

496 ({ 
__»suÉ
 = (
__mode
); \

497 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

499 ià((
__å
)->
_mode
 == 0) \

501 (
__å
)->
_mode
 = -1; \

502 
__»suÉ
 = (
__å
)->
_mode
; \

504 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

505 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

507 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

508 
__»suÉ
; })

	)

511 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

512 
_IO_va_li¡
, *
__»¡riù
);

513 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

514 
_IO_va_li¡
);

515 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

516 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

519 #ifdeà
__LDBL_COMPAT


520 
	~<b™s/libio-ldbl.h
>

523 #ifdeà
__ılu¥lus


	@/usr/include/bits/math-finite.h

19 #iâdeà
_MATH_H


23 
	#__REDIRFROM
(...è
	`__REDIRFROM_X
(
__VA_ARGS__
)

	)

25 
	#__REDIRTO
(...è
	`__REDIRTO_X
(
__VA_ARGS__
)

	)

27 
	#__MATH_REDIRCALL_X
(
äom
, 
¬gs
, 
to
) \

28 
_MdoubË_
 
	`__REDIRECT_NTH
 (
äom
, 
¬gs
, 
to
)

	)

29 
	#__MATH_REDIRCALL
(
funùiÚ
, 
»’Œªt
, 
¬gs
) \

30 
__MATH_REDIRCALL_X
 \

31 (
	`__REDIRFROM
 (
funùiÚ
, 
»’Œªt
), 
¬gs
, \

32 
	`__REDIRTO
 (
funùiÚ
, 
»’Œªt
))

	)

33 
	#__MATH_REDIRCALL_2
(
äom
, 
»’Œªt
, 
¬gs
, 
to
) \

34 
__MATH_REDIRCALL_X
 \

35 (
	`__REDIRFROM
 (
äom
, 
»’Œªt
), 
¬gs
, \

36 
	`__REDIRTO
 (
to
, 
»’Œªt
))

	)

38 
	#__MATH_REDIRCALL_INTERNAL
(
funùiÚ
, 
»’Œªt
, 
¬gs
) \

39 
__MATH_REDIRCALL_X
 \

40 (
	`__REDIRFROM
 (
	`__CONCAT
 (
__
, 
funùiÚ
), \

41 
	`__CONCAT
 (
»’Œªt
, 
_fš™e
)), \

42 
¬gs
, 
	`__REDIRTO
 (
funùiÚ
, 
_r
))

	)

46 
__MATH_REDIRCALL
 (
acos
, , (
_MdoubË_
));

48 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


50 
__MATH_REDIRCALL
 (
acosh
, , (
_MdoubË_
));

54 
__MATH_REDIRCALL
 (
asš
, , (
_MdoubË_
));

57 
__MATH_REDIRCALL
 (
©ª2
, , (
_MdoubË_
, _Mdouble_));

59 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


61 
__MATH_REDIRCALL
 (
©ªh
, , (
_MdoubË_
));

65 
__MATH_REDIRCALL
 (
cosh
, , (
_MdoubË_
));

68 
__MATH_REDIRCALL
 (
exp
, , (
_MdoubË_
));

70 #ià
__GLIBC_USE
 (
IEC_60559_FUNCS_EXT
)

72 
__MATH_REDIRCALL
 (
exp10
, , (
_MdoubË_
));

75 #ifdeà
__USE_ISOC99


77 
__MATH_REDIRCALL
 (
exp2
, , (
_MdoubË_
));

81 
__MATH_REDIRCALL
 (
fmod
, , (
_MdoubË_
, _Mdouble_));

83 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99


85 
__MATH_REDIRCALL
 (
hypÙ
, , (
_MdoubË_
, _Mdouble_));

88 #ià(
__MATH_DECLARING_DOUBLE
 && (
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN
)) \

89 || (!
	g__MATH_DECLARING_DOUBLE
 && 
defšed
 
	g__USE_MISC
)

91 
__MATH_REDIRCALL
 (
j0
, , (
_MdoubË_
));

94 
__MATH_REDIRCALL
 (
y0
, , (
_MdoubË_
));

97 
__MATH_REDIRCALL
 (
j1
, , (
_MdoubË_
));

100 
__MATH_REDIRCALL
 (
y1
, , (
_MdoubË_
));

103 
__MATH_REDIRCALL
 (
jn
, , (, 
_MdoubË_
));

106 
__MATH_REDIRCALL
 (
yn
, , (, 
_MdoubË_
));

109 #ifdeà
__USE_MISC


111 
__MATH_REDIRCALL
 (
lgamma
, 
_r
, (
_MdoubË_
, *));

117 
__MATH_REDIRCALL_INTERNAL
 (
lgamma
, 
_r
, (
_MdoubË_
, *));

119 #ià((
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99
) \

120 && 
defšed
 
	g__ex‹º_®ways_šlše
)

122 
__ex‹º_®ways_šlše
 
_MdoubË_


123 
__NTH
 (
	$__REDIRFROM
 (
lgamma
, ) (
_MdoubË_
 
__d
))

125 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


126  
	`__REDIRTO
 (
lgamma
, 
_r
è(
__d
, &
signgam
);

128 
__loÿl_signgam
 = 0;

129  
	`__REDIRTO
 (
lgamma
, 
_r
è(
__d
, &
__loÿl_signgam
);

131 
	}
}

134 #ià((
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)) \

135 && 
defšed
 
	g__ex‹º_®ways_šlše
è&& !
__MATH_DECLARING_FLOATN


137 
__ex‹º_®ways_šlše
 
_MdoubË_


138 
__NTH
 (
	$__REDIRFROM
 (
gamma
, ) (
_MdoubË_
 
__d
))

140  
	`__REDIRTO
 (
lgamma
, 
_r
è(
__d
, &
signgam
);

141 
	}
}

145 
__MATH_REDIRCALL
 (
log
, , (
_MdoubË_
));

148 
__MATH_REDIRCALL
 (
log10
, , (
_MdoubË_
));

150 #ifdeà
__USE_ISOC99


152 
__MATH_REDIRCALL
 (
log2
, , (
_MdoubË_
));

156 
__MATH_REDIRCALL
 (
pow
, , (
_MdoubË_
, _Mdouble_));

158 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


160 
__MATH_REDIRCALL
 (
»mašd”
, , (
_MdoubË_
, _Mdouble_));

163 #ià((
__MATH_DECLARING_DOUBLE
 \

164 && (
defšed
 
	g__USE_MISC
 \

165 || (
defšed
 
	g__USE_XOPEN_EXTENDED
 && !defšed 
	g__USE_XOPEN2K8
))) \

166 || (!
defšed
 
	g__MATH_DECLARE_LDOUBLE
 && defšed 
	g__USE_MISC
)) \

167 && !
__MATH_DECLARING_FLOATN


169 
__MATH_REDIRCALL
 (
sÿlb
, , (
_MdoubË_
, _Mdouble_));

173 
__MATH_REDIRCALL
 (
sšh
, , (
_MdoubË_
));

176 
__MATH_REDIRCALL
 (
sq¹
, , (
_MdoubË_
));

178 #ià
defšed
 
__USE_ISOC99
 && defšed 
__ex‹º_®ways_šlše


180 
_MdoubË_


181 
	$__REDIRFROM
 (
__gamma
, 
_r_fš™e
è(
_MdoubË_
, *);

183 
__ex‹º_®ways_šlše
 
_MdoubË_


184 
	`__NTH
 (
	$__REDIRFROM
 (
tgamma
, ) (
_MdoubË_
 
__d
))

186 
__loÿl_signgam
 = 0;

187 
_MdoubË_
 
__»s
 = 
	`__REDIRTO
 (
gamma
, 
_r
è(
__d
, &
__loÿl_signgam
);

188  
__loÿl_signgam
 < 0 ? -
__»s
 : __res;

189 
	}
}

192 #undeà
__REDIRFROM


193 #undeà
__REDIRTO


194 #undeà
__MATH_REDIRCALL


195 #undeà
__MATH_REDIRCALL_2


196 #undeà
__MATH_REDIRCALL_INTERNAL


197 #undeà
__MATH_REDIRCALL_X


	@/usr/include/bits/math-vector.h

19 #iâdeà
_MATH_H


25 
	~<b™s/libm-simd-deş-¡ubs.h
>

27 #ià
defšed
 
__x86_64__
 && defšed 
__FAST_MATH__


28 #ià
defšed
 
_OPENMP
 && _OPENMP >= 201307

30 
	#__DECL_SIMD_x86_64
 
	`_P¿gma
 ("om°deş¬simd‚Ùšb¿nch")

	)

31 #–ià
__GNUC_PREREQ
 (6,0)

33 
	#__DECL_SIMD_x86_64
 
	`__©Œibu‹__
 ((
	`__simd__
 ("nÙšb¿nch")))

	)

36 #ifdeà
__DECL_SIMD_x86_64


37 #undeà
__DECL_SIMD_cos


38 
	#__DECL_SIMD_cos
 
__DECL_SIMD_x86_64


	)

39 #undeà
__DECL_SIMD_cosf


40 
	#__DECL_SIMD_cosf
 
__DECL_SIMD_x86_64


	)

41 #undeà
__DECL_SIMD_sš


42 
	#__DECL_SIMD_sš
 
__DECL_SIMD_x86_64


	)

43 #undeà
__DECL_SIMD_sšf


44 
	#__DECL_SIMD_sšf
 
__DECL_SIMD_x86_64


	)

45 #undeà
__DECL_SIMD_sšcos


46 
	#__DECL_SIMD_sšcos
 
__DECL_SIMD_x86_64


	)

47 #undeà
__DECL_SIMD_sšcosf


48 
	#__DECL_SIMD_sšcosf
 
__DECL_SIMD_x86_64


	)

49 #undeà
__DECL_SIMD_log


50 
	#__DECL_SIMD_log
 
__DECL_SIMD_x86_64


	)

51 #undeà
__DECL_SIMD_logf


52 
	#__DECL_SIMD_logf
 
__DECL_SIMD_x86_64


	)

53 #undeà
__DECL_SIMD_exp


54 
	#__DECL_SIMD_exp
 
__DECL_SIMD_x86_64


	)

55 #undeà
__DECL_SIMD_expf


56 
	#__DECL_SIMD_expf
 
__DECL_SIMD_x86_64


	)

57 #undeà
__DECL_SIMD_pow


58 
	#__DECL_SIMD_pow
 
__DECL_SIMD_x86_64


	)

59 #undeà
__DECL_SIMD_powf


60 
	#__DECL_SIMD_powf
 
__DECL_SIMD_x86_64


	)

	@/usr/include/bits/mathcalls-helper-functions.h

21 
__MATHDECL_1
 (, 
__åşassify
,, (
_MdoubË_
 
__v®ue
))

22 
__©Œibu‹__
 ((
__cÚ¡__
));

25 
__MATHDECL_1
 (, 
__signb™
,, (
_MdoubË_
 
__v®ue
))

26 
__©Œibu‹__
 ((
__cÚ¡__
));

30 
__MATHDECL_1
 (, 
__isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

33 
__MATHDECL_1
 (, 
__fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

36 
__MATHDECL_1
 (, 
__i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

39 
__MATHDECL_1
 (, 
__i£qsig
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

42 
__MATHDECL_1
 (, 
__issigÇlšg
,, (
_MdoubË_
 
__v®ue
))

43 
__©Œibu‹__
 ((
__cÚ¡__
));

	@/usr/include/bits/mathcalls.h

45 #iâdeà
_MATH_H


53 
__MATHCALL
 (
acos
,, (
_MdoubË_
 
__x
));

55 
__MATHCALL
 (
asš
,, (
_MdoubË_
 
__x
));

57 
__MATHCALL
 (
©ª
,, (
_MdoubË_
 
__x
));

59 
__MATHCALL
 (
©ª2
,, (
_MdoubË_
 
__y
, _MdoubË_ 
__x
));

62 
__MATHCALL_VEC
 (
cos
,, (
_MdoubË_
 
__x
));

64 
__MATHCALL_VEC
 (
sš
,, (
_MdoubË_
 
__x
));

66 
__MATHCALL
 (
n
,, (
_MdoubË_
 
__x
));

71 
__MATHCALL
 (
cosh
,, (
_MdoubË_
 
__x
));

73 
__MATHCALL
 (
sšh
,, (
_MdoubË_
 
__x
));

75 
__MATHCALL
 (
nh
,, (
_MdoubË_
 
__x
));

77 #ifdeà
__USE_GNU


79 
__MATHDECL_VEC
 (,
sšcos
,,

80 (
_MdoubË_
 
__x
, _MdoubË_ *
__sšx
, _MdoubË_ *
__cosx
));

83 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


85 
__MATHCALL
 (
acosh
,, (
_MdoubË_
 
__x
));

87 
__MATHCALL
 (
asšh
,, (
_MdoubË_
 
__x
));

89 
__MATHCALL
 (
©ªh
,, (
_MdoubË_
 
__x
));

95 
__MATHCALL_VEC
 (
exp
,, (
_MdoubË_
 
__x
));

98 
__MATHCALL
 (
äexp
,, (
_MdoubË_
 
__x
, *
__expÚ’t
));

101 
__MATHCALL
 (
ldexp
,, (
_MdoubË_
 
__x
, 
__expÚ’t
));

104 
__MATHCALL_VEC
 (
log
,, (
_MdoubË_
 
__x
));

107 
__MATHCALL
 (
log10
,, (
_MdoubË_
 
__x
));

110 
__MATHCALL
 (
modf
,, (
_MdoubË_
 
__x
, _MdoubË_ *
__Œ
)è
__nÚnuÎ
 ((2));

112 #ià
__GLIBC_USE
 (
IEC_60559_FUNCS_EXT
)

114 
__MATHCALL
 (
exp10
,, (
_MdoubË_
 
__x
));

117 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


119 
__MATHCALL
 (
expm1
,, (
_MdoubË_
 
__x
));

122 
__MATHCALL
 (
log1p
,, (
_MdoubË_
 
__x
));

125 
__MATHCALL
 (
logb
,, (
_MdoubË_
 
__x
));

128 #ifdeà
__USE_ISOC99


130 
__MATHCALL
 (
exp2
,, (
_MdoubË_
 
__x
));

133 
__MATHCALL
 (
log2
,, (
_MdoubË_
 
__x
));

140 
__MATHCALL_VEC
 (
pow
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

143 
__MATHCALL
 (
sq¹
,, (
_MdoubË_
 
__x
));

145 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99


147 
__MATHCALL
 (
hypÙ
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

150 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


152 
__MATHCALL
 (
cb¹
,, (
_MdoubË_
 
__x
));

159 
__MATHCALLX
 (
û
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

162 
__MATHCALLX
 (
çbs
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

165 
__MATHCALLX
 (
æoÜ
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

168 
__MATHCALL
 (
fmod
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

170 #ifdeà
__USE_MISC


171 #ià((!
defšed
 
__ılu¥lus
 \

172 || 
	g__ılu¥lus
 < 201103L \

173 || 
	g__MATH_DECLARING_DOUBLE
 == 0)) \

174 && !
__MATH_DECLARING_FLOATN


177 
__MATHDECL_1
 (,
isšf
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

180 #ià!
__MATH_DECLARING_FLOATN


182 
__MATHDECL_1
 (,
fš™e
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

185 
__MATHCALL
 (
d»m
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

189 
__MATHCALL
 (
signifiÿnd
,, (
_MdoubË_
 
__x
));

194 #ifdeà
__USE_ISOC99


196 
__MATHCALLX
 (
cİysign
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

199 #ifdeà
__USE_ISOC99


201 
__MATHCALLX
 (
Çn
,, (cÚ¡ *
__gb
), (
__cÚ¡__
));

205 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

206 #ià((!
defšed
 
__ılu¥lus
 \

207 || 
	g__ılu¥lus
 < 201103L \

208 || 
	g__MATH_DECLARING_DOUBLE
 == 0)) \

209 && !
__MATH_DECLARING_FLOATN


211 
__MATHDECL_1
 (,
i¢ª
,, (
_MdoubË_
 
__v®ue
)è
__©Œibu‹__
 ((
__cÚ¡__
));

215 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && 
__MATH_DECLARING_DOUBLE
)

217 
__MATHCALL
 (
j0
,, (
_MdoubË_
));

218 
__MATHCALL
 (
j1
,, (
_MdoubË_
));

219 
__MATHCALL
 (
jn
,, (, 
_MdoubË_
));

220 
__MATHCALL
 (
y0
,, (
_MdoubË_
));

221 
__MATHCALL
 (
y1
,, (
_MdoubË_
));

222 
__MATHCALL
 (
yn
,, (, 
_MdoubË_
));

226 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_ISOC99


228 
__MATHCALL
 (
”f
,, (
_MdoubË_
));

229 
__MATHCALL
 (
”fc
,, (
_MdoubË_
));

230 
__MATHCALL
 (
lgamma
,, (
_MdoubË_
));

233 #ifdeà
__USE_ISOC99


235 
__MATHCALL
 (
tgamma
,, (
_MdoubË_
));

238 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

239 #ià!
__MATH_DECLARING_FLOATN


241 
__MATHCALL
 (
gamma
,, (
_MdoubË_
));

245 #ifdeà
__USE_MISC


249 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubË_
, *
__signgamp
));

253 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


256 
__MATHCALL
 (
ršt
,, (
_MdoubË_
 
__x
));

259 
__MATHCALL
 (
Ãxá”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

260 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__LDBL_COMPAT
 && !
__MATH_DECLARING_FLOATN


261 
__MATHCALL
 (
Ãx‰ow¬d
,, (
_MdoubË_
 
__x
, 
__y
));

264 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| 
__MATH_DECLARING_FLOATN


266 
__MATHCALL
 (
Ãxtdown
,, (
_MdoubË_
 
__x
));

268 
__MATHCALL
 (
Ãxtup
,, (
_MdoubË_
 
__x
));

272 
__MATHCALL
 (
»mašd”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

274 #ifdeà
__USE_ISOC99


276 
__MATHCALL
 (
sÿlbn
,, (
_MdoubË_
 
__x
, 
__n
));

280 
__MATHDECL
 (,
ogb
,, (
_MdoubË_
 
__x
));

283 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| 
__MATH_DECLARING_FLOATN


285 
__MATHDECL
 (, 
Îogb
,, (
_MdoubË_
 
__x
));

288 #ifdeà
__USE_ISOC99


290 
__MATHCALL
 (
sÿlbÊ
,, (
_MdoubË_
 
__x
, 
__n
));

294 
__MATHCALL
 (
Ã¬byšt
,, (
_MdoubË_
 
__x
));

298 
__MATHCALLX
 (
round
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

302 
__MATHCALLX
 (
Œunc
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

307 
__MATHCALL
 (
»mquo
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, *
__quo
));

314 
__MATHDECL
 (,
Ìšt
,, (
_MdoubË_
 
__x
));

315 
__ex‹nsiÚ__


316 
__MATHDECL
 (,
Îršt
,, (
_MdoubË_
 
__x
));

320 
__MATHDECL
 (,
Ìound
,, (
_MdoubË_
 
__x
));

321 
__ex‹nsiÚ__


322 
__MATHDECL
 (,
Îround
,, (
_MdoubË_
 
__x
));

326 
__MATHCALL
 (
fdim
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
));

329 
__MATHCALLX
 (
fmax
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

332 
__MATHCALLX
 (
fmš
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

335 
__MATHCALL
 (
fma
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
, _MdoubË_ 
__z
));

338 #ià
__GLIBC_USE
 (
IEC_60559_BFP_EXT
è|| 
__MATH_DECLARING_FLOATN


340 
__MATHCALLX
 (
roundev’
,, (
_MdoubË_
 
__x
), (
__cÚ¡__
));

344 
__MATHDECL
 (
__štmax_t
, 
äomå
,, (
_MdoubË_
 
__x
, 
__round
,

345 
__width
));

349 
__MATHDECL
 (
__uštmax_t
, 
uäomå
,, (
_MdoubË_
 
__x
, 
__round
,

350 
__width
));

355 
__MATHDECL
 (
__štmax_t
, 
äomåx
,, (
_MdoubË_
 
__x
, 
__round
,

356 
__width
));

361 
__MATHDECL
 (
__uštmax_t
, 
uäomåx
,, (
_MdoubË_
 
__x
, 
__round
,

362 
__width
));

365 
__MATHCALLX
 (
fmaxmag
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

368 
__MATHCALLX
 (
fmšmag
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
), (
__cÚ¡__
));

371 
__MATHDECL_1
 (, 
tÙ®Üd”
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
))

372 
__©Œibu‹__
 ((
__cÚ¡__
));

375 
__MATHDECL_1
 (, 
tÙ®Üd”mag
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__y
))

376 
__©Œibu‹__
 ((
__cÚ¡__
));

379 
__MATHDECL_1
 (, 
ÿnÚiÿlize
,, (
_MdoubË_
 *
__cx
, cÚ¡ _MdoubË_ *
__x
));

382 
__MATHCALL
 (
g‘·ylßd
,, (cÚ¡ 
_MdoubË_
 *
__x
));

385 
__MATHDECL_1
 (, 
£aylßd
,, (
_MdoubË_
 *
__x
, _MdoubË_ 
__·ylßd
));

388 
__MATHDECL_1
 (, 
£aylßdsig
,, (
_MdoubË_
 *
__x
, _MdoubË_ 
__·ylßd
));

391 #ià(
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

392 && 
	g__MATH_DECLARING_DOUBLE
 \

393 && !
defšed
 
	g__USE_XOPEN2K8
)) \

394 && !
__MATH_DECLARING_FLOATN


396 
__MATHCALL
 (
sÿlb
,, (
_MdoubË_
 
__x
, _MdoubË_ 
__n
));

	@/usr/include/bits/mathinline.h

19 #iâdeà
_MATH_H


23 #iâdeà
__ex‹º_®ways_šlše


24 
	#__MATH_INLINE
 
__šlše


	)

26 
	#__MATH_INLINE
 
__ex‹º_®ways_šlše


	)

31 #ià
__GNUC_PREREQ
 (2, 8)

32 #ià!
__GNUC_PREREQ
 (3, 4è&& !
defšed
 
__NO_MATH_INLINES
 \

33 && 
defšed
 
	g__OPTIMIZE__


37 #ifdeà
__USE_ISOC99


40 #ifdeà
__SSE_MATH__


41 
__MATH_INLINE
 

42 
__NTH
 (
	$Ìštf
 (
__x
))

44 
__»s
;

49 
__asm
 
	`__vŞ©e__
 ("cvtss2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

50  
__»s
;

51 
	}
}

53 #ifdeà
__SSE2_MATH__


54 
__MATH_INLINE
 

55 
__NTH
 (
	$Ìšt
 (
__x
))

57 
__»s
;

62 
__asm
 
	`__vŞ©e__
 ("cvtsd2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

63  
__»s
;

64 
	}
}

66 #ifdeà
__x86_64__


67 
__ex‹nsiÚ__


68 
__MATH_INLINE
 

69 
__NTH
 (
	$Îrštf
 (
__x
))

71 
__»s
;

76 
__asm
 
	`__vŞ©e__
 ("cvtss2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

77  
__»s
;

78 
	}
}

79 
__ex‹nsiÚ__


80 
__MATH_INLINE
 

81 
__NTH
 (
	$Îršt
 (
__x
))

83 
__»s
;

88 
__asm
 
	`__vŞ©e__
 ("cvtsd2s˜%1, %0" : "ô" (
__»s
è: "xm" (
__x
));

89  
__»s
;

90 
	}
}

93 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0 \

94 && 
defšed
 
__SSE2_MATH__


96 
__MATH_INLINE
 

97 
__NTH
 (
	$fmaxf
 (
__x
, 
__y
))

99 #ifdeà
__AVX__


100 
__»s
;

101 
	`__asm
 ("vmaxs %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

102  
__»s
;

104 
	`__asm
 ("maxs %1, %0" : "+x" (
__x
è: "xm" (
__y
));

105  
__x
;

107 
	}
}

108 
__MATH_INLINE
 

109 
__NTH
 (
	$fmax
 (
__x
, 
__y
))

111 #ifdeà
__AVX__


112 
__»s
;

113 
	`__asm
 ("vmaxsd %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

114  
__»s
;

116 
	`__asm
 ("maxsd %1, %0" : "+x" (
__x
è: "xm" (
__y
));

117  
__x
;

119 
	}
}

122 
__MATH_INLINE
 

123 
__NTH
 (
	$fmšf
 (
__x
, 
__y
))

125 #ifdeà
__AVX__


126 
__»s
;

127 
	`__asm
 ("vmšs %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

128  
__»s
;

130 
	`__asm
 ("mšs %1, %0" : "+x" (
__x
è: "xm" (
__y
));

131  
__x
;

133 
	}
}

134 
__MATH_INLINE
 

135 
__NTH
 (
	$fmš
 (
__x
, 
__y
))

137 #ifdeà
__AVX__


138 
__»s
;

139 
	`__asm
 ("vmšsd %2, %1, %0" : "=x" (
__»s
è: "x" (
x
), "xm" (
__y
));

140  
__»s
;

142 
	`__asm
 ("mšsd %1, %0" : "+x" (
__x
è: "xm" (
__y
));

143  
__x
;

145 
	}
}

150 #ià
defšed
 
__SSE4_1__
 && defšed 
__SSE2_MATH__


151 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_ISOC99


154 
__MATH_INLINE
 

155 
__NTH
 (
	$ršt
 (
__x
))

157 
__»s
;

162 
__asm
 
	`__vŞ©e__
 ("roundsd $4, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

163  
__»s
;

164 
	}
}

165 
__MATH_INLINE
 

166 
__NTH
 (
	$rštf
 (
__x
))

168 
__»s
;

173 
__asm
 
	`__vŞ©e__
 ("rounds $4, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

174  
__»s
;

175 
	}
}

177 #ifdeà
__USE_ISOC99


179 
__MATH_INLINE
 

180 
__NTH
 (
	$Ã¬byšt
 (
__x
))

182 
__»s
;

187 
__asm
 
	`__vŞ©e__
 ("roundsd $0xc, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

188  
__»s
;

189 
	}
}

190 
__MATH_INLINE
 

191 
__NTH
 (
	$Ã¬byštf
 (
__x
))

193 
__»s
;

198 
__asm
 
	`__vŞ©e__
 ("rounds $0xc, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

199  
__»s
;

200 
	}
}

206 
__MATH_INLINE
 

207 
__NTH
 (
	$û
 (
__x
))

209 
__»s
;

210 
	`__asm
 ("roundsd $2, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

211  
__»s
;

212 
	}
}

214 
__MATH_INLINE
 

215 
__NTH
 (
	$ûf
 (
__x
))

217 
__»s
;

218 
	`__asm
 ("rounds $2, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

219  
__»s
;

220 
	}
}

223 
__MATH_INLINE
 

224 
__NTH
 (
	$æoÜ
 (
__x
))

226 
__»s
;

227 
	`__asm
 ("roundsd $1, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

228  
__»s
;

229 
	}
}

231 
__MATH_INLINE
 

232 
__NTH
 (
	$æoÜf
 (
__x
))

234 
__»s
;

235 
	`__asm
 ("rounds $1, %1, %0" : "=x" (
__»s
è: "xm" (
__x
));

236  
__»s
;

237 
	}
}

245 #ià!
defšed
 
__SSE2_MATH__
 && !defšed 
__x86_64__


246 #ià((!
defšed
 
__NO_MATH_INLINES
 || defšed 
__LIBC_INTERNAL_MATH_INLINES
) \

247 && 
defšed
 
	g__OPTIMIZE__
)

251 #undeà
m©h_”rhªdlšg


260 #ifdeà
__USE_ISOC99


261 
	#__šlše_m©hİ
(
func
, 
İ
) \

262 
	`__šlše_m©hİ_
 (, 
func
, 
İ
) \

263 
	`__šlše_m©hİ_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
) \

264 
	`__šlše_m©hİ_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
)

	)

265 
	#__šlše_m©hİNP
(
func
, 
İ
) \

266 
	`__šlše_m©hİNP_
 (, 
func
, 
İ
) \

267 
	`__šlše_m©hİNP_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
) \

268 
	`__šlše_m©hİNP_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
)

	)

270 
	#__šlše_m©hİ
(
func
, 
İ
) \

271 
	`__šlše_m©hİ_
 (, 
func
, 
İ
)

	)

272 
	#__šlše_m©hİNP
(
func
, 
İ
) \

273 
	`__šlše_m©hİNP_
 (, 
func
, 
İ
)

	)

276 
	#__šlše_m©hİ_
(
æßt_ty³
, 
func
, 
İ
) \

277 
	`__šlše_m©hİ_deş_
 (
æßt_ty³
, 
func
, 
İ
, "0" (
__x
))

	)

278 
	#__šlše_m©hİNP_
(
æßt_ty³
, 
func
, 
İ
) \

279 
	`__šlše_m©hİ_deşNP_
 (
æßt_ty³
, 
func
, 
İ
, "0" (
__x
))

	)

282 #ifdeà
__USE_ISOC99


283 
	#__šlše_m©hİ_deş
(
func
, 
İ
, 
·¿ms
...) \

284 
	`__šlše_m©hİ_deş_
 (, 
func
, 
İ
, 
·¿ms
) \

285 
	`__šlše_m©hİ_deş_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
, 
·¿ms
) \

286 
	`__šlše_m©hİ_deş_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
, 
·¿ms
)

	)

287 
	#__šlše_m©hİ_deşNP
(
func
, 
İ
, 
·¿ms
...) \

288 
	`__šlše_m©hİ_deşNP_
 (, 
func
, 
İ
, 
·¿ms
) \

289 
	`__šlše_m©hİ_deşNP_
 (, 
	`__CONCAT
(
func
,
f
), 
İ
, 
·¿ms
) \

290 
	`__šlše_m©hİ_deşNP_
 (, 
	`__CONCAT
(
func
,
l
), 
İ
, 
·¿ms
)

	)

292 
	#__šlše_m©hİ_deş
(
func
, 
İ
, 
·¿ms
...) \

293 
	`__šlše_m©hİ_deş_
 (, 
func
, 
İ
, 
·¿ms
)

	)

294 
	#__šlše_m©hİ_deşNP
(
func
, 
İ
, 
·¿ms
...) \

295 
	`__šlše_m©hİ_deşNP_
 (, 
func
, 
İ
, 
·¿ms
)

	)

298 
	#__šlše_m©hİ_deş_
(
æßt_ty³
, 
func
, 
İ
, 
·¿ms
...) \

299 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³è
__THROW
; \

300 
	`__šlše_m©hİ_deşNP_
 (
æßt_ty³
, 
func
, 
İ
, 
·¿ms
)

	)

302 
	#__šlše_m©hİ_deşNP_
(
æßt_ty³
, 
func
, 
İ
, 
·¿ms
...) \

303 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
__x
)) \

305 
æßt_ty³
 
__»suÉ
; \

306 
__asm
 
	`__vŞ©e__
 (
İ
 : "ñ" (
__»suÉ
è: 
·¿ms
); \

307  
__»suÉ
; \

308 }

	)

311 #ifdeà
__USE_ISOC99


312 
	#__šlše_m©hcode
(
func
, 
¬g
, 
code
) \

313 
	`__šlše_m©hcode_
 (, 
func
, 
¬g
, 
code
) \

314 
	`__šlše_m©hcode_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g
, 
code
) \

315 
	`__šlše_m©hcode_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g
, 
code
)

	)

316 
	#__šlše_m©hcodeNP
(
func
, 
¬g
, 
code
) \

317 
	`__šlše_m©hcodeNP_
 (, 
func
, 
¬g
, 
code
) \

318 
	`__šlše_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g
, 
code
) \

319 
	`__šlše_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g
, 
code
)

	)

320 
	#__šlše_m©hcode2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

321 
	`__šlše_m©hcode2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
) \

322 
	`__šlše_m©hcode2_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
code
) \

323 
	`__šlše_m©hcode2_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
code
)

	)

324 
	#__šlše_m©hcodeNP2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

325 
	`__šlše_m©hcodeNP2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
) \

326 
	`__šlše_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
code
) \

327 
	`__šlše_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
code
)

	)

328 
	#__šlše_m©hcode3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

329 
	`__šlše_m©hcode3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

330 
	`__šlše_m©hcode3_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

331 
	`__šlše_m©hcode3_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

332 
	#__šlše_m©hcodeNP3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

333 
	`__šlše_m©hcodeNP3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

334 
	`__šlše_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
f
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

335 
	`__šlše_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
l
), 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

337 
	#__šlše_m©hcode
(
func
, 
¬g
, 
code
) \

338 
	`__šlše_m©hcode_
 (, 
func
, (
¬g
), 
code
)

	)

339 
	#__šlše_m©hcodeNP
(
func
, 
¬g
, 
code
) \

340 
	`__šlše_m©hcodeNP_
 (, 
func
, (
¬g
), 
code
)

	)

341 
	#__šlše_m©hcode2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

342 
	`__šlše_m©hcode2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

343 
	#__šlše_m©hcodeNP2
(
func
, 
¬g1
, 
¬g2
, 
code
) \

344 
	`__šlše_m©hcodeNP2_
 (, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

345 
	#__šlše_m©hcode3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

346 
	`__šlše_m©hcode3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

347 
	#__šlše_m©hcodeNP3
(
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

348 
	`__šlše_m©hcodeNP3_
 (, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

351 
	#__šlše_m©hcode_
(
æßt_ty³
, 
func
, 
¬g
, 
code
) \

352 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³è
__THROW
; \

353 
	`__šlše_m©hcodeNP_
(
æßt_ty³
, 
func
, 
¬g
, 
code
)

	)

355 
	#__šlše_m©hcodeNP_
(
æßt_ty³
, 
func
, 
¬g
, 
code
) \

356 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g
)) \

358 
code
; \

359 }

	)

362 
	#__šlše_m©hcode2_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
) \

363 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³, flßt_ty³è
__THROW
; \

364 
	`__šlše_m©hcodeNP2_
 (
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
)

	)

366 
	#__šlše_m©hcodeNP2_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
code
) \

367 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g1
, flßt_ty³ 
¬g2
)) \

369 
code
; \

370 }

	)

372 
	#__šlše_m©hcode3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

373 
__MATH_INLINE
 
æßt_ty³
 
	`func
 (æßt_ty³, flßt_ty³, flßt_ty³è
__THROW
; \

374 
	`__šlše_m©hcodeNP3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
)

	)

376 
	#__šlše_m©hcodeNP3_
(
æßt_ty³
, 
func
, 
¬g1
, 
¬g2
, 
¬g3
, 
code
) \

377 
__MATH_INLINE
 
æßt_ty³
 
	`__NTH
 (
	`func
 (æßt_ty³ 
¬g1
, flßt_ty³ 
¬g2
, \

378 
æßt_ty³
 
¬g3
)) \

380 
code
; \

381 }

	)

385 #ià!
defšed
 
__NO_MATH_INLINES
 && defšed 
__OPTIMIZE__


389 #ifdeà
__FAST_MATH__


390 #ifdeà
__USE_GNU


391 
	#__sšcos_code
 \

392 
__co¤
; \

393 
__sšr
; \

394 
__swtmp
; \

395 
__asm
 
__vŞ©e__
 \

410 : "ñ" (
__co¤
), "=u" (
__sšr
), "÷" (
__swtmp
è: "0" (
__x
)); \

411 *
__sšx
 = 
__sšr
; \

412 *
__cosx
 = 
__co¤


	)

414 
__MATH_INLINE
 

415 
__NTH
 (
	$__sšcos
 (
__x
, *
__sšx
, *
__cosx
))

417 
__sšcos_code
;

418 
	}
}

420 
__MATH_INLINE
 

421 
__NTH
 (
	$__sšcosf
 (
__x
, *
__sšx
, *
__cosx
))

423 
__sšcos_code
;

424 
	}
}

426 
__MATH_INLINE
 

427 
__NTH
 (
	$__sšco¦
 (
__x
, *
__sšx
, *
__cosx
))

429 
__sšcos_code
;

430 
	}
}

437 #ià
__GNUC_PREREQ
 (3, 5)

438 
	#__expm1_code
 \

439 
__‹mp
; \

440 
__‹mp
 = 
	`__butš_expm1l
 (
__x
); \

441  
__‹mp
 ? __‹m°: 
__x


	)

443 
	#__expm1_code
 \

444 
__v®ue
; \

445 
__expÚ’t
; \

446 
__‹mp
; \

447 
__asm
 
__vŞ©e__
 \

456 : "ñ" (
__v®ue
), "=u" (
__expÚ’t
è: "0" (
__x
)); \

457 
__asm
 
__vŞ©e__
 \

459 : "ñ" (
__‹mp
è: "0" (1.0), "u" (
__expÚ’t
)); \

460 
__‹mp
 -= 1.0; \

461 
__‹mp
 +ğ
__v®ue
; \

462  
__‹mp
 ? __‹m°: 
__x


	)

464 
	$__šlše_m©hcodeNP_
 (, 
__expm1l
, 
__x
, 
__expm1_code
)

466 #ià
	`__GNUC_PREREQ
 (3, 4)

467 
	`__šlše_m©hcodeNP_
 (, 
__ex¶
, 
__x
,  
	$__butš_ex¶
 (
__x
))

469 
	#__exp_code
 \

470 
__v®ue
; \

471 
__expÚ’t
; \

472 
__asm
 
__vŞ©e__
 \

480 : "ñ" (
__v®ue
), "=u" (
__expÚ’t
è: "0" (
__x
)); \

481 
__v®ue
 += 1.0; \

482 
__asm
 
__vŞ©e__
 \

484 : "ñ" (
__v®ue
è: "0" (__v®ue), "u" (
__expÚ’t
)); \

485  
__v®ue


	)

486 
	$__šlše_m©hcodeNP
 (
exp
, 
__x
, 
__exp_code
)

487 
	$__šlše_m©hcodeNP_
 (, 
__ex¶
, 
__x
, 
__exp_code
)

491 #ià!
	`__GNUC_PREREQ
 (3, 5)

492 
	`__šlše_m©hcodeNP
 (
n
, 
__x
, \

493 
__v®ue
; \

494 
__v®ue2
 
	`__©Œibu‹__
 ((
__unu£d__
)); \

495 
__asm
 
__vŞ©e__
 \

497 : "ñ" (
__v®ue2
), "=u" (
__v®ue
è: "0" (
__x
)); \

498  
__v®ue
)

503 #ià
	`__GNUC_PREREQ
 (3, 4)

504 
	`__šlše_m©hcodeNP2_
 (, 
__©ª2l
, 
__y
, 
__x
,

505  
	$__butš_©ª2l
 (
__y
, 
__x
))

507 
	#__©ª2_code
 \

508 
__v®ue
; \

509 
__asm
 
__vŞ©e__
 \

511 : "ñ" (
__v®ue
è: "0" (
__x
), "u" (
__y
) : "st(1)"); \

512  
__v®ue


	)

513 #ifdeà
__FAST_MATH__


514 
	$__šlše_m©hcodeNP2
 (
©ª2
, 
__y
, 
__x
, 
__©ª2_code
)

516 
	$__šlše_m©hcodeNP2_
 (, 
__©ª2l
, 
__y
, 
__x
, 
__©ª2_code
)

520 #ià
defšed
 
__FAST_MATH__
 && !
	`__GNUC_PREREQ
 (3, 5)

521 
	`__šlše_m©hcodeNP2
 (
fmod
, 
__x
, 
__y
, \

522 
__v®ue
; \

523 
__asm
 
__vŞ©e__
 \

528 : "ñ" (
__v®ue
è: "0" (
__x
), "u" (
__y
) : "ax", "cc"); \

529  
__v®ue
)

533 #ifdeà
__FAST_MATH__


534 #ià!
	`__GNUC_PREREQ
 (3,3)

535 
	`__šlše_m©hİNP
 (
sq¹
, "fsqrt")

536 
	`__šlše_m©hİNP_
 (, 
__sq¹l
, "fsqrt")

537 
	#__libc_sq¹l
(
n
è
	`__sq¹l
 (n)

	)

539 
	#__libc_sq¹l
(
n
è
	`__butš_sq¹l
 (n)

	)

543 #ià
	`__GNUC_PREREQ
 (2, 8)

544 
	`__šlše_m©hcodeNP_
 (, 
çbs
, 
__x
,  
	$__butš_çbs
 (
__x
))

545 #ifdeà
__USE_ISOC99


546 
	`__šlše_m©hcodeNP_
 (, 
çbsf
, 
__x
,  
	$__butš_çbsf
 (
__x
))

547 
	`__šlše_m©hcodeNP_
 (, 
çb¦
, 
__x
,  
	$__butš_çb¦
 (
__x
))

549 
	`__šlše_m©hcodeNP_
 (, 
__çb¦
, 
__x
,  
	$__butš_çb¦
 (
__x
))

551 
	`__šlše_m©hİ
 (
çbs
, "fabs")

552 
	`__šlše_m©hİ_
 (, 
__çb¦
, "fabs")

555 #ifdeà
__FAST_MATH__


556 #ià!
	`__GNUC_PREREQ
 (3, 4)

558 
	`__šlše_m©hİNP
 (
sš
, "fsin")

560 
	`__šlše_m©hİNP
 (
cos
, "fcos")

562 
	`__šlše_m©hİ_deşNP
 (
log
, "ædÊ2; fxch; fyl2x", "0" (
__x
) : "st(1)")

565 #ià!
	`__GNUC_PREREQ
 (3, 5)

566 
	`__šlše_m©hİ_deşNP
 (
log10
, "ædlg2; fxch; fyl2x", "0" (
__x
) : "st(1)")

568 
	`__šlše_m©hcodeNP
 (
asš
, 
__x
,  
	`__©ª2l
 (__x, 
	`__libc_sq¹l
 (1.0 - __x * __x)))

569 
	`__šlše_m©hcodeNP
 (
acos
, 
__x
,  
	`__©ª2l
 (
	`__libc_sq¹l
 (1.0 - __x * __x), __x))

572 #ià!
	`__GNUC_PREREQ
 (3, 4)

573 
	`__šlše_m©hİ_deşNP
 (
©ª
, "æd1; f·n", "0" (
__x
) : "st(1)")

577 
	`__šlše_m©hcode_
 (, 
__sgn1l
, 
__x
, \

578 
__ex‹nsiÚ__
 uniÚ { 
__xld
; 
__xi
[3]; } 
__n
 = \

579 { 
__xld
: 
__x
 
	}
}; \

580 
	g__n
.
	g__xi
[2] = (
__n
.
__xi
[2] & 0x8000) | 0x3fff; \

581 
	g__n
.
	g__xi
[1] = 0x80000000; \

582 
	g__n
.
	g__xi
[0] = 0; \

583  
	g__n
.
	g__xld
)

586 #ifdeà
__FAST_MATH__


588 
__šlše_m©hcodeNP
 (
sšh
, 
__x
, \

589 
__exm1
 = 
__expm1l
 (
__çb¦
 (
__x
)); \

590  0.5 * (
__exm1
 / (__exm1 + 1.0è+ __exm1è* 
	$__sgn1l
 (
__x
))

592 
	`__šlše_m©hcodeNP
 (
cosh
, 
__x
, \

593 
__ex
 = 
	`__ex¶
 (
__x
); \

594  0.5 * (
__ex
 + 1.0 / __ex))

596 
	`__šlše_m©hcodeNP
 (
nh
, 
__x
, \

597 
__exm1
 = 
	`__expm1l
 (-
	`__çb¦
 (
__x
 + __x)); \

598  
__exm1
 / (__exm1 + 2.0è* 
	`__sgn1l
 (-
__x
))

601 
	`__šlše_m©hcodeNP
 (
æoÜ
, 
__x
, \

602 
__v®ue
; \

603 
__ignÜe
; \

604 
__cw
; \

605 
__cwtmp
; \

606 
__asm
 
	`__vŞ©e
 ("fnstcw %3\n\t" \

614 : "ñ" (
__v®ue
), "=&q" (
__ignÜe
), "=m" (
__cwtmp
), \

615 "=m" (
__cw
) \

616 : "0" (
__x
)); \

617  
__v®ue
)

619 
	`__šlše_m©hcodeNP
 (
û
, 
__x
, \

620 
__v®ue
; \

621 
__ignÜe
; \

622 
__cw
; \

623 
__cwtmp
; \

624 
__asm
 
	`__vŞ©e
 ("fnstcw %3\n\t" \

632 : "ñ" (
__v®ue
), "=&q" (
__ignÜe
), "=m" (
__cwtmp
), \

633 "=m" (
__cw
) \

634 : "0" (
__x
)); \

635  
__v®ue
)

637 #ifdeà
__FAST_MATH__


638 
	#__ldexp_code
 \

639 
__v®ue
; \

640 
__asm
 
__vŞ©e__
 \

642 : "ñ" (
__v®ue
è: "0" (
__x
), "u" ((è
__y
)); \

643  
__v®ue


	)

645 
__MATH_INLINE
 

646 
	`__NTH
 (
	$ldexp
 (
__x
, 
__y
))

648 
__ldexp_code
;

649 
	}
}

654 #ifdeà
__USE_ISOC99


656 #ifdeà
__FAST_MATH__


657 
	$__šlše_m©hcodeNP
 (
expm1
, 
__x
, 
__expm1_code
)

661 
	#__M_SQRT2
 1.41421356237309504880L

	)

663 #ià!
	`__GNUC_PREREQ
 (3, 5)

664 
	`__šlše_m©hcodeNP
 (
log1p
, 
__x
, \

665 
__v®ue
; \

666 ià(
	`__çb¦
 (
__x
è>ğ1.0 - 0.5 * 
__M_SQRT2
) \

667 
__v®ue
 = 
	`logl
 (1.0 + 
__x
); \

669 
__asm
 
__vŞ©e__
 \

673 : "ñ" (
__v®ue
è: "0" (
__x
) : "st(1)"); \

674  
__v®ue
)

679 
	`__šlše_m©hcodeNP
 (
asšh
, 
__x
, \

680 
__y
 = 
	`__çb¦
 (
__x
); \

681  (
	`log1¶
 (
__y
 * __y / (
	`__libc_sq¹l
 (__y * __y + 1.0) + 1.0) + __y) \

682 * 
	$__sgn1l
 (
__x
)))

684 
	`__šlše_m©hcodeNP
 (
acosh
, 
__x
, \

685  
	`logl
 (
__x
 + 
	`__libc_sq¹l
 (__x - 1.0) * __libc_sqrtl (__x + 1.0)))

687 
	`__šlše_m©hcodeNP
 (
©ªh
, 
__x
, \

688 
__y
 = 
	`__çb¦
 (
__x
); \

689  -0.5 * 
	`log1¶
 (-(
__y
 + __yè/ (1.0 + __y)è* 
	$__sgn1l
 (
__x
))

692 
	`__šlše_m©hcodeNP2
 (
hypÙ
, 
__x
, 
__y
,

693  
	`__libc_sq¹l
 (
__x
 * __x + 
__y
 * __y))

695 #ià!
	`__GNUC_PREREQ
 (3, 5)

696 
	`__šlše_m©hcodeNP
(
logb
, 
__x
, \

697 
__v®ue
; \

698 
__junk
; \

699 
__asm
 
__vŞ©e__
 \

701 : "ñ" (
__junk
), "=u" (
__v®ue
è: "0" (
__x
)); \

702  
__v®ue
)

708 #ifdeà
__USE_ISOC99


709 #ifdeà
__FAST_MATH__


711 #ià!
	`__GNUC_PREREQ
 (3, 5)

712 
	`__šlše_m©hİ_deşNP
 (
log2
, "æd1; fxch; fyl2x", "0" (
__x
) : "st(1)")

715 
__MATH_INLINE
 

716 
	`__NTH
 (
	$ldexpf
 (
__x
, 
__y
))

718 
__ldexp_code
;

719 
	}
}

721 
__MATH_INLINE
 

722 
__NTH
 (
	$ldex¶
 (
__x
, 
__y
))

724 
__ldexp_code
;

725 
	}
}

727 
__šlše_m©hİNP
 (
ršt
, "frndint")

730 
	#__Ìšt_code
 \

731 
__ÌšŒes
; \

732 
__asm__
 
__vŞ©e__
 \

734 : "=m" (
__ÌšŒes
è: "t" (
__x
) : "st"); \

735  
__ÌšŒes


	)

736 
__MATH_INLINE
 

737 
__NTH
 (
	$Ìštf
 (
__x
))

739 
__Ìšt_code
;

740 
	}
}

741 
__MATH_INLINE
 

742 
__NTH
 (
	$Ìšt
 (
__x
))

744 
__Ìšt_code
;

745 
	}
}

746 
__MATH_INLINE
 

747 
__NTH
 (
	$Ìš
 (
__x
))

749 
__Ìšt_code
;

750 
	}
}

751 #undeà
__Ìšt_code


753 
	#__Îršt_code
 \

754 
__ÎršŒes
; \

755 
__asm__
 
__vŞ©e__
 \

757 : "=m" (
__ÎršŒes
è: "t" (
__x
) : "st"); \

758  
__ÎršŒes


	)

759 
__ex‹nsiÚ__


760 
__MATH_INLINE
 

761 
__NTH
 (
	$Îrštf
 (
__x
))

763 
__Îršt_code
;

764 
	}
}

765 
__ex‹nsiÚ__


766 
__MATH_INLINE
 

767 
__NTH
 (
	$Îršt
 (
__x
))

769 
__Îršt_code
;

770 
	}
}

771 
__ex‹nsiÚ__


772 
__MATH_INLINE
 

773 
__NTH
 (
	$Îrš
 (
__x
))

775 
__Îršt_code
;

776 
	}
}

777 #undeà
__Îršt_code


782 #ifdeà
__USE_MISC


784 #ià
defšed
 
__FAST_MATH__
 && !
__GNUC_PREREQ
 (3, 5)

785 
__šlše_m©hcodeNP2
 (
d»m
, 
__x
, 
__y
, \

786 
__v®ue
; \

787 
__şobb”ed
; \

788 
__asm
 
__vŞ©e__
 \

793 : "ñ" (
__v®ue
), "=&a" (
__şobb”ed
è: "0" (
__x
), "u" (
__y
) : "cc"); \

794  
__v®ue
)

799 
__MATH_INLINE
 

800 
__NTH
 (
	$__fš™e
 (
__x
))

802  (
__ex‹nsiÚ__


803 (((((uniÚ { 
__d
; 
__i
[2]; }è{__d: 
__x
}).__i[1]

805 
	}
}

810 #undeà
__©ª2_code


811 #ifdeà
__FAST_MATH__


812 #undeà
__expm1_code


813 #undeà
__exp_code


814 #undeà
__sšcos_code


821 #ifdeà
__LIBC_INTERNAL_MATH_INLINES


822 
__šlše_m©hİ
 (
__›“754_sq¹
, "fsqrt")

823 
__šlše_m©hcode2_
 (, 
__›“754_©ª2l
, 
__y
, 
__x
,

824 
__v®ue
;

825 
__asm
 
__vŞ©e__
 ("fpatan\n\t"

826 : "ñ" (
__v®ue
)

827 : "0" (
__x
), "u" (
__y
) : "st(1)");

828  
__v®ue
;)

	@/usr/include/bits/mman.h

19 #iâdeà
_SYS_MMAN_H


27 #ifdeà
__USE_MISC


28 
	#MAP_32BIT
 0x40

	)

32 #ifdeà
__USE_MISC


33 
	#MAP_GROWSDOWN
 0x00100

	)

34 
	#MAP_DENYWRITE
 0x00800

	)

35 
	#MAP_EXECUTABLE
 0x01000

	)

36 
	#MAP_LOCKED
 0x02000

	)

37 
	#MAP_NORESERVE
 0x04000

	)

38 
	#MAP_POPULATE
 0x08000

	)

39 
	#MAP_NONBLOCK
 0x10000

	)

40 
	#MAP_STACK
 0x20000

	)

41 
	#MAP_HUGETLB
 0x40000

	)

45 
	~<b™s/mmª-lšux.h
>

	@/usr/include/bits/posix1_lim.h

24 #iâdef 
_BITS_POSIX1_LIM_H


25 
	#_BITS_POSIX1_LIM_H
 1

	)

31 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

34 
	#_POSIX_AIO_MAX
 1

	)

37 
	#_POSIX_ARG_MAX
 4096

	)

40 #ifdeà
__USE_XOPEN2K


41 
	#_POSIX_CHILD_MAX
 25

	)

43 
	#_POSIX_CHILD_MAX
 6

	)

47 
	#_POSIX_DELAYTIMER_MAX
 32

	)

51 
	#_POSIX_HOST_NAME_MAX
 255

	)

54 
	#_POSIX_LINK_MAX
 8

	)

57 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

60 
	#_POSIX_MAX_CANON
 255

	)

64 
	#_POSIX_MAX_INPUT
 255

	)

67 
	#_POSIX_MQ_OPEN_MAX
 8

	)

70 
	#_POSIX_MQ_PRIO_MAX
 32

	)

73 
	#_POSIX_NAME_MAX
 14

	)

76 #ifdeà
__USE_XOPEN2K


77 
	#_POSIX_NGROUPS_MAX
 8

	)

79 
	#_POSIX_NGROUPS_MAX
 0

	)

83 #ifdeà
__USE_XOPEN2K


84 
	#_POSIX_OPEN_MAX
 20

	)

86 
	#_POSIX_OPEN_MAX
 16

	)

89 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

96 
	#_POSIX_PATH_MAX
 256

	)

99 
	#_POSIX_PIPE_BUF
 512

	)

103 
	#_POSIX_RE_DUP_MAX
 255

	)

106 
	#_POSIX_RTSIG_MAX
 8

	)

109 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

112 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

115 
	#_POSIX_SIGQUEUE_MAX
 32

	)

118 
	#_POSIX_SSIZE_MAX
 32767

	)

121 
	#_POSIX_STREAM_MAX
 8

	)

124 
	#_POSIX_SYMLINK_MAX
 255

	)

128 
	#_POSIX_SYMLOOP_MAX
 8

	)

131 
	#_POSIX_TIMER_MAX
 32

	)

134 
	#_POSIX_TTY_NAME_MAX
 9

	)

137 #ifdeà
__USE_XOPEN2K


138 
	#_POSIX_TZNAME_MAX
 6

	)

140 
	#_POSIX_TZNAME_MAX
 3

	)

143 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


145 
	#_POSIX_QLIMIT
 1

	)

149 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

152 
	#_POSIX_UIO_MAXIOV
 16

	)

156 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

160 
	~<b™s/loÿl_lim.h
>

163 #iâdef 
SSIZE_MAX


164 
	#SSIZE_MAX
 
LONG_MAX


	)

171 #iâdef 
NGROUPS_MAX


172 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix_opt.h

19 #iâdef 
_BITS_POSIX_OPT_H


20 
	#_BITS_POSIX_OPT_H
 1

	)

23 
	#_POSIX_JOB_CONTROL
 1

	)

26 
	#_POSIX_SAVED_IDS
 1

	)

29 
	#_POSIX_PRIORITY_SCHEDULING
 200809L

	)

32 
	#_POSIX_SYNCHRONIZED_IO
 200809L

	)

35 
	#_POSIX_FSYNC
 200809L

	)

38 
	#_POSIX_MAPPED_FILES
 200809L

	)

41 
	#_POSIX_MEMLOCK
 200809L

	)

44 
	#_POSIX_MEMLOCK_RANGE
 200809L

	)

47 
	#_POSIX_MEMORY_PROTECTION
 200809L

	)

50 
	#_POSIX_CHOWN_RESTRICTED
 0

	)

54 
	#_POSIX_VDISABLE
 '\0'

	)

57 
	#_POSIX_NO_TRUNC
 1

	)

60 
	#_XOPEN_REALTIME
 1

	)

63 
	#_XOPEN_REALTIME_THREADS
 1

	)

66 
	#_XOPEN_SHM
 1

	)

69 
	#_POSIX_THREADS
 200809L

	)

72 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

73 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200809L

	)

76 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200809L

	)

79 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200809L

	)

82 
	#_POSIX_THREAD_ATTR_STACKADDR
 200809L

	)

85 
	#_POSIX_THREAD_PRIO_INHERIT
 200809L

	)

89 
	#_POSIX_THREAD_PRIO_PROTECT
 200809L

	)

91 #ifdeà
__USE_XOPEN2K8


93 
	#_POSIX_THREAD_ROBUST_PRIO_INHERIT
 200809L

	)

96 
	#_POSIX_THREAD_ROBUST_PRIO_PROTECT
 -1

	)

100 
	#_POSIX_SEMAPHORES
 200809L

	)

103 
	#_POSIX_REALTIME_SIGNALS
 200809L

	)

106 
	#_POSIX_ASYNCHRONOUS_IO
 200809L

	)

107 
	#_POSIX_ASYNC_IO
 1

	)

109 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

111 
	#_POSIX_PRIORITIZED_IO
 200809L

	)

114 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

117 
	#_LFS_LARGEFILE
 1

	)

118 
	#_LFS64_LARGEFILE
 1

	)

119 
	#_LFS64_STDIO
 1

	)

122 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200809L

	)

125 
	#_POSIX_CPUTIME
 0

	)

128 
	#_POSIX_THREAD_CPUTIME
 0

	)

131 
	#_POSIX_REGEXP
 1

	)

134 
	#_POSIX_READER_WRITER_LOCKS
 200809L

	)

137 
	#_POSIX_SHELL
 1

	)

140 
	#_POSIX_TIMEOUTS
 200809L

	)

143 
	#_POSIX_SPIN_LOCKS
 200809L

	)

146 
	#_POSIX_SPAWN
 200809L

	)

149 
	#_POSIX_TIMERS
 200809L

	)

152 
	#_POSIX_BARRIERS
 200809L

	)

155 
	#_POSIX_MESSAGE_PASSING
 200809L

	)

158 
	#_POSIX_THREAD_PROCESS_SHARED
 200809L

	)

161 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

164 
	#_POSIX_CLOCK_SELECTION
 200809L

	)

167 
	#_POSIX_ADVISORY_INFO
 200809L

	)

170 
	#_POSIX_IPV6
 200809L

	)

173 
	#_POSIX_RAW_SOCKETS
 200809L

	)

176 
	#_POSIX2_CHAR_TERM
 200809L

	)

179 
	#_POSIX_SPORADIC_SERVER
 -1

	)

180 
	#_POSIX_THREAD_SPORADIC_SERVER
 -1

	)

183 
	#_POSIX_TRACE
 -1

	)

184 
	#_POSIX_TRACE_EVENT_FILTER
 -1

	)

185 
	#_POSIX_TRACE_INHERIT
 -1

	)

186 
	#_POSIX_TRACE_LOG
 -1

	)

189 
	#_POSIX_TYPED_MEMORY_OBJECTS
 -1

	)

	@/usr/include/bits/pthreadtypes.h

19 #iâdeà
_BITS_PTHREADTYPES_COMMON_H


20 
	#_BITS_PTHREADTYPES_COMMON_H
 1

	)

23 
	~<b™s/th»ad-sh¬ed-ty³s.h
>

27 
	t±h»ad_t
;

34 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

35 
	m__®ign
;

36 } 
	t±h»ad_mu‹x©Œ_t
;

43 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

44 
	m__®ign
;

45 } 
	t±h»ad_cÚd©Œ_t
;

49 
	t±h»ad_key_t
;

53 
	t__ONCE_ALIGNMENT
 
	t±h»ad_Úû_t
;

56 
	u±h»ad_©Œ_t


58 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

59 
	m__®ign
;

61 #iâdeà
__have_±h»ad_©Œ_t


62 
±h»ad_©Œ_t
 
	t±h»ad_©Œ_t
;

63 
	#__have_±h»ad_©Œ_t
 1

	)

69 
__±h»ad_mu‹x_s
 
	m__d©a
;

70 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

71 
	m__®ign
;

72 } 
	t±h»ad_mu‹x_t
;

77 
__±h»ad_cÚd_s
 
	m__d©a
;

78 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

79 
__ex‹nsiÚ__
 
	m__®ign
;

80 } 
	t±h»ad_cÚd_t
;

83 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


88 
__±h»ad_rwlock_¬ch_t
 
	m__d©a
;

89 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

90 
	m__®ign
;

91 } 
	t±h»ad_rwlock_t
;

95 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

96 
	m__®ign
;

97 } 
	t±h»ad_rwlock©Œ_t
;

101 #ifdeà
__USE_XOPEN2K


103 vŞ©
	t±h»ad_¥šlock_t
;

110 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

111 
	m__®ign
;

112 } 
	t±h»ad_b¬r›r_t
;

116 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

117 
	m__®ign
;

118 } 
	t±h»ad_b¬r›¿‰r_t
;

	@/usr/include/bits/resource.h

19 #iâdeà
_SYS_RESOURCE_H


23 
	~<b™s/ty³s.h
>

31 
	e__¾im™_»sourû


34 
	mRLIMIT_CPU
 = 0,

35 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

38 
	mRLIMIT_FSIZE
 = 1,

39 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

42 
	mRLIMIT_DATA
 = 2,

43 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

46 
	mRLIMIT_STACK
 = 3,

47 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

50 
	mRLIMIT_CORE
 = 4,

51 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

57 
	m__RLIMIT_RSS
 = 5,

58 
	#RLIMIT_RSS
 
__RLIMIT_RSS


	)

61 
	mRLIMIT_NOFILE
 = 7,

62 
	m__RLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

63 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

64 
	#RLIMIT_OFILE
 
__RLIMIT_OFILE


	)

67 
	mRLIMIT_AS
 = 9,

68 
	#RLIMIT_AS
 
RLIMIT_AS


	)

71 
	m__RLIMIT_NPROC
 = 6,

72 
	#RLIMIT_NPROC
 
__RLIMIT_NPROC


	)

75 
	m__RLIMIT_MEMLOCK
 = 8,

76 
	#RLIMIT_MEMLOCK
 
__RLIMIT_MEMLOCK


	)

79 
	m__RLIMIT_LOCKS
 = 10,

80 
	#RLIMIT_LOCKS
 
__RLIMIT_LOCKS


	)

83 
	m__RLIMIT_SIGPENDING
 = 11,

84 
	#RLIMIT_SIGPENDING
 
__RLIMIT_SIGPENDING


	)

87 
	m__RLIMIT_MSGQUEUE
 = 12,

88 
	#RLIMIT_MSGQUEUE
 
__RLIMIT_MSGQUEUE


	)

93 
	m__RLIMIT_NICE
 = 13,

94 
	#RLIMIT_NICE
 
__RLIMIT_NICE


	)

98 
	m__RLIMIT_RTPRIO
 = 14,

99 
	#RLIMIT_RTPRIO
 
__RLIMIT_RTPRIO


	)

104 
	m__RLIMIT_RTTIME
 = 15,

105 
	#RLIMIT_RTTIME
 
__RLIMIT_RTTIME


	)

107 
	m__RLIMIT_NLIMITS
 = 16,

108 
	m__RLIM_NLIMITS
 = 
__RLIMIT_NLIMITS


109 
	#RLIMIT_NLIMITS
 
__RLIMIT_NLIMITS


	)

110 
	#RLIM_NLIMITS
 
__RLIM_NLIMITS


	)

114 #iâdeà
__USE_FILE_OFFSET64


115 
	#RLIM_INFINITY
 ((
__¾im_t
è-1)

	)

117 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

120 #ifdeà
__USE_LARGEFILE64


121 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

125 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

126 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

130 #iâdeà
__USE_FILE_OFFSET64


131 
__¾im_t
 
	t¾im_t
;

133 
__¾im64_t
 
	t¾im_t
;

135 #ifdeà
__USE_LARGEFILE64


136 
__¾im64_t
 
	t¾im64_t
;

139 
	s¾im™


142 
¾im_t
 
	m¾im_cur
;

144 
¾im_t
 
	m¾im_max
;

147 #ifdeà
__USE_LARGEFILE64


148 
	s¾im™64


151 
¾im64_t
 
	m¾im_cur
;

153 
¾im64_t
 
	m¾im_max
;

158 
	e__ru§ge_who


161 
	mRUSAGE_SELF
 = 0,

162 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

165 
	mRUSAGE_CHILDREN
 = -1

166 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

168 #ifdeà
__USE_GNU


171 
	mRUSAGE_THREAD
 = 1

172 
	#RUSAGE_THREAD
 
RUSAGE_THREAD


	)

174 
	#RUSAGE_LWP
 
RUSAGE_THREAD


	)

178 
	~<b™s/ty³s/¡ruù_timev®.h
>

179 
	~<b™s/ty³s/¡ruù_ru§ge.h
>

182 
	#PRIO_MIN
 -20

	)

183 
	#PRIO_MAX
 20

	)

187 
	e__´iÜ™y_which


189 
	mPRIO_PROCESS
 = 0,

190 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

191 
	mPRIO_PGRP
 = 1,

192 
	#PRIO_PGRP
 
PRIO_PGRP


	)

193 
	mPRIO_USER
 = 2

194 
	#PRIO_USER
 
PRIO_USER


	)

198 
	g__BEGIN_DECLS


200 #ifdeà
__USE_GNU


202 #iâdeà
__USE_FILE_OFFSET64


203 
	$´lim™
 (
__pid_t
 
__pid
, 
__¾im™_»sourû
 
__»sourû
,

204 cÚ¡ 
¾im™
 *
__Ãw_lim™
,

205 
¾im™
 *
__Şd_lim™
è
__THROW
;

207 #ifdeà
__REDIRECT_NTH


208 
	`__REDIRECT_NTH
 (
´lim™
, (
__pid_t
 
__pid
,

209 
__¾im™_»sourû
 
__»sourû
,

210 cÚ¡ 
¾im™
 *
__Ãw_lim™
,

211 
¾im™
 *
__Şd_lim™
), 
´lim™64
);

213 
	#´lim™
 
´lim™64


	)

216 #ifdeà
__USE_LARGEFILE64


217 
	$´lim™64
 (
__pid_t
 
__pid
, 
__¾im™_»sourû
 
__»sourû
,

218 cÚ¡ 
¾im™64
 *
__Ãw_lim™
,

219 
¾im™64
 *
__Şd_lim™
è
__THROW
;

223 
__END_DECLS


	@/usr/include/bits/setjmp.h

19 #iâdeà
_BITS_SETJMP_H


20 
	#_BITS_SETJMP_H
 1

	)

22 #ià!
defšed
 
_SETJMP_H
 && !defšed 
_PTHREAD_H


26 
	~<b™s/wÜdsize.h
>

28 #iâdeà
_ASM


30 #ià
__WORDSIZE
 == 64

31 
	t__jmp_buf
[8];

32 #–ià
defšed
 
__x86_64__


33 
__ex‹nsiÚ__
 
	t__jmp_buf
[8];

35 
	t__jmp_buf
[6];

	@/usr/include/bits/stat.h

18 #ià!
defšed
 
_SYS_STAT_H
 && !defšed 
_FCNTL_H


22 #iâdeà
_BITS_STAT_H


23 
	#_BITS_STAT_H
 1

	)

26 #iâdeà
__x86_64__


27 
	#_STAT_VER_LINUX_OLD
 1

	)

28 
	#_STAT_VER_KERNEL
 1

	)

29 
	#_STAT_VER_SVR4
 2

	)

30 
	#_STAT_VER_LINUX
 3

	)

33 
	#_MKNOD_VER_LINUX
 1

	)

34 
	#_MKNOD_VER_SVR4
 2

	)

35 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

37 
	#_STAT_VER_KERNEL
 0

	)

38 
	#_STAT_VER_LINUX
 1

	)

41 
	#_MKNOD_VER_LINUX
 0

	)

44 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

46 
	s¡©


48 
__dev_t
 
	m¡_dev
;

49 #iâdeà
__x86_64__


50 
	m__·d1
;

52 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


53 
__šo_t
 
	m¡_šo
;

55 
__šo_t
 
	m__¡_šo
;

57 #iâdeà
__x86_64__


58 
__mode_t
 
	m¡_mode
;

59 
__Æšk_t
 
	m¡_Æšk
;

61 
__Æšk_t
 
	m¡_Æšk
;

62 
__mode_t
 
	m¡_mode
;

64 
__uid_t
 
	m¡_uid
;

65 
__gid_t
 
	m¡_gid
;

66 #ifdeà
__x86_64__


67 
	m__·d0
;

69 
__dev_t
 
	m¡_rdev
;

70 #iâdeà
__x86_64__


71 
	m__·d2
;

73 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


74 
__off_t
 
	m¡_size
;

76 
__off64_t
 
	m¡_size
;

78 
__blksize_t
 
	m¡_blksize
;

79 #ià
defšed
 
__x86_64__
 || !defšed 
__USE_FILE_OFFSET64


80 
__blkút_t
 
	m¡_blocks
;

82 
__blkút64_t
 
	m¡_blocks
;

84 #ifdeà
__USE_XOPEN2K8


91 
time¥ec
 
	m¡_©im
;

92 
time¥ec
 
	m¡_mtim
;

93 
time¥ec
 
	m¡_ùim
;

94 
	#¡_©ime
 
¡_©im
.
tv_£c


	)

95 
	#¡_mtime
 
¡_mtim
.
tv_£c


	)

96 
	#¡_ùime
 
¡_ùim
.
tv_£c


	)

98 
__time_t
 
	m¡_©ime
;

99 
__sysÿÎ_ulÚg_t
 
	m¡_©im’£c
;

100 
__time_t
 
	m¡_mtime
;

101 
__sysÿÎ_ulÚg_t
 
	m¡_mtim’£c
;

102 
__time_t
 
	m¡_ùime
;

103 
__sysÿÎ_ulÚg_t
 
	m¡_ùim’£c
;

105 #ifdeà
__x86_64__


106 
__sysÿÎ_¦Úg_t
 
	m__glibc_»£rved
[3];

108 #iâdeà
__USE_FILE_OFFSET64


109 
	m__glibc_»£rved4
;

110 
	m__glibc_»£rved5
;

112 
__šo64_t
 
	m¡_šo
;

117 #ifdeà
__USE_LARGEFILE64


119 
	s¡©64


121 
__dev_t
 
	m¡_dev
;

122 #ifdeà
__x86_64__


123 
__šo64_t
 
	m¡_šo
;

124 
__Æšk_t
 
	m¡_Æšk
;

125 
__mode_t
 
	m¡_mode
;

127 
	m__·d1
;

128 
__šo_t
 
	m__¡_šo
;

129 
__mode_t
 
	m¡_mode
;

130 
__Æšk_t
 
	m¡_Æšk
;

132 
__uid_t
 
	m¡_uid
;

133 
__gid_t
 
	m¡_gid
;

134 #ifdeà
__x86_64__


135 
	m__·d0
;

136 
__dev_t
 
	m¡_rdev
;

137 
__off_t
 
	m¡_size
;

139 
__dev_t
 
	m¡_rdev
;

140 
	m__·d2
;

141 
__off64_t
 
	m¡_size
;

143 
__blksize_t
 
	m¡_blksize
;

144 
__blkút64_t
 
	m¡_blocks
;

145 #ifdeà
__USE_XOPEN2K8


152 
time¥ec
 
	m¡_©im
;

153 
time¥ec
 
	m¡_mtim
;

154 
time¥ec
 
	m¡_ùim
;

156 
__time_t
 
	m¡_©ime
;

157 
__sysÿÎ_ulÚg_t
 
	m¡_©im’£c
;

158 
__time_t
 
	m¡_mtime
;

159 
__sysÿÎ_ulÚg_t
 
	m¡_mtim’£c
;

160 
__time_t
 
	m¡_ùime
;

161 
__sysÿÎ_ulÚg_t
 
	m¡_ùim’£c
;

163 #ifdeà
__x86_64__


164 
__sysÿÎ_¦Úg_t
 
	m__glibc_»£rved
[3];

166 
__šo64_t
 
	m¡_šo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
è((buf)->
¡_mode
 - (buf)->¡_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ifdeà
__USE_ATFILE


206 
	#UTIME_NOW
 ((1È<< 30è- 1l)

	)

207 
	#UTIME_OMIT
 ((1È<< 30è- 2l)

	)

	@/usr/include/bits/stdint-intn.h

19 #iâdeà
_BITS_STDINT_INTN_H


20 
	#_BITS_STDINT_INTN_H
 1

	)

22 
	~<b™s/ty³s.h
>

24 
__št8_t
 
	tšt8_t
;

25 
__št16_t
 
	tšt16_t
;

26 
__št32_t
 
	tšt32_t
;

27 
__št64_t
 
	tšt64_t
;

	@/usr/include/bits/stdint-uintn.h

19 #iâdeà
_BITS_STDINT_UINTN_H


20 
	#_BITS_STDINT_UINTN_H
 1

	)

22 
	~<b™s/ty³s.h
>

24 
__ušt8_t
 
	tušt8_t
;

25 
__ušt16_t
 
	tušt16_t
;

26 
__ušt32_t
 
	tušt32_t
;

27 
__ušt64_t
 
	tušt64_t
;

	@/usr/include/bits/stdio-ldbl.h

19 #iâdeà
_STDIO_H


23 
	$__LDBL_REDIR_DECL
 (
årštf
)

24 
	$__LDBL_REDIR_DECL
 (
´štf
)

25 
	$__LDBL_REDIR_DECL
 (
¥rštf
)

26 
	$__LDBL_REDIR_DECL
 (
vårštf
)

27 
	$__LDBL_REDIR_DECL
 (
v´štf
)

28 
	$__LDBL_REDIR_DECL
 (
v¥rštf
)

29 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

30 && !
defšed
 
__REDIRECT
 \

31 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

32 
	$__LDBL_REDIR1_DECL
 (
fsÿnf
, 
__Ædbl___isoc99_fsÿnf
)

33 
	$__LDBL_REDIR1_DECL
 (
sÿnf
, 
__Ædbl___isoc99_sÿnf
)

34 
	$__LDBL_REDIR1_DECL
 (
ssÿnf
, 
__Ædbl___isoc99_ssÿnf
)

36 
	$__LDBL_REDIR_DECL
 (
fsÿnf
)

37 
	$__LDBL_REDIR_DECL
 (
sÿnf
)

38 
	$__LDBL_REDIR_DECL
 (
ssÿnf
)

41 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


42 
	$__LDBL_REDIR_DECL
 (
¢´štf
)

43 
	$__LDBL_REDIR_DECL
 (
v¢´štf
)

46 #ifdef 
__USE_ISOC99


47 #ià!
defšed
 
__USE_GNU
 && !defšed 
__REDIRECT
 \

48 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

49 
	$__LDBL_REDIR1_DECL
 (
vfsÿnf
, 
__Ædbl___isoc99_vfsÿnf
)

50 
	$__LDBL_REDIR1_DECL
 (
vsÿnf
, 
__Ædbl___isoc99_vsÿnf
)

51 
	$__LDBL_REDIR1_DECL
 (
vssÿnf
, 
__Ædbl___isoc99_vssÿnf
)

53 
	$__LDBL_REDIR_DECL
 (
vfsÿnf
)

54 
	$__LDBL_REDIR_DECL
 (
vssÿnf
)

55 
	$__LDBL_REDIR_DECL
 (
vsÿnf
)

59 #ifdeà
__USE_XOPEN2K8


60 
	$__LDBL_REDIR_DECL
 (
vd´štf
)

61 
	$__LDBL_REDIR_DECL
 (
d´štf
)

64 #ifdeà
__USE_GNU


65 
	$__LDBL_REDIR_DECL
 (
va¥rštf
)

66 
	$__LDBL_REDIR_DECL
 (
__a¥rštf
)

67 
	$__LDBL_REDIR_DECL
 (
a¥rštf
)

68 
	$__LDBL_REDIR_DECL
 (
ob¡ack_´štf
)

69 
	$__LDBL_REDIR_DECL
 (
ob¡ack_v´štf
)

72 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


73 
	$__LDBL_REDIR_DECL
 (
__¥rštf_chk
)

74 
	$__LDBL_REDIR_DECL
 (
__v¥rštf_chk
)

75 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


76 
	$__LDBL_REDIR_DECL
 (
__¢´štf_chk
)

77 
	$__LDBL_REDIR_DECL
 (
__v¢´štf_chk
)

79 #ià
__USE_FORTIFY_LEVEL
 > 1

80 
	$__LDBL_REDIR_DECL
 (
__årštf_chk
)

81 
	$__LDBL_REDIR_DECL
 (
__´štf_chk
)

82 
	$__LDBL_REDIR_DECL
 (
__vårštf_chk
)

83 
	$__LDBL_REDIR_DECL
 (
__v´štf_chk
)

84 #ifdeà
__USE_XOPEN2K8


85 
	$__LDBL_REDIR_DECL
 (
__d´štf_chk
)

86 
	$__LDBL_REDIR_DECL
 (
__vd´štf_chk
)

88 #ifdeà
__USE_GNU


89 
	$__LDBL_REDIR_DECL
 (
__a¥rštf_chk
)

90 
	$__LDBL_REDIR_DECL
 (
__va¥rštf_chk
)

91 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_´štf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__ob¡ack_v´štf_chk
)

	@/usr/include/bits/stdio.h

19 #iâdeà
_STDIO_H


23 #iâdeà
__ex‹º_šlše


24 
	#__STDIO_INLINE
 
šlše


	)

26 
	#__STDIO_INLINE
 
__ex‹º_šlše


	)

30 #ifdeà
__USE_EXTERN_INLINES


33 #ià!(
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
)

35 
__STDIO_INLINE
 

36 
	$v´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

38  
	`vårštf
 (
¡dout
, 
__fmt
, 
__¬g
);

39 
	}
}

43 
__STDIO_INLINE
 

44 
	$g‘ch¬
 ()

46  
	`_IO_g‘c
 (
¡dš
);

47 
	}
}

50 #ifdeà
__USE_MISC


52 
__STDIO_INLINE
 

53 
	$fg‘c_uÆocked
 (
FILE
 *
__å
)

55  
	`_IO_g‘c_uÆocked
 (
__å
);

56 
	}
}

60 #ifdeà
__USE_POSIX


62 
__STDIO_INLINE
 

63 
	$g‘c_uÆocked
 (
FILE
 *
__å
)

65  
	`_IO_g‘c_uÆocked
 (
__å
);

66 
	}
}

69 
__STDIO_INLINE
 

70 
	$g‘ch¬_uÆocked
 ()

72  
	`_IO_g‘c_uÆocked
 (
¡dš
);

73 
	}
}

78 
__STDIO_INLINE
 

79 
	$putch¬
 (
__c
)

81  
	`_IO_putc
 (
__c
, 
¡dout
);

82 
	}
}

85 #ifdeà
__USE_MISC


87 
__STDIO_INLINE
 

88 
	$åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

90  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

91 
	}
}

95 #ifdeà
__USE_POSIX


97 
__STDIO_INLINE
 

98 
	$putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
)

100  
	`_IO_putc_uÆocked
 (
__c
, 
__¡»am
);

101 
	}
}

104 
__STDIO_INLINE
 

105 
	$putch¬_uÆocked
 (
__c
)

107  
	`_IO_putc_uÆocked
 (
__c
, 
¡dout
);

108 
	}
}

112 #ifdef 
__USE_GNU


114 
__STDIO_INLINE
 
_IO_ssize_t


115 
	$g‘lše
 (**
__lš•Œ
, 
size_t
 *
__n
, 
FILE
 *
__¡»am
)

117  
	`__g‘d–im
 (
__lš•Œ
, 
__n
, '\n', 
__¡»am
);

118 
	}
}

122 #ifdeà
__USE_MISC


124 
__STDIO_INLINE
 

125 
__NTH
 (
	$ãof_uÆocked
 (
FILE
 *
__¡»am
))

127  
	`_IO_ãof_uÆocked
 (
__¡»am
);

128 
	}
}

131 
__STDIO_INLINE
 

132 
__NTH
 (
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
))

134  
	`_IO_ã¼Ü_uÆocked
 (
__¡»am
);

135 
	}
}

141 #ià
defšed
 
__USE_MISC
 && defšed 
__GNUC__
 && defšed 
__OPTIMIZE__
 \

142 && !
defšed
 
	g__ılu¥lus


144 
	#ä—d_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

145 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

146 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

147 && (
size_t
è(
size
) != 0) \

148 ? ({ *
__±r
 = (*è(
±r
); \

149 
FILE
 *
__¡»am
 = (
¡»am
); \

150 
size_t
 
__út
; \

151 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

152 
__út
 > 0; --__cnt) \

154 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
); \

155 ià(
__c
 =ğ
EOF
) \

157 *
__±r
++ = 
__c
; \

159 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

160 / (
size_t
è(
size
); }) \

161 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

162 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

164 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

165 (è(
n
), (
size_t
) 0) \

166 : 
	`ä—d_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

168 
	#fwr™e_uÆocked
(
±r
, 
size
, 
n
, 
¡»am
) \

169 (
	`__ex‹nsiÚ__
 ((
	`__butš_cÚ¡ªt_p
 (
size
è&& __butš_cÚ¡ªt_°(
n
) \

170 && (
size_t
è(
size
è* (size_tè(
n
) <= 8 \

171 && (
size_t
è(
size
) != 0) \

172 ? ({ cÚ¡ *
__±r
 = (cÚ¡ *è(
±r
); \

173 
FILE
 *
__¡»am
 = (
¡»am
); \

174 
size_t
 
__út
; \

175 
__út
 = (
size_t
è(
size
è* (size_tè(
n
); \

176 
__út
 > 0; --__cnt) \

177 ià(
	`_IO_putc_uÆocked
 (*
__±r
++, 
__¡»am
è=ğ
EOF
) \

179 ((
size_t
è(
size
è* (size_tè(
n
è- 
__út
) \

180 / (
size_t
è(
size
); }) \

181 : (((
	`__butš_cÚ¡ªt_p
 (
size
è&& (
size_t
) (size) == 0) \

182 || (
	`__butš_cÚ¡ªt_p
 (
n
è&& (
size_t
) (n) == 0)) \

184 ? ((è(
±r
), (è(
¡»am
), (è(
size
), \

185 (è(
n
), (
size_t
) 0) \

186 : 
	`fwr™e_uÆocked
 (
±r
, 
size
, 
n
, 
¡»am
))))

	)

190 #undeà
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

19 #iâdeà
_STDIO_H


23 
	$__¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

24 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

25 
	$__v¥rštf_chk
 (*
__»¡riù
 
__s
, 
__æag
, 
size_t
 
__¦’
,

26 cÚ¡ *
__»¡riù
 
__fÜm©
,

27 
_G_va_li¡
 
__­
è
__THROW
;

29 #ifdeà
__va_¬g_·ck


30 
__fÜtify_funùiÚ
 

31 
	`__NTH
 (
	$¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fmt
, ...))

33  
	`__butš___¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

34 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

35 
	}
}

36 #–ià!
defšed
 
__ılu¥lus


37 
	#¥rštf
(
¡r
, ...) \

38 
	`__butš___¥rštf_chk
 (
¡r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

39 
__VA_ARGS__
)

	)

42 
__fÜtify_funùiÚ
 

43 
__NTH
 (
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fmt
,

44 
_G_va_li¡
 
__­
))

46  
	`__butš___v¥rštf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

47 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

48 
	}
}

50 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


52 
	$__¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

53 
size_t
 
__¦’
, cÚ¡ *
__»¡riù
 
__fÜm©
,

54 ...è
__THROW
;

55 
	$__v¢´štf_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__n
, 
__æag
,

56 
size_t
 
__¦’
, cÚ¡ *
__»¡riù
 
__fÜm©
,

57 
_G_va_li¡
 
__­
è
__THROW
;

59 #ifdeà
__va_¬g_·ck


60 
__fÜtify_funùiÚ
 

61 
	`__NTH
 (
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

62 cÚ¡ *
__»¡riù
 
__fmt
, ...))

64  
	`__butš___¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

65 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¬g_·ck
 ());

66 
	}
}

67 #–ià!
defšed
 
__ılu¥lus


68 
	#¢´štf
(
¡r
, 
Ën
, ...) \

69 
	`__butš___¢´štf_chk
 (
¡r
, 
Ën
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

70 
__VA_ARGS__
)

	)

73 
__fÜtify_funùiÚ
 

74 
__NTH
 (
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__n
,

75 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

77  
	`__butš___v¢´štf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

78 
	`__bos
 (
__s
), 
__fmt
, 
__­
);

79 
	}
}

83 #ià
__USE_FORTIFY_LEVEL
 > 1

85 
__årštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

86 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

87 
__´štf_chk
 (
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

88 
__vårštf_chk
 (
FILE
 *
__»¡riù
 
__¡»am
, 
__æag
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__­
);

90 
__v´štf_chk
 (
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
,

91 
_G_va_li¡
 
__­
);

93 #ifdeà
__va_¬g_·ck


94 
__fÜtify_funùiÚ
 

95 
	$årštf
 (
FILE
 *
__»¡riù
 
__¡»am
, cÚ¡ *__»¡riù 
__fmt
, ...)

97  
	`__årštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

98 
	`__va_¬g_·ck
 ());

99 
	}
}

101 
__fÜtify_funùiÚ
 

102 
	$´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, ...)

104  
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¬g_·ck
 ());

105 
	}
}

106 #–ià!
defšed
 
__ılu¥lus


107 
	#´štf
(...) \

108 
	`__´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

109 
	#årštf
(
¡»am
, ...) \

110 
	`__årštf_chk
 (
¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

113 
__fÜtify_funùiÚ
 

114 
	$v´štf
 (cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

116 #ifdeà
__USE_EXTERN_INLINES


117  
	`__vårštf_chk
 (
¡dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

119  
	`__v´štf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

121 
	}
}

123 
__fÜtify_funùiÚ
 

124 
	$vårštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

125 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

127  
	`__vårštf_chk
 (
__¡»am
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

128 
	}
}

130 #ifdeà
__USE_XOPEN2K8


131 
	$__d´štf_chk
 (
__fd
, 
__æag
, cÚ¡ *
__»¡riù
 
__fmt
,

132 ...è
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

133 
	$__vd´štf_chk
 (
__fd
, 
__æag
,

134 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

135 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

137 #ifdeà
__va_¬g_·ck


138 
__fÜtify_funùiÚ
 

139 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

141  
	`__d´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

142 
	`__va_¬g_·ck
 ());

143 
	}
}

144 #–ià!
defšed
 
__ılu¥lus


145 
	#d´štf
(
fd
, ...) \

146 
	`__d´štf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

149 
__fÜtify_funùiÚ
 

150 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
)

152  
	`__vd´štf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

153 
	}
}

156 #ifdeà
__USE_GNU


158 
	$__a¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

159 cÚ¡ *
__»¡riù
 
__fmt
, ...)

160 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 4))è
__wur
;

161 
	$__va¥rštf_chk
 (**
__»¡riù
 
__±r
, 
__æag
,

162 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__¬g
)

163 
__THROW
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 3, 0))è
__wur
;

164 
	$__ob¡ack_´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

165 
__æag
, cÚ¡ *
__»¡riù
 
__fÜm©
,

167 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

168 
	$__ob¡ack_v´štf_chk
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

169 
__æag
,

170 cÚ¡ *
__»¡riù
 
__fÜm©
,

171 
_G_va_li¡
 
__¬gs
)

172 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

174 #ifdeà
__va_¬g_·ck


175 
__fÜtify_funùiÚ
 

176 
	`__NTH
 (
	$a¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
, ...))

178  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

179 
	`__va_¬g_·ck
 ());

180 
	}
}

182 
__fÜtify_funùiÚ
 

183 
__NTH
 (
	$__a¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
,

186  
	`__a¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

187 
	`__va_¬g_·ck
 ());

188 
	}
}

190 
__fÜtify_funùiÚ
 

191 
__NTH
 (
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

192 cÚ¡ *
__»¡riù
 
__fmt
, ...))

194  
	`__ob¡ack_´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

195 
	`__va_¬g_·ck
 ());

196 
	}
}

197 #–ià!
defšed
 
__ılu¥lus


198 
	#a¥rštf
(
±r
, ...) \

199 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

200 
	#__a¥rštf
(
±r
, ...) \

201 
	`__a¥rštf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

202 
	#ob¡ack_´štf
(
ob¡ack
, ...) \

203 
	`__ob¡ack_´štf_chk
 (
ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

206 
__fÜtify_funùiÚ
 

207 
__NTH
 (
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__fmt
,

208 
_G_va_li¡
 
__­
))

210  
	`__va¥rštf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__­
);

211 
	}
}

213 
__fÜtify_funùiÚ
 

214 
__NTH
 (
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

215 cÚ¡ *
__»¡riù
 
__fmt
, 
_G_va_li¡
 
__­
))

217  
	`__ob¡ack_v´štf_chk
 (
__ob¡ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

218 
__­
);

219 
	}
}

225 #ià
__GLIBC_USE
 (
DEPRECATED_GETS
)

226 *
	$__g‘s_chk
 (*
__¡r
, 
size_t
è
__wur
;

227 *
	`__REDIRECT
 (
__g‘s_w¬n
, (*
__¡r
), 
g‘s
)

228 
__wur
 
	`__w¬Ç‰r
 ("please use fgets or getline instead, gets can't "

231 
__fÜtify_funùiÚ
 
__wur
 *

232 
	$g‘s
 (*
__¡r
)

234 ià(
	`__bos
 (
__¡r
è!ğ(
size_t
) -1)

235  
	`__g‘s_chk
 (
__¡r
, 
	`__bos
 (__str));

236  
	`__g‘s_w¬n
 (
__¡r
);

237 
	}
}

240 *
	$__fg‘s_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

241 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

242 *
	`__REDIRECT
 (
__fg‘s_®Ÿs
,

243 (*
__»¡riù
 
__s
, 
__n
,

244 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s
è
__wur
;

245 *
	`__REDIRECT
 (
__fg‘s_chk_w¬n
,

246 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

247 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_chk
)

248 
__wur
 
	`__w¬Ç‰r
 ("fgets called with bigger sizehan†ength "

251 
__fÜtify_funùiÚ
 
__wur
 *

252 
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

254 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

256 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

257  
	`__fg‘s_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

259 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

260  
	`__fg‘s_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

262  
	`__fg‘s_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

263 
	}
}

265 
size_t
 
	$__ä—d_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

266 
size_t
 
__size
, size_ˆ
__n
,

267 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

268 
size_t
 
	`__REDIRECT
 (
__ä—d_®Ÿs
,

269 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

270 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

271 
ä—d
è
__wur
;

272 
size_t
 
	`__REDIRECT
 (
__ä—d_chk_w¬n
,

273 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

274 
size_t
 
__size
, size_ˆ
__n
,

275 
FILE
 *
__»¡riù
 
__¡»am
),

276 
__ä—d_chk
)

277 
__wur
 
	`__w¬Ç‰r
 ("fread called with bigger size *‚membhan†ength "

280 
__fÜtify_funùiÚ
 
__wur
 
size_t


281 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

282 
FILE
 *
__»¡riù
 
__¡»am
)

284 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

286 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

287 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

288 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

289  
	`__ä—d_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

291 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

292  
	`__ä—d_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__¡»am
);

294  
	`__ä—d_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

295 
	}
}

297 #ifdeà
__USE_GNU


298 *
	$__fg‘s_uÆocked_chk
 (*
__»¡riù
 
__s
, 
size_t
 
__size
,

299 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

300 *
	`__REDIRECT
 (
__fg‘s_uÆocked_®Ÿs
,

301 (*
__»¡riù
 
__s
, 
__n
,

302 
FILE
 *
__»¡riù
 
__¡»am
), 
fg‘s_uÆocked
è
__wur
;

303 *
	`__REDIRECT
 (
__fg‘s_uÆocked_chk_w¬n
,

304 (*
__»¡riù
 
__s
, 
size_t
 
__size
, 
__n
,

305 
FILE
 *
__»¡riù
 
__¡»am
), 
__fg‘s_uÆocked_chk
)

306 
__wur
 
	`__w¬Ç‰r
 ("fgets_unlocked called with bigger sizehan†ength "

309 
__fÜtify_funùiÚ
 
__wur
 *

310 
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

312 ià(
	`__bos
 (
__s
è!ğ(
size_t
) -1)

314 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
) || __n <= 0)

315  
	`__fg‘s_uÆocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

317 ià((
size_t
è
__n
 > 
	`__bos
 (
__s
))

318  
	`__fg‘s_uÆocked_chk_w¬n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__¡»am
);

320  
	`__fg‘s_uÆocked_®Ÿs
 (
__s
, 
__n
, 
__¡»am
);

321 
	}
}

324 #ifdeà
__USE_MISC


325 #undeà
ä—d_uÆocked


326 
size_t
 
	$__ä—d_uÆocked_chk
 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

327 
size_t
 
__size
, size_ˆ
__n
,

328 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

329 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_®Ÿs
,

330 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

331 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
),

332 
ä—d_uÆocked
è
__wur
;

333 
size_t
 
	`__REDIRECT
 (
__ä—d_uÆocked_chk_w¬n
,

334 (*
__»¡riù
 
__±r
, 
size_t
 
__±¾’
,

335 
size_t
 
__size
, size_ˆ
__n
,

336 
FILE
 *
__»¡riù
 
__¡»am
),

337 
__ä—d_uÆocked_chk
)

338 
__wur
 
	`__w¬Ç‰r
 ("fread_unlocked called with bigger size *‚membhan "

341 
__fÜtify_funùiÚ
 
__wur
 
size_t


342 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
, size_ˆ
__n
,

343 
FILE
 *
__»¡riù
 
__¡»am
)

345 ià(
	`__bos0
 (
__±r
è!ğ(
size_t
) -1)

347 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
)

348 || !
	`__butš_cÚ¡ªt_p
 (
__n
)

349 || (
__size
 | 
__n
è>ğ(((
size_t
) 1) << (8 *  (size_t) / 2)))

350  
	`__ä—d_uÆocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

351 
__¡»am
);

353 ià(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

354  
	`__ä—d_uÆocked_chk_w¬n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

355 
__¡»am
);

358 #ifdeà
__USE_EXTERN_INLINES


359 ià(
	`__butš_cÚ¡ªt_p
 (
__size
)

360 && 
	`__butš_cÚ¡ªt_p
 (
__n
)

361 && (
__size
 | 
__n
è< (((
size_t
) 1) << (8 *  (size_t) / 2))

362 && 
__size
 * 
__n
 <= 8)

364 
size_t
 
__út
 = 
__size
 * 
__n
;

365 *
__ıŒ
 = (*è
__±r
;

366 ià(
__út
 == 0)

369 ; 
__út
 > 0; --__cnt)

371 
__c
 = 
	`_IO_g‘c_uÆocked
 (
__¡»am
);

372 ià(
__c
 =ğ
EOF
)

374 *
__ıŒ
++ = 
__c
;

376  (
__ıŒ
 - (*è
__±r
è/ 
__size
;

379  
	`__ä—d_uÆocked_®Ÿs
 (
__±r
, 
__size
, 
__n
, 
__¡»am
);

380 
	}
}

	@/usr/include/bits/stdio_lim.h

18 #iâdeà
_BITS_STDIO_LIM_H


19 
	#_BITS_STDIO_LIM_H
 1

	)

21 #iâdeà
_STDIO_H


25 
	#L_tm²am
 20

	)

26 
	#TMP_MAX
 238328

	)

27 
	#FILENAME_MAX
 4096

	)

29 #ifdeà
__USE_POSIX


30 
	#L_ù”mid
 9

	)

31 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


32 
	#L_cu£rid
 9

	)

36 #undeà
FOPEN_MAX


37 
	#FOPEN_MAX
 16

	)

	@/usr/include/bits/stdlib-bsearch.h

19 
__ex‹º_šlše
 *

20 
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

21 
__com·r_â_t
 
__com·r
)

23 
size_t
 
__l
, 
__u
, 
__idx
;

24 cÚ¡ *
__p
;

25 
__com·risÚ
;

27 
__l
 = 0;

28 
__u
 = 
__nmemb
;

29 
__l
 < 
__u
)

31 
__idx
 = (
__l
 + 
__u
) / 2;

32 
__p
 = (*è(((cÚ¡ *è
__ba£
è+ (
__idx
 * 
__size
));

33 
__com·risÚ
 = (*
__com·r
è(
__key
, 
__p
);

34 ià(
__com·risÚ
 < 0)

35 
__u
 = 
__idx
;

36 ià(
__com·risÚ
 > 0)

37 
__l
 = 
__idx
 + 1;

39  (*è
__p
;

42  
NULL
;

43 
	}
}

	@/usr/include/bits/stdlib-float.h

19 #iâdeà
_STDLIB_H


23 #ifdeà
__USE_EXTERN_INLINES


24 
__ex‹º_šlše
 

25 
__NTH
 (
	$©of
 (cÚ¡ *
__ÅŒ
))

27  
	`¡¹od
 (
__ÅŒ
, (**è
NULL
);

28 
	}
}

	@/usr/include/bits/stdlib-ldbl.h

19 #iâdeà
_STDLIB_H


23 #ifdef 
__USE_ISOC99


24 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd
, 
¡¹od
)

27 #ifdeà
__USE_GNU


28 
	$__LDBL_REDIR1_DECL
 (
¡¹Şd_l
, 
¡¹od_l
)

31 #ià
	`__GLIBC_USE
 (
IEC_60559_BFP_EXT
)

32 
	$__LDBL_REDIR1_DECL
 (
¡räoml
, 
¡räomd
)

35 #ifdeà
__USE_MISC


36 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

39 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

40 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

19 #iâdeà
_STDLIB_H


23 *
	$__»®·th_chk
 (cÚ¡ *
__»¡riù
 
__Çme
,

24 *
__»¡riù
 
__»sŞved
,

25 
size_t
 
__»sŞvedËn
è
__THROW
 
__wur
;

26 *
	`__REDIRECT_NTH
 (
__»®·th_®Ÿs
,

27 (cÚ¡ *
__»¡riù
 
__Çme
,

28 *
__»¡riù
 
__»sŞved
), 
»®·th
è
__wur
;

29 *
	`__REDIRECT_NTH
 (
__»®·th_chk_w¬n
,

30 (cÚ¡ *
__»¡riù
 
__Çme
,

31 *
__»¡riù
 
__»sŞved
,

32 
size_t
 
__»sŞvedËn
), 
__»®·th_chk
è
__wur


33 
	`__w¬Ç‰r
 ("second‡rgument of„ealpath must beƒither NULL or‡t "

36 
__fÜtify_funùiÚ
 
__wur
 *

37 
	`__NTH
 (
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
, *__»¡riù 
__»sŞved
))

39 ià(
	`__bos
 (
__»sŞved
è!ğ(
size_t
) -1)

41 #ià
defšed
 
_LIBC_LIMITS_H_
 && defšed 
PATH_MAX


42 ià(
	`__bos
 (
__»sŞved
è< 
PATH_MAX
)

43  
	`__»®·th_chk_w¬n
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

45  
	`__»®·th_chk
 (
__Çme
, 
__»sŞved
, 
	`__bos
 (__resolved));

48  
	`__»®·th_®Ÿs
 (
__Çme
, 
__»sŞved
);

49 
	}
}

52 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

53 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

54 
	`__REDIRECT_NTH
 (
__±¢ame_r_®Ÿs
, (
__fd
, *
__buf
,

55 
size_t
 
__buæ’
), 
±¢ame_r
)

56 
	`__nÚnuÎ
 ((2));

57 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¬n
,

58 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

59 
size_t
 
__Ä—l
), 
__±¢ame_r_chk
)

60 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ptsname_r called with buflen biggerhan "

63 
__fÜtify_funùiÚ
 

64 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

66 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

68 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

69  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

70 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

71  
	`__±¢ame_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

73  
	`__±¢ame_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

74 
	}
}

77 
	$__wùomb_chk
 (*
__s
, 
wch¬_t
 
__wch¬
, 
size_t
 
__buæ’
)

78 
__THROW
 
__wur
;

79 
	`__REDIRECT_NTH
 (
__wùomb_®Ÿs
, (*
__s
, 
wch¬_t
 
__wch¬
),

80 
wùomb
è
__wur
;

82 
__fÜtify_funùiÚ
 
__wur
 

83 
	`__NTH
 (
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
))

88 
	#__STDLIB_MB_LEN_MAX
 16

	)

89 #ià
defšed
 
MB_LEN_MAX
 && MB_LEN_MAX !ğ
__STDLIB_MB_LEN_MAX


92 ià(
	`__bos
 (
__s
è!ğ(
size_t
è-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

93  
	`__wùomb_chk
 (
__s
, 
__wch¬
, 
	`__bos
 (__s));

94  
	`__wùomb_®Ÿs
 (
__s
, 
__wch¬
);

95 
	}
}

98 
size_t
 
	$__mb¡owcs_chk
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

99 cÚ¡ *
__»¡riù
 
__¤c
,

100 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

101 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_®Ÿs
,

102 (
wch¬_t
 *
__»¡riù
 
__d¡
,

103 cÚ¡ *
__»¡riù
 
__¤c
,

104 
size_t
 
__Ën
), 
mb¡owcs
);

105 
size_t
 
	`__REDIRECT_NTH
 (
__mb¡owcs_chk_w¬n
,

106 (
wch¬_t
 *
__»¡riù
 
__d¡
,

107 cÚ¡ *
__»¡riù
 
__¤c
,

108 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__mb¡owcs_chk
)

109 
	`__w¬Ç‰r
 ("mbstowcs called with dst buffer smallerhan†en "

112 
__fÜtify_funùiÚ
 
size_t


113 
	`__NTH
 (
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
, cÚ¡ *__»¡riù 
__¤c
,

114 
size_t
 
__Ën
))

116 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

118 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

119  
	`__mb¡owcs_chk
 (
__d¡
, 
__¤c
, 
__Ën
,

120 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

122 ià(
__Ën
 > 
	`__bos
 (
__d¡
è/  (
wch¬_t
))

123  
	`__mb¡owcs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
,

124 
	`__bos
 (
__d¡
è/  (
wch¬_t
));

126  
	`__mb¡owcs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

127 
	}
}

130 
size_t
 
	$__wc¡ombs_chk
 (*
__»¡riù
 
__d¡
,

131 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

132 
size_t
 
__Ën
, size_ˆ
__d¡Ën
è
__THROW
;

133 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_®Ÿs
,

134 (*
__»¡riù
 
__d¡
,

135 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

136 
size_t
 
__Ën
), 
wc¡ombs
);

137 
size_t
 
	`__REDIRECT_NTH
 (
__wc¡ombs_chk_w¬n
,

138 (*
__»¡riù
 
__d¡
,

139 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
,

140 
size_t
 
__Ën
, size_ˆ
__d¡Ën
), 
__wc¡ombs_chk
)

141 
	`__w¬Ç‰r
 ("wcstombs called with dst buffer smallerhan†en");

143 
__fÜtify_funùiÚ
 
size_t


144 
	`__NTH
 (
	$wc¡ombs
 (*
__»¡riù
 
__d¡
, cÚ¡ 
wch¬_t
 *__»¡riù 
__¤c
,

145 
size_t
 
__Ën
))

147 ià(
	`__bos
 (
__d¡
è!ğ(
size_t
) -1)

149 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

150  
	`__wc¡ombs_chk
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

151 ià(
__Ën
 > 
	`__bos
 (
__d¡
))

152  
	`__wc¡ombs_chk_w¬n
 (
__d¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dst));

154  
	`__wc¡ombs_®Ÿs
 (
__d¡
, 
__¤c
, 
__Ën
);

155 
	}
}

	@/usr/include/bits/string_fortified.h

18 #iâdeà
_BITS_STRING_FORTIFIED_H


19 
	#_BITS_STRING_FORTIFIED_H
 1

	)

21 #iâdeà
_STRING_H


25 #ià!
__GNUC_PREREQ
 (5,0)

26 
__w¬ndeş
 (
__w¬n_mem£t_z”o_Ën
,

30 
__fÜtify_funùiÚ
 *

31 
__NTH
 (
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

32 
size_t
 
__Ën
))

34  
	`__butš___memıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

35 
	}
}

37 
__fÜtify_funùiÚ
 *

38 
__NTH
 (
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__Ën
))

40  
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

41 
	}
}

43 #ifdeà
__USE_GNU


44 
__fÜtify_funùiÚ
 *

45 
__NTH
 (
	$mempıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

46 
size_t
 
__Ën
))

48  
	`__butš___mempıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

49 
	}
}

58 
__fÜtify_funùiÚ
 *

59 
__NTH
 (
	$mem£t
 (*
__de¡
, 
__ch
, 
size_t
 
__Ën
))

63 #ià!
	`__GNUC_PREREQ
 (5,0)

64 ià(
	`__butš_cÚ¡ªt_p
 (
__Ën
) && __len == 0

65 && (!
	`__butš_cÚ¡ªt_p
 (
__ch
) || __ch != 0))

67 
	`__w¬n_mem£t_z”o_Ën
 ();

68  
__de¡
;

71  
	`__butš___mem£t_chk
 (
__de¡
, 
__ch
, 
__Ën
, 
	`__bos0
 (__dest));

72 
	}
}

74 #ifdeà
__USE_MISC


75 
	~<b™s/¡ršgs_fÜtif›d.h
>

77 
	$__ex¶ic™_bz”o_chk
 (*
__de¡
, 
size_t
 
__Ën
, size_ˆ
__de¡Ën
)

78 
__THROW
 
	`__nÚnuÎ
 ((1));

80 
__fÜtify_funùiÚ
 

81 
	`__NTH
 (
	$ex¶ic™_bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

83 
	`__ex¶ic™_bz”o_chk
 (
__de¡
, 
__Ën
, 
	`__bos0
 (__dest));

84 
	}
}

87 
__fÜtify_funùiÚ
 *

88 
__NTH
 (
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

90  
	`__butš___¡rıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

91 
	}
}

93 #ifdeà
__USE_GNU


94 
__fÜtify_funùiÚ
 *

95 
__NTH
 (
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

97  
	`__butš___¡pıy_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

98 
	}
}

102 
__fÜtify_funùiÚ
 *

103 
__NTH
 (
	$¡ºıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

104 
size_t
 
__Ën
))

106  
	`__butš___¡ºıy_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

107 
	}
}

110 *
	$__¡²ıy_chk
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

111 
size_t
 
__de¡Ën
è
__THROW
;

112 *
	`__REDIRECT_NTH
 (
__¡²ıy_®Ÿs
, (*
__de¡
, cÚ¡ *
__¤c
,

113 
size_t
 
__n
), 
¡²ıy
);

115 
__fÜtify_funùiÚ
 *

116 
	`__NTH
 (
	$¡²ıy
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
))

118 ià(
	`__bos
 (
__de¡
è!ğ(
size_t
) -1

119 && (!
	`__butš_cÚ¡ªt_p
 (
__n
è|| __À> 
	`__bos
 (
__de¡
)))

120  
	`__¡²ıy_chk
 (
__de¡
, 
__¤c
, 
__n
, 
	`__bos
 (__dest));

121  
	`__¡²ıy_®Ÿs
 (
__de¡
, 
__¤c
, 
__n
);

122 
	}
}

125 
__fÜtify_funùiÚ
 *

126 
__NTH
 (
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
))

128  
	`__butš___¡rÿt_chk
 (
__de¡
, 
__¤c
, 
	`__bos
 (__dest));

129 
	}
}

132 
__fÜtify_funùiÚ
 *

133 
__NTH
 (
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

134 
size_t
 
__Ën
))

136  
	`__butš___¡ºÿt_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos
 (__dest));

137 
	}
}

	@/usr/include/bits/sys_errlist.h

19 #iâdeà
_STDIO_H


25 #ifdeà 
__USE_MISC


26 
sys_Ã¼
;

27 cÚ¡ *cÚ¡ 
sys_”¾i¡
[];

29 #ifdeà 
__USE_GNU


30 
_sys_Ã¼
;

31 cÚ¡ *cÚ¡ 
_sys_”¾i¡
[];

	@/usr/include/bits/types.h

23 #iâdef 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wÜdsize.h
>

30 
	t__u_ch¬
;

31 
	t__u_shÜt
;

32 
	t__u_št
;

33 
	t__u_lÚg
;

36 sigÃd 
	t__št8_t
;

37 
	t__ušt8_t
;

38 sigÃd 
	t__št16_t
;

39 
	t__ušt16_t
;

40 sigÃd 
	t__št32_t
;

41 
	t__ušt32_t
;

42 #ià
__WORDSIZE
 == 64

43 sigÃd 
	t__št64_t
;

44 
	t__ušt64_t
;

46 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

47 
__ex‹nsiÚ__
 
	t__ušt64_t
;

51 #ià
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

55 
__ex‹nsiÚ__
 
	t__quad_t
;

56 
__ex‹nsiÚ__
 
	t__u_quad_t
;

60 #ià
__WORDSIZE
 == 64

61 
	t__štmax_t
;

62 
	t__uštmax_t
;

64 
__ex‹nsiÚ__
 
	t__štmax_t
;

65 
__ex‹nsiÚ__
 
	t__uštmax_t
;

98 
	#__S16_TYPE
 

	)

99 
	#__U16_TYPE
 

	)

100 
	#__S32_TYPE
 

	)

101 
	#__U32_TYPE
 

	)

102 
	#__SLONGWORD_TYPE
 

	)

103 
	#__ULONGWORD_TYPE
 

	)

104 #ià
__WORDSIZE
 == 32

105 
	#__SQUAD_TYPE
 
__quad_t


	)

106 
	#__UQUAD_TYPE
 
__u_quad_t


	)

107 
	#__SWORD_TYPE
 

	)

108 
	#__UWORD_TYPE
 

	)

109 
	#__SLONG32_TYPE
 

	)

110 
	#__ULONG32_TYPE
 

	)

111 
	#__S64_TYPE
 
__quad_t


	)

112 
	#__U64_TYPE
 
__u_quad_t


	)

115 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

116 #–ià
__WORDSIZE
 == 64

117 
	t__SQUAD_TYPE
 

	)

118 
	t__UQUAD_TYPE
 

	)

119 
	t__SWORD_TYPE
 

	)

120 
	t__UWORD_TYPE
 

	)

121 
	t__SLONG32_TYPE
 

	)

122 
	t__ULONG32_TYPE
 

	)

123 
	t__S64_TYPE
 

	)

124 
	t__U64_TYPE
 

	)

126 
	t__STD_TYPE
 

	)

130 
	~<b™s/ty³sizes.h
>

133 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

134 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

135 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

136 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

137 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

138 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

139 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

140 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

141 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

142 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

143 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

144 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

145 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

146 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

147 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

148 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

149 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

150 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

152 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

153 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

156 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

159 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

162 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

167 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

168 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

171 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

172 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

175 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

176 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

179 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fswÜd_t
;

181 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysÿÎ_¦Úg_t
;

186 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysÿÎ_ulÚg_t
;

190 
__off64_t
 
	t__loff_t
;

191 *
	t__ÿddr_t
;

194 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

197 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

202 
	t__sig_©omic_t
;

204 #undeà
__STD_TYPE


	@/usr/include/bits/types/FILE.h

1 #iâdeà
__FILE_defšed


2 
	#__FILE_defšed
 1

	)

4 
	g_IO_FILE
;

7 
_IO_FILE
 
	tFILE
;

	@/usr/include/bits/types/__FILE.h

1 #iâdeà
____FILE_defšed


2 
	#____FILE_defšed
 1

	)

4 
	g_IO_FILE
;

5 
_IO_FILE
 
	t__FILE
;

	@/usr/include/bits/types/clock_t.h

1 #iâdeà
__şock_t_defšed


2 
	#__şock_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şock_t
 
	tşock_t
;

	@/usr/include/bits/types/clockid_t.h

1 #iâdeà
__şockid_t_defšed


2 
	#__şockid_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__şockid_t
 
	tşockid_t
;

	@/usr/include/bits/types/locale_t.h

19 #iâdeà
_BITS_TYPES_LOCALE_T_H


20 
	#_BITS_TYPES_LOCALE_T_H
 1

	)

22 
	~<b™s/ty³s/__loÿË_t.h
>

24 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/bits/types/struct_timespec.h

1 #iâdeà
__time¥ec_defšed


2 
	#__time¥ec_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

8 
	stime¥ec


10 
__time_t
 
	mtv_£c
;

11 
__sysÿÎ_¦Úg_t
 
	mtv_n£c
;

	@/usr/include/bits/types/struct_timeval.h

1 #iâdeà
__timev®_defšed


2 
	#__timev®_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

8 
	stimev®


10 
__time_t
 
	mtv_£c
;

11 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/types/time_t.h

1 #iâdeà
__time_t_defšed


2 
	#__time_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__time_t
 
	ttime_t
;

	@/usr/include/bits/types/timer_t.h

1 #iâdeà
__tim”_t_defšed


2 
	#__tim”_t_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
__tim”_t
 
	ttim”_t
;

	@/usr/include/bits/unistd.h

19 #iâdeà
_UNISTD_H


23 
ssize_t
 
	$__»ad_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

24 
size_t
 
__buæ’
è
__wur
;

25 
ssize_t
 
	`__REDIRECT
 (
__»ad_®Ÿs
, (
__fd
, *
__buf
,

26 
size_t
 
__nby‹s
), 
»ad
è
__wur
;

27 
ssize_t
 
	`__REDIRECT
 (
__»ad_chk_w¬n
,

28 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

29 
size_t
 
__buæ’
), 
__»ad_chk
)

30 
__wur
 
	`__w¬Ç‰r
 ("read called with bigger†engthhan size of "

33 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


34 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
)

36 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

38 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

39  
	`__»ad_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

41 ià(
__nby‹s
 > 
	`__bos0
 (
__buf
))

42  
	`__»ad_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
	`__bos0
 (__buf));

44  
	`__»ad_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
);

45 
	}
}

47 #ifdeà
__USE_UNIX98


48 
ssize_t
 
	$__´—d_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

49 
__off_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

50 
ssize_t
 
	$__´—d64_chk
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

51 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
è
__wur
;

52 
ssize_t
 
	`__REDIRECT
 (
__´—d_®Ÿs
,

53 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

54 
__off_t
 
__off£t
), 
´—d
è
__wur
;

55 
ssize_t
 
	`__REDIRECT
 (
__´—d64_®Ÿs
,

56 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

57 
__off64_t
 
__off£t
), 
´—d64
è
__wur
;

58 
ssize_t
 
	`__REDIRECT
 (
__´—d_chk_w¬n
,

59 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

60 
__off_t
 
__off£t
, 
size_t
 
__bufsize
), 
__´—d_chk
)

61 
__wur
 
	`__w¬Ç‰r
 ("pread called with bigger†engthhan size of "

63 
ssize_t
 
	`__REDIRECT
 (
__´—d64_chk_w¬n
,

64 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

65 
__off64_t
 
__off£t
, 
size_t
 
__bufsize
),

66 
__´—d64_chk
)

67 
__wur
 
	`__w¬Ç‰r
 ("pread64 called with bigger†engthhan size of "

70 #iâdeà
__USE_FILE_OFFSET64


71 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


72 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off_t
 
__off£t
)

74 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

76 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

77  
	`__´—d_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

79 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

80  
	`__´—d_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

81 
	`__bos0
 (
__buf
));

83  
	`__´—d_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

84 
	}
}

86 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


87 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

89 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

91 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

92  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

94 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

95  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

96 
	`__bos0
 (
__buf
));

99  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

100 
	}
}

103 #ifdeà
__USE_LARGEFILE64


104 
__fÜtify_funùiÚ
 
__wur
 
ssize_t


105 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
)

107 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

109 ià(!
	`__butš_cÚ¡ªt_p
 (
__nby‹s
))

110  
	`__´—d64_chk
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
, 
	`__bos0
 (__buf));

112 iàĞ
__nby‹s
 > 
	`__bos0
 (
__buf
))

113  
	`__´—d64_chk_w¬n
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
,

114 
	`__bos0
 (
__buf
));

117  
	`__´—d64_®Ÿs
 (
__fd
, 
__buf
, 
__nby‹s
, 
__off£t
);

118 
	}
}

122 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


123 
ssize_t
 
	$__»adlšk_chk
 (cÚ¡ *
__»¡riù
 
__·th
,

124 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

125 
size_t
 
__buæ’
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

127 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_®Ÿs
,

128 (cÚ¡ *
__»¡riù
 
__·th
,

129 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
), 
»adlšk
)

130 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

131 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk_chk_w¬n
,

132 (cÚ¡ *
__»¡riù
 
__·th
,

133 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

134 
size_t
 
__buæ’
), 
__»adlšk_chk
)

135 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
	`__w¬Ç‰r
 ("readlink called with bigger†ength "

138 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((1, 2)è
__wur
 
ssize_t


139 
	`__NTH
 (
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
, *__»¡riù 
__buf
,

140 
size_t
 
__Ën
))

142 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

144 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

145  
	`__»adlšk_chk
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

147 iàĞ
__Ën
 > 
	`__bos
 (
__buf
))

148  
	`__»adlšk_chk_w¬n
 (
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

150  
	`__»adlšk_®Ÿs
 (
__·th
, 
__buf
, 
__Ën
);

151 
	}
}

154 #ifdeà
__USE_ATFILE


155 
ssize_t
 
	$__»adlšk©_chk
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

156 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

157 
size_t
 
__buæ’
)

158 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

159 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_®Ÿs
,

160 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

161 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
),

162 
»adlšk©
)

163 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

164 
ssize_t
 
	`__REDIRECT_NTH
 (
__»adlšk©_chk_w¬n
,

165 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

166 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
,

167 
size_t
 
__buæ’
), 
__»adlšk©_chk
)

168 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
	`__w¬Ç‰r
 ("readlinkat called with bigger "

172 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((2, 3)è
__wur
 
ssize_t


173 
	`__NTH
 (
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

174 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
))

176 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

178 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

179  
	`__»adlšk©_chk
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

181 ià(
__Ën
 > 
	`__bos
 (
__buf
))

182  
	`__»adlšk©_chk_w¬n
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
,

183 
	`__bos
 (
__buf
));

185  
	`__»adlšk©_®Ÿs
 (
__fd
, 
__·th
, 
__buf
, 
__Ën
);

186 
	}
}

189 *
	$__g‘cwd_chk
 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
)

190 
__THROW
 
__wur
;

191 *
	`__REDIRECT_NTH
 (
__g‘cwd_®Ÿs
,

192 (*
__buf
, 
size_t
 
__size
), 
g‘cwd
è
__wur
;

193 *
	`__REDIRECT_NTH
 (
__g‘cwd_chk_w¬n
,

194 (*
__buf
, 
size_t
 
__size
, size_ˆ
__buæ’
),

195 
__g‘cwd_chk
)

196 
__wur
 
	`__w¬Ç‰r
 ("getcwd caller with bigger†engthhan size of "

199 
__fÜtify_funùiÚ
 
__wur
 *

200 
	`__NTH
 (
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
))

202 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

204 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
))

205  
	`__g‘cwd_chk
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

207 ià(
__size
 > 
	`__bos
 (
__buf
))

208  
	`__g‘cwd_chk_w¬n
 (
__buf
, 
__size
, 
	`__bos
 (__buf));

210  
	`__g‘cwd_®Ÿs
 (
__buf
, 
__size
);

211 
	}
}

213 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


214 *
	$__g‘wd_chk
 (*
__buf
, 
size_t
 
buæ’
)

215 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

216 *
	`__REDIRECT_NTH
 (
__g‘wd_w¬n
, (*
__buf
), 
g‘wd
)

217 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("please use getcwd instead,‡s getwd "

220 
__fÜtify_funùiÚ
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
 *

221 
	`__NTH
 (
	$g‘wd
 (*
__buf
))

223 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

224  
	`__g‘wd_chk
 (
__buf
, 
	`__bos
 (__buf));

225  
	`__g‘wd_w¬n
 (
__buf
);

226 
	}
}

229 
size_t
 
	$__cÚf¡r_chk
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

230 
size_t
 
__buæ’
è
__THROW
;

231 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_®Ÿs
, (
__Çme
, *
__buf
,

232 
size_t
 
__Ën
), 
cÚf¡r
);

233 
size_t
 
	`__REDIRECT_NTH
 (
__cÚf¡r_chk_w¬n
,

234 (
__Çme
, *
__buf
, 
size_t
 
__Ën
,

235 
size_t
 
__buæ’
), 
__cÚf¡r_chk
)

236 
	`__w¬Ç‰r
 ("confstr called with bigger†engthhan size of destination "

239 
__fÜtify_funùiÚ
 
size_t


240 
	`__NTH
 (
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
))

242 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

244 ià(!
	`__butš_cÚ¡ªt_p
 (
__Ën
))

245  
	`__cÚf¡r_chk
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

247 ià(
	`__bos
 (
__buf
è< 
__Ën
)

248  
	`__cÚf¡r_chk_w¬n
 (
__Çme
, 
__buf
, 
__Ën
, 
	`__bos
 (__buf));

250  
	`__cÚf¡r_®Ÿs
 (
__Çme
, 
__buf
, 
__Ën
);

251 
	}
}

254 
	$__g‘groups_chk
 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
)

255 
__THROW
 
__wur
;

256 
	`__REDIRECT_NTH
 (
__g‘groups_®Ÿs
, (
__size
, 
__gid_t
 
__li¡
[]),

257 
g‘groups
è
__wur
;

258 
	`__REDIRECT_NTH
 (
__g‘groups_chk_w¬n
,

259 (
__size
, 
__gid_t
 
__li¡
[], 
size_t
 
__li¡Ën
),

260 
__g‘groups_chk
)

261 
__wur
 
	`__w¬Ç‰r
 ("getgroups called with bigger group counthan what "

264 
__fÜtify_funùiÚ
 

265 
	`__NTH
 (
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]))

267 ià(
	`__bos
 (
__li¡
è!ğ(
size_t
) -1)

269 ià(!
	`__butš_cÚ¡ªt_p
 (
__size
) || __size < 0)

270  
	`__g‘groups_chk
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

272 ià(
__size
 *  (
__gid_t
è> 
	`__bos
 (
__li¡
))

273  
	`__g‘groups_chk_w¬n
 (
__size
, 
__li¡
, 
	`__bos
 (__list));

275  
	`__g‘groups_®Ÿs
 (
__size
, 
__li¡
);

276 
	}
}

279 
	$__‰yÇme_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

280 
size_t
 
__Ä—l
è
__THROW
 
	`__nÚnuÎ
 ((2));

281 
	`__REDIRECT_NTH
 (
__‰yÇme_r_®Ÿs
, (
__fd
, *
__buf
,

282 
size_t
 
__buæ’
), 
‰yÇme_r
)

283 
	`__nÚnuÎ
 ((2));

284 
	`__REDIRECT_NTH
 (
__‰yÇme_r_chk_w¬n
,

285 (
__fd
, *
__buf
, 
size_t
 
__buæ’
,

286 
size_t
 
__Ä—l
), 
__‰yÇme_r_chk
)

287 
	`__nÚnuÎ
 ((2)è
	`__w¬Ç‰r
 ("ttyname_r called with bigger buflenhan "

290 
__fÜtify_funùiÚ
 

291 
	`__NTH
 (
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
))

293 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

295 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

296  
	`__‰yÇme_r_chk
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

298 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

299  
	`__‰yÇme_r_chk_w¬n
 (
__fd
, 
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

301  
	`__‰yÇme_r_®Ÿs
 (
__fd
, 
__buf
, 
__buæ’
);

302 
	}
}

305 #ifdeà
__USE_POSIX199506


306 
	$__g‘logš_r_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

307 
	`__nÚnuÎ
 ((1));

308 
	`__REDIRECT
 (
__g‘logš_r_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

309 
g‘logš_r
è
	`__nÚnuÎ
 ((1));

310 
	`__REDIRECT
 (
__g‘logš_r_chk_w¬n
,

311 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

312 
__g‘logš_r_chk
)

313 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("getlogin_r called with bigger buflenhan "

316 
__fÜtify_funùiÚ
 

317 
	$g‘logš_r
 (*
__buf
, 
size_t
 
__buæ’
)

319 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

321 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

322  
	`__g‘logš_r_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

324 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

325  
	`__g‘logš_r_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

327  
	`__g‘logš_r_®Ÿs
 (
__buf
, 
__buæ’
);

328 
	}
}

332 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_UNIX98


333 
	$__g‘ho¡Çme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

334 
__THROW
 
	`__nÚnuÎ
 ((1));

335 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_®Ÿs
, (*
__buf
, 
size_t
 
__buæ’
),

336 
g‘ho¡Çme
è
	`__nÚnuÎ
 ((1));

337 
	`__REDIRECT_NTH
 (
__g‘ho¡Çme_chk_w¬n
,

338 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

339 
__g‘ho¡Çme_chk
)

340 
	`__nÚnuÎ
 ((1)è
	`__w¬Ç‰r
 ("gethostname called with bigger buflenhan "

343 
__fÜtify_funùiÚ
 

344 
	`__NTH
 (
	$g‘ho¡Çme
 (*
__buf
, 
size_t
 
__buæ’
))

346 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

348 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

349  
	`__g‘ho¡Çme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

351 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

352  
	`__g‘ho¡Çme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

354  
	`__g‘ho¡Çme_®Ÿs
 (
__buf
, 
__buæ’
);

355 
	}
}

359 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

360 
	$__g‘domašÇme_chk
 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
)

361 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

362 
	`__REDIRECT_NTH
 (
__g‘domašÇme_®Ÿs
, (*
__buf
,

363 
size_t
 
__buæ’
),

364 
g‘domašÇme
è
	`__nÚnuÎ
 ((1)è
__wur
;

365 
	`__REDIRECT_NTH
 (
__g‘domašÇme_chk_w¬n
,

366 (*
__buf
, 
size_t
 
__buæ’
, size_ˆ
__Ä—l
),

367 
__g‘domašÇme_chk
)

368 
	`__nÚnuÎ
 ((1)è
__wur
 
	`__w¬Ç‰r
 ("getdomainname called with bigger "

372 
__fÜtify_funùiÚ
 

373 
	`__NTH
 (
	$g‘domašÇme
 (*
__buf
, 
size_t
 
__buæ’
))

375 ià(
	`__bos
 (
__buf
è!ğ(
size_t
) -1)

377 ià(!
	`__butš_cÚ¡ªt_p
 (
__buæ’
))

378  
	`__g‘domašÇme_chk
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

380 ià(
__buæ’
 > 
	`__bos
 (
__buf
))

381  
	`__g‘domašÇme_chk_w¬n
 (
__buf
, 
__buæ’
, 
	`__bos
 (__buf));

383  
	`__g‘domašÇme_®Ÿs
 (
__buf
, 
__buæ’
);

384 
	}
}

	@/usr/include/bits/waitflags.h

19 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


25 
	#WNOHANG
 1

	)

26 
	#WUNTRACED
 2

	)

29 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


30 
	#WSTOPPED
 2

	)

31 
	#WEXITED
 4

	)

32 
	#WCONTINUED
 8

	)

33 
	#WNOWAIT
 0x01000000

	)

36 
	#__WNOTHREAD
 0x20000000

	)

38 
	#__WALL
 0x40000000

	)

39 
	#__WCLONE
 0x80000000

	)

42 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


43 #iâdeà
__ENUM_IDTYPE_T


44 
	#__ENUM_IDTYPE_T
 1

	)

48 #undeà
P_ALL


49 #undeà
P_PID


50 #undeà
P_PGID


54 
	mP_ALL
,

55 
	mP_PID
,

56 
	mP_PGID


57 } 
	tidty³_t
;

	@/usr/include/bits/waitstatus.h

19 #ià!
defšed
 
_SYS_WAIT_H
 && !defšed 
_STDLIB_H


28 
	#__WEXITSTATUS
(
¡©us
è(((¡©usè& 0xff00è>> 8)

	)

31 
	#__WTERMSIG
(
¡©us
è((¡©usè& 0x7f)

	)

34 
	#__WSTOPSIG
(
¡©us
è
	`__WEXITSTATUS
(¡©us)

	)

37 
	#__WIFEXITED
(
¡©us
è(
	`__WTERMSIG
(¡©usè=ğ0)

	)

40 
	#__WIFSIGNALED
(
¡©us
) \

41 (((sigÃd è(((
¡©us
è& 0x7fè+ 1è>> 1è> 0)

	)

44 
	#__WIFSTOPPED
(
¡©us
è(((¡©usè& 0xffè=ğ0x7f)

	)

48 #ifdeà
WCONTINUED


49 
	#__WIFCONTINUED
(
¡©us
è((¡©usè=ğ
__W_CONTINUED
)

	)

53 
	#__WCOREDUMP
(
¡©us
è((¡©usè& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
»t
, 
sig
è(Ô‘è<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
è((sigè<< 8 | 0x7f)

	)

58 
	#__W_CONTINUED
 0xffff

	)

59 
	#__WCOREFLAG
 0x80

	)

	@/usr/include/bits/wchar.h

19 #iâdeà
_BITS_WCHAR_H


20 
	#_BITS_WCHAR_H
 1

	)

33 #ifdeà
__WCHAR_MAX__


34 
	#__WCHAR_MAX
 
__WCHAR_MAX__


	)

35 #–ià
L
'\0' - 1 > 0

36 
	#__WCHAR_MAX
 (0xffffffffu + 
L
'\0')

	)

38 
	#__WCHAR_MAX
 (0x7ffffffà+ 
L
'\0')

	)

41 #ifdeà
__WCHAR_MIN__


42 
	#__WCHAR_MIN
 
__WCHAR_MIN__


	)

43 #–ià
L
'\0' - 1 > 0

44 
	#__WCHAR_MIN
 (
L
'\0' + 0)

	)

46 
	#__WCHAR_MIN
 (-
__WCHAR_MAX
 - 1)

	)

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__
 && !defšed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

7 
	#__WORDSIZE32_SIZE_ULONG
 0

	)

8 
	#__WORDSIZE32_PTRDIFF_LONG
 0

	)

11 #ifdeà
__x86_64__


12 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

14 
	#__SYSCALL_WORDSIZE
 64

	)

16 
	#__WORDSIZE_TIME64_COMPAT32
 0

	)

	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

61 
	~<b™s/ušŠ-id’t™y.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

80 
	#htobe16
(
x
è
	`__ušt16_id’t™y
 (x)

	)

81 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

82 
	#be16toh
(
x
è
	`__ušt16_id’t™y
 (x)

	)

83 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

85 
	#htobe32
(
x
è
	`__ušt32_id’t™y
 (x)

	)

86 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

87 
	#be32toh
(
x
è
	`__ušt32_id’t™y
 (x)

	)

88 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

90 
	#htobe64
(
x
è
	`__ušt64_id’t™y
 (x)

	)

91 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

92 
	#be64toh
(
x
è
	`__ušt64_id’t™y
 (x)

	)

93 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

119 #undeà
__USE_ISOC11


120 #undeà
__USE_ISOC99


121 #undeà
__USE_ISOC95


122 #undeà
__USE_ISOCXX11


123 #undeà
__USE_POSIX


124 #undeà
__USE_POSIX2


125 #undeà
__USE_POSIX199309


126 #undeà
__USE_POSIX199506


127 #undeà
__USE_XOPEN


128 #undeà
__USE_XOPEN_EXTENDED


129 #undeà
__USE_UNIX98


130 #undeà
__USE_XOPEN2K


131 #undeà
__USE_XOPEN2KXSI


132 #undeà
__USE_XOPEN2K8


133 #undeà
__USE_XOPEN2K8XSI


134 #undeà
__USE_LARGEFILE


135 #undeà
__USE_LARGEFILE64


136 #undeà
__USE_FILE_OFFSET64


137 #undeà
__USE_MISC


138 #undeà
__USE_ATFILE


139 #undeà
__USE_GNU


140 #undeà
__USE_FORTIFY_LEVEL


141 #undeà
__KERNEL_STRICT_NAMES


142 #undeà
__GLIBC_USE_DEPRECATED_GETS


146 #iâdeà
_LOOSE_KERNEL_NAMES


147 
	#__KERNEL_STRICT_NAMES


	)

157 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


158 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

159 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

161 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

168 #ià
defšed
 
__şªg_majÜ__
 && defšed 
__şªg_mšÜ__


169 
	#__glibc_şªg_´”eq
(
maj
, 
mš
) \

170 ((
__şªg_majÜ__
 << 16è+ 
__şªg_mšÜ__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

172 
	#__glibc_şªg_´”eq
(
maj
, 
mš
è0

	)

176 
	#__GLIBC_USE
(
F
è
__GLIBC_USE_
 ## 
	)
F

182 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

183 && !
defšed
 
	g_DEFAULT_SOURCE


185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

190 #ifdeà
_GNU_SOURCE


191 #undeà
_ISOC95_SOURCE


192 
	#_ISOC95_SOURCE
 1

	)

193 #undeà
_ISOC99_SOURCE


194 
	#_ISOC99_SOURCE
 1

	)

195 #undeà
_ISOC11_SOURCE


196 
	#_ISOC11_SOURCE
 1

	)

197 #undeà
_POSIX_SOURCE


198 
	#_POSIX_SOURCE
 1

	)

199 #undeà
_POSIX_C_SOURCE


200 
	#_POSIX_C_SOURCE
 200809L

	)

201 #undeà
_XOPEN_SOURCE


202 
	#_XOPEN_SOURCE
 700

	)

203 #undeà
_XOPEN_SOURCE_EXTENDED


204 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

205 #undeà
_LARGEFILE64_SOURCE


206 
	#_LARGEFILE64_SOURCE
 1

	)

207 #undeà
_DEFAULT_SOURCE


208 
	#_DEFAULT_SOURCE
 1

	)

209 #undeà
_ATFILE_SOURCE


210 
	#_ATFILE_SOURCE
 1

	)

215 #ià(
defšed
 
_DEFAULT_SOURCE
 \

216 || (!
defšed
 
	g__STRICT_ANSI__
 \

217 && !
defšed
 
	g_ISOC99_SOURCE
 \

218 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

219 && !
defšed
 
	g_XOPEN_SOURCE
))

220 #undeà
_DEFAULT_SOURCE


221 
	#_DEFAULT_SOURCE
 1

	)

225 #ià(
defšed
 
_ISOC11_SOURCE
 \

226 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

227 
	#__USE_ISOC11
 1

	)

231 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

232 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

233 
	#__USE_ISOC99
 1

	)

237 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

238 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

239 
	#__USE_ISOC95
 1

	)

242 #ifdeà
__ılu¥lus


244 #ià
__ılu¥lus
 >= 201703L

245 
	#__USE_ISOC11
 1

	)

249 #ià
__ılu¥lus
 >ğ201103L || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__


250 
	#__USE_ISOCXX11
 1

	)

251 
	#__USE_ISOC99
 1

	)

258 #ifdeà
_DEFAULT_SOURCE


259 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


260 
	#__USE_POSIX_IMPLICITLY
 1

	)

262 #undeà
_POSIX_SOURCE


263 
	#_POSIX_SOURCE
 1

	)

264 #undeà
_POSIX_C_SOURCE


265 
	#_POSIX_C_SOURCE
 200809L

	)

268 #ià((!
defšed
 
__STRICT_ANSI__
 \

269 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

270 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

271 
	#_POSIX_SOURCE
 1

	)

272 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

273 
	#_POSIX_C_SOURCE
 2

	)

274 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

275 
	#_POSIX_C_SOURCE
 199506L

	)

276 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

277 
	#_POSIX_C_SOURCE
 200112L

	)

279 
	#_POSIX_C_SOURCE
 200809L

	)

281 
	#__USE_POSIX_IMPLICITLY
 1

	)

290 #ià((!
defšed
 
_POSIX_C_SOURCE
 || (_POSIX_C_SOURCE - 0) < 199506L) \

291 && (
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE
))

292 
	#_POSIX_SOURCE
 1

	)

293 #undeà
_POSIX_C_SOURCE


294 
	#_POSIX_C_SOURCE
 199506L

	)

297 #ià(
defšed
 
_POSIX_SOURCE
 \

298 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

299 || 
defšed
 
_XOPEN_SOURCE
)

300 
	#__USE_POSIX
 1

	)

303 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


304 
	#__USE_POSIX2
 1

	)

307 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

308 
	#__USE_POSIX199309
 1

	)

311 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

312 
	#__USE_POSIX199506
 1

	)

315 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

316 
	#__USE_XOPEN2K
 1

	)

317 #undeà
__USE_ISOC95


318 
	#__USE_ISOC95
 1

	)

319 #undeà
__USE_ISOC99


320 
	#__USE_ISOC99
 1

	)

323 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

324 
	#__USE_XOPEN2K8
 1

	)

325 #undeà
_ATFILE_SOURCE


326 
	#_ATFILE_SOURCE
 1

	)

329 #ifdef 
_XOPEN_SOURCE


330 
	#__USE_XOPEN
 1

	)

331 #ià(
_XOPEN_SOURCE
 - 0) >= 500

332 
	#__USE_XOPEN_EXTENDED
 1

	)

333 
	#__USE_UNIX98
 1

	)

334 #undeà
_LARGEFILE_SOURCE


335 
	#_LARGEFILE_SOURCE
 1

	)

336 #ià(
_XOPEN_SOURCE
 - 0) >= 600

337 #ià(
_XOPEN_SOURCE
 - 0) >= 700

338 
	#__USE_XOPEN2K8
 1

	)

339 
	#__USE_XOPEN2K8XSI
 1

	)

341 
	#__USE_XOPEN2K
 1

	)

342 
	#__USE_XOPEN2KXSI
 1

	)

343 #undeà
__USE_ISOC95


344 
	#__USE_ISOC95
 1

	)

345 #undeà
__USE_ISOC99


346 
	#__USE_ISOC99
 1

	)

349 #ifdeà
_XOPEN_SOURCE_EXTENDED


350 
	#__USE_XOPEN_EXTENDED
 1

	)

355 #ifdeà
_LARGEFILE_SOURCE


356 
	#__USE_LARGEFILE
 1

	)

359 #ifdeà
_LARGEFILE64_SOURCE


360 
	#__USE_LARGEFILE64
 1

	)

363 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

364 
	#__USE_FILE_OFFSET64
 1

	)

367 #ià
defšed
 
_DEFAULT_SOURCE


368 
	#__USE_MISC
 1

	)

371 #ifdef 
_ATFILE_SOURCE


372 
	#__USE_ATFILE
 1

	)

375 #ifdef 
_GNU_SOURCE


376 
	#__USE_GNU
 1

	)

379 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

380 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

381 #ià
_FORTIFY_SOURCE
 > 1

382 
	#__USE_FORTIFY_LEVEL
 2

	)

384 
	#__USE_FORTIFY_LEVEL
 1

	)

387 
	#__USE_FORTIFY_LEVEL
 0

	)

394 #ià
defšed
 
__ılu¥lus
 ? __ılu¥lu >ğ201402L : defšed 
__USE_ISOC11


395 
	#__GLIBC_USE_DEPRECATED_GETS
 0

	)

397 
	#__GLIBC_USE_DEPRECATED_GETS
 1

	)

402 
	~<¡dc-´edef.h
>

410 #undeà
__GNU_LIBRARY__


411 
	#__GNU_LIBRARY__
 6

	)

415 
	#__GLIBC__
 2

	)

416 
	#__GLIBC_MINOR__
 27

	)

418 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

419 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

422 #iâdeà
__ASSEMBLER__


423 #iâdeà
_SYS_CDEFS_H


424 
	~<sys/cdefs.h
>

429 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


430 
	#__USE_LARGEFILE
 1

	)

431 
	#__USE_LARGEFILE64
 1

	)

437 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

438 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

439 && 
defšed
 
	g__ex‹º_šlše


440 
	#__USE_EXTERN_INLINES
 1

	)

448 
	~<gnu/¡ubs.h
>

	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

31 
	~<b™s/ty³s/time_t.h
>

32 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

33 #iâdeà
__USE_XOPEN2K


34 
	~<time.h
>

37 #iâdeà
__pid_t_defšed


38 
__pid_t
 
	tpid_t
;

39 
	#__pid_t_defšed


	)

43 
	~<b™s/sched.h
>

44 
	~<b™s/ıu-£t.h
>

47 
	#sched_´iÜ™y
 
sched_´iÜ™y


	)

48 
	#__sched_´iÜ™y
 
sched_´iÜ™y


	)

51 
__BEGIN_DECLS


54 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

55 
__THROW
;

58 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

61 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

62 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

65 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

68 
	$sched_y›ld
 (è
__THROW
;

71 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

74 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

77 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

80 #ifdeà
__USE_GNU


82 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

83 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

84 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

86 
ıu£
)

	)

87 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

88 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

90 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

91 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

92 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

93 
ıu£
)

	)

94 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

95 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

97 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

98 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

99 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

100 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

102 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

103 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

104 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

105 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

106 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

107 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

108 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

109 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

110 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

111 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

112 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

113 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

115 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

116 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

117 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

121 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

122 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

125 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

126 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

129 
__END_DECLS


	@/usr/include/snappy-stubs-public.h

36 #iâdeà
THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_STUBS_PUBLIC_H_


37 
	#THIRD_PARTY_SNAPPY_OPENSOURCE_SNAPPY_STUBS_PUBLIC_H_


	)

40 
	~<¡dšt.h
>

44 
	~<¡ddef.h
>

48 
	~<sys/uio.h
>

51 
	#SNAPPY_MAJOR


	)

52 
	#SNAPPY_MINOR


	)

53 
	#SNAPPY_PATCHLEVEL


	)

54 
	#SNAPPY_VERSION
 \

55 ((
SNAPPY_MAJOR
 << 16è| (
SNAPPY_MINOR
 << 8è| 
SNAPPY_PATCHLEVEL
)

	)

57 
	~<¡ršg
>

59 
Çme¥aû
 
	g¢­py
 {

62 
št8_t
 
	tšt8
;

63 
ušt8_t
 
	tušt8
;

64 
št16_t
 
	tšt16
;

65 
ušt16_t
 
	tušt16
;

66 
št32_t
 
	tšt32
;

67 
ušt32_t
 
	tušt32
;

68 
št64_t
 
	tšt64
;

69 
ušt64_t
 
	tušt64
;

71 sigÃd 
	tšt8
;

72 
	tušt8
;

73 
	tšt16
;

74 
	tušt16
;

75 
	tšt32
;

76 
	tušt32
;

77 
	tšt64
;

78 
	tušt64
;

81 
	g¡d
::
	t¡ršg
 string;

86 
	siovec
 {

87 * 
	giov_ba£
;

88 
size_t
 
	giov_Ën
;

	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

27 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

30 
	g__BEGIN_DECLS


32 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


34 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

35 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

38 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

39 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

42 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

45 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


48 *
	`šdex
 (*
__s
, 
__c
)

49 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

50 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

51 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

53 #ià
defšed
 
__OPTIMIZE__


54 
__ex‹º_®ways_šlše
 *

55 
	`šdex
 (*
__s
, 
__c
è
__THROW


57  
	`__butš_šdex
 (
__s
, 
__c
);

60 
__ex‹º_®ways_šlše
 const *

61 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


63  
	`__butš_šdex
 (
__s
, 
__c
);

66 
	}
}

68 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

69 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

73 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


76 *
	`ršdex
 (*
__s
, 
__c
)

77 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

79 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ià
defšed
 
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`ršdex
 (*
__s
, 
__c
è
__THROW


85  
	`__butš_ršdex
 (
__s
, 
__c
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


91  
	`__butš_ršdex
 (
__s
, 
__c
);

94 
	}
}

96 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

101 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


104 
	$ffs
 (
__i
è
__THROW
 
__©Œibu‹_cÚ¡__
;

109 #ifdef 
__USE_MISC


110 
	$ff¦
 (
__l
è
__THROW
 
__©Œibu‹_cÚ¡__
;

111 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

112 
__THROW
 
__©Œibu‹_cÚ¡__
;

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

123 #ifdef 
__USE_XOPEN2K8


125 
	~<b™s/ty³s/loÿË_t.h
>

128 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
loÿË_t
 
__loc
)

129 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

133 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

134 
size_t
 
__n
, 
loÿË_t
 
__loc
)

135 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

138 
__END_DECLS


140 #ià
	`__GNUC_PREREQ
 (3,4è&& 
__USE_FORTIFY_LEVEL
 > 0 \

141 && 
defšed
 
__fÜtify_funùiÚ


143 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


144 
	~<b™s/¡ršgs_fÜtif›d.h
>

	@/usr/include/sys/select.h

21 #iâdeà
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

30 
	~<b™s/£Ëù.h
>

33 
	~<b™s/ty³s/sig£t_t.h
>

36 
	~<b™s/ty³s/time_t.h
>

37 
	~<b™s/ty³s/¡ruù_timev®.h
>

38 #ifdeà
__USE_XOPEN2K


39 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

42 #iâdeà
__su£cÚds_t_defšed


43 
__su£cÚds_t
 
	tsu£cÚds_t
;

44 
	#__su£cÚds_t_defšed


	)

49 
	t__fd_mask
;

52 #undeà
__NFDBITS


54 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

55 
	#__FD_ELT
(
d
è((dè/ 
__NFDBITS
)

	)

56 
	#__FD_MASK
(
d
è((
__fd_mask
è(1UL << ((dè% 
__NFDBITS
)))

	)

63 #ifdeà
__USE_XOPEN


64 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

65 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

67 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

68 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

70 } 
	tfd_£t
;

73 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

75 #ifdeà
__USE_MISC


77 
__fd_mask
 
	tfd_mask
;

80 
	#NFDBITS
 
__NFDBITS


	)

85 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

86 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

87 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

88 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

91 
__BEGIN_DECLS


101 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

102 
fd_£t
 *
__»¡riù
 
__wr™efds
,

103 
fd_£t
 *
__»¡riù
 
__exû±fds
,

104 
timev®
 *
__»¡riù
 
__timeout
);

106 #ifdeà
__USE_XOPEN2K


113 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

114 
fd_£t
 *
__»¡riù
 
__wr™efds
,

115 
fd_£t
 *
__»¡riù
 
__exû±fds
,

116 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

117 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

122 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__GNUC__


123 
	~<b™s/£Ëù2.h
>

126 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

19 #iâdeà
_SYS_SYSMACROS_H_OUTER


21 #iâdeà
__SYSMACROS_DEPRECATED_INCLUSION


22 
	#_SYS_SYSMACROS_H_OUTER
 1

	)

30 #undeà
majÜ


31 #undeà
mšÜ


32 #undeà
makedev


36 #iâdeà
_SYS_SYSMACROS_H


37 
	#_SYS_SYSMACROS_H
 1

	)

39 
	~<ã©u»s.h
>

40 
	~<b™s/ty³s.h
>

41 
	~<b™s/sysmaüos.h
>

52 
	#__SYSMACROS_DM
(
symbŞ
è
__SYSMACROS_DM1
 \

53 (
In
 
the
 
GNU
 
C
 
Lib¿ry
, #symbŞ 
is
 
defšed
\
n
\

54 
by
 <
sys
/
sysmaüos
.
h
>. 
FÜ
 
hi¡Üiÿl
 
com·tib™y
, 
™
 
is
\
n
\

55 
cu¼’y
 
defšed
 
by
 <
sys
/
ty³s
.
h
> 
as
 
w–l
, 
but
 
we
 
¶ª
 
to
\
n
\

56 
»move
 
this
 
soÚ
. 
To
 
u£
 #symbŞ, 
šşude
 <
sys
/
sysmaüos
.
h
>\
n
\

57 
dœeùly
. 
If
 
you
 
did
 
nÙ
 
š‹nd
 
to
 
u£
 
a
 
sy¡em
-
defšed
 
maüo
\
n
\

58 #symbŞ, 
you
 
should
 
undefše
 
™
 
aá”
 
šşudšg
 <
sys
/
ty³s
.
h
>.)

	)

62 
	#__SYSMACROS_DM1
(...è
	`__glibc_maüo_w¬nšg
 (#__VA_ARGS__)

	)

64 
	#__SYSMACROS_DECL_TEMPL
(
¹y³
, 
Çme
, 
´Ùo
) \

65 
¹y³
 
gnu_dev_
##
Çme
 
´Ùo
 
__THROW
 
__©Œibu‹_cÚ¡__
;

	)

67 
	#__SYSMACROS_IMPL_TEMPL
(
¹y³
, 
Çme
, 
´Ùo
) \

68 
__ex‹nsiÚ__
 
__ex‹º_šlše
 
__©Œibu‹_cÚ¡__
 
¹y³
 \

69 
	`__NTH
 (
gnu_dev_
##
Çme
 
´Ùo
)

	)

71 
__BEGIN_DECLS


73 
	$__SYSMACROS_DECLARE_MAJOR
 (
__SYSMACROS_DECL_TEMPL
)

74 
	$__SYSMACROS_DECLARE_MINOR
 (
__SYSMACROS_DECL_TEMPL
)

75 
	$__SYSMACROS_DECLARE_MAKEDEV
 (
__SYSMACROS_DECL_TEMPL
)

77 #ifdeà
__USE_EXTERN_INLINES


79 
	$__SYSMACROS_DEFINE_MAJOR
 (
__SYSMACROS_IMPL_TEMPL
)

80 
	$__SYSMACROS_DEFINE_MINOR
 (
__SYSMACROS_IMPL_TEMPL
)

81 
	$__SYSMACROS_DEFINE_MAKEDEV
 (
__SYSMACROS_IMPL_TEMPL
)

85 
__END_DECLS


89 #iâdeà
__SYSMACROS_NEED_IMPLEMENTATION


90 #undeà
__SYSMACROS_DECL_TEMPL


91 #undeà
__SYSMACROS_IMPL_TEMPL


92 #undeà
__SYSMACROS_DECLARE_MAJOR


93 #undeà
__SYSMACROS_DECLARE_MINOR


94 #undeà
__SYSMACROS_DECLARE_MAKEDEV


95 #undeà
__SYSMACROS_DEFINE_MAJOR


96 #undeà
__SYSMACROS_DEFINE_MINOR


97 #undeà
__SYSMACROS_DEFINE_MAKEDEV


100 #ifdeà
__SYSMACROS_DEPRECATED_INCLUSION


101 
	#majÜ
(
dev
è
	`__SYSMACROS_DM
 (
majÜ
è
	`gnu_dev_majÜ
 (dev)

	)

102 
	#mšÜ
(
dev
è
	`__SYSMACROS_DM
 (
mšÜ
è
	`gnu_dev_mšÜ
 (dev)

	)

103 
	#makedev
(
maj
, 
mš
è
	`__SYSMACROS_DM
 (
makedev
è
	`gnu_dev_makedev
 (maj, mš)

	)

105 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

106 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

107 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/time.h

22 #iâdef 
_TIME_H


23 
	#_TIME_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	#__Ãed_NULL


	)

29 
	~<¡ddef.h
>

33 
	~<b™s/time.h
>

37 
	~<b™s/ty³s/şock_t.h
>

38 
	~<b™s/ty³s/time_t.h
>

39 
	~<b™s/ty³s/¡ruù_tm.h
>

41 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_ISOC11


42 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

45 #ifdeà
__USE_POSIX199309


46 
	~<b™s/ty³s/şockid_t.h
>

47 
	~<b™s/ty³s/tim”_t.h
>

48 
	~<b™s/ty³s/¡ruù_™im”¥ec.h
>

49 
	gsigev’t
;

52 #ifdeà
__USE_XOPEN2K


53 #iâdeà
__pid_t_defšed


54 
__pid_t
 
	tpid_t
;

55 
	#__pid_t_defšed


	)

59 #ifdeà
__USE_XOPEN2K8


60 
	~<b™s/ty³s/loÿË_t.h
>

63 #ifdeà
__USE_ISOC11


65 
	#TIME_UTC
 1

	)

68 
__BEGIN_DECLS


72 
şock_t
 
	$şock
 (è
__THROW
;

75 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

78 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

79 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

82 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

88 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

89 cÚ¡ *
__»¡riù
 
__fÜm©
,

90 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

92 #ifdeà
__USE_XOPEN


95 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

96 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

97 
__THROW
;

100 #ifdeà
__USE_XOPEN2K8


104 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

105 cÚ¡ *
__»¡riù
 
__fÜm©
,

106 cÚ¡ 
tm
 *
__»¡riù
 
__
,

107 
loÿË_t
 
__loc
è
__THROW
;

110 #ifdeà
__USE_GNU


111 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

112 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

113 
loÿË_t
 
__loc
è
__THROW
;

119 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

123 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

125 #ifdeà
__USE_POSIX


128 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

129 
tm
 *
__»¡riù
 
__
è
__THROW
;

133 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

134 
tm
 *
__»¡riù
 
__
è
__THROW
;

139 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

142 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

144 #ifdeà
__USE_POSIX


149 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

150 *
__»¡riù
 
__buf
è
__THROW
;

153 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

154 *
__»¡riù
 
__buf
è
__THROW
;

159 *
__tzÇme
[2];

160 
__daylight
;

161 
__timezÚe
;

164 #ifdef 
__USE_POSIX


166 *
tzÇme
[2];

170 
	$tz£t
 (è
__THROW
;

173 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


174 
daylight
;

175 
timezÚe
;

178 #ifdeà
__USE_MISC


181 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

187 
	#__i¦—p
(
y—r
) \

188 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

191 #ifdeà
__USE_MISC


196 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

199 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

202 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

206 #ifdeà
__USE_POSIX199309


211 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

212 
time¥ec
 *
__»maššg
);

216 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

219 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

222 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

223 
__THROW
;

225 #ifdeà
__USE_XOPEN2K


230 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

231 cÚ¡ 
time¥ec
 *
__»q
,

232 
time¥ec
 *
__»m
);

235 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

240 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

241 
sigev’t
 *
__»¡riù
 
__evp
,

242 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

245 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

248 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

249 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

250 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

253 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

254 
__THROW
;

257 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

261 #ifdeà
__USE_ISOC11


263 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

264 
__THROW
 
	`__nÚnuÎ
 ((1));

268 #ifdeà
__USE_XOPEN_EXTENDED


280 
g‘d©e_”r
;

289 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

292 #ifdeà
__USE_GNU


303 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

304 
tm
 *
__»¡riù
 
__»sbuå
);

307 
__END_DECLS


	@/usr/include/bits/_G_config.h

4 #iâdeà
_BITS_G_CONFIG_H


5 
	#_BITS_G_CONFIG_H
 1

	)

7 #ià!
defšed
 
_BITS_LIBIO_H
 && !defšed 
_G_CONFIG_H


13 
	~<b™s/ty³s.h
>

14 
	#__Ãed_size_t


	)

15 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


16 
	#__Ãed_wch¬_t


	)

18 
	#__Ãed_NULL


	)

19 
	~<¡ddef.h
>

21 
	~<b™s/ty³s/__mb¡©e_t.h
>

22 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


23 
	~<b™s/ty³s/wšt_t.h
>

28 
__off_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos_t
;

33 
__off64_t
 
	m__pos
;

34 
__mb¡©e_t
 
	m__¡©e
;

35 } 
	t_G_åos64_t
;

36 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


37 
	~<gcÚv.h
>

40 
__gcÚv_šfo
 
	m__cd
;

43 
__gcÚv_šfo
 
	m__cd
;

44 
__gcÚv_¡•_d©a
 
	m__d©a
;

45 } 
	m__combšed
;

46 } 
	t_G_icÚv_t
;

51 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

53 
	#_G_HAVE_MMAP
 1

	)

54 
	#_G_HAVE_MREMAP
 1

	)

56 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

59 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

61 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/bits/byteswap.h

19 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/ty³s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((è((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8)))

	)

35 
	~<b™s/by‹sw­-16.h
>

38 
	#__bsw­_cÚ¡ªt_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

42 #ifdeà
__GNUC__


43 #ià
__GNUC_PREREQ
 (4, 3)

44 
__šlše
 

45 
	$__bsw­_32
 (
__bsx
)

47  
	`__butš_bsw­32
 (
__bsx
);

48 
	}
}

49 #–ià
__GNUC__
 >= 2

50 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

51 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

52 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

53 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

54 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

55 || 
defšed
 
	g__amdçm10__
)

58 
	#__bsw­_32
(
x
) \

59 (
__ex‹nsiÚ__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

62 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

64 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw­_32
(
x
) \

68 (
__ex‹nsiÚ__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

71 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "ô" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw­_32
(
x
) \

83 (
__ex‹nsiÚ__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

87 
__šlše
 

88 
	$__bsw­_32
 (
__bsx
)

90  
	`__bsw­_cÚ¡ªt_32
 (
__bsx
);

91 
	}
}

95 #ià
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw­_cÚ¡ªt_64
(
x
) \

98 (
	`__ex‹nsiÚ__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
è& 0x00000000000000ffuÎè<< 56)))

	)

107 #ià
__GNUC_PREREQ
 (4, 3)

108 
__šlše
 
__ušt64_t


109 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

111  
	`__butš_bsw­64
 (
__bsx
);

112 
	}
}

113 #–ià
__WORDSIZE
 == 64

114 
	#__bsw­_64
(
x
) \

115 (
__ex‹nsiÚ__
 \

116 ({ 
__ušt64_t
 
__v
, 
__x
 = (
x
); \

117 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

118 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

120 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw­_64
(
x
) \

124 (
__ex‹nsiÚ__
 \

125 ({ uniÚ { 
__ex‹nsiÚ__
 
__ušt64_t
 
__Î
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

128 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

131 
__w
.
__Î
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

135 
__r
.
__Î
; }))

	)

138 
	#__bsw­_cÚ¡ªt_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

148 
__šlše
 
__ušt64_t


149 
	$__bsw­_64
 (
__ušt64_t
 
__bsx
)

151  
	`__bsw­_cÚ¡ªt_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/cpu-set.h

20 #iâdeà
_BITS_CPU_SET_H


21 
	#_BITS_CPU_SET_H
 1

	)

23 #iâdeà
_SCHED_H


28 
	#__CPU_SETSIZE
 1024

	)

29 
	#__NCPUBITS
 (8 *  (
__ıu_mask
))

	)

32 
__CPU_MASK_TYPE
 
	t__ıu_mask
;

35 
	#__CPUELT
(
ıu
è((ıuè/ 
__NCPUBITS
)

	)

36 
	#__CPUMASK
(
ıu
è((
__ıu_mask
è1 << ((ıuè% 
__NCPUBITS
))

	)

41 
__ıu_mask
 
	m__b™s
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

42 } 
	tıu_£t_t
;

45 #ià
__GNUC_PREREQ
 (2, 91)

46 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

47 dØ
	`__butš_mem£t
 (
ıu£
, '\0', 
£tsize
); 0)

	)

49 
	#__CPU_ZERO_S
(
£tsize
, 
ıu£
) \

51 
size_t
 
__i
; \

52 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

53 
__ıu_mask
 *
__b™s
 = (
ıu£
)->__bits; \

54 
__i
 = 0; __˜< 
__imax
; ++__i) \

55 
__b™s
[
__i
] = 0; \

56 } 0)

	)

58 
	#__CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
) \

59 (
__ex‹nsiÚ__
 \

60 ({ 
size_t
 
__ıu
 = (
ıu
); \

61 
__ıu
 / 8 < (
£tsize
) \

62 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

63 |ğ
	`__CPUMASK
 (
__ıu
)) \

64 : 0; }))

	)

65 
	#__CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
) \

66 (
__ex‹nsiÚ__
 \

67 ({ 
size_t
 
__ıu
 = (
ıu
); \

68 
__ıu
 / 8 < (
£tsize
) \

69 ? (((
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

70 &ğ~
	`__CPUMASK
 (
__ıu
)) \

71 : 0; }))

	)

72 
	#__CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
) \

73 (
__ex‹nsiÚ__
 \

74 ({ 
size_t
 
__ıu
 = (
ıu
); \

75 
__ıu
 / 8 < (
£tsize
) \

76 ? ((((cÚ¡ 
__ıu_mask
 *è((
ıu£
)->
__b™s
))[
	`__CPUELT
 (
__ıu
)] \

77 & 
	`__CPUMASK
 (
__ıu
))) != 0 \

78 : 0; }))

	)

80 
	#__CPU_COUNT_S
(
£tsize
, 
ıu£
) \

81 
	`__sched_ıucouÁ
 (
£tsize
, 
ıu£
)

	)

83 #ià
__GNUC_PREREQ
 (2, 91)

84 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

85 (
	`__butš_memcmp
 (
ıu£1
, 
ıu£2
, 
£tsize
è=ğ0)

	)

87 
	#__CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

88 (
__ex‹nsiÚ__
 \

89 ({ cÚ¡ 
__ıu_mask
 *
__¬r1
 = (
ıu£1
)->
__b™s
; \

90 cÚ¡ 
__ıu_mask
 *
__¬r2
 = (
ıu£2
)->
__b™s
; \

91 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

92 
size_t
 
__i
; \

93 
__i
 = 0; __˜< 
__imax
; ++__i) \

94 ià(
__¬r1
[
__i
] !ğ
__¬r2
[__i]) \

96 
__i
 =ğ
__imax
; }))

	)

99 
	#__CPU_OP_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, 
İ
) \

100 (
__ex‹nsiÚ__
 \

101 ({ 
ıu_£t_t
 *
__de¡
 = (
de¡£t
); \

102 cÚ¡ 
__ıu_mask
 *
__¬r1
 = (
¤c£t1
)->
__b™s
; \

103 cÚ¡ 
__ıu_mask
 *
__¬r2
 = (
¤c£t2
)->
__b™s
; \

104 
size_t
 
__imax
 = (
£tsize
è/  (
__ıu_mask
); \

105 
size_t
 
__i
; \

106 
__i
 = 0; __˜< 
__imax
; ++__i) \

107 ((
__ıu_mask
 *è
__de¡
->
__b™s
)[
__i
] = 
__¬r1
[__i] 
İ
 
__¬r2
[__i]; \

108 
__de¡
; }))

	)

110 
	#__CPU_ALLOC_SIZE
(
couÁ
) \

111 ((((
couÁ
è+ 
__NCPUBITS
 - 1è/ __NCPUBITSè*  (
__ıu_mask
))

	)

112 
	#__CPU_ALLOC
(
couÁ
è
	`__sched_ıu®loc
 (couÁ)

	)

113 
	#__CPU_FREE
(
ıu£t
è
	`__sched_ıuä“
 (ıu£t)

	)

115 
__BEGIN_DECLS


117 
	$__sched_ıucouÁ
 (
size_t
 
__£tsize
, cÚ¡ 
ıu_£t_t
 *
__£
)

118 
__THROW
;

119 
ıu_£t_t
 *
	$__sched_ıu®loc
 (
size_t
 
__couÁ
è
__THROW
 
__wur
;

120 
	$__sched_ıuä“
 (
ıu_£t_t
 *
__£t
è
__THROW
;

122 
__END_DECLS


	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/fcntl-linux.h

19 #iâdef 
_FCNTL_H


37 #ifdeà
__USE_GNU


38 
	~<b™s/ty³s/¡ruù_iovec.h
>

42 
	#O_ACCMODE
 0003

	)

43 
	#O_RDONLY
 00

	)

44 
	#O_WRONLY
 01

	)

45 
	#O_RDWR
 02

	)

46 #iâdeà
O_CREAT


47 
	#O_CREAT
 0100

	)

49 #iâdeà
O_EXCL


50 
	#O_EXCL
 0200

	)

52 #iâdeà
O_NOCTTY


53 
	#O_NOCTTY
 0400

	)

55 #iâdeà
O_TRUNC


56 
	#O_TRUNC
 01000

	)

58 #iâdeà
O_APPEND


59 
	#O_APPEND
 02000

	)

61 #iâdeà
O_NONBLOCK


62 
	#O_NONBLOCK
 04000

	)

64 #iâdeà
O_NDELAY


65 
	#O_NDELAY
 
O_NONBLOCK


	)

67 #iâdeà
O_SYNC


68 
	#O_SYNC
 04010000

	)

70 
	#O_FSYNC
 
O_SYNC


	)

71 #iâdeà
O_ASYNC


72 
	#O_ASYNC
 020000

	)

74 #iâdeà
__O_LARGEFILE


75 
	#__O_LARGEFILE
 0100000

	)

78 #iâdeà
__O_DIRECTORY


79 
	#__O_DIRECTORY
 0200000

	)

81 #iâdeà
__O_NOFOLLOW


82 
	#__O_NOFOLLOW
 0400000

	)

84 #iâdeà
__O_CLOEXEC


85 
	#__O_CLOEXEC
 02000000

	)

87 #iâdeà
__O_DIRECT


88 
	#__O_DIRECT
 040000

	)

90 #iâdeà
__O_NOATIME


91 
	#__O_NOATIME
 01000000

	)

93 #iâdeà
__O_PATH


94 
	#__O_PATH
 010000000

	)

96 #iâdeà
__O_DSYNC


97 
	#__O_DSYNC
 010000

	)

99 #iâdeà
__O_TMPFILE


100 
	#__O_TMPFILE
 (020000000 | 
__O_DIRECTORY
)

	)

103 #iâdeà
F_GETLK


104 #iâdeà
__USE_FILE_OFFSET64


105 
	#F_GETLK
 5

	)

106 
	#F_SETLK
 6

	)

107 
	#F_SETLKW
 7

	)

109 
	#F_GETLK
 
F_GETLK64


	)

110 
	#F_SETLK
 
F_SETLK64


	)

111 
	#F_SETLKW
 
F_SETLKW64


	)

114 #iâdeà
F_GETLK64


115 
	#F_GETLK64
 12

	)

116 
	#F_SETLK64
 13

	)

117 
	#F_SETLKW64
 14

	)

131 #ifdeà
__USE_GNU


132 
	#F_OFD_GETLK
 36

	)

133 
	#F_OFD_SETLK
 37

	)

134 
	#F_OFD_SETLKW
 38

	)

137 #ifdeà
__USE_LARGEFILE64


138 
	#O_LARGEFILE
 
__O_LARGEFILE


	)

141 #ifdeà
__USE_XOPEN2K8


142 
	#O_DIRECTORY
 
__O_DIRECTORY


	)

143 
	#O_NOFOLLOW
 
__O_NOFOLLOW


	)

144 
	#O_CLOEXEC
 
__O_CLOEXEC


	)

147 #ifdeà
__USE_GNU


148 
	#O_DIRECT
 
__O_DIRECT


	)

149 
	#O_NOATIME
 
__O_NOATIME


	)

150 
	#O_PATH
 
__O_PATH


	)

151 
	#O_TMPFILE
 
__O_TMPFILE


	)

157 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


158 
	#O_DSYNC
 
__O_DSYNC


	)

159 #ià
defšed
 
__O_RSYNC


160 
	#O_RSYNC
 
__O_RSYNC


	)

162 
	#O_RSYNC
 
O_SYNC


	)

167 
	#F_DUPFD
 0

	)

168 
	#F_GETFD
 1

	)

169 
	#F_SETFD
 2

	)

170 
	#F_GETFL
 3

	)

171 
	#F_SETFL
 4

	)

173 #iâdeà
__F_SETOWN


174 
	#__F_SETOWN
 8

	)

175 
	#__F_GETOWN
 9

	)

178 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


179 
	#F_SETOWN
 
__F_SETOWN


	)

180 
	#F_GETOWN
 
__F_GETOWN


	)

183 #iâdeà
__F_SETSIG


184 
	#__F_SETSIG
 10

	)

185 
	#__F_GETSIG
 11

	)

187 #iâdeà
__F_SETOWN_EX


188 
	#__F_SETOWN_EX
 15

	)

189 
	#__F_GETOWN_EX
 16

	)

192 #ifdeà
__USE_GNU


193 
	#F_SETSIG
 
__F_SETSIG


	)

194 
	#F_GETSIG
 
__F_GETSIG


	)

195 
	#F_SETOWN_EX
 
__F_SETOWN_EX


	)

196 
	#F_GETOWN_EX
 
__F_GETOWN_EX


	)

199 #ifdeà
__USE_GNU


200 
	#F_SETLEASE
 1024

	)

201 
	#F_GETLEASE
 1025

	)

202 
	#F_NOTIFY
 1026

	)

203 
	#F_SETPIPE_SZ
 1031

	)

204 
	#F_GETPIPE_SZ
 1032

	)

205 
	#F_ADD_SEALS
 1033

	)

206 
	#F_GET_SEALS
 1034

	)

208 
	#F_GET_RW_HINT
 1035

	)

209 
	#F_SET_RW_HINT
 1036

	)

210 
	#F_GET_FILE_RW_HINT
 1037

	)

211 
	#F_SET_FILE_RW_HINT
 1038

	)

213 #ifdeà
__USE_XOPEN2K8


214 
	#F_DUPFD_CLOEXEC
 1030

	)

219 
	#FD_CLOEXEC
 1

	)

221 #iâdeà
F_RDLCK


223 
	#F_RDLCK
 0

	)

224 
	#F_WRLCK
 1

	)

225 
	#F_UNLCK
 2

	)

230 #iâdeà
F_EXLCK


231 
	#F_EXLCK
 4

	)

232 
	#F_SHLCK
 8

	)

235 #ifdeà
__USE_MISC


237 
	#LOCK_SH
 1

	)

238 
	#LOCK_EX
 2

	)

239 
	#LOCK_NB
 4

	)

241 
	#LOCK_UN
 8

	)

244 #ifdeà
__USE_GNU


245 
	#LOCK_MAND
 32

	)

246 
	#LOCK_READ
 64

	)

247 
	#LOCK_WRITE
 128

	)

248 
	#LOCK_RW
 192

	)

251 #ifdeà
__USE_GNU


253 
	#DN_ACCESS
 0x00000001

	)

254 
	#DN_MODIFY
 0x00000002

	)

255 
	#DN_CREATE
 0x00000004

	)

256 
	#DN_DELETE
 0x00000008

	)

257 
	#DN_RENAME
 0x00000010

	)

258 
	#DN_ATTRIB
 0x00000020

	)

259 
	#DN_MULTISHOT
 0x80000000

	)

263 #ifdeà
__USE_GNU


265 
	e__pid_ty³


267 
	mF_OWNER_TID
 = 0,

268 
	mF_OWNER_PID
,

269 
	mF_OWNER_PGRP
,

270 
	mF_OWNER_GID
 = 
F_OWNER_PGRP


274 
	sf_owÃr_ex


276 
__pid_ty³
 
	mty³
;

277 
__pid_t
 
	mpid
;

281 #ifdeà
__USE_GNU


283 
	#F_SEAL_SEAL
 0x0001

	)

284 
	#F_SEAL_SHRINK
 0x0002

	)

285 
	#F_SEAL_GROW
 0x0004

	)

286 
	#F_SEAL_WRITE
 0x0008

	)

289 #ifdeà
__USE_GNU


291 
	#RWF_WRITE_LIFE_NOT_SET
 0

	)

292 
	#RWH_WRITE_LIFE_NONE
 1

	)

293 
	#RWH_WRITE_LIFE_SHORT
 2

	)

294 
	#RWH_WRITE_LIFE_MEDIUM
 3

	)

295 
	#RWH_WRITE_LIFE_LONG
 4

	)

296 
	#RWH_WRITE_LIFE_EXTREME
 5

	)

301 #ifdef 
__USE_MISC


302 
	#FAPPEND
 
O_APPEND


	)

303 
	#FFSYNC
 
O_FSYNC


	)

304 
	#FASYNC
 
O_ASYNC


	)

305 
	#FNONBLOCK
 
O_NONBLOCK


	)

306 
	#FNDELAY
 
O_NDELAY


	)

309 #iâdeà
__POSIX_FADV_DONTNEED


310 
	#__POSIX_FADV_DONTNEED
 4

	)

311 
	#__POSIX_FADV_NOREUSE
 5

	)

314 #ifdeà
__USE_XOPEN2K


315 
	#POSIX_FADV_NORMAL
 0

	)

316 
	#POSIX_FADV_RANDOM
 1

	)

317 
	#POSIX_FADV_SEQUENTIAL
 2

	)

318 
	#POSIX_FADV_WILLNEED
 3

	)

319 
	#POSIX_FADV_DONTNEED
 
__POSIX_FADV_DONTNEED


	)

320 
	#POSIX_FADV_NOREUSE
 
__POSIX_FADV_NOREUSE


	)

324 #ifdeà
__USE_GNU


326 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

329 
	#SYNC_FILE_RANGE_WRITE
 2

	)

332 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

337 
	#SPLICE_F_MOVE
 1

	)

338 
	#SPLICE_F_NONBLOCK
 2

	)

341 
	#SPLICE_F_MORE
 4

	)

342 
	#SPLICE_F_GIFT
 8

	)

346 
	~<lšux/çÎoc.h
>

350 
	sfe_hªdË


352 
	mhªdË_by‹s
;

353 
	mhªdË_ty³
;

355 
	mf_hªdË
[0];

359 
	#MAX_HANDLE_SZ
 128

	)

363 #ifdeà
__USE_ATFILE


364 
	#AT_FDCWD
 -100

	)

367 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

368 
	#AT_REMOVEDIR
 0x200

	)

370 
	#AT_SYMLINK_FOLLOW
 0x400

	)

371 #ifdeà
__USE_GNU


372 
	#AT_NO_AUTOMOUNT
 0x800

	)

374 
	#AT_EMPTY_PATH
 0x1000

	)

376 
	#AT_EACCESS
 0x200

	)

380 
	g__BEGIN_DECLS


382 #ifdeà
__USE_GNU


385 
__ssize_t
 
	$»adah—d
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__couÁ
)

386 
__THROW
;

393 
	`sync_fe_¿nge
 (
__fd
, 
__off64_t
 
__off£t
, __off64_ˆ
__couÁ
,

394 
__æags
);

401 
__ssize_t
 
	`vm¥liû
 (
__fdout
, cÚ¡ 
iovec
 *
__iov
,

402 
size_t
 
__couÁ
, 
__æags
);

408 
__ssize_t
 
	`¥liû
 (
__fdš
, 
__off64_t
 *
__offš
, 
__fdout
,

409 
__off64_t
 *
__offout
, 
size_t
 
__Ën
,

410 
__æags
);

416 
__ssize_t
 
	`‹e
 (
__fdš
, 
__fdout
, 
size_t
 
__Ën
,

417 
__æags
);

423 #iâdeà
__USE_FILE_OFFSET64


424 
	`çÎoÿ‹
 (
__fd
, 
__mode
, 
__off_t
 
__off£t
, __off_ˆ
__Ën
);

426 #ifdeà
__REDIRECT


427 
	`__REDIRECT
 (
çÎoÿ‹
, (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

428 
__off64_t
 
__Ën
),

429 
çÎoÿ‹64
);

431 
	#çÎoÿ‹
 
çÎoÿ‹64


	)

434 #ifdeà
__USE_LARGEFILE64


435 
	`çÎoÿ‹64
 (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

436 
__off64_t
 
__Ën
);

441 
	$Çme_to_hªdË_©
 (
__dfd
, cÚ¡ *
__Çme
,

442 
fe_hªdË
 *
__hªdË
, *
__mÁ_id
,

443 
__æags
è
__THROW
;

449 
	`İ’_by_hªdË_©
 (
__mouÁdœfd
, 
fe_hªdË
 *
__hªdË
,

450 
__æags
);

454 
__END_DECLS


	@/usr/include/bits/floatn-common.h

20 #iâdeà
_BITS_FLOATN_COMMON_H


21 
	#_BITS_FLOATN_COMMON_H


	)

23 
	~<ã©u»s.h
>

24 
	~<b™s/lÚg-doubË.h
>

34 
	#__HAVE_FLOAT16
 0

	)

35 
	#__HAVE_FLOAT32
 1

	)

36 
	#__HAVE_FLOAT64
 1

	)

37 
	#__HAVE_FLOAT32X
 1

	)

38 
	#__HAVE_FLOAT128X
 0

	)

52 
	#__HAVE_DISTINCT_FLOAT16
 
__HAVE_FLOAT16


	)

53 
	#__HAVE_DISTINCT_FLOAT32
 0

	)

54 
	#__HAVE_DISTINCT_FLOAT64
 0

	)

55 
	#__HAVE_DISTINCT_FLOAT32X
 0

	)

56 
	#__HAVE_DISTINCT_FLOAT64X
 0

	)

57 
	#__HAVE_DISTINCT_FLOAT128X
 
__HAVE_FLOAT128X


	)

62 #ià
__GNUC_PREREQ
 (7, 0è&& !
defšed
 
__ılu¥lus


63 
	#__HAVE_FLOATN_NOT_TYPEDEF
 1

	)

65 
	#__HAVE_FLOATN_NOT_TYPEDEF
 0

	)

68 #iâdeà
__ASSEMBLER__


73 #ià
__HAVE_FLOAT16


74 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


76 
	#__f16
(
x
è((
_Flßt16
èx##
f
)

	)

78 
	#__f16
(
x
èx##
f16


	)

82 #ià
__HAVE_FLOAT32


83 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


84 
	#__f32
(
x
èx##
f


	)

86 
	#__f32
(
x
èx##
f32


	)

90 #ià
__HAVE_FLOAT64


91 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


92 #ifdeà
__NO_LONG_DOUBLE_MATH


93 
	#__f64
(
x
èx##
l


	)

95 
	#__f64
(
x
è
	)
x

98 
	#__f64
(
x
èx##
f64


	)

102 #ià
__HAVE_FLOAT32X


103 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


104 
	#__f32x
(
x
è
	)
x

106 
	#__f32x
(
x
èx##
f32x


	)

110 #ià
__HAVE_FLOAT64X


111 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


112 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


113 
	#__f64x
(
x
èx##
l


	)

115 
	#__f64x
(
x
è
	`__f128
 (x)

	)

118 
	#__f64x
(
x
èx##
f64x


	)

122 #ià
__HAVE_FLOAT128X


123 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


126 
	#__f128x
(
x
èx##
f128x


	)

131 #ià
__HAVE_FLOAT16


132 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


133 
_Com¶ex
 
	t__cæßt16
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HC__
)));

134 
	#__CFLOAT16
 
__cæßt16


	)

136 
	#__CFLOAT16
 
_Com¶ex
 
_Flßt16


	)

140 #ià
__HAVE_FLOAT32


141 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


142 
	#__CFLOAT32
 
_Com¶ex
 

	)

144 
	#__CFLOAT32
 
_Com¶ex
 
_Flßt32


	)

148 #ià
__HAVE_FLOAT64


149 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


150 #ifdeà
__NO_LONG_DOUBLE_MATH


151 
	#__CFLOAT64
 
_Com¶ex
 

	)

153 
	#__CFLOAT64
 
_Com¶ex
 

	)

156 
	#__CFLOAT64
 
_Com¶ex
 
_Flßt64


	)

160 #ià
__HAVE_FLOAT32X


161 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


162 
	#__CFLOAT32X
 
_Com¶ex
 

	)

164 
	#__CFLOAT32X
 
_Com¶ex
 
_Flßt32x


	)

168 #ià
__HAVE_FLOAT64X


169 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


170 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


171 
	#__CFLOAT64X
 
_Com¶ex
 

	)

173 
	#__CFLOAT64X
 
__CFLOAT128


	)

176 
	#__CFLOAT64X
 
_Com¶ex
 
_Flßt64x


	)

180 #ià
__HAVE_FLOAT128X


181 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


184 
	#__CFLOAT128X
 
_Com¶ex
 
_Flßt128x


	)

189 #ià
__HAVE_FLOAT16


191 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


192 
	t_Flßt16
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__HF__
)));

195 #ià!
__GNUC_PREREQ
 (7, 0)

196 
	#__butš_huge_v®f16
(è((
_Flßt16
è
	`__butš_huge_v®
 ())

	)

197 
	#__butš_šff16
(è((
_Flßt16
è
	`__butš_šf
 ())

	)

198 
	#__butš_Çnf16
(
x
è((
_Flßt16
è
	`__butš_Çn
 (x))

	)

199 
	#__butš_Çnsf16
(
x
è((
_Flßt16
è
	`__butš_Çns
 (x))

	)

204 #ià
__HAVE_FLOAT32


206 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


207 
	t_Flßt32
;

210 #ià!
__GNUC_PREREQ
 (7, 0)

211 
	#__butš_huge_v®f32
(è(
	`__butš_huge_v®f
 ())

	)

212 
	#__butš_šff32
(è(
	`__butš_šff
 ())

	)

213 
	#__butš_Çnf32
(
x
è(
	`__butš_Çnf
 (x))

	)

214 
	#__butš_Çnsf32
(
x
è(
	`__butš_Çnsf
 (x))

	)

219 #ià
__HAVE_FLOAT64


228 #ifdeà
__NO_LONG_DOUBLE_MATH


230 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


231 
	t_Flßt64
;

234 #ià!
__GNUC_PREREQ
 (7, 0)

235 
	#__butš_huge_v®f64
(è(
	`__butš_huge_v®l
 ())

	)

236 
	#__butš_šff64
(è(
	`__butš_šæ
 ())

	)

237 
	#__butš_Çnf64
(
x
è(
	`__butš_ÇÆ
 (x))

	)

238 
	#__butš_Çnsf64
(
x
è(
	`__butš_Çn¦
 (x))

	)

243 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


244 
	t_Flßt64
;

247 #ià!
__GNUC_PREREQ
 (7, 0)

248 
	#__butš_huge_v®f64
(è(
	`__butš_huge_v®
 ())

	)

249 
	#__butš_šff64
(è(
	`__butš_šf
 ())

	)

250 
	#__butš_Çnf64
(
x
è(
	`__butš_Çn
 (x))

	)

251 
	#__butš_Çnsf64
(
x
è(
	`__butš_Çns
 (x))

	)

258 #ià
__HAVE_FLOAT32X


260 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


261 
	t_Flßt32x
;

264 #ià!
__GNUC_PREREQ
 (7, 0)

265 
	#__butš_huge_v®f32x
(è(
	`__butš_huge_v®
 ())

	)

266 
	#__butš_šff32x
(è(
	`__butš_šf
 ())

	)

267 
	#__butš_Çnf32x
(
x
è(
	`__butš_Çn
 (x))

	)

268 
	#__butš_Çnsf32x
(
x
è(
	`__butš_Çns
 (x))

	)

273 #ià
__HAVE_FLOAT64X


275 #ià
__HAVE_FLOAT64X_LONG_DOUBLE


277 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


278 
	t_Flßt64x
;

281 #ià!
__GNUC_PREREQ
 (7, 0)

282 
	#__butš_huge_v®f64x
(è(
	`__butš_huge_v®l
 ())

	)

283 
	#__butš_šff64x
(è(
	`__butš_šæ
 ())

	)

284 
	#__butš_Çnf64x
(
x
è(
	`__butš_ÇÆ
 (x))

	)

285 
	#__butš_Çnsf64x
(
x
è(
	`__butš_Çn¦
 (x))

	)

290 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


291 
_Flßt128
 
	t_Flßt64x
;

294 #ià!
__GNUC_PREREQ
 (7, 0)

295 
	#__butš_huge_v®f64x
(è(
	`__butš_huge_v®f128
 ())

	)

296 
	#__butš_šff64x
(è(
	`__butš_šff128
 ())

	)

297 
	#__butš_Çnf64x
(
x
è(
	`__butš_Çnf128
 (x))

	)

298 
	#__butš_Çnsf64x
(
x
è(
	`__butš_Çnsf128
 (x))

	)

305 #ià
__HAVE_FLOAT128X


307 #ià!
__GNUC_PREREQ
 (7, 0è|| 
defšed
 
__ılu¥lus


311 #ià!
__GNUC_PREREQ
 (7, 0)

312 
	#__butš_huge_v®f128x
(è((
_Flßt128x
è
	`__butš_huge_v®
 ())

	)

313 
	#__butš_šff128x
(è((
_Flßt128x
è
	`__butš_šf
 ())

	)

314 
	#__butš_Çnf128x
(
x
è((
_Flßt128x
è
	`__butš_Çn
 (x))

	)

315 
	#__butš_Çnsf128x
(
x
è((
_Flßt128x
è
	`__butš_Çns
 (x))

	)

	@/usr/include/bits/getopt_core.h

20 #iâdeà
_GETOPT_CORE_H


21 
	#_GETOPT_CORE_H
 1

	)

28 
__BEGIN_DECLS


36 *
İrg
;

50 
İtšd
;

55 
İ‹¼
;

59 
İtİt
;

91 
	$g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

92 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

94 
__END_DECLS


	@/usr/include/bits/libio-ldbl.h

19 #iâdeà
_BITS_LIBIO_LDBL_H


20 
	#_BITS_LIBIO_LDBL_H
 1

	)

22 #iâdeà
_BITS_LIBIO_H


26 
	$__LDBL_REDIR_DECL
 (
_IO_vfsÿnf
)

27 
	$__LDBL_REDIR_DECL
 (
_IO_vårštf
)

	@/usr/include/bits/libm-simd-decl-stubs.h

19 #iâdeà
_MATH_H


33 #iâdeà
_BITS_LIBM_SIMD_DECL_STUBS_H


34 
	#_BITS_LIBM_SIMD_DECL_STUBS_H
 1

	)

36 
	#__DECL_SIMD_cos


	)

37 
	#__DECL_SIMD_cosf


	)

38 
	#__DECL_SIMD_co¦


	)

39 
	#__DECL_SIMD_cosf16


	)

40 
	#__DECL_SIMD_cosf32


	)

41 
	#__DECL_SIMD_cosf64


	)

42 
	#__DECL_SIMD_cosf128


	)

43 
	#__DECL_SIMD_cosf32x


	)

44 
	#__DECL_SIMD_cosf64x


	)

45 
	#__DECL_SIMD_cosf128x


	)

47 
	#__DECL_SIMD_sš


	)

48 
	#__DECL_SIMD_sšf


	)

49 
	#__DECL_SIMD_sšl


	)

50 
	#__DECL_SIMD_sšf16


	)

51 
	#__DECL_SIMD_sšf32


	)

52 
	#__DECL_SIMD_sšf64


	)

53 
	#__DECL_SIMD_sšf128


	)

54 
	#__DECL_SIMD_sšf32x


	)

55 
	#__DECL_SIMD_sšf64x


	)

56 
	#__DECL_SIMD_sšf128x


	)

58 
	#__DECL_SIMD_sšcos


	)

59 
	#__DECL_SIMD_sšcosf


	)

60 
	#__DECL_SIMD_sšco¦


	)

61 
	#__DECL_SIMD_sšcosf16


	)

62 
	#__DECL_SIMD_sšcosf32


	)

63 
	#__DECL_SIMD_sšcosf64


	)

64 
	#__DECL_SIMD_sšcosf128


	)

65 
	#__DECL_SIMD_sšcosf32x


	)

66 
	#__DECL_SIMD_sšcosf64x


	)

67 
	#__DECL_SIMD_sšcosf128x


	)

69 
	#__DECL_SIMD_log


	)

70 
	#__DECL_SIMD_logf


	)

71 
	#__DECL_SIMD_logl


	)

72 
	#__DECL_SIMD_logf16


	)

73 
	#__DECL_SIMD_logf32


	)

74 
	#__DECL_SIMD_logf64


	)

75 
	#__DECL_SIMD_logf128


	)

76 
	#__DECL_SIMD_logf32x


	)

77 
	#__DECL_SIMD_logf64x


	)

78 
	#__DECL_SIMD_logf128x


	)

80 
	#__DECL_SIMD_exp


	)

81 
	#__DECL_SIMD_expf


	)

82 
	#__DECL_SIMD_ex¶


	)

83 
	#__DECL_SIMD_expf16


	)

84 
	#__DECL_SIMD_expf32


	)

85 
	#__DECL_SIMD_expf64


	)

86 
	#__DECL_SIMD_expf128


	)

87 
	#__DECL_SIMD_expf32x


	)

88 
	#__DECL_SIMD_expf64x


	)

89 
	#__DECL_SIMD_expf128x


	)

91 
	#__DECL_SIMD_pow


	)

92 
	#__DECL_SIMD_powf


	)

93 
	#__DECL_SIMD_powl


	)

94 
	#__DECL_SIMD_powf16


	)

95 
	#__DECL_SIMD_powf32


	)

96 
	#__DECL_SIMD_powf64


	)

97 
	#__DECL_SIMD_powf128


	)

98 
	#__DECL_SIMD_powf32x


	)

99 
	#__DECL_SIMD_powf64x


	)

100 
	#__DECL_SIMD_powf128x


	)

	@/usr/include/bits/local_lim.h

24 #iâdeà
NR_OPEN


25 
	#__undef_NR_OPEN


	)

27 #iâdeà
LINK_MAX


28 
	#__undef_LINK_MAX


	)

30 #iâdeà
OPEN_MAX


31 
	#__undef_OPEN_MAX


	)

33 #iâdeà
ARG_MAX


34 
	#__undef_ARG_MAX


	)

38 
	~<lšux/lim™s.h
>

41 #ifdeà
__undef_NR_OPEN


42 #undeà
NR_OPEN


43 #undeà
__undef_NR_OPEN


46 #ifdeà
__undef_LINK_MAX


47 #undeà
LINK_MAX


48 #undeà
__undef_LINK_MAX


51 #ifdeà
__undef_OPEN_MAX


52 #undeà
OPEN_MAX


53 #undeà
__undef_OPEN_MAX


56 #ifdeà
__undef_ARG_MAX


57 #undeà
ARG_MAX


58 #undeà
__undef_ARG_MAX


62 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

64 
	#PTHREAD_KEYS_MAX
 1024

	)

67 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

69 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

72 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

74 #undeà
PTHREAD_THREADS_MAX


78 
	#AIO_PRIO_DELTA_MAX
 20

	)

81 
	#PTHREAD_STACK_MIN
 16384

	)

84 
	#DELAYTIMER_MAX
 2147483647

	)

87 
	#TTY_NAME_MAX
 32

	)

90 
	#LOGIN_NAME_MAX
 256

	)

93 
	#HOST_NAME_MAX
 64

	)

96 
	#MQ_PRIO_MAX
 32768

	)

99 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/mman-linux.h

19 #iâdeà
_SYS_MMAN_H


32 
	#PROT_READ
 0x1

	)

33 
	#PROT_WRITE
 0x2

	)

34 
	#PROT_EXEC
 0x4

	)

35 
	#PROT_NONE
 0x0

	)

36 
	#PROT_GROWSDOWN
 0x01000000

	)

38 
	#PROT_GROWSUP
 0x02000000

	)

42 
	#MAP_SHARED
 0x01

	)

43 
	#MAP_PRIVATE
 0x02

	)

44 #ifdeà
__USE_MISC


45 
	#MAP_TYPE
 0x0à

	)

49 
	#MAP_FIXED
 0x10

	)

50 #ifdeà
__USE_MISC


51 
	#MAP_FILE
 0

	)

52 #ifdeà
__MAP_ANONYMOUS


53 
	#MAP_ANONYMOUS
 
__MAP_ANONYMOUS


	)

55 
	#MAP_ANONYMOUS
 0x20

	)

57 
	#MAP_ANON
 
MAP_ANONYMOUS


	)

59 
	#MAP_HUGE_SHIFT
 26

	)

60 
	#MAP_HUGE_MASK
 0x3f

	)

64 
	#MS_ASYNC
 1

	)

65 
	#MS_SYNC
 4

	)

66 
	#MS_INVALIDATE
 2

	)

69 #ifdeà
__USE_GNU


70 
	#MREMAP_MAYMOVE
 1

	)

71 
	#MREMAP_FIXED
 2

	)

75 #ifdeà
__USE_MISC


76 
	#MADV_NORMAL
 0

	)

77 
	#MADV_RANDOM
 1

	)

78 
	#MADV_SEQUENTIAL
 2

	)

79 
	#MADV_WILLNEED
 3

	)

80 
	#MADV_DONTNEED
 4

	)

81 
	#MADV_FREE
 8

	)

82 
	#MADV_REMOVE
 9

	)

83 
	#MADV_DONTFORK
 10

	)

84 
	#MADV_DOFORK
 11

	)

85 
	#MADV_MERGEABLE
 12

	)

86 
	#MADV_UNMERGEABLE
 13

	)

87 
	#MADV_HUGEPAGE
 14

	)

88 
	#MADV_NOHUGEPAGE
 15

	)

89 
	#MADV_DONTDUMP
 16

	)

91 
	#MADV_DODUMP
 17

	)

92 
	#MADV_WIPEONFORK
 18

	)

93 
	#MADV_KEEPONFORK
 19

	)

94 
	#MADV_HWPOISON
 100

	)

98 #ifdeà
__USE_XOPEN2K


99 
	#POSIX_MADV_NORMAL
 0

	)

100 
	#POSIX_MADV_RANDOM
 1

	)

101 
	#POSIX_MADV_SEQUENTIAL
 2

	)

102 
	#POSIX_MADV_WILLNEED
 3

	)

103 
	#POSIX_MADV_DONTNEED
 4

	)

107 #iâdeà
MCL_CURRENT


108 
	#MCL_CURRENT
 1

	)

109 
	#MCL_FUTURE
 2

	)

111 
	#MCL_ONFAULT
 4

	)

115 
	~<b™s/mmª-sh¬ed.h
>

	@/usr/include/bits/sched.h

20 #iâdeà
_BITS_SCHED_H


21 
	#_BITS_SCHED_H
 1

	)

23 #iâdeà
_SCHED_H


28 
	#SCHED_OTHER
 0

	)

29 
	#SCHED_FIFO
 1

	)

30 
	#SCHED_RR
 2

	)

31 #ifdeà
__USE_GNU


32 
	#SCHED_BATCH
 3

	)

33 
	#SCHED_ISO
 4

	)

34 
	#SCHED_IDLE
 5

	)

35 
	#SCHED_DEADLINE
 6

	)

37 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

40 #ifdeà
__USE_GNU


42 
	#CSIGNAL
 0x000000fà

	)

43 
	#CLONE_VM
 0x00000100

	)

44 
	#CLONE_FS
 0x00000200

	)

45 
	#CLONE_FILES
 0x00000400

	)

46 
	#CLONE_SIGHAND
 0x00000800

	)

47 
	#CLONE_PTRACE
 0x00002000

	)

48 
	#CLONE_VFORK
 0x00004000

	)

50 
	#CLONE_PARENT
 0x00008000

	)

52 
	#CLONE_THREAD
 0x00010000

	)

53 
	#CLONE_NEWNS
 0x00020000

	)

54 
	#CLONE_SYSVSEM
 0x00040000

	)

55 
	#CLONE_SETTLS
 0x00080000

	)

56 
	#CLONE_PARENT_SETTID
 0x00100000

	)

58 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

60 
	#CLONE_DETACHED
 0x00400000

	)

61 
	#CLONE_UNTRACED
 0x00800000

	)

63 
	#CLONE_CHILD_SETTID
 0x01000000

	)

65 
	#CLONE_NEWCGROUP
 0x02000000

	)

66 
	#CLONE_NEWUTS
 0x04000000

	)

67 
	#CLONE_NEWIPC
 0x08000000

	)

68 
	#CLONE_NEWUSER
 0x10000000

	)

69 
	#CLONE_NEWPID
 0x20000000

	)

70 
	#CLONE_NEWNET
 0x40000000

	)

71 
	#CLONE_IO
 0x80000000

	)

75 
	ssched_·¿m


77 
	msched_´iÜ™y
;

80 
	g__BEGIN_DECLS


82 #ifdeà
__USE_GNU


84 
	$şÚe
 ((*
__â
è(*
__¬g
), *
__chd_¡ack
,

85 
__æags
, *
__¬g
, ...è
__THROW
;

88 
	$unsh¬e
 (
__æags
è
__THROW
;

91 
	$sched_g‘ıu
 (è
__THROW
;

94 
	$£Šs
 (
__fd
, 
__n¡y³
è
__THROW
;

97 
__END_DECLS


	@/usr/include/bits/select.h

18 #iâdeà
_SYS_SELECT_H


22 
	~<b™s/wÜdsize.h
>

25 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

27 #ià
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "¡osq"

	)

30 
	#__FD_ZERO_STOS
 "¡o¦"

	)

33 
	#__FD_ZERO
(
fd¥
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¬r
 = (
£t
); \

52 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |ğ
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((è(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &ğ~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)è!ğ0)

	)

	@/usr/include/bits/select2.h

19 #iâdeà
_SYS_SELECT_H


24 
__fd–t_chk
 (
__d
);

25 
	$__fd–t_w¬n
 (
__d
)

26 
	`__w¬Ç‰r
 ("bit outside of fd_set selected");

27 #undeà
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__ex‹nsiÚ__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__butš_cÚ¡ªt_p
 (
__d
) \

32 ? (0 <ğ
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fd–t_w¬n
 (
__d
)) \

35 : 
	`__fd–t_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/strings_fortified.h

19 #iâdeà
__STRINGS_FORTIFIED


20 
	#__STRINGS_FORTIFIED
 1

	)

22 
__fÜtify_funùiÚ
 

23 
__NTH
 (
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__Ën
))

25 (è
	`__butš___memmove_chk
 (
__de¡
, 
__¤c
, 
__Ën
, 
	`__bos0
 (__dest));

26 
	}
}

28 
__fÜtify_funùiÚ
 

29 
__NTH
 (
	$bz”o
 (*
__de¡
, 
size_t
 
__Ën
))

31 (è
	`__butš___mem£t_chk
 (
__de¡
, '\0', 
__Ën
, 
	`__bos0
 (__dest));

32 
	}
}

	@/usr/include/bits/sysmacros.h

19 #iâdeà
_BITS_SYSMACROS_H


20 
	#_BITS_SYSMACROS_H
 1

	)

22 #iâdeà
_SYS_SYSMACROS_H


36 
	#__SYSMACROS_DECLARE_MAJOR
(
DECL_TEMPL
) \

37 
	`DECL_TEMPL
(, 
majÜ
, (
__dev_t
 
__dev
))

	)

39 
	#__SYSMACROS_DEFINE_MAJOR
(
DECL_TEMPL
) \

40 
	`__SYSMACROS_DECLARE_MAJOR
 (
DECL_TEMPL
) \

42 
__majÜ
; \

43 
__majÜ
 = ((
__dev
 & (
__dev_t
) 0x00000000000fff00u) >> 8); \

44 
__majÜ
 |ğ((
__dev
 & (
__dev_t
) 0xfffff00000000000u) >> 32); \

45  
__majÜ
; \

46 }

	)

48 
	#__SYSMACROS_DECLARE_MINOR
(
DECL_TEMPL
) \

49 
	`DECL_TEMPL
(, 
mšÜ
, (
__dev_t
 
__dev
))

	)

51 
	#__SYSMACROS_DEFINE_MINOR
(
DECL_TEMPL
) \

52 
	`__SYSMACROS_DECLARE_MINOR
 (
DECL_TEMPL
) \

54 
__mšÜ
; \

55 
__mšÜ
 = ((
__dev
 & (
__dev_t
) 0x00000000000000ffu) >> 0); \

56 
__mšÜ
 |ğ((
__dev
 & (
__dev_t
) 0x00000ffffff00000u) >> 12); \

57  
__mšÜ
; \

58 }

	)

60 
	#__SYSMACROS_DECLARE_MAKEDEV
(
DECL_TEMPL
) \

61 
	`DECL_TEMPL
(
__dev_t
, 
makedev
, (
__majÜ
, 
__mšÜ
))

	)

63 
	#__SYSMACROS_DEFINE_MAKEDEV
(
DECL_TEMPL
) \

64 
	`__SYSMACROS_DECLARE_MAKEDEV
 (
DECL_TEMPL
) \

66 
__dev_t
 
__dev
; \

67 
__dev
 = (((
__dev_t
è(
__majÜ
 & 0x00000fffu)) << 8); \

68 
__dev
 |ğ(((
__dev_t
è(
__majÜ
 & 0xfffff000u)) << 32); \

69 
__dev
 |ğ(((
__dev_t
è(
__mšÜ
 & 0x000000ffu)) << 0); \

70 
__dev
 |ğ(((
__dev_t
è(
__mšÜ
 & 0xffffff00u)) << 12); \

71  
__dev
; \

72 }

	)

	@/usr/include/bits/thread-shared-types.h

19 #iâdeà
_THREAD_SHARED_TYPES_H


20 
	#_THREAD_SHARED_TYPES_H
 1

	)

77 
	~<b™s/±h»adty³s-¬ch.h
>

81 #ià!
__PTHREAD_MUTEX_USE_UNION


82 
	s__±h»ad_š‹º®_li¡


84 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

85 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

86 } 
	t__±h»ad_li¡_t
;

88 
	s__±h»ad_š‹º®_¦i¡


90 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

91 } 
	t__±h»ad_¦i¡_t
;

95 #ià
__PTHREAD_MUTEX_LOCK_ELISION


96 #ià!
__PTHREAD_MUTEX_USE_UNION


97 
	#__PTHREAD_SPINS_DATA
 \

98 
__¥šs
; \

99 
__–isiÚ


	)

100 
	#__PTHREAD_SPINS
 0, 0

	)

102 
	#__PTHREAD_SPINS_DATA
 \

105 
__e¥šs
; \

106 
__“lisiÚ
; \

107 } 
__–isiÚ_d©a


	)

108 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

109 
	#__¥šs
 
__–isiÚ_d©a
.
__e¥šs


	)

110 
	#__–isiÚ
 
__–isiÚ_d©a
.
__“lisiÚ


	)

113 
	#__PTHREAD_SPINS_DATA
 
__¥šs


	)

115 
	#__PTHREAD_SPINS
 0

	)

118 
	s__±h»ad_mu‹x_s


120 
__lock
 
	m__LOCK_ALIGNMENT
;

121 
	m__couÁ
;

122 
	m__owÃr
;

123 #ià!
__PTHREAD_MUTEX_NUSERS_AFTER_KIND


124 
	m__nu£rs
;

128 
	m__kšd
;

129 
	m__PTHREAD_COMPAT_PADDING_MID


130 #ià
__PTHREAD_MUTEX_NUSERS_AFTER_KIND


131 
	m__nu£rs
;

133 #ià!
__PTHREAD_MUTEX_USE_UNION


134 
	m__PTHREAD_SPINS_DATA
;

135 
__±h»ad_li¡_t
 
	m__li¡
;

136 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

138 
__ex‹nsiÚ__
 union

140 
	m__PTHREAD_SPINS_DATA
;

141 
__±h»ad_¦i¡_t
 
	m__li¡
;

143 
	#__PTHREAD_MUTEX_HAVE_PREV
 0

	)

145 
	m__PTHREAD_COMPAT_PADDING_END


151 
	s__±h»ad_cÚd_s


153 
__ex‹nsiÚ__
 union

155 
__ex‹nsiÚ__
 
	m__w£q
;

158 
	m__low
;

159 
	m__high
;

160 } 
	m__w£q32
;

162 
__ex‹nsiÚ__
 union

164 
__ex‹nsiÚ__
 
	m__g1_¡¬t
;

167 
	m__low
;

168 
	m__high
;

169 } 
	m__g1_¡¬t32
;

171 
	m__g_»fs
[2] 
	m__LOCK_ALIGNMENT
;

172 
	m__g_size
[2];

173 
	m__g1_Üig_size
;

174 
	m__w»fs
;

175 
	m__g_sigÇls
[2];

	@/usr/include/bits/time.h

23 #iâdeà
_BITS_TIME_H


24 
	#_BITS_TIME_H
 1

	)

26 
	~<b™s/ty³s.h
>

34 
	#CLOCKS_PER_SEC
 ((
__şock_t
è1000000)

	)

36 #ià(!
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_POSIX
) \

37 && !
defšed
 
__USE_XOPEN2K


40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

54 
	#CLOCK_MONOTONIC_RAW
 4

	)

56 
	#CLOCK_REALTIME_COARSE
 5

	)

58 
	#CLOCK_MONOTONIC_COARSE
 6

	)

60 
	#CLOCK_BOOTTIME
 7

	)

62 
	#CLOCK_REALTIME_ALARM
 8

	)

64 
	#CLOCK_BOOTTIME_ALARM
 9

	)

66 
	#CLOCK_TAI
 11

	)

69 
	#TIMER_ABSTIME
 1

	)

72 #ifdeà
__USE_GNU


73 
	~<b™s/timex.h
>

75 
__BEGIN_DECLS


78 
	$şock_adjtime
 (
__şockid_t
 
__şock_id
, 
timex
 *
__utx
è
__THROW
;

80 
__END_DECLS


	@/usr/include/bits/types/__locale_t.h

20 #iâdeà
_BITS_TYPES___LOCALE_T_H


21 
	#_BITS_TYPES___LOCALE_T_H
 1

	)

28 
	s__loÿË_¡ruù


31 
__loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

42 
__loÿË_¡ruù
 *
	t__loÿË_t
;

	@/usr/include/bits/types/sigset_t.h

1 #iâdeà
__sig£t_t_defšed


2 
	#__sig£t_t_defšed
 1

	)

4 
	~<b™s/ty³s/__sig£t_t.h
>

7 
__sig£t_t
 
	tsig£t_t
;

	@/usr/include/bits/types/struct_itimerspec.h

1 #iâdeà
__™im”¥ec_defšed


2 
	#__™im”¥ec_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

5 
	~<b™s/ty³s/¡ruù_time¥ec.h
>

8 
	s™im”¥ec


10 
time¥ec
 
	m™_š‹rv®
;

11 
time¥ec
 
	m™_v®ue
;

	@/usr/include/bits/types/struct_rusage.h

19 #iâdeà
__ru§ge_defšed


20 
	#__ru§ge_defšed
 1

	)

22 
	~<b™s/ty³s.h
>

23 
	~<b™s/ty³s/¡ruù_timev®.h
>

31 
	sru§ge


34 
timev®
 
	mru_utime
;

36 
timev®
 
	mru_¡ime
;

38 
__ex‹nsiÚ__
 union

40 
	mru_maxrss
;

41 
__sysÿÎ_¦Úg_t
 
	m__ru_maxrss_wÜd
;

46 
__ex‹nsiÚ__
 union

48 
	mru_ixrss
;

49 
__sysÿÎ_¦Úg_t
 
	m__ru_ixrss_wÜd
;

52 
__ex‹nsiÚ__
 union

54 
	mru_idrss
;

55 
__sysÿÎ_¦Úg_t
 
	m__ru_idrss_wÜd
;

58 
__ex‹nsiÚ__
 union

60 
	mru_i¤ss
;

61 
__sysÿÎ_¦Úg_t
 
	m__ru_i¤ss_wÜd
;

65 
__ex‹nsiÚ__
 union

67 
	mru_mšæt
;

68 
__sysÿÎ_¦Úg_t
 
	m__ru_mšæt_wÜd
;

71 
__ex‹nsiÚ__
 union

73 
	mru_majæt
;

74 
__sysÿÎ_¦Úg_t
 
	m__ru_majæt_wÜd
;

77 
__ex‹nsiÚ__
 union

79 
	mru_nsw­
;

80 
__sysÿÎ_¦Úg_t
 
	m__ru_nsw­_wÜd
;

84 
__ex‹nsiÚ__
 union

86 
	mru_šblock
;

87 
__sysÿÎ_¦Úg_t
 
	m__ru_šblock_wÜd
;

90 
__ex‹nsiÚ__
 union

92 
	mru_oublock
;

93 
__sysÿÎ_¦Úg_t
 
	m__ru_oublock_wÜd
;

96 
__ex‹nsiÚ__
 union

98 
	mru_msg¢d
;

99 
__sysÿÎ_¦Úg_t
 
	m__ru_msg¢d_wÜd
;

102 
__ex‹nsiÚ__
 union

104 
	mru_msgrcv
;

105 
__sysÿÎ_¦Úg_t
 
	m__ru_msgrcv_wÜd
;

108 
__ex‹nsiÚ__
 union

110 
	mru_nsigÇls
;

111 
__sysÿÎ_¦Úg_t
 
	m__ru_nsigÇls_wÜd
;

116 
__ex‹nsiÚ__
 union

118 
	mru_nvcsw
;

119 
__sysÿÎ_¦Úg_t
 
	m__ru_nvcsw_wÜd
;

123 
__ex‹nsiÚ__
 union

125 
	mru_nivcsw
;

126 
__sysÿÎ_¦Úg_t
 
	m__ru_nivcsw_wÜd
;

	@/usr/include/bits/types/struct_tm.h

1 #iâdeà
__¡ruù_tm_defšed


2 
	#__¡ruù_tm_defšed
 1

	)

4 
	~<b™s/ty³s.h
>

7 
	stm


9 
	mtm_£c
;

10 
	mtm_mš
;

11 
	mtm_hour
;

12 
	mtm_mday
;

13 
	mtm_mÚ
;

14 
	mtm_y—r
;

15 
	mtm_wday
;

16 
	mtm_yday
;

17 
	mtm_isd¡
;

19 #ifdef 
__USE_MISC


20 
	mtm_gmtoff
;

21 cÚ¡ *
	mtm_zÚe
;

23 
	m__tm_gmtoff
;

24 cÚ¡ *
	m__tm_zÚe
;

	@/usr/include/bits/typesizes.h

19 #iâdeà
_BITS_TYPES_H


23 #iâdef 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifdeà
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

74 
	#__CPU_MASK_TYPE
 
__SYSCALL_ULONG_TYPE


	)

76 #ifdeà
__x86_64__


80 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

83 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__RLIM_T_MATCHES_RLIM64_T
 1

	)

88 
	#__RLIM_T_MATCHES_RLIM64_T
 0

	)

92 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uintn-identity.h

19 #ià!
defšed
 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


23 #iâdeà
_BITS_UINTN_IDENTITY_H


24 
	#_BITS_UINTN_IDENTITY_H
 1

	)

26 
	~<b™s/ty³s.h
>

32 
__šlše
 
__ušt16_t


33 
	$__ušt16_id’t™y
 (
__ušt16_t
 
__x
)

35  
__x
;

36 
	}
}

38 
__šlše
 
__ušt32_t


39 
	$__ušt32_id’t™y
 (
__ušt32_t
 
__x
)

41  
__x
;

42 
	}
}

44 
__šlše
 
__ušt64_t


45 
	$__ušt64_id’t™y
 (
__ušt64_t
 
__x
)

47  
__x
;

48 
	}
}

	@/usr/include/gnu/stubs.h

6 #ià!
defšed
 
__x86_64__


7 
	~<gnu/¡ubs-32.h
>

9 #ià
defšed
 
__x86_64__
 && defšed 
__LP64__


10 
	~<gnu/¡ubs-64.h
>

12 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


13 
	~<gnu/¡ubs-x32.h
>

	@/usr/include/linux/errno.h

1 
	~<asm/”ºo.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

58 
	#__STDC_ISO_10646__
 201706L

	)

61 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/sys/cdefs.h

18 #iâdef 
_SYS_CDEFS_H


19 
	#_SYS_CDEFS_H
 1

	)

22 #iâdeà
_FEATURES_H


23 
	~<ã©u»s.h
>

29 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


34 #undeà
__P


35 #undeà
__PMT


37 #ifdeà
__GNUC__


41 #ià
__GNUC_PREREQ
 (4, 6è&& !
defšed
 
_LIBC


42 
	#__LEAF
 , 
__Ëaf__


	)

43 
	#__LEAF_ATTR
 
	`__©Œibu‹__
 ((
__Ëaf__
))

	)

45 
	#__LEAF


	)

46 
	#__LEAF_ATTR


	)

54 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

55 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
))

	)

56 
	#__THROWNL
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

57 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
)è
	)
fct

58 
	#__NTHNL
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

60 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
fù
è
__LEAF_ATTR
 fù 
	`throw
 ()

	)

64 
	#__NTHNL
(
fù
èfù 
	`throw
 ()

	)

66 
	#__THROW


	)

67 
	#__THROWNL


	)

68 
	#__NTH
(
fù
è
	)
fct

69 
	#__NTHNL
(
fù
è
	)
fct

75 
	#__šlše


	)

77 
	#__THROW


	)

78 
	#__THROWNL


	)

79 
	#__NTH
(
fù
è
	)
fct

86 #ià
defšed
 
__şªg__
 && defšed 
__has_ex‹nsiÚ


87 
	#__glibc_şªg_has_ex‹nsiÚ
(
ext
è
	`__has_ex‹nsiÚ
 (ext)

	)

89 
	#__glibc_şªg_has_ex‹nsiÚ
(
ext
è0

	)

94 
	#__P
(
¬gs
è
	)
args

95 
	#__PMT
(
¬gs
è
	)
args

100 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

101 
	#__STRING
(
x
è#x

	)

104 
	#__±r_t
 *

	)

108 #ifdef 
__ılu¥lus


109 
	#__BEGIN_DECLS
 "C" {

	)

110 
	#__END_DECLS
 }

	)

112 
	#__BEGIN_DECLS


	)

113 
	#__END_DECLS


	)

118 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

119 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

121 #ià
__GNUC_PREREQ
 (4,3)

122 
	#__w¬ndeş
(
Çme
, 
msg
) \

123 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

124 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

125 
	#__”rÜdeş
(
Çme
, 
msg
) \

126 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

128 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

129 
	#__w¬Ç‰r
(
msg
)

	)

130 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

137 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

138 
	#__æex¬r
 []

	)

139 
	#__glibc_c99_æex¬r_avaabË
 1

	)

140 #–ià
__GNUC_PREREQ
 (2,97)

143 
	#__æex¬r
 []

	)

144 
	#__glibc_c99_æex¬r_avaabË
 1

	)

145 #–ià
defšed
 
__GNUC__


148 
	#__æex¬r
 [0]

	)

149 
	#__glibc_c99_æex¬r_avaabË
 1

	)

152 
	#__æex¬r
 [1]

	)

153 
	#__glibc_c99_æex¬r_avaabË
 0

	)

167 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

169 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

170 #ifdeà
__ılu¥lus


171 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

172 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

173 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

174 
Çme
 
´Ùo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

176 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

177 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

178 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

179 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROWNL


	)

181 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

182 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

195 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

196 
	#__©Œibu‹__
(
xyz
è

	)

202 #ià
__GNUC_PREREQ
 (2,96)

203 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

205 
	#__©Œibu‹_m®loc__


	)

210 #ià
__GNUC_PREREQ
 (4, 3)

211 
	#__©Œibu‹_®loc_size__
(
·¿ms
) \

212 
	`__©Œibu‹__
 ((
__®loc_size__
 
·¿ms
))

	)

214 
	#__©Œibu‹_®loc_size__
(
·¿ms
è

	)

220 #ià
__GNUC_PREREQ
 (2,96)

221 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

223 
	#__©Œibu‹_pu»__


	)

227 #ià
__GNUC_PREREQ
 (2,5)

228 
	#__©Œibu‹_cÚ¡__
 
	`__©Œibu‹__
 ((
__cÚ¡__
))

	)

230 
	#__©Œibu‹_cÚ¡__


	)

236 #ià
__GNUC_PREREQ
 (3,1)

237 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

238 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

240 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

241 
	#__©Œibu‹_nošlše__


	)

245 #ià
__GNUC_PREREQ
 (3,2)

246 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

248 
	#__©Œibu‹_d•»ÿ‹d__


	)

254 #ià
__GNUC_PREREQ
 (4,5) || \

255 
	$__glibc_şªg_has_ex‹nsiÚ
 (
__©Œibu‹_d•»ÿ‹d_w™h_mes§ge__
)

256 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
) \

257 
	`__©Œibu‹__
 ((
	`__d•»ÿ‹d__
 (
msg
)))

	)

259 
	#__©Œibu‹_d•»ÿ‹d_msg__
(
msg
è
__©Œibu‹_d•»ÿ‹d__


	)

268 #ià
	`__GNUC_PREREQ
 (2,8)

269 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

271 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

278 #ià
	`__GNUC_PREREQ
 (2,97)

279 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

280 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

282 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

287 #ià
	`__GNUC_PREREQ
 (3,3)

288 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

290 
	#__nÚnuÎ
(
·¿ms
)

	)

295 #ià
	`__GNUC_PREREQ
 (3,4)

296 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

297 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

298 #ià
__USE_FORTIFY_LEVEL
 > 0

299 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

302 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

304 #iâdeà
__wur


305 
	#__wur


	)

309 #ià
	`__GNUC_PREREQ
 (3,2)

313 #undeà
__®ways_šlše


314 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

316 #undeà
__®ways_šlše


317 
	#__®ways_šlše
 
__šlše


	)

322 #ià
	`__GNUC_PREREQ
 (4,3)

323 
	#__©Œibu‹_¬tificŸl__
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

325 
	#__©Œibu‹_¬tificŸl__


	)

337 #ià(!
defšed
 
__ılu¥lus
 || 
	`__GNUC_PREREQ
 (4,3) \

338 || (
defšed
 
__şªg__
 && (defšed 
__GNUC_STDC_INLINE__
 \

339 || 
defšed
 
__GNUC_GNU_INLINE__
)))

340 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


341 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

342 
	#__ex‹º_®ways_šlše
 \

343 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

345 
	#__ex‹º_šlše
 
__šlše


	)

346 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

350 #ifdeà
__ex‹º_®ways_šlše


351 
	#__fÜtify_funùiÚ
 
__ex‹º_®ways_šlše
 
__©Œibu‹_¬tificŸl__


	)

356 #ià
	`__GNUC_PREREQ
 (4,3)

357 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

358 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

365 #ià!
	`__GNUC_PREREQ
 (2,8)

366 
	#__ex‹nsiÚ__


	)

370 #ià!
	`__GNUC_PREREQ
 (2,92)

371 
	#__»¡riù


	)

377 #ià
	`__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


378 
	#__»¡riù_¬r
 
__»¡riù


	)

380 #ifdeà
__GNUC__


381 
	#__»¡riù_¬r


	)

383 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

384 
	#__»¡riù_¬r
 
»¡riù


	)

387 
	#__»¡riù_¬r


	)

392 #ià
__GNUC__
 >= 3

393 
	#__glibc_uÆik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 0)

	)

394 
	#__glibc_lik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 1)

	)

396 
	#__glibc_uÆik–y
(
cÚd
è(cÚd)

	)

397 
	#__glibc_lik–y
(
cÚd
è(cÚd)

	)

400 #ià(!
defšed
 
_NÜ‘uº
 \

401 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

402 && !
	$__GNUC_PREREQ
 (4,7))

403 #ià
	`__GNUC_PREREQ
 (2,8)

404 
	#_NÜ‘uº
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

	)

406 
	#_NÜ‘uº


	)

410 #ià
	`__GNUC_PREREQ
 (8, 0)

414 
	#__©Œibu‹_nÚ¡ršg__
 
	`__©Œibu‹__
 ((
__nÚ¡ršg__
))

	)

416 
	#__©Œibu‹_nÚ¡ršg__


	)

419 #ià(!
defšed
 
_Stic_as£¹
 && !defšed 
__ılu¥lus
 \

420 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

421 && (!
	`__GNUC_PREREQ
 (4, 6è|| 
defšed
 
__STRICT_ANSI__
))

422 
	#_Stic_as£¹
(
ex´
, 
dŸgno¡ic
) \

423 (*
	`__Stic_as£¹_funùiÚ
 ()) \

424 [!! (¡ruù { 
__”rÜ_if_Ãg©ive
: (
ex´
è? 2 : -1; })]

	)

427 
	~<b™s/wÜdsize.h
>

428 
	~<b™s/lÚg-doubË.h
>

430 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


431 
	#__LDBL_COMPAT
 1

	)

432 #ifdeà
__REDIRECT


433 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

434 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

435 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

436 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

437 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

438 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

439 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

440 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

441 
	#__LDBL_REDIR_DECL
(
Çme
) \

442 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

443 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

444 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

445 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

446 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

449 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


450 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

451 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

452 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

453 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

454 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

455 #ifdeà
__REDIRECT


456 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

457 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

458 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

467 #ià
	`__GNUC_PREREQ
 (4,8è|| 
	`__glibc_şªg_´”eq
 (3,5)

468 
	#__glibc_maüo_w¬nšg1
(
mes§ge
è
	`_P¿gma
 (#mes§ge)

	)

469 
	#__glibc_maüo_w¬nšg
(
mes§ge
) \

470 
	`__glibc_maüo_w¬nšg1
 (
GCC
 
w¬nšg
 
mes§ge
)

	)

472 
	#__glibc_maüo_w¬nšg
(
msg
)

	)

482 #ià!
defšed
 
__ılu¥lus
 \

483 && (
	`__GNUC_PREREQ
 (4, 9) \

484 || 
	`__glibc_şªg_has_ex‹nsiÚ
 (
c_g’”ic_£ËùiÚs
) \

485 || (!
defšed
 
__GNUC__
 && defšed 
__STDC_VERSION__
 \

486 && 
__STDC_VERSION__
 >= 201112L))

487 
	#__HAVE_GENERIC_SELECTION
 1

	)

489 
	#__HAVE_GENERIC_SELECTION
 0

	)

	@/usr/include/sys/uio.h

18 #iâdeà
_SYS_UIO_H


19 
	#_SYS_UIO_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<sys/ty³s.h
>

23 
	~<b™s/ty³s/¡ruù_iovec.h
>

24 
	~<b™s/uio_lim.h
>

25 #ifdeà
__IOV_MAX


26 
	#UIO_MAXIOV
 
__IOV_MAX


	)

28 #undeà
UIO_MAXIOV


31 
__BEGIN_DECLS


41 
ssize_t
 
	$»adv
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
)

42 
__wur
;

52 
ssize_t
 
	$wr™ev
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
)

53 
__wur
;

56 #ifdeà
__USE_MISC


57 #iâdeà
__USE_FILE_OFFSET64


67 
ssize_t
 
	$´—dv
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

68 
__off_t
 
__off£t
è
__wur
;

79 
ssize_t
 
	$pwr™ev
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

80 
__off_t
 
__off£t
è
__wur
;

83 #ifdeà
__REDIRECT


84 
ssize_t
 
	`__REDIRECT
 (
´—dv
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

85 
__couÁ
, 
__off64_t
 
__off£t
),

86 
´—dv64
è
__wur
;

87 
ssize_t
 
	`__REDIRECT
 (
pwr™ev
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

88 
__couÁ
, 
__off64_t
 
__off£t
),

89 
pwr™ev64
è
__wur
;

91 
	#´—dv
 
´—dv64


	)

92 
	#pwr™ev
 
pwr™ev64


	)

96 #ifdeà
__USE_LARGEFILE64


106 
ssize_t
 
	$´—dv64
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

107 
__off64_t
 
__off£t
è
__wur
;

118 
ssize_t
 
	$pwr™ev64
 (
__fd
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

119 
__off64_t
 
__off£t
è
__wur
;

124 #ifdeà
__USE_GNU


125 #iâdeà
__USE_FILE_OFFSET64


127 
ssize_t
 
	$´—dv2
 (
__å
, cÚ¡ 
iovec
 *
__iovec
, 
__couÁ
,

128 
__off_t
 
__off£t
, 
___æags
è
__wur
;

131 
ssize_t
 
	$pwr™ev2
 (
__fd
, cÚ¡ 
iovec
 *
__iodev
, 
__couÁ
,

132 
__off_t
 
__off£t
, 
__æags
è
__wur
;

135 #ifdeà
__REDIRECT


136 
ssize_t
 
	`__REDIRECT
 (
pwr™ev2
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

137 
__couÁ
, 
__off64_t
 
__off£t
,

138 
__æags
),

139 
pwr™ev64v2
è
__wur
;

140 
ssize_t
 
	`__REDIRECT
 (
´—dv2
, (
__fd
, cÚ¡ 
iovec
 *
__iovec
,

141 
__couÁ
, 
__off64_t
 
__off£t
,

142 
__æags
),

143 
´—dv64v2
è
__wur
;

145 
	#´—dv2
 
´—dv64v2


	)

146 
	#pwr™ev2
 
pwr™ev64v2


	)

150 #ifdeà
__USE_LARGEFILE64


152 
ssize_t
 
	$´—dv64v2
 (
__å
, cÚ¡ 
iovec
 *
__iovec
,

153 
__couÁ
, 
__off64_t
 
__off£t
,

154 
___æags
è
__wur
;

157 
ssize_t
 
	$pwr™ev64v2
 (
__fd
, cÚ¡ 
iovec
 *
__iodev
,

158 
__couÁ
, 
__off64_t
 
__off£t
,

159 
__æags
è
__wur
;

163 
__END_DECLS


167 #ifdeà
__USE_GNU


168 
	~<b™s/uio-ext.h
>

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/bits/byteswap-16.h

19 #iâdeà
_BITS_BYTESWAP_H


23 #ifdeà
__GNUC__


24 #ià
__GNUC__
 >= 2

25 
	#__bsw­_16
(
x
) \

26 (
__ex‹nsiÚ__
 \

27 ({ 
__v
, 
__x
 = (è(
x
); \

28 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

29 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "ô" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw­_16
(
x
) \

39 (
__ex‹nsiÚ__
 \

40 ({ 
__x
 = (è(
x
); \

41 
	`__bsw­_cÚ¡ªt_16
 (
__x
); }))

	)

44 
__šlše
 

45 
	$__bsw­_16
 (
__bsx
)

47  
	`__bsw­_cÚ¡ªt_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/long-double.h

	@/usr/include/bits/mman-shared.h

19 #iâdeà
_SYS_MMAN_H


23 #ifdeà
__USE_GNU


25 #iâdeà
MFD_CLOEXEC


26 
	#MFD_CLOEXEC
 1U

	)

27 
	#MFD_ALLOW_SEALING
 2U

	)

28 
	#MFD_HUGETLB
 4U

	)

32 #iâdeà
MLOCK_ONFAULT


33 
	#MLOCK_ONFAULT
 1U

	)

37 #iâdeà
PKEY_DISABLE_ACCESS


38 
	#PKEY_DISABLE_ACCESS
 0x1

	)

39 
	#PKEY_DISABLE_WRITE
 0x2

	)

42 
__BEGIN_DECLS


46 
	$memfd_ü—‹
 (cÚ¡ *
__Çme
, 
__æags
è
__THROW
;

50 
	$mlock2
 (cÚ¡ *
__addr
, 
size_t
 
__Ëngth
, 
__æags
è
__THROW
;

56 
	$pkey_®loc
 (
__æags
, 
__acûss_rights
è
__THROW
;

60 
	$pkey_£t
 (
__key
, 
__acûss_rights
è
__THROW
;

64 
	$pkey_g‘
 (
__key
è
__THROW
;

68 
	$pkey_ä“
 (
__key
è
__THROW
;

72 
	$pkey_m´Ùeù
 (*
__addr
, 
size_t
 
__Ën
, 
__´Ù
, 
__pkey
è
__THROW
;

74 
__END_DECLS


	@/usr/include/bits/pthreadtypes-arch.h

18 #iâdeà
_BITS_PTHREADTYPES_ARCH_H


19 
	#_BITS_PTHREADTYPES_ARCH_H
 1

	)

21 
	~<b™s/wÜdsize.h
>

23 #ifdeà
__x86_64__


24 #ià
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

29 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

31 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

32 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

33 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

34 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

35 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

38 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

39 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

40 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

45 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

46 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

47 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

48 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

51 
	#__PTHREAD_COMPAT_PADDING_MID


	)

52 
	#__PTHREAD_COMPAT_PADDING_END


	)

53 
	#__PTHREAD_MUTEX_LOCK_ELISION
 1

	)

54 #ifdeà
__x86_64__


55 
	#__PTHREAD_MUTEX_NUSERS_AFTER_KIND
 0

	)

56 
	#__PTHREAD_MUTEX_USE_UNION
 0

	)

58 
	#__PTHREAD_MUTEX_NUSERS_AFTER_KIND
 1

	)

59 
	#__PTHREAD_MUTEX_USE_UNION
 1

	)

62 
	#__LOCK_ALIGNMENT


	)

63 
	#__ONCE_ALIGNMENT


	)

65 
	s__±h»ad_rwlock_¬ch_t


67 
	m__»ad”s
;

68 
	m__wr™”s
;

69 
	m__w½ha£_fu‹x
;

70 
	m__wr™”s_fu‹x
;

71 
	m__·d3
;

72 
	m__·d4
;

73 #ifdeà
__x86_64__


74 
	m__cur_wr™”
;

75 
	m__sh¬ed
;

76 sigÃd 
	m__rw–isiÚ
;

77 #ifdeà 
__ILP32__


78 
	m__·d1
[3];

79 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0 }

	)

81 
	m__·d1
[7];

82 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0, { 0, 0, 0, 0, 0, 0, 0 }

	)

84 
	m__·d2
;

87 
	m__æags
;

88 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

92 
	m__æags
;

93 
	m__sh¬ed
;

94 sigÃd 
	m__rw–isiÚ
;

95 
	#__PTHREAD_RWLOCK_ELISION_EXTRA
 0

	)

96 
	m__·d2
;

97 
	m__cur_wr™”
;

101 #iâdeà
__x86_64__


103 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/timex.h

18 #iâdef 
_BITS_TIMEX_H


19 
	#_BITS_TIMEX_H
 1

	)

21 
	~<b™s/ty³s.h
>

22 
	~<b™s/ty³s/¡ruù_timev®.h
>

26 
	stimex


28 
	mmodes
;

29 
__sysÿÎ_¦Úg_t
 
	moff£t
;

30 
__sysÿÎ_¦Úg_t
 
	mäeq
;

31 
__sysÿÎ_¦Úg_t
 
	mmax”rÜ
;

32 
__sysÿÎ_¦Úg_t
 
	me¡”rÜ
;

33 
	m¡©us
;

34 
__sysÿÎ_¦Úg_t
 
	mcÚ¡ªt
;

35 
__sysÿÎ_¦Úg_t
 
	m´ecisiÚ
;

36 
__sysÿÎ_¦Úg_t
 
	mtŞ”ªû
;

37 
timev®
 
	mtime
;

38 
__sysÿÎ_¦Úg_t
 
	mtick
;

39 
__sysÿÎ_¦Úg_t
 
	mµsäeq
;

40 
__sysÿÎ_¦Úg_t
 
	mj™‹r
;

41 
	mshiá
;

42 
__sysÿÎ_¦Úg_t
 
	m¡ab
;

43 
__sysÿÎ_¦Úg_t
 
	mj™út
;

44 
__sysÿÎ_¦Úg_t
 
	mÿlút
;

45 
__sysÿÎ_¦Úg_t
 
	m”rút
;

46 
__sysÿÎ_¦Úg_t
 
	m¡bút
;

48 
	mi
;

57 
	#ADJ_OFFSET
 0x0001

	)

58 
	#ADJ_FREQUENCY
 0x0002

	)

59 
	#ADJ_MAXERROR
 0x0004

	)

60 
	#ADJ_ESTERROR
 0x0008

	)

61 
	#ADJ_STATUS
 0x0010

	)

62 
	#ADJ_TIMECONST
 0x0020

	)

63 
	#ADJ_TAI
 0x0080

	)

64 
	#ADJ_SETOFFSET
 0x0100

	)

65 
	#ADJ_MICRO
 0x1000

	)

66 
	#ADJ_NANO
 0x2000

	)

67 
	#ADJ_TICK
 0x4000

	)

68 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

69 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

72 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

73 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

74 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

75 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

76 
	#MOD_STATUS
 
ADJ_STATUS


	)

77 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

78 
	#MOD_CLKB
 
ADJ_TICK


	)

79 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

80 
	#MOD_TAI
 
ADJ_TAI


	)

81 
	#MOD_MICRO
 
ADJ_MICRO


	)

82 
	#MOD_NANO
 
ADJ_NANO


	)

86 
	#STA_PLL
 0x0001

	)

87 
	#STA_PPSFREQ
 0x0002

	)

88 
	#STA_PPSTIME
 0x0004

	)

89 
	#STA_FLL
 0x0008

	)

91 
	#STA_INS
 0x0010

	)

92 
	#STA_DEL
 0x0020

	)

93 
	#STA_UNSYNC
 0x0040

	)

94 
	#STA_FREQHOLD
 0x0080

	)

96 
	#STA_PPSSIGNAL
 0x0100

	)

97 
	#STA_PPSJITTER
 0x0200

	)

98 
	#STA_PPSWANDER
 0x0400

	)

99 
	#STA_PPSERROR
 0x0800

	)

101 
	#STA_CLOCKERR
 0x1000

	)

102 
	#STA_NANO
 0x2000

	)

103 
	#STA_MODE
 0x4000

	)

104 
	#STA_CLK
 0x8000

	)

107 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

108 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@/usr/include/bits/types/__mbstate_t.h

1 #iâdeà
____mb¡©e_t_defšed


2 
	#____mb¡©e_t_defšed
 1

	)

8 #iâdeà
__WINT_TYPE__


9 
	#__WINT_TYPE__
 

	)

15 
	m__couÁ
;

18 
__WINT_TYPE__
 
	m__wch
;

19 
	m__wchb
[4];

20 } 
	m__v®ue
;

21 } 
	t__mb¡©e_t
;

	@/usr/include/bits/types/__sigset_t.h

1 #iâdeà
____sig£t_t_defšed


2 
	#____sig£t_t_defšed


	)

4 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

7 
	m__v®
[
_SIGSET_NWORDS
];

8 } 
	t__sig£t_t
;

	@/usr/include/bits/types/struct_iovec.h

19 #iâdeà
__iovec_defšed


20 
	#__iovec_defšed
 1

	)

22 
	#__Ãed_size_t


	)

23 
	~<¡ddef.h
>

26 
	siovec


28 *
	miov_ba£
;

29 
size_t
 
	miov_Ën
;

	@/usr/include/bits/types/wint_t.h

1 #iâdeà
__wšt_t_defšed


2 
	#__wšt_t_defšed
 1

	)

9 #iâdeà
_WINT_T


10 
	#_WINT_T
 1

	)

16 #iâdeà
__WINT_TYPE__


17 
	#__WINT_TYPE__
 

	)

20 
__WINT_TYPE__
 
	twšt_t
;

	@/usr/include/bits/uio-ext.h

19 #iâdeà
_BITS_UIO_EXT_H


20 
	#_BITS_UIO_EXT_H
 1

	)

22 #iâdeà
_SYS_UIO_H


26 
__BEGIN_DECLS


29 
ssize_t
 
	$´oûss_vm_»adv
 (
pid_t
 
__pid
, cÚ¡ 
iovec
 *
__lvec
,

30 
__liovút
,

31 cÚ¡ 
iovec
 *
__rvec
,

32 
__riovút
,

33 
__æags
)

34 
__THROW
;

37 
ssize_t
 
	$´oûss_vm_wr™ev
 (
pid_t
 
__pid
, cÚ¡ 
iovec
 *
__lvec
,

38 
__liovút
,

39 cÚ¡ 
iovec
 *
__rvec
,

40 
__riovút
,

41 
__æags
)

42 
__THROW
;

45 
	#RWF_HIPRI
 0x00000001

	)

46 
	#RWF_DSYNC
 0x00000002

	)

47 
	#RWF_SYNC
 0x00000004

	)

48 
	#RWF_NOWAIT
 0x00000008

	)

50 
__END_DECLS


	@/usr/include/bits/uio_lim.h

19 #iâdeà
_BITS_UIO_LIM_H


20 
	#_BITS_UIO_LIM_H
 1

	)

30 
	#__IOV_MAX
 1024

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s/__mb¡©e_t.h
>

27 
	~<b™s/ty³s/wšt_t.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004,

60 
	m__GCONV_TRANSLIT
 = 0x0008

65 
	g__gcÚv_¡•
;

66 
	g__gcÚv_¡•_d©a
;

67 
	g__gcÚv_lßded_objeù
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 
	s__gcÚv_¡•


86 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

87 cÚ¡ *
__modÇme
;

89 
__couÁ”
;

91 *
__äom_Çme
;

92 *
__to_Çme
;

94 
__gcÚv_fù
 
__fù
;

95 
__gcÚv_btowc_fù
 
__btowc_fù
;

96 
__gcÚv_š™_fù
 
__š™_fù
;

97 
__gcÚv_’d_fù
 
__’d_fù
;

101 
__mš_Ãeded_äom
;

102 
__max_Ãeded_äom
;

103 
__mš_Ãeded_to
;

104 
__max_Ãeded_to
;

107 
__¡©eful
;

109 *
__d©a
;

114 
	s__gcÚv_¡•_d©a


116 *
__outbuf
;

117 *
__outbuãnd
;

121 
__æags
;

125 
__švoÿtiÚ_couÁ”
;

129 
__š‹º®_u£
;

131 
__mb¡©e_t
 *
__¡©•
;

132 
__mb¡©e_t
 
__¡©e
;

138 
	s__gcÚv_šfo


140 
size_t
 
__n¡•s
;

141 
__gcÚv_¡•
 *
__¡•s
;

142 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
[0];

143 } *
	t__gcÚv_t
;

146 
	`__gcÚv_Œª¦™”©e
 (
__gcÚv_¡•
 *
¡•
,

147 
__gcÚv_¡•_d©a
 *
¡•_d©a
,

148 cÚ¡ *
šbuf¡¬t
,

149 cÚ¡ **
šbuå
,

150 cÚ¡ *
šbuãnd
,

151 **
outbuf¡¬t
,

152 
size_t
 *
œ»v”sibË
);

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_chæags


	)

11 
	#__¡ub_ç‰ach


	)

12 
	#__¡ub_fchæags


	)

13 
	#__¡ub_fd‘ach


	)

14 
	#__¡ub_g‰y


	)

15 
	#__¡ub_lchmod


	)

16 
	#__¡ub_»voke


	)

17 
	#__¡ub_£ogš


	)

18 
	#__¡ub_sig»tuº


	)

19 
	#__¡ub_s¡k


	)

20 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-x32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub___com·t_ü—‹_moduË


	)

12 
	#__¡ub___com·t_g‘_k”Ãl_syms


	)

13 
	#__¡ub___com·t_qu”y_moduË


	)

14 
	#__¡ub___com·t_u£lib


	)

15 
	#__¡ub_chæags


	)

16 
	#__¡ub_ç‰ach


	)

17 
	#__¡ub_fchæags


	)

18 
	#__¡ub_fd‘ach


	)

19 
	#__¡ub_g‘msg


	)

20 
	#__¡ub_g‰y


	)

21 
	#__¡ub_lchmod


	)

22 
	#__¡ub_nfs£rvùl


	)

23 
	#__¡ub_putmsg


	)

24 
	#__¡ub_»voke


	)

25 
	#__¡ub_£ogš


	)

26 
	#__¡ub_sig»tuº


	)

27 
	#__¡ub_s¡k


	)

28 
	#__¡ub_¡ty


	)

	@/usr/include/linux/falloc.h

2 #iâdeà
_FALLOC_H_


3 
	#_FALLOC_H_


	)

5 
	#FALLOC_FL_KEEP_SIZE
 0x01

	)

6 
	#FALLOC_FL_PUNCH_HOLE
 0x02

	)

7 
	#FALLOC_FL_NO_HIDE_STALE
 0x04

	)

29 
	#FALLOC_FL_COLLAPSE_RANGE
 0x08

	)

43 
	#FALLOC_FL_ZERO_RANGE
 0x10

	)

60 
	#FALLOC_FL_INSERT_RANGE
 0x20

	)

78 
	#FALLOC_FL_UNSHARE_RANGE
 0x40

	)

	@/usr/include/linux/limits.h

2 #iâdeà
_LINUX_LIMITS_H


3 
	#_LINUX_LIMITS_H


	)

5 
	#NR_OPEN
 1024

	)

7 
	#NGROUPS_MAX
 65536

	)

8 
	#ARG_MAX
 131072

	)

9 
	#LINK_MAX
 127

	)

10 
	#MAX_CANON
 255

	)

11 
	#MAX_INPUT
 255

	)

12 
	#NAME_MAX
 255

	)

13 
	#PATH_MAX
 4096

	)

14 
	#PIPE_BUF
 4096

	)

15 
	#XATTR_NAME_MAX
 255

	)

16 
	#XATTR_SIZE_MAX
 65536

	)

17 
	#XATTR_LIST_MAX
 65536

	)

19 
	#RTSIG_MAX
 32

	)

	@/usr/include/asm-generic/errno.h

2 #iâdeà
_ASM_GENERIC_ERRNO_H


3 
	#_ASM_GENERIC_ERRNO_H


	)

5 
	~<asm-g’”ic/”ºo-ba£.h
>

7 
	#EDEADLK
 35

	)

8 
	#ENAMETOOLONG
 36

	)

9 
	#ENOLCK
 37

	)

18 
	#ENOSYS
 38

	)

20 
	#ENOTEMPTY
 39

	)

21 
	#ELOOP
 40

	)

22 
	#EWOULDBLOCK
 
EAGAIN


	)

23 
	#ENOMSG
 42

	)

24 
	#EIDRM
 43

	)

25 
	#ECHRNG
 44

	)

26 
	#EL2NSYNC
 45

	)

27 
	#EL3HLT
 46

	)

28 
	#EL3RST
 47

	)

29 
	#ELNRNG
 48

	)

30 
	#EUNATCH
 49

	)

31 
	#ENOCSI
 50

	)

32 
	#EL2HLT
 51

	)

33 
	#EBADE
 52

	)

34 
	#EBADR
 53

	)

35 
	#EXFULL
 54

	)

36 
	#ENOANO
 55

	)

37 
	#EBADRQC
 56

	)

38 
	#EBADSLT
 57

	)

40 
	#EDEADLOCK
 
EDEADLK


	)

42 
	#EBFONT
 59

	)

43 
	#ENOSTR
 60

	)

44 
	#ENODATA
 61

	)

45 
	#ETIME
 62

	)

46 
	#ENOSR
 63

	)

47 
	#ENONET
 64

	)

48 
	#ENOPKG
 65

	)

49 
	#EREMOTE
 66

	)

50 
	#ENOLINK
 67

	)

51 
	#EADV
 68

	)

52 
	#ESRMNT
 69

	)

53 
	#ECOMM
 70

	)

54 
	#EPROTO
 71

	)

55 
	#EMULTIHOP
 72

	)

56 
	#EDOTDOT
 73

	)

57 
	#EBADMSG
 74

	)

58 
	#EOVERFLOW
 75

	)

59 
	#ENOTUNIQ
 76

	)

60 
	#EBADFD
 77

	)

61 
	#EREMCHG
 78

	)

62 
	#ELIBACC
 79

	)

63 
	#ELIBBAD
 80

	)

64 
	#ELIBSCN
 81

	)

65 
	#ELIBMAX
 82

	)

66 
	#ELIBEXEC
 83

	)

67 
	#EILSEQ
 84

	)

68 
	#ERESTART
 85

	)

69 
	#ESTRPIPE
 86

	)

70 
	#EUSERS
 87

	)

71 
	#ENOTSOCK
 88

	)

72 
	#EDESTADDRREQ
 89

	)

73 
	#EMSGSIZE
 90

	)

74 
	#EPROTOTYPE
 91

	)

75 
	#ENOPROTOOPT
 92

	)

76 
	#EPROTONOSUPPORT
 93

	)

77 
	#ESOCKTNOSUPPORT
 94

	)

78 
	#EOPNOTSUPP
 95

	)

79 
	#EPFNOSUPPORT
 96

	)

80 
	#EAFNOSUPPORT
 97

	)

81 
	#EADDRINUSE
 98

	)

82 
	#EADDRNOTAVAIL
 99

	)

83 
	#ENETDOWN
 100

	)

84 
	#ENETUNREACH
 101

	)

85 
	#ENETRESET
 102

	)

86 
	#ECONNABORTED
 103

	)

87 
	#ECONNRESET
 104

	)

88 
	#ENOBUFS
 105

	)

89 
	#EISCONN
 106

	)

90 
	#ENOTCONN
 107

	)

91 
	#ESHUTDOWN
 108

	)

92 
	#ETOOMANYREFS
 109

	)

93 
	#ETIMEDOUT
 110

	)

94 
	#ECONNREFUSED
 111

	)

95 
	#EHOSTDOWN
 112

	)

96 
	#EHOSTUNREACH
 113

	)

97 
	#EALREADY
 114

	)

98 
	#EINPROGRESS
 115

	)

99 
	#ESTALE
 116

	)

100 
	#EUCLEAN
 117

	)

101 
	#ENOTNAM
 118

	)

102 
	#ENAVAIL
 119

	)

103 
	#EISNAM
 120

	)

104 
	#EREMOTEIO
 121

	)

105 
	#EDQUOT
 122

	)

107 
	#ENOMEDIUM
 123

	)

108 
	#EMEDIUMTYPE
 124

	)

109 
	#ECANCELED
 125

	)

110 
	#ENOKEY
 126

	)

111 
	#EKEYEXPIRED
 127

	)

112 
	#EKEYREVOKED
 128

	)

113 
	#EKEYREJECTED
 129

	)

116 
	#EOWNERDEAD
 130

	)

117 
	#ENOTRECOVERABLE
 131

	)

119 
	#ERFKILL
 132

	)

121 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/errno-base.h

2 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


3 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

5 
	#EPERM
 1

	)

6 
	#ENOENT
 2

	)

7 
	#ESRCH
 3

	)

8 
	#EINTR
 4

	)

9 
	#EIO
 5

	)

10 
	#ENXIO
 6

	)

11 
	#E2BIG
 7

	)

12 
	#ENOEXEC
 8

	)

13 
	#EBADF
 9

	)

14 
	#ECHILD
 10

	)

15 
	#EAGAIN
 11

	)

16 
	#ENOMEM
 12

	)

17 
	#EACCES
 13

	)

18 
	#EFAULT
 14

	)

19 
	#ENOTBLK
 15

	)

20 
	#EBUSY
 16

	)

21 
	#EEXIST
 17

	)

22 
	#EXDEV
 18

	)

23 
	#ENODEV
 19

	)

24 
	#ENOTDIR
 20

	)

25 
	#EISDIR
 21

	)

26 
	#EINVAL
 22

	)

27 
	#ENFILE
 23

	)

28 
	#EMFILE
 24

	)

29 
	#ENOTTY
 25

	)

30 
	#ETXTBSY
 26

	)

31 
	#EFBIG
 27

	)

32 
	#ENOSPC
 28

	)

33 
	#ESPIPE
 29

	)

34 
	#EROFS
 30

	)

35 
	#EMLINK
 31

	)

36 
	#EPIPE
 32

	)

37 
	#EDOM
 33

	)

38 
	#ERANGE
 34

	)

	@
1
.
1
/usr/include
272
6725
build/CMakeFiles/3.10.2/CompilerIdC/CMakeCCompilerId.c
build/CMakeFiles/3.10.2/CompilerIdCXX/CMakeCXXCompilerId.cpp
build/CMakeFiles/CheckTypeSize/CMAKE_SIZEOF_UNSIGNED_SHORT.c
build/CMakeFiles/feature_tests.c
build/include/port/port_config.h
db/autocompact_test.cc
db/builder.cc
db/builder.h
db/c.cc
db/c_test.c
db/corruption_test.cc
db/db_bench.cc
db/db_impl.cc
db/db_impl.h
db/db_iter.cc
db/db_iter.h
db/db_test.cc
db/dbformat.cc
db/dbformat.h
db/dbformat_test.cc
db/dumpfile.cc
db/fault_injection_test.cc
db/fh.cc
db/fh.h
db/filename.cc
db/filename.h
db/filename_test.cc
db/leveldbutil.cc
db/log_format.h
db/log_reader.cc
db/log_reader.h
db/log_test.cc
db/log_writer.cc
db/log_writer.h
db/memtable.cc
db/memtable.h
db/recovery_test.cc
db/repair.cc
db/skiplist.h
db/skiplist_test.cc
db/snapshot.h
db/table_cache.cc
db/table_cache.h
db/version_edit.cc
db/version_edit.h
db/version_edit_test.cc
db/version_set.cc
db/version_set.h
db/version_set_test.cc
db/write_batch.cc
db/write_batch_internal.h
db/write_batch_test.cc
doc/bench/db_bench_sqlite3.cc
doc/bench/db_bench_tree_db.cc
helpers/memenv/memenv.cc
helpers/memenv/memenv.h
helpers/memenv/memenv_test.cc
include/leveldb/c.h
include/leveldb/cache.h
include/leveldb/comparator.h
include/leveldb/db.h
include/leveldb/dumpfile.h
include/leveldb/env.h
include/leveldb/export.h
include/leveldb/filter_policy.h
include/leveldb/iterator.h
include/leveldb/options.h
include/leveldb/slice.h
include/leveldb/status.h
include/leveldb/table.h
include/leveldb/table_builder.h
include/leveldb/write_batch.h
issues/issue178_test.cc
issues/issue200_test.cc
issues/issue320_test.cc
port/port.h
port/port_example.h
port/port_stdcxx.h
port/thread_annotations.h
table/block.cc
table/block.h
table/block_builder.cc
table/block_builder.h
table/filter_block.cc
table/filter_block.h
table/filter_block_test.cc
table/format.cc
table/format.h
table/iterator.cc
table/iterator_wrapper.h
table/merger.cc
table/merger.h
table/table.cc
table/table_builder.cc
table/table_test.cc
table/two_level_iterator.cc
table/two_level_iterator.h
util/arena.cc
util/arena.h
util/arena_test.cc
util/bloom.cc
util/bloom_test.cc
util/cache.cc
util/cache_test.cc
util/coding.cc
util/coding.h
util/coding_test.cc
util/comparator.cc
util/crc32c.cc
util/crc32c.h
util/crc32c_test.cc
util/env.cc
util/env_posix.cc
util/env_posix_test.cc
util/env_posix_test_helper.h
util/env_test.cc
util/env_windows.cc
util/env_windows_test.cc
util/env_windows_test_helper.h
util/filter_policy.cc
util/hash.cc
util/hash.h
util/hash_test.cc
util/histogram.cc
util/histogram.h
util/logging.cc
util/logging.h
util/logging_test.cc
util/mutexlock.h
util/no_destructor.h
util/no_destructor_test.cc
util/options.cc
util/posix_logger.h
util/random.h
util/status.cc
util/status_test.cc
util/testharness.cc
util/testharness.h
util/testutil.cc
util/testutil.h
util/windows_logger.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/math.h
/usr/include/pthread.h
/usr/include/snappy.h
/usr/include/sqlite3.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/sys/mman.h
/usr/include/sys/resource.h
/usr/include/sys/stat.h
/usr/include/sys/time.h
/usr/include/sys/types.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/bits/confname.h
/usr/include/bits/dirent.h
/usr/include/bits/environments.h
/usr/include/bits/errno.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/floatn.h
/usr/include/bits/flt-eval-method.h
/usr/include/bits/fp-fast.h
/usr/include/bits/fp-logb.h
/usr/include/bits/getopt_posix.h
/usr/include/bits/iscanonical.h
/usr/include/bits/libc-header-start.h
/usr/include/bits/libio.h
/usr/include/bits/math-finite.h
/usr/include/bits/math-vector.h
/usr/include/bits/mathcalls-helper-functions.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathinline.h
/usr/include/bits/mman.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/resource.h
/usr/include/bits/setjmp.h
/usr/include/bits/stat.h
/usr/include/bits/stdint-intn.h
/usr/include/bits/stdint-uintn.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-bsearch.h
/usr/include/bits/stdlib-float.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string_fortified.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/types.h
/usr/include/bits/types/FILE.h
/usr/include/bits/types/__FILE.h
/usr/include/bits/types/clock_t.h
/usr/include/bits/types/clockid_t.h
/usr/include/bits/types/locale_t.h
/usr/include/bits/types/struct_timespec.h
/usr/include/bits/types/struct_timeval.h
/usr/include/bits/types/time_t.h
/usr/include/bits/types/timer_t.h
/usr/include/bits/unistd.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wchar.h
/usr/include/bits/wordsize.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/sched.h
/usr/include/snappy-stubs-public.h
/usr/include/strings.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/time.h
/usr/include/bits/_G_config.h
/usr/include/bits/byteswap.h
/usr/include/bits/cpu-set.h
/usr/include/bits/endian.h
/usr/include/bits/fcntl-linux.h
/usr/include/bits/floatn-common.h
/usr/include/bits/getopt_core.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/libm-simd-decl-stubs.h
/usr/include/bits/local_lim.h
/usr/include/bits/mman-linux.h
/usr/include/bits/sched.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/strings_fortified.h
/usr/include/bits/sysmacros.h
/usr/include/bits/thread-shared-types.h
/usr/include/bits/time.h
/usr/include/bits/types/__locale_t.h
/usr/include/bits/types/sigset_t.h
/usr/include/bits/types/struct_itimerspec.h
/usr/include/bits/types/struct_rusage.h
/usr/include/bits/types/struct_tm.h
/usr/include/bits/typesizes.h
/usr/include/bits/uintn-identity.h
/usr/include/gnu/stubs.h
/usr/include/linux/errno.h
/usr/include/stdc-predef.h
/usr/include/sys/cdefs.h
/usr/include/sys/uio.h
/usr/include/asm/errno.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/long-double.h
/usr/include/bits/mman-shared.h
/usr/include/bits/pthreadtypes-arch.h
/usr/include/bits/timex.h
/usr/include/bits/types/__mbstate_t.h
/usr/include/bits/types/__sigset_t.h
/usr/include/bits/types/struct_iovec.h
/usr/include/bits/types/wint_t.h
/usr/include/bits/uio-ext.h
/usr/include/bits/uio_lim.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/gnu/stubs-x32.h
/usr/include/linux/falloc.h
/usr/include/linux/limits.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/errno-base.h
